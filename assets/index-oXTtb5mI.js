(function(){const ie=document.createElement("link").relList;if(ie&&ie.supports&&ie.supports("modulepreload"))return;for(const te of document.querySelectorAll('link[rel="modulepreload"]'))T(te);new MutationObserver(te=>{for(const ue of te)if(ue.type==="childList")for(const Re of ue.addedNodes)Re.tagName==="LINK"&&Re.rel==="modulepreload"&&T(Re)}).observe(document,{childList:!0,subtree:!0});function $(te){const ue={};return te.integrity&&(ue.integrity=te.integrity),te.referrerPolicy&&(ue.referrerPolicy=te.referrerPolicy),te.crossOrigin==="use-credentials"?ue.credentials="include":te.crossOrigin==="anonymous"?ue.credentials="omit":ue.credentials="same-origin",ue}function T(te){if(te.ep)return;te.ep=!0;const ue=$(te);fetch(te.href,ue)}})();var Ra=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Vd(H){return H&&H.__esModule&&Object.prototype.hasOwnProperty.call(H,"default")?H.default:H}var Wu={exports:{}},vr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ud;function nm(){if(Ud)return vr;Ud=1;var H=Symbol.for("react.transitional.element"),ie=Symbol.for("react.fragment");function $(T,te,ue){var Re=null;if(ue!==void 0&&(Re=""+ue),te.key!==void 0&&(Re=""+te.key),"key"in te){ue={};for(var Oe in te)Oe!=="key"&&(ue[Oe]=te[Oe])}else ue=te;return te=ue.ref,{$$typeof:H,type:T,key:Re,ref:te!==void 0?te:null,props:ue}}return vr.Fragment=ie,vr.jsx=$,vr.jsxs=$,vr}var xd;function im(){return xd||(xd=1,Wu.exports=nm()),Wu.exports}var Y=im(),Fu={exports:{}},me={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dd;function am(){if(Dd)return me;Dd=1;var H=Symbol.for("react.transitional.element"),ie=Symbol.for("react.portal"),$=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),ue=Symbol.for("react.consumer"),Re=Symbol.for("react.context"),Oe=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),D=Symbol.for("react.memo"),W=Symbol.for("react.lazy"),Te=Symbol.iterator;function ye(v){return v===null||typeof v!="object"?null:(v=Te&&v[Te]||v["@@iterator"],typeof v=="function"?v:null)}var fe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ue=Object.assign,At={};function Ke(v,G,V){this.props=v,this.context=G,this.refs=At,this.updater=V||fe}Ke.prototype.isReactComponent={},Ke.prototype.setState=function(v,G){if(typeof v!="object"&&typeof v!="function"&&v!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,v,G,"setState")},Ke.prototype.forceUpdate=function(v){this.updater.enqueueForceUpdate(this,v,"forceUpdate")};function Ee(){}Ee.prototype=Ke.prototype;function ut(v,G,V){this.props=v,this.context=G,this.refs=At,this.updater=V||fe}var Me=ut.prototype=new Ee;Me.constructor=ut,Ue(Me,Ke.prototype),Me.isPureReactComponent=!0;var N=Array.isArray,pe={H:null,A:null,T:null,S:null,V:null},tt=Object.prototype.hasOwnProperty;function ft(v,G,V,P,ne,we){return V=we.ref,{$$typeof:H,type:v,key:G,ref:V!==void 0?V:null,props:we}}function nt(v,G){return ft(v.type,G,void 0,void 0,void 0,v.props)}function xe(v){return typeof v=="object"&&v!==null&&v.$$typeof===H}function tn(v){var G={"=":"=0",":":"=2"};return"$"+v.replace(/[=:]/g,function(V){return G[V]})}var h=/\/+/g;function Ze(v,G){return typeof v=="object"&&v!==null&&v.key!=null?tn(""+v.key):G.toString(36)}function cn(){}function w(v){switch(v.status){case"fulfilled":return v.value;case"rejected":throw v.reason;default:switch(typeof v.status=="string"?v.then(cn,cn):(v.status="pending",v.then(function(G){v.status==="pending"&&(v.status="fulfilled",v.value=G)},function(G){v.status==="pending"&&(v.status="rejected",v.reason=G)})),v.status){case"fulfilled":return v.value;case"rejected":throw v.reason}}throw v}function _e(v,G,V,P,ne){var we=typeof v;(we==="undefined"||we==="boolean")&&(v=null);var he=!1;if(v===null)he=!0;else switch(we){case"bigint":case"string":case"number":he=!0;break;case"object":switch(v.$$typeof){case H:case ie:he=!0;break;case W:return he=v._init,_e(he(v._payload),G,V,P,ne)}}if(he)return ne=ne(v),he=P===""?"."+Ze(v,0):P,N(ne)?(V="",he!=null&&(V=he.replace(h,"$&/")+"/"),_e(ne,G,V,"",function(vn){return vn})):ne!=null&&(xe(ne)&&(ne=nt(ne,V+(ne.key==null||v&&v.key===ne.key?"":(""+ne.key).replace(h,"$&/")+"/")+he)),G.push(ne)),1;he=0;var Dt=P===""?".":P+":";if(N(v))for(var Ye=0;Ye<v.length;Ye++)P=v[Ye],we=Dt+Ze(P,Ye),he+=_e(P,G,V,we,ne);else if(Ye=ye(v),typeof Ye=="function")for(v=Ye.call(v),Ye=0;!(P=v.next()).done;)P=P.value,we=Dt+Ze(P,Ye++),he+=_e(P,G,V,we,ne);else if(we==="object"){if(typeof v.then=="function")return _e(w(v),G,V,P,ne);throw G=String(v),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.")}return he}function U(v,G,V){if(v==null)return v;var P=[],ne=0;return _e(v,P,"","",function(we){return G.call(V,we,ne++)}),P}function E(v){if(v._status===-1){var G=v._result;G=G(),G.then(function(V){(v._status===0||v._status===-1)&&(v._status=1,v._result=V)},function(V){(v._status===0||v._status===-1)&&(v._status=2,v._result=V)}),v._status===-1&&(v._status=0,v._result=G)}if(v._status===1)return v._result.default;throw v._result}var j=typeof reportError=="function"?reportError:function(v){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var G=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof v=="object"&&v!==null&&typeof v.message=="string"?String(v.message):String(v),error:v});if(!window.dispatchEvent(G))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",v);return}console.error(v)};function K(){}return me.Children={map:U,forEach:function(v,G,V){U(v,function(){G.apply(this,arguments)},V)},count:function(v){var G=0;return U(v,function(){G++}),G},toArray:function(v){return U(v,function(G){return G})||[]},only:function(v){if(!xe(v))throw Error("React.Children.only expected to receive a single React element child.");return v}},me.Component=Ke,me.Fragment=$,me.Profiler=te,me.PureComponent=ut,me.StrictMode=T,me.Suspense=Z,me.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=pe,me.__COMPILER_RUNTIME={__proto__:null,c:function(v){return pe.H.useMemoCache(v)}},me.cache=function(v){return function(){return v.apply(null,arguments)}},me.cloneElement=function(v,G,V){if(v==null)throw Error("The argument must be a React element, but you passed "+v+".");var P=Ue({},v.props),ne=v.key,we=void 0;if(G!=null)for(he in G.ref!==void 0&&(we=void 0),G.key!==void 0&&(ne=""+G.key),G)!tt.call(G,he)||he==="key"||he==="__self"||he==="__source"||he==="ref"&&G.ref===void 0||(P[he]=G[he]);var he=arguments.length-2;if(he===1)P.children=V;else if(1<he){for(var Dt=Array(he),Ye=0;Ye<he;Ye++)Dt[Ye]=arguments[Ye+2];P.children=Dt}return ft(v.type,ne,void 0,void 0,we,P)},me.createContext=function(v){return v={$$typeof:Re,_currentValue:v,_currentValue2:v,_threadCount:0,Provider:null,Consumer:null},v.Provider=v,v.Consumer={$$typeof:ue,_context:v},v},me.createElement=function(v,G,V){var P,ne={},we=null;if(G!=null)for(P in G.key!==void 0&&(we=""+G.key),G)tt.call(G,P)&&P!=="key"&&P!=="__self"&&P!=="__source"&&(ne[P]=G[P]);var he=arguments.length-2;if(he===1)ne.children=V;else if(1<he){for(var Dt=Array(he),Ye=0;Ye<he;Ye++)Dt[Ye]=arguments[Ye+2];ne.children=Dt}if(v&&v.defaultProps)for(P in he=v.defaultProps,he)ne[P]===void 0&&(ne[P]=he[P]);return ft(v,we,void 0,void 0,null,ne)},me.createRef=function(){return{current:null}},me.forwardRef=function(v){return{$$typeof:Oe,render:v}},me.isValidElement=xe,me.lazy=function(v){return{$$typeof:W,_payload:{_status:-1,_result:v},_init:E}},me.memo=function(v,G){return{$$typeof:D,type:v,compare:G===void 0?null:G}},me.startTransition=function(v){var G=pe.T,V={};pe.T=V;try{var P=v(),ne=pe.S;ne!==null&&ne(V,P),typeof P=="object"&&P!==null&&typeof P.then=="function"&&P.then(K,j)}catch(we){j(we)}finally{pe.T=G}},me.unstable_useCacheRefresh=function(){return pe.H.useCacheRefresh()},me.use=function(v){return pe.H.use(v)},me.useActionState=function(v,G,V){return pe.H.useActionState(v,G,V)},me.useCallback=function(v,G){return pe.H.useCallback(v,G)},me.useContext=function(v){return pe.H.useContext(v)},me.useDebugValue=function(){},me.useDeferredValue=function(v,G){return pe.H.useDeferredValue(v,G)},me.useEffect=function(v,G,V){var P=pe.H;if(typeof V=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return P.useEffect(v,G)},me.useId=function(){return pe.H.useId()},me.useImperativeHandle=function(v,G,V){return pe.H.useImperativeHandle(v,G,V)},me.useInsertionEffect=function(v,G){return pe.H.useInsertionEffect(v,G)},me.useLayoutEffect=function(v,G){return pe.H.useLayoutEffect(v,G)},me.useMemo=function(v,G){return pe.H.useMemo(v,G)},me.useOptimistic=function(v,G){return pe.H.useOptimistic(v,G)},me.useReducer=function(v,G,V){return pe.H.useReducer(v,G,V)},me.useRef=function(v){return pe.H.useRef(v)},me.useState=function(v){return pe.H.useState(v)},me.useSyncExternalStore=function(v,G,V){return pe.H.useSyncExternalStore(v,G,V)},me.useTransition=function(){return pe.H.useTransition()},me.version="19.1.0",me}var kd;function df(){return kd||(kd=1,Fu.exports=am()),Fu.exports}var be=df();const sm=Vd(be);var $u={exports:{}},br={},ef={exports:{}},tf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ld;function lm(){return Ld||(Ld=1,function(H){function ie(U,E){var j=U.length;U.push(E);e:for(;0<j;){var K=j-1>>>1,v=U[K];if(0<te(v,E))U[K]=E,U[j]=v,j=K;else break e}}function $(U){return U.length===0?null:U[0]}function T(U){if(U.length===0)return null;var E=U[0],j=U.pop();if(j!==E){U[0]=j;e:for(var K=0,v=U.length,G=v>>>1;K<G;){var V=2*(K+1)-1,P=U[V],ne=V+1,we=U[ne];if(0>te(P,j))ne<v&&0>te(we,P)?(U[K]=we,U[ne]=j,K=ne):(U[K]=P,U[V]=j,K=V);else if(ne<v&&0>te(we,j))U[K]=we,U[ne]=j,K=ne;else break e}}return E}function te(U,E){var j=U.sortIndex-E.sortIndex;return j!==0?j:U.id-E.id}if(H.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var ue=performance;H.unstable_now=function(){return ue.now()}}else{var Re=Date,Oe=Re.now();H.unstable_now=function(){return Re.now()-Oe}}var Z=[],D=[],W=1,Te=null,ye=3,fe=!1,Ue=!1,At=!1,Ke=!1,Ee=typeof setTimeout=="function"?setTimeout:null,ut=typeof clearTimeout=="function"?clearTimeout:null,Me=typeof setImmediate<"u"?setImmediate:null;function N(U){for(var E=$(D);E!==null;){if(E.callback===null)T(D);else if(E.startTime<=U)T(D),E.sortIndex=E.expirationTime,ie(Z,E);else break;E=$(D)}}function pe(U){if(At=!1,N(U),!Ue)if($(Z)!==null)Ue=!0,tt||(tt=!0,Ze());else{var E=$(D);E!==null&&_e(pe,E.startTime-U)}}var tt=!1,ft=-1,nt=5,xe=-1;function tn(){return Ke?!0:!(H.unstable_now()-xe<nt)}function h(){if(Ke=!1,tt){var U=H.unstable_now();xe=U;var E=!0;try{e:{Ue=!1,At&&(At=!1,ut(ft),ft=-1),fe=!0;var j=ye;try{t:{for(N(U),Te=$(Z);Te!==null&&!(Te.expirationTime>U&&tn());){var K=Te.callback;if(typeof K=="function"){Te.callback=null,ye=Te.priorityLevel;var v=K(Te.expirationTime<=U);if(U=H.unstable_now(),typeof v=="function"){Te.callback=v,N(U),E=!0;break t}Te===$(Z)&&T(Z),N(U)}else T(Z);Te=$(Z)}if(Te!==null)E=!0;else{var G=$(D);G!==null&&_e(pe,G.startTime-U),E=!1}}break e}finally{Te=null,ye=j,fe=!1}E=void 0}}finally{E?Ze():tt=!1}}}var Ze;if(typeof Me=="function")Ze=function(){Me(h)};else if(typeof MessageChannel<"u"){var cn=new MessageChannel,w=cn.port2;cn.port1.onmessage=h,Ze=function(){w.postMessage(null)}}else Ze=function(){Ee(h,0)};function _e(U,E){ft=Ee(function(){U(H.unstable_now())},E)}H.unstable_IdlePriority=5,H.unstable_ImmediatePriority=1,H.unstable_LowPriority=4,H.unstable_NormalPriority=3,H.unstable_Profiling=null,H.unstable_UserBlockingPriority=2,H.unstable_cancelCallback=function(U){U.callback=null},H.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):nt=0<U?Math.floor(1e3/U):5},H.unstable_getCurrentPriorityLevel=function(){return ye},H.unstable_next=function(U){switch(ye){case 1:case 2:case 3:var E=3;break;default:E=ye}var j=ye;ye=E;try{return U()}finally{ye=j}},H.unstable_requestPaint=function(){Ke=!0},H.unstable_runWithPriority=function(U,E){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var j=ye;ye=U;try{return E()}finally{ye=j}},H.unstable_scheduleCallback=function(U,E,j){var K=H.unstable_now();switch(typeof j=="object"&&j!==null?(j=j.delay,j=typeof j=="number"&&0<j?K+j:K):j=K,U){case 1:var v=-1;break;case 2:v=250;break;case 5:v=1073741823;break;case 4:v=1e4;break;default:v=5e3}return v=j+v,U={id:W++,callback:E,priorityLevel:U,startTime:j,expirationTime:v,sortIndex:-1},j>K?(U.sortIndex=j,ie(D,U),$(Z)===null&&U===$(D)&&(At?(ut(ft),ft=-1):At=!0,_e(pe,j-K))):(U.sortIndex=v,ie(Z,U),Ue||fe||(Ue=!0,tt||(tt=!0,Ze()))),U},H.unstable_shouldYield=tn,H.unstable_wrapCallback=function(U){var E=ye;return function(){var j=ye;ye=E;try{return U.apply(this,arguments)}finally{ye=j}}}}(tf)),tf}var Bd;function rm(){return Bd||(Bd=1,ef.exports=lm()),ef.exports}var nf={exports:{}},qt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qd;function om(){if(qd)return qt;qd=1;var H=df();function ie(Z){var D="https://react.dev/errors/"+Z;if(1<arguments.length){D+="?args[]="+encodeURIComponent(arguments[1]);for(var W=2;W<arguments.length;W++)D+="&args[]="+encodeURIComponent(arguments[W])}return"Minified React error #"+Z+"; visit "+D+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function $(){}var T={d:{f:$,r:function(){throw Error(ie(522))},D:$,C:$,L:$,m:$,X:$,S:$,M:$},p:0,findDOMNode:null},te=Symbol.for("react.portal");function ue(Z,D,W){var Te=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:te,key:Te==null?null:""+Te,children:Z,containerInfo:D,implementation:W}}var Re=H.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Oe(Z,D){if(Z==="font")return"";if(typeof D=="string")return D==="use-credentials"?D:""}return qt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,qt.createPortal=function(Z,D){var W=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!D||D.nodeType!==1&&D.nodeType!==9&&D.nodeType!==11)throw Error(ie(299));return ue(Z,D,null,W)},qt.flushSync=function(Z){var D=Re.T,W=T.p;try{if(Re.T=null,T.p=2,Z)return Z()}finally{Re.T=D,T.p=W,T.d.f()}},qt.preconnect=function(Z,D){typeof Z=="string"&&(D?(D=D.crossOrigin,D=typeof D=="string"?D==="use-credentials"?D:"":void 0):D=null,T.d.C(Z,D))},qt.prefetchDNS=function(Z){typeof Z=="string"&&T.d.D(Z)},qt.preinit=function(Z,D){if(typeof Z=="string"&&D&&typeof D.as=="string"){var W=D.as,Te=Oe(W,D.crossOrigin),ye=typeof D.integrity=="string"?D.integrity:void 0,fe=typeof D.fetchPriority=="string"?D.fetchPriority:void 0;W==="style"?T.d.S(Z,typeof D.precedence=="string"?D.precedence:void 0,{crossOrigin:Te,integrity:ye,fetchPriority:fe}):W==="script"&&T.d.X(Z,{crossOrigin:Te,integrity:ye,fetchPriority:fe,nonce:typeof D.nonce=="string"?D.nonce:void 0})}},qt.preinitModule=function(Z,D){if(typeof Z=="string")if(typeof D=="object"&&D!==null){if(D.as==null||D.as==="script"){var W=Oe(D.as,D.crossOrigin);T.d.M(Z,{crossOrigin:W,integrity:typeof D.integrity=="string"?D.integrity:void 0,nonce:typeof D.nonce=="string"?D.nonce:void 0})}}else D==null&&T.d.M(Z)},qt.preload=function(Z,D){if(typeof Z=="string"&&typeof D=="object"&&D!==null&&typeof D.as=="string"){var W=D.as,Te=Oe(W,D.crossOrigin);T.d.L(Z,W,{crossOrigin:Te,integrity:typeof D.integrity=="string"?D.integrity:void 0,nonce:typeof D.nonce=="string"?D.nonce:void 0,type:typeof D.type=="string"?D.type:void 0,fetchPriority:typeof D.fetchPriority=="string"?D.fetchPriority:void 0,referrerPolicy:typeof D.referrerPolicy=="string"?D.referrerPolicy:void 0,imageSrcSet:typeof D.imageSrcSet=="string"?D.imageSrcSet:void 0,imageSizes:typeof D.imageSizes=="string"?D.imageSizes:void 0,media:typeof D.media=="string"?D.media:void 0})}},qt.preloadModule=function(Z,D){if(typeof Z=="string")if(D){var W=Oe(D.as,D.crossOrigin);T.d.m(Z,{as:typeof D.as=="string"&&D.as!=="script"?D.as:void 0,crossOrigin:W,integrity:typeof D.integrity=="string"?D.integrity:void 0})}else T.d.m(Z)},qt.requestFormReset=function(Z){T.d.r(Z)},qt.unstable_batchedUpdates=function(Z,D){return Z(D)},qt.useFormState=function(Z,D,W){return Re.H.useFormState(Z,D,W)},qt.useFormStatus=function(){return Re.H.useHostTransitionStatus()},qt.version="19.1.0",qt}var zd;function cm(){if(zd)return nf.exports;zd=1;function H(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H)}catch(ie){console.error(ie)}}return H(),nf.exports=om(),nf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gd;function um(){if(Gd)return br;Gd=1;var H=rm(),ie=df(),$=cm();function T(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function te(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ue(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Re(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Oe(e){if(ue(e)!==e)throw Error(T(188))}function Z(e){var t=e.alternate;if(!t){if(t=ue(e),t===null)throw Error(T(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(r===null)break;var c=r.alternate;if(c===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===c.child){for(c=r.child;c;){if(c===n)return Oe(r),e;if(c===s)return Oe(r),t;c=c.sibling}throw Error(T(188))}if(n.return!==s.return)n=r,s=c;else{for(var d=!1,g=r.child;g;){if(g===n){d=!0,n=r,s=c;break}if(g===s){d=!0,s=r,n=c;break}g=g.sibling}if(!d){for(g=c.child;g;){if(g===n){d=!0,n=c,s=r;break}if(g===s){d=!0,s=c,n=r;break}g=g.sibling}if(!d)throw Error(T(189))}}if(n.alternate!==s)throw Error(T(190))}if(n.tag!==3)throw Error(T(188));return n.stateNode.current===n?e:t}function D(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=D(e),t!==null)return t;e=e.sibling}return null}var W=Object.assign,Te=Symbol.for("react.element"),ye=Symbol.for("react.transitional.element"),fe=Symbol.for("react.portal"),Ue=Symbol.for("react.fragment"),At=Symbol.for("react.strict_mode"),Ke=Symbol.for("react.profiler"),Ee=Symbol.for("react.provider"),ut=Symbol.for("react.consumer"),Me=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),pe=Symbol.for("react.suspense"),tt=Symbol.for("react.suspense_list"),ft=Symbol.for("react.memo"),nt=Symbol.for("react.lazy"),xe=Symbol.for("react.activity"),tn=Symbol.for("react.memo_cache_sentinel"),h=Symbol.iterator;function Ze(e){return e===null||typeof e!="object"?null:(e=h&&e[h]||e["@@iterator"],typeof e=="function"?e:null)}var cn=Symbol.for("react.client.reference");function w(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===cn?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ue:return"Fragment";case Ke:return"Profiler";case At:return"StrictMode";case pe:return"Suspense";case tt:return"SuspenseList";case xe:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case fe:return"Portal";case Me:return(e.displayName||"Context")+".Provider";case ut:return(e._context.displayName||"Context")+".Consumer";case N:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ft:return t=e.displayName||null,t!==null?t:w(e.type)||"Memo";case nt:t=e._payload,e=e._init;try{return w(e(t))}catch{}}return null}var _e=Array.isArray,U=ie.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,E=$.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,j={pending:!1,data:null,method:null,action:null},K=[],v=-1;function G(e){return{current:e}}function V(e){0>v||(e.current=K[v],K[v]=null,v--)}function P(e,t){v++,K[v]=e.current,e.current=t}var ne=G(null),we=G(null),he=G(null),Dt=G(null);function Ye(e,t){switch(P(he,t),P(we,e),P(ne,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?sd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=sd(t),e=ld(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}V(ne),P(ne,e)}function vn(){V(ne),V(we),V(he)}function ns(e){e.memoizedState!==null&&P(Dt,e);var t=ne.current,n=ld(t,e.type);t!==n&&(P(we,e),P(ne,n))}function is(e){we.current===e&&(V(ne),V(we)),Dt.current===e&&(V(Dt),dr._currentValue=j)}var ai=Object.prototype.hasOwnProperty,as=H.unstable_scheduleCallback,ss=H.unstable_cancelCallback,Rr=H.unstable_shouldYield,Tr=H.unstable_requestPaint,Vt=H.unstable_now,Ta=H.unstable_getCurrentPriorityLevel,_a=H.unstable_ImmediatePriority,ls=H.unstable_UserBlockingPriority,De=H.unstable_NormalPriority,_r=H.unstable_LowPriority,nl=H.unstable_IdlePriority,rs=H.log,Cr=H.unstable_setDisableYieldValue,xi=null,He=null;function st(e){if(typeof rs=="function"&&Cr(e),He&&typeof He.setStrictMode=="function")try{He.setStrictMode(xi,e)}catch{}}var Je=Math.clz32?Math.clz32:Mr,il=Math.log,Er=Math.LN2;function Mr(e){return e>>>=0,e===0?32:31-(il(e)/Er|0)|0}var Ca=256,Di=4194304;function bn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ea(e,t,n){var s=e.pendingLanes;if(s===0)return 0;var r=0,c=e.suspendedLanes,d=e.pingedLanes;e=e.warmLanes;var g=s&134217727;return g!==0?(s=g&~c,s!==0?r=bn(s):(d&=g,d!==0?r=bn(d):n||(n=g&~e,n!==0&&(r=bn(n))))):(g=s&~c,g!==0?r=bn(g):d!==0?r=bn(d):n||(n=s&~e,n!==0&&(r=bn(n)))),r===0?0:t!==0&&t!==r&&(t&c)===0&&(c=r&-r,n=t&-t,c>=n||c===32&&(n&4194048)!==0)?t:r}function ki(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function os(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function al(){var e=Ca;return Ca<<=1,(Ca&4194048)===0&&(Ca=256),e}function Ma(){var e=Di;return Di<<=1,(Di&62914560)===0&&(Di=4194304),e}function ht(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Li(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function wr(e,t,n,s,r,c){var d=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var g=e.entanglements,y=e.expirationTimes,_=e.hiddenUpdates;for(n=d&~n;0<n;){var x=31-Je(n),z=1<<x;g[x]=0,y[x]=-1;var C=_[x];if(C!==null)for(_[x]=null,x=0;x<C.length;x++){var M=C[x];M!==null&&(M.lane&=-536870913)}n&=~z}s!==0&&Nr(e,s,0),c!==0&&r===0&&e.tag!==0&&(e.suspendedLanes|=c&~(d&~t))}function Nr(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-Je(t);e.entangledLanes|=t,e.entanglements[s]=e.entanglements[s]|1073741824|n&4194090}function It(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-Je(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}function sl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ll(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function rl(){var e=E.p;return e!==0?e:(e=window.event,e===void 0?32:_d(e.type))}function Ur(e,t){var n=E.p;try{return E.p=e,t()}finally{E.p=n}}var Sn=Math.random().toString(36).slice(2),yt="__reactFiber$"+Sn,Et="__reactProps$"+Sn,Bi="__reactContainer$"+Sn,cs="__reactEvents$"+Sn,vc="__reactListeners$"+Sn,ol="__reactHandles$"+Sn,xr="__reactResources$"+Sn,wa="__reactMarker$"+Sn;function cl(e){delete e[yt],delete e[Et],delete e[cs],delete e[vc],delete e[ol]}function An(e){var t=e[yt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Bi]||n[yt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=ud(e);e!==null;){if(n=e[yt])return n;e=ud(e)}return t}e=n,n=e.parentNode}return null}function si(e){if(e=e[yt]||e[Bi]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function qn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(T(33))}function qi(e){var t=e[xr];return t||(t=e[xr]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function dt(e){e[wa]=!0}var re=new Set,Dr={};function li(e,t){zn(e,t),zn(e+"Capture",t)}function zn(e,t){for(Dr[e]=t,e=0;e<t.length;e++)re.add(t[e])}var kr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Fe={},ul={};function bc(e){return ai.call(ul,e)?!0:ai.call(Fe,e)?!1:kr.test(e)?ul[e]=!0:(Fe[e]=!0,!1)}function ri(e,t,n){if(bc(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function zi(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function On(e,t,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+s)}}var fl,hl;function Gi(e){if(fl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);fl=t&&t[1]||"",hl=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+fl+e+hl}var us=!1;function fs(e,t){if(!e||us)return"";us=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var z=function(){throw Error()};if(Object.defineProperty(z.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(z,[])}catch(M){var C=M}Reflect.construct(e,[],z)}else{try{z.call()}catch(M){C=M}e.call(z.prototype)}}else{try{throw Error()}catch(M){C=M}(z=e())&&typeof z.catch=="function"&&z.catch(function(){})}}catch(M){if(M&&C&&typeof M.stack=="string")return[M.stack,C.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var c=s.DetermineComponentFrameRoot(),d=c[0],g=c[1];if(d&&g){var y=d.split(`
`),_=g.split(`
`);for(r=s=0;s<y.length&&!y[s].includes("DetermineComponentFrameRoot");)s++;for(;r<_.length&&!_[r].includes("DetermineComponentFrameRoot");)r++;if(s===y.length||r===_.length)for(s=y.length-1,r=_.length-1;1<=s&&0<=r&&y[s]!==_[r];)r--;for(;1<=s&&0<=r;s--,r--)if(y[s]!==_[r]){if(s!==1||r!==1)do if(s--,r--,0>r||y[s]!==_[r]){var x=`
`+y[s].replace(" at new "," at ");return e.displayName&&x.includes("<anonymous>")&&(x=x.replace("<anonymous>",e.displayName)),x}while(1<=s&&0<=r);break}}}finally{us=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Gi(n):""}function Sc(e){switch(e.tag){case 26:case 27:case 5:return Gi(e.type);case 16:return Gi("Lazy");case 13:return Gi("Suspense");case 19:return Gi("SuspenseList");case 0:case 15:return fs(e.type,!1);case 11:return fs(e.type.render,!1);case 1:return fs(e.type,!0);case 31:return Gi("Activity");default:return""}}function dl(e){try{var t="";do t+=Sc(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function Yt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Lr(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Ac(e){var t=Lr(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(d){s=""+d,c.call(this,d)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function hs(e){e._valueTracker||(e._valueTracker=Ac(e))}function un(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Lr(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function Hi(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var ji=/[\n"\\]/g;function Pt(e){return e.replace(ji,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function gl(e,t,n,s,r,c,d,g){e.name="",d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"?e.type=d:e.removeAttribute("type"),t!=null?d==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+Yt(t)):e.value!==""+Yt(t)&&(e.value=""+Yt(t)):d!=="submit"&&d!=="reset"||e.removeAttribute("value"),t!=null?ml(e,d,Yt(t)):n!=null?ml(e,d,Yt(n)):s!=null&&e.removeAttribute("value"),r==null&&c!=null&&(e.defaultChecked=!!c),r!=null&&(e.checked=r&&typeof r!="function"&&typeof r!="symbol"),g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"?e.name=""+Yt(g):e.removeAttribute("name")}function ds(e,t,n,s,r,c,d,g){if(c!=null&&typeof c!="function"&&typeof c!="symbol"&&typeof c!="boolean"&&(e.type=c),t!=null||n!=null){if(!(c!=="submit"&&c!=="reset"||t!=null))return;n=n!=null?""+Yt(n):"",t=t!=null?""+Yt(t):n,g||t===e.value||(e.value=t),e.defaultValue=t}s=s??r,s=typeof s!="function"&&typeof s!="symbol"&&!!s,e.checked=g?e.checked:!!s,e.defaultChecked=!!s,d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.name=d)}function ml(e,t,n){t==="number"&&Hi(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function Gn(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+Yt(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,s&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Br(e,t,n){if(t!=null&&(t=""+Yt(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+Yt(n):""}function ot(e,t,n,s){if(t==null){if(s!=null){if(n!=null)throw Error(T(92));if(_e(s)){if(1<s.length)throw Error(T(93));s=s[0]}n=s}n==null&&(n=""),t=n}n=Yt(t),e.defaultValue=n,s=e.textContent,s===n&&s!==""&&s!==null&&(e.value=s)}function F(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var qr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Mt(e,t,n){var s=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":s?e.setProperty(t,n):typeof n!="number"||n===0||qr.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function zr(e,t,n){if(t!=null&&typeof t!="object")throw Error(T(62));if(e=e.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="");for(var r in t)s=t[r],t.hasOwnProperty(r)&&n[r]!==s&&Mt(e,r,s)}else for(var c in t)t.hasOwnProperty(c)&&Mt(e,c,t[c])}function gs(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Oc=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Gr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ms(e){return Gr.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var ps=null;function Na(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var oi=null,Hn=null;function pl(e){var t=si(e);if(t&&(e=t.stateNode)){var n=e[Et]||null;e:switch(e=t.stateNode,t.type){case"input":if(gl(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+Pt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=s[Et]||null;if(!r)throw Error(T(90));gl(s,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)s=n[t],s.form===e.form&&un(s)}break e;case"textarea":Br(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&Gn(e,!!n.multiple,t,!1)}}}var Ua=!1;function yl(e,t,n){if(Ua)return e(t,n);Ua=!0;try{var s=e(t);return s}finally{if(Ua=!1,(oi!==null||Hn!==null)&&(Zo(),oi&&(t=oi,e=Hn,Hn=oi=null,pl(t),e)))for(t=0;t<e.length;t++)pl(e[t])}}function jn(e,t){var n=e.stateNode;if(n===null)return null;var s=n[Et]||null;if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(T(231,t,typeof n));return n}var Qt=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Vn=!1;if(Qt)try{var fn={};Object.defineProperty(fn,"passive",{get:function(){Vn=!0}}),window.addEventListener("test",fn,fn),window.removeEventListener("test",fn,fn)}catch{Vn=!1}var Rn=null,ys=null,vs=null;function ci(){if(vs)return vs;var e,t=ys,n=t.length,s,r="value"in Rn?Rn.value:Rn.textContent,c=r.length;for(e=0;e<n&&t[e]===r[e];e++);var d=n-e;for(s=1;s<=d&&t[n-s]===r[c-s];s++);return vs=r.slice(e,1<s?1-s:void 0)}function xa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function bs(){return!0}function Hr(){return!1}function kt(e){function t(n,s,r,c,d){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(n=e[g],this[g]=n?n(c):c[g]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?bs:Hr,this.isPropagationStopped=Hr,this}return W(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=bs)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=bs)},persist:function(){},isPersistent:bs}),t}var je={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ss=kt(je),Da=W({},je,{view:0,detail:0}),Rc=kt(Da),vl,As,ka,zt=W({},Da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:hn,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ka&&(ka&&e.type==="mousemove"?(vl=e.screenX-ka.screenX,As=e.screenY-ka.screenY):As=vl=0,ka=e),vl)},movementY:function(e){return"movementY"in e?e.movementY:As}}),bl=kt(zt),Tc=W({},zt,{dataTransfer:0}),Os=kt(Tc),_c=W({},Da,{relatedTarget:0}),Sl=kt(_c),Cc=W({},je,{animationName:0,elapsedTime:0,pseudoElement:0}),Ec=kt(Cc),Mc=W({},je,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),jr=kt(Mc),Vr=W({},je,{data:0}),Ir=kt(Vr),wc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function La(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Pr[e])?!!t[e]:!1}function hn(){return La}var Nc=W({},Da,{key:function(e){if(e.key){var t=wc[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=xa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Yr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:hn,charCode:function(e){return e.type==="keypress"?xa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?xa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Uc=kt(Nc),Qr=W({},zt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Xr=kt(Qr),xc=W({},Da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:hn}),Kr=kt(xc),Dc=W({},je,{propertyName:0,elapsedTime:0,pseudoElement:0}),kc=kt(Dc),Lc=W({},zt,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Zr=kt(Lc),Bc=W({},je,{newState:0,oldState:0}),Al=kt(Bc),Jr=[9,13,27,32],ui=Qt&&"CompositionEvent"in window,Xt=null;Qt&&"documentMode"in document&&(Xt=document.documentMode);var qc=Qt&&"TextEvent"in window&&!Xt,Wr=Qt&&(!ui||Xt&&8<Xt&&11>=Xt),Fr=" ",$r=!1;function eo(e,t){switch(e){case"keyup":return Jr.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function to(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var fi=!1;function zc(e,t){switch(e){case"compositionend":return to(t);case"keypress":return t.which!==32?null:($r=!0,Fr);case"textInput":return e=t.data,e===Fr&&$r?null:e;default:return null}}function no(e,t){if(fi)return e==="compositionend"||!ui&&eo(e,t)?(e=ci(),vs=ys=Rn=null,fi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Wr&&t.locale!=="ko"?null:t.data;default:return null}}var Gc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function io(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Gc[e.type]:t==="textarea"}function Ol(e,t,n,s){oi?Hn?Hn.push(s):Hn=[s]:oi=s,t=tc(t,"onChange"),0<t.length&&(n=new Ss("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var Vi=null,Ii=null;function ao(e){ed(e,0)}function Ba(e){var t=qn(e);if(un(t))return e}function so(e,t){if(e==="change")return t}var lo=!1;if(Qt){var Rl;if(Qt){var Rs="oninput"in document;if(!Rs){var hi=document.createElement("div");hi.setAttribute("oninput","return;"),Rs=typeof hi.oninput=="function"}Rl=Rs}else Rl=!1;lo=Rl&&(!document.documentMode||9<document.documentMode)}function Yi(){Vi&&(Vi.detachEvent("onpropertychange",Tl),Ii=Vi=null)}function Tl(e){if(e.propertyName==="value"&&Ba(Ii)){var t=[];Ol(t,Ii,e,Na(e)),yl(ao,t)}}function ro(e,t,n){e==="focusin"?(Yi(),Vi=t,Ii=n,Vi.attachEvent("onpropertychange",Tl)):e==="focusout"&&Yi()}function oo(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ba(Ii)}function co(e,t){if(e==="click")return Ba(t)}function Hc(e,t){if(e==="input"||e==="change")return Ba(t)}function _l(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Gt=typeof Object.is=="function"?Object.is:_l;function In(e,t){if(Gt(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!ai.call(t,r)||!Gt(e[r],t[r]))return!1}return!0}function uo(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Ts(e,t){var n=uo(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=uo(n)}}function Cl(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Cl(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Lt(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=Hi(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Hi(e.document)}return t}function qa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var El=Qt&&"documentMode"in document&&11>=document.documentMode,Pi=null,Ml=null,di=null,_s=!1;function fo(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;_s||Pi==null||Pi!==Hi(s)||(s=Pi,"selectionStart"in s&&qa(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),di&&In(di,s)||(di=s,s=tc(Ml,"onSelect"),0<s.length&&(t=new Ss("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=Pi)))}function gi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var mi={animationend:gi("Animation","AnimationEnd"),animationiteration:gi("Animation","AnimationIteration"),animationstart:gi("Animation","AnimationStart"),transitionrun:gi("Transition","TransitionRun"),transitionstart:gi("Transition","TransitionStart"),transitioncancel:gi("Transition","TransitionCancel"),transitionend:gi("Transition","TransitionEnd")},pi={},ho={};Qt&&(ho=document.createElement("div").style,"AnimationEvent"in window||(delete mi.animationend.animation,delete mi.animationiteration.animation,delete mi.animationstart.animation),"TransitionEvent"in window||delete mi.transitionend.transition);function Yn(e){if(pi[e])return pi[e];if(!mi[e])return e;var t=mi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ho)return pi[e]=t[n];return e}var Pn=Yn("animationend"),Cs=Yn("animationiteration"),go=Yn("animationstart"),mo=Yn("transitionrun"),po=Yn("transitionstart"),jc=Yn("transitioncancel"),yo=Yn("transitionend"),vo=new Map,Qi="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Qi.push("scrollEnd");function gt(e,t){vo.set(e,t),li(t,[e])}var bo=new WeakMap;function Kt(e,t){if(typeof e=="object"&&e!==null){var n=bo.get(e);return n!==void 0?n:(t={value:e,source:t,stack:dl(t)},bo.set(e,t),t)}return{value:e,source:t,stack:dl(t)}}var mt=[],Xi=0,wl=0;function Es(){for(var e=Xi,t=wl=Xi=0;t<e;){var n=mt[t];mt[t++]=null;var s=mt[t];mt[t++]=null;var r=mt[t];mt[t++]=null;var c=mt[t];if(mt[t++]=null,s!==null&&r!==null){var d=s.pending;d===null?r.next=r:(r.next=d.next,d.next=r),s.pending=r}c!==0&&Ms(n,r,c)}}function Tn(e,t,n,s){mt[Xi++]=e,mt[Xi++]=t,mt[Xi++]=n,mt[Xi++]=s,wl|=s,e.lanes|=s,e=e.alternate,e!==null&&(e.lanes|=s)}function Ot(e,t,n,s){return Tn(e,t,n,s),Qn(e)}function Ki(e,t){return Tn(e,null,null,t),Qn(e)}function Ms(e,t,n){e.lanes|=n;var s=e.alternate;s!==null&&(s.lanes|=n);for(var r=!1,c=e.return;c!==null;)c.childLanes|=n,s=c.alternate,s!==null&&(s.childLanes|=n),c.tag===22&&(e=c.stateNode,e===null||e._visibility&1||(r=!0)),e=c,c=c.return;return e.tag===3?(c=e.stateNode,r&&t!==null&&(r=31-Je(n),e=c.hiddenUpdates,s=e[r],s===null?e[r]=[t]:s.push(t),t.lane=n|536870912),c):null}function Qn(e){if(50<sr)throw sr=0,Au=null,Error(T(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var yi={};function Nl(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ht(e,t,n,s){return new Nl(e,t,n,s)}function za(e){return e=e.prototype,!(!e||!e.isReactComponent)}function _n(e,t){var n=e.alternate;return n===null?(n=Ht(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function So(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ga(e,t,n,s,r,c){var d=0;if(s=e,typeof e=="function")za(e)&&(d=1);else if(typeof e=="string")d=Ig(e,n,ne.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case xe:return e=Ht(31,n,t,r),e.elementType=xe,e.lanes=c,e;case Ue:return vi(n.children,r,c,t);case At:d=8,r|=24;break;case Ke:return e=Ht(12,n,t,r|2),e.elementType=Ke,e.lanes=c,e;case pe:return e=Ht(13,n,t,r),e.elementType=pe,e.lanes=c,e;case tt:return e=Ht(19,n,t,r),e.elementType=tt,e.lanes=c,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ee:case Me:d=10;break e;case ut:d=9;break e;case N:d=11;break e;case ft:d=14;break e;case nt:d=16,s=null;break e}d=29,n=Error(T(130,e===null?"null":typeof e,"")),s=null}return t=Ht(d,n,t,r),t.elementType=e,t.type=s,t.lanes=c,t}function vi(e,t,n,s){return e=Ht(7,e,s,t),e.lanes=n,e}function Ul(e,t,n){return e=Ht(6,e,null,t),e.lanes=n,e}function ws(e,t,n){return t=Ht(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Zi=[],Ji=0,Ns=null,Us=0,Bt=[],Zt=0,Cn=null,En=1,Mn="";function bi(e,t){Zi[Ji++]=Us,Zi[Ji++]=Ns,Ns=e,Us=t}function Ao(e,t,n){Bt[Zt++]=En,Bt[Zt++]=Mn,Bt[Zt++]=Cn,Cn=e;var s=En;e=Mn;var r=32-Je(s)-1;s&=~(1<<r),n+=1;var c=32-Je(t)+r;if(30<c){var d=r-r%5;c=(s&(1<<d)-1).toString(32),s>>=d,r-=d,En=1<<32-Je(t)+r|n<<r|s,Mn=c+e}else En=1<<c|n<<r|s,Mn=e}function xl(e){e.return!==null&&(bi(e,1),Ao(e,1,0))}function Dl(e){for(;e===Ns;)Ns=Zi[--Ji],Zi[Ji]=null,Us=Zi[--Ji],Zi[Ji]=null;for(;e===Cn;)Cn=Bt[--Zt],Bt[Zt]=null,Mn=Bt[--Zt],Bt[Zt]=null,En=Bt[--Zt],Bt[Zt]=null}var Rt=null,$e=null,de=!1,wn=null,Jt=!1,Si=Error(T(519));function Nn(e){var t=Error(T(418,""));throw xn(Kt(t,e)),Si}function kl(e){var t=e.stateNode,n=e.type,s=e.memoizedProps;switch(t[yt]=e,t[Et]=s,n){case"dialog":Ae("cancel",t),Ae("close",t);break;case"iframe":case"object":case"embed":Ae("load",t);break;case"video":case"audio":for(n=0;n<rr.length;n++)Ae(rr[n],t);break;case"source":Ae("error",t);break;case"img":case"image":case"link":Ae("error",t),Ae("load",t);break;case"details":Ae("toggle",t);break;case"input":Ae("invalid",t),ds(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0),hs(t);break;case"select":Ae("invalid",t);break;case"textarea":Ae("invalid",t),ot(t,s.value,s.defaultValue,s.children),hs(t)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||s.suppressHydrationWarning===!0||ad(t.textContent,n)?(s.popover!=null&&(Ae("beforetoggle",t),Ae("toggle",t)),s.onScroll!=null&&Ae("scroll",t),s.onScrollEnd!=null&&Ae("scrollend",t),s.onClick!=null&&(t.onclick=nc),t=!0):t=!1,t||Nn(e)}function Ll(e){for(Rt=e.return;Rt;)switch(Rt.tag){case 5:case 13:Jt=!1;return;case 27:case 3:Jt=!0;return;default:Rt=Rt.return}}function Un(e){if(e!==Rt)return!1;if(!de)return Ll(e),de=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||qu(e.type,e.memoizedProps)),n=!n),n&&$e&&Nn(e),Ll(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(T(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){$e=Bn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}$e=null}}else t===27?(t=$e,ya(e.type)?(e=ju,ju=null,$e=e):$e=t):$e=Rt?Bn(e.stateNode.nextSibling):null;return!0}function Wi(){$e=Rt=null,de=!1}function Fi(){var e=wn;return e!==null&&($t===null?$t=e:$t.push.apply($t,e),wn=null),e}function xn(e){wn===null?wn=[e]:wn.push(e)}var Ha=G(null),dn=null,Dn=null;function gn(e,t,n){P(Ha,t._currentValue),t._currentValue=n}function pt(e){e._currentValue=Ha.current,V(Ha)}function $i(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Bl(e,t,n,s){var r=e.child;for(r!==null&&(r.return=e);r!==null;){var c=r.dependencies;if(c!==null){var d=r.child;c=c.firstContext;e:for(;c!==null;){var g=c;c=r;for(var y=0;y<t.length;y++)if(g.context===t[y]){c.lanes|=n,g=c.alternate,g!==null&&(g.lanes|=n),$i(c.return,n,e),s||(d=null);break e}c=g.next}}else if(r.tag===18){if(d=r.return,d===null)throw Error(T(341));d.lanes|=n,c=d.alternate,c!==null&&(c.lanes|=n),$i(d,n,e),d=null}else d=r.child;if(d!==null)d.return=r;else for(d=r;d!==null;){if(d===e){d=null;break}if(r=d.sibling,r!==null){r.return=d.return,d=r;break}d=d.return}r=d}}function ja(e,t,n,s){e=null;for(var r=t,c=!1;r!==null;){if(!c){if((r.flags&524288)!==0)c=!0;else if((r.flags&262144)!==0)break}if(r.tag===10){var d=r.alternate;if(d===null)throw Error(T(387));if(d=d.memoizedProps,d!==null){var g=r.type;Gt(r.pendingProps.value,d.value)||(e!==null?e.push(g):e=[g])}}else if(r===Dt.current){if(d=r.alternate,d===null)throw Error(T(387));d.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(e!==null?e.push(dr):e=[dr])}r=r.return}e!==null&&Bl(t,e,n,s),t.flags|=262144}function Va(e){for(e=e.firstContext;e!==null;){if(!Gt(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ai(e){dn=e,Dn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function vt(e){return ql(dn,e)}function Wt(e,t){return dn===null&&Ai(e),ql(e,t)}function ql(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Dn===null){if(e===null)throw Error(T(308));Dn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Dn=Dn.next=t;return n}var Ia=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,s){e.push(s)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Oo=H.unstable_scheduleCallback,Ro=H.unstable_NormalPriority,Qe={$$typeof:Me,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Xn(){return{controller:new Ia,data:new Map,refCount:0}}function Ya(e){e.refCount--,e.refCount===0&&Oo(Ro,function(){e.controller.abort()})}var ea=null,We=0,ta=0,na=null;function Vc(e,t){if(ea===null){var n=ea=[];We=0,ta=Mu(),na={status:"pending",value:void 0,then:function(s){n.push(s)}}}return We++,t.then(To,To),t}function To(){if(--We===0&&ea!==null){na!==null&&(na.status="fulfilled");var e=ea;ea=null,ta=0,na=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Ic(e,t){var n=[],s={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var r=0;r<n.length;r++)(0,n[r])(t)},function(r){for(s.status="rejected",s.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),s}var _o=U.S;U.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Vc(e,t),_o!==null&&_o(e,t)};var Kn=G(null);function zl(){var e=Kn.current;return e!==null?e:Xe.pooledCache}function ia(e,t){t===null?P(Kn,Kn.current):P(Kn,t.pool)}function Co(){var e=zl();return e===null?null:{parent:Qe._currentValue,pool:e}}var Pa=Error(T(460)),Eo=Error(T(474)),xs=Error(T(542)),Gl={then:function(){}};function Mo(e){return e=e.status,e==="fulfilled"||e==="rejected"}function Qa(){}function wo(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(Qa,Qa),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Uo(e),e;default:if(typeof t.status=="string")t.then(Qa,Qa);else{if(e=Xe,e!==null&&100<e.shellSuspendCounter)throw Error(T(482));e=t,e.status="pending",e.then(function(s){if(t.status==="pending"){var r=t;r.status="fulfilled",r.value=s}},function(s){if(t.status==="pending"){var r=t;r.status="rejected",r.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,Uo(e),e}throw Xa=t,Pa}}var Xa=null;function No(){if(Xa===null)throw Error(T(459));var e=Xa;return Xa=null,e}function Uo(e){if(e===Pa||e===xs)throw Error(T(483))}var kn=!1;function Ds(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function Zn(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function Jn(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(ze&2)!==0){var r=s.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),s.pending=t,t=Qn(e),Ms(e,null,n),t}return Tn(e,s,t,n),Qn(e)}function Ka(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,It(e,n)}}function jl(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var d={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};c===null?r=c=d:c=c.next=d,n=n.next}while(n!==null);c===null?r=c=t:c=c.next=t}else r=c=t;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:c,shared:s.shared,callbacks:s.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Vl=!1;function Za(){if(Vl){var e=na;if(e!==null)throw e}}function Ja(e,t,n,s){Vl=!1;var r=e.updateQueue;kn=!1;var c=r.firstBaseUpdate,d=r.lastBaseUpdate,g=r.shared.pending;if(g!==null){r.shared.pending=null;var y=g,_=y.next;y.next=null,d===null?c=_:d.next=_,d=y;var x=e.alternate;x!==null&&(x=x.updateQueue,g=x.lastBaseUpdate,g!==d&&(g===null?x.firstBaseUpdate=_:g.next=_,x.lastBaseUpdate=y))}if(c!==null){var z=r.baseState;d=0,x=_=y=null,g=c;do{var C=g.lane&-536870913,M=C!==g.lane;if(M?(Ne&C)===C:(s&C)===C){C!==0&&C===ta&&(Vl=!0),x!==null&&(x=x.next={lane:0,tag:g.tag,payload:g.payload,callback:null,next:null});e:{var ce=e,se=g;C=t;var Ie=n;switch(se.tag){case 1:if(ce=se.payload,typeof ce=="function"){z=ce.call(Ie,z,C);break e}z=ce;break e;case 3:ce.flags=ce.flags&-65537|128;case 0:if(ce=se.payload,C=typeof ce=="function"?ce.call(Ie,z,C):ce,C==null)break e;z=W({},z,C);break e;case 2:kn=!0}}C=g.callback,C!==null&&(e.flags|=64,M&&(e.flags|=8192),M=r.callbacks,M===null?r.callbacks=[C]:M.push(C))}else M={lane:C,tag:g.tag,payload:g.payload,callback:g.callback,next:null},x===null?(_=x=M,y=z):x=x.next=M,d|=C;if(g=g.next,g===null){if(g=r.shared.pending,g===null)break;M=g,g=M.next,M.next=null,r.lastBaseUpdate=M,r.shared.pending=null}}while(!0);x===null&&(y=z),r.baseState=y,r.firstBaseUpdate=_,r.lastBaseUpdate=x,c===null&&(r.shared.lanes=0),da|=d,e.lanes=d,e.memoizedState=z}}function aa(e,t){if(typeof e!="function")throw Error(T(191,e));e.call(t)}function Il(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)aa(n[e],t)}var Wn=G(null),ks=G(0);function Ls(e,t){e=Ni,P(ks,e),P(Wn,t),Ni=e|t.baseLanes}function Bs(){P(ks,Ni),P(Wn,Wn.current)}function Yl(){Ni=ks.current,V(Wn),V(ks)}var Fn=0,ge=null,Be=null,lt=null,qs=!1,Oi=!1,nn=!1,$n=0,Ri=0,sa=null,Yc=0;function it(){throw Error(T(321))}function Pl(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Gt(e[n],t[n]))return!1;return!0}function Ql(e,t,n,s,r,c){return Fn=c,ge=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,U.H=e===null||e.memoizedState===null?zf:Gf,nn=!1,c=n(s,r),nn=!1,Oi&&(c=xo(t,n,s,r)),Xl(e),c}function Xl(e){U.H=Bo;var t=Be!==null&&Be.next!==null;if(Fn=0,lt=Be=ge=null,qs=!1,Ri=0,sa=null,t)throw Error(T(300));e===null||Tt||(e=e.dependencies,e!==null&&Va(e)&&(Tt=!0))}function xo(e,t,n,s){ge=e;var r=0;do{if(Oi&&(sa=null),Ri=0,Oi=!1,25<=r)throw Error(T(301));if(r+=1,lt=Be=null,e.updateQueue!=null){var c=e.updateQueue;c.lastEffect=null,c.events=null,c.stores=null,c.memoCache!=null&&(c.memoCache.index=0)}U.H=eg,c=t(n,s)}while(Oi);return c}function Pc(){var e=U.H,t=e.useState()[0];return t=typeof t.then=="function"?m(t):t,e=e.useState()[0],(Be!==null?Be.memoizedState:null)!==e&&(ge.flags|=1024),t}function i(){var e=$n!==0;return $n=0,e}function a(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function l(e){if(qs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}qs=!1}Fn=0,lt=Be=ge=null,Oi=!1,Ri=$n=0,sa=null}function o(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lt===null?ge.memoizedState=lt=e:lt=lt.next=e,lt}function u(){if(Be===null){var e=ge.alternate;e=e!==null?e.memoizedState:null}else e=Be.next;var t=lt===null?ge.memoizedState:lt.next;if(t!==null)lt=t,Be=e;else{if(e===null)throw ge.alternate===null?Error(T(467)):Error(T(310));Be=e,e={memoizedState:Be.memoizedState,baseState:Be.baseState,baseQueue:Be.baseQueue,queue:Be.queue,next:null},lt===null?ge.memoizedState=lt=e:lt=lt.next=e}return lt}function f(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function m(e){var t=Ri;return Ri+=1,sa===null&&(sa=[]),e=wo(sa,e,t),t=ge,(lt===null?t.memoizedState:lt.next)===null&&(t=t.alternate,U.H=t===null||t.memoizedState===null?zf:Gf),e}function p(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return m(e);if(e.$$typeof===Me)return vt(e)}throw Error(T(438,String(e)))}function R(e){var t=null,n=ge.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var s=ge.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(r){return r.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=f(),ge.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),s=0;s<e;s++)n[s]=tn;return t.index++,n}function S(e,t){return typeof t=="function"?t(e):t}function k(e){var t=u();return L(t,Be,e)}function L(e,t,n){var s=e.queue;if(s===null)throw Error(T(311));s.lastRenderedReducer=n;var r=e.baseQueue,c=s.pending;if(c!==null){if(r!==null){var d=r.next;r.next=c.next,c.next=d}t.baseQueue=r=c,s.pending=null}if(c=e.baseState,r===null)e.memoizedState=c;else{t=r.next;var g=d=null,y=null,_=t,x=!1;do{var z=_.lane&-536870913;if(z!==_.lane?(Ne&z)===z:(Fn&z)===z){var C=_.revertLane;if(C===0)y!==null&&(y=y.next={lane:0,revertLane:0,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null}),z===ta&&(x=!0);else if((Fn&C)===C){_=_.next,C===ta&&(x=!0);continue}else z={lane:0,revertLane:_.revertLane,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null},y===null?(g=y=z,d=c):y=y.next=z,ge.lanes|=C,da|=C;z=_.action,nn&&n(c,z),c=_.hasEagerState?_.eagerState:n(c,z)}else C={lane:z,revertLane:_.revertLane,action:_.action,hasEagerState:_.hasEagerState,eagerState:_.eagerState,next:null},y===null?(g=y=C,d=c):y=y.next=C,ge.lanes|=z,da|=z;_=_.next}while(_!==null&&_!==t);if(y===null?d=c:y.next=g,!Gt(c,e.memoizedState)&&(Tt=!0,x&&(n=na,n!==null)))throw n;e.memoizedState=c,e.baseState=d,e.baseQueue=y,s.lastRenderedState=c}return r===null&&(s.lanes=0),[e.memoizedState,s.dispatch]}function I(e){var t=u(),n=t.queue;if(n===null)throw Error(T(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,c=t.memoizedState;if(r!==null){n.pending=null;var d=r=r.next;do c=e(c,d.action),d=d.next;while(d!==r);Gt(c,t.memoizedState)||(Tt=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,s]}function B(e,t,n){var s=ge,r=u(),c=de;if(c){if(n===void 0)throw Error(T(407));n=n()}else n=t();var d=!Gt((Be||r).memoizedState,n);d&&(r.memoizedState=n,Tt=!0),r=r.queue;var g=ae.bind(null,s,r,e);if(Kl(2048,8,g,[e]),r.getSnapshot!==t||d||lt!==null&&lt.memoizedState.tag&1){if(s.flags|=2048,zs(9,Do(),X.bind(null,s,r,n,t),null),Xe===null)throw Error(T(349));c||(Fn&124)!==0||Q(s,t,n)}return n}function Q(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ge.updateQueue,t===null?(t=f(),ge.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function X(e,t,n,s){t.value=n,t.getSnapshot=s,Ce(t)&&Le(e)}function ae(e,t,n){return n(function(){Ce(t)&&Le(e)})}function Ce(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Gt(e,n)}catch{return!0}}function Le(e){var t=Ki(e,2);t!==null&&on(t,e,2)}function qe(e){var t=o();if(typeof e=="function"){var n=e;if(e=n(),nn){st(!0);try{n()}finally{st(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:e},t}function oe(e,t,n,s){return e.baseState=n,L(e,Be,typeof s=="function"?s:S)}function jt(e,t,n,s,r){if(Lo(e))throw Error(T(485));if(e=t.action,e!==null){var c={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(d){c.listeners.push(d)}};U.T!==null?n(!0):c.isTransition=!1,s(c),n=t.pending,n===null?(c.next=t.pending=c,bt(t,c)):(c.next=n.next,t.pending=n.next=c)}}function bt(e,t){var n=t.action,s=t.payload,r=e.state;if(t.isTransition){var c=U.T,d={};U.T=d;try{var g=n(r,s),y=U.S;y!==null&&y(d,g),la(e,t,g)}catch(_){Wa(e,t,_)}finally{U.T=c}}else try{c=n(r,s),la(e,t,c)}catch(_){Wa(e,t,_)}}function la(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){Ti(e,t,s)},function(s){return Wa(e,t,s)}):Ti(e,t,n)}function Ti(e,t,n){t.status="fulfilled",t.value=n,gf(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,bt(e,n)))}function Wa(e,t,n){var s=e.pending;if(e.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=n,gf(t),t=t.next;while(t!==s)}e.action=null}function gf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function mf(e,t){return t}function pf(e,t){if(de){var n=Xe.formState;if(n!==null){e:{var s=ge;if(de){if($e){t:{for(var r=$e,c=Jt;r.nodeType!==8;){if(!c){r=null;break t}if(r=Bn(r.nextSibling),r===null){r=null;break t}}c=r.data,r=c==="F!"||c==="F"?r:null}if(r){$e=Bn(r.nextSibling),s=r.data==="F!";break e}}Nn(s)}s=!1}s&&(t=n[0])}}return n=o(),n.memoizedState=n.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mf,lastRenderedState:t},n.queue=s,n=Lf.bind(null,ge,s),s.dispatch=n,s=qe(!1),c=Jc.bind(null,ge,!1,s.queue),s=o(),r={state:t,dispatch:null,action:e,pending:null},s.queue=r,n=jt.bind(null,ge,r,c,n),r.dispatch=n,s.memoizedState=e,[t,n,!1]}function yf(e){var t=u();return vf(t,Be,e)}function vf(e,t,n){if(t=L(e,t,mf)[0],e=k(S)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=m(t)}catch(d){throw d===Pa?xs:d}else s=t;t=u();var r=t.queue,c=r.dispatch;return n!==t.memoizedState&&(ge.flags|=2048,zs(9,Do(),Jd.bind(null,r,n),null)),[s,c,e]}function Jd(e,t){e.action=t}function bf(e){var t=u(),n=Be;if(n!==null)return vf(t,n,e);u(),t=t.memoizedState,n=u();var s=n.queue.dispatch;return n.memoizedState=e,[t,s,!1]}function zs(e,t,n,s){return e={tag:e,create:n,deps:s,inst:t,next:null},t=ge.updateQueue,t===null&&(t=f(),ge.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function Do(){return{destroy:void 0,resource:void 0}}function Sf(){return u().memoizedState}function ko(e,t,n,s){var r=o();s=s===void 0?null:s,ge.flags|=e,r.memoizedState=zs(1|t,Do(),n,s)}function Kl(e,t,n,s){var r=u();s=s===void 0?null:s;var c=r.memoizedState.inst;Be!==null&&s!==null&&Pl(s,Be.memoizedState.deps)?r.memoizedState=zs(t,c,n,s):(ge.flags|=e,r.memoizedState=zs(1|t,c,n,s))}function Af(e,t){ko(8390656,8,e,t)}function Of(e,t){Kl(2048,8,e,t)}function Rf(e,t){return Kl(4,2,e,t)}function Tf(e,t){return Kl(4,4,e,t)}function _f(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Cf(e,t,n){n=n!=null?n.concat([e]):null,Kl(4,4,_f.bind(null,t,e),n)}function Qc(){}function Ef(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;return t!==null&&Pl(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function Mf(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;if(t!==null&&Pl(t,s[1]))return s[0];if(s=e(),nn){st(!0);try{e()}finally{st(!1)}}return n.memoizedState=[s,t],s}function Xc(e,t,n){return n===void 0||(Fn&1073741824)!==0?e.memoizedState=t:(e.memoizedState=n,e=Uh(),ge.lanes|=e,da|=e,n)}function wf(e,t,n,s){return Gt(n,t)?n:Wn.current!==null?(e=Xc(e,n,s),Gt(e,t)||(Tt=!0),e):(Fn&42)===0?(Tt=!0,e.memoizedState=n):(e=Uh(),ge.lanes|=e,da|=e,t)}function Nf(e,t,n,s,r){var c=E.p;E.p=c!==0&&8>c?c:8;var d=U.T,g={};U.T=g,Jc(e,!1,t,n);try{var y=r(),_=U.S;if(_!==null&&_(g,y),y!==null&&typeof y=="object"&&typeof y.then=="function"){var x=Ic(y,s);Zl(e,t,x,rn(e))}else Zl(e,t,s,rn(e))}catch(z){Zl(e,t,{then:function(){},status:"rejected",reason:z},rn())}finally{E.p=c,U.T=d}}function Wd(){}function Kc(e,t,n,s){if(e.tag!==5)throw Error(T(476));var r=Uf(e).queue;Nf(e,r,t,j,n===null?Wd:function(){return xf(e),n(s)})}function Uf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:j,baseState:j,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:j},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function xf(e){var t=Uf(e).next.queue;Zl(e,t,{},rn())}function Zc(){return vt(dr)}function Df(){return u().memoizedState}function kf(){return u().memoizedState}function Fd(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=rn();e=Zn(n);var s=Jn(t,e,n);s!==null&&(on(s,t,n),Ka(s,t,n)),t={cache:Xn()},e.payload=t;return}t=t.return}}function $d(e,t,n){var s=rn();n={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Lo(e)?Bf(t,n):(n=Ot(e,t,n,s),n!==null&&(on(n,e,s),qf(n,t,s)))}function Lf(e,t,n){var s=rn();Zl(e,t,n,s)}function Zl(e,t,n,s){var r={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Lo(e))Bf(t,r);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var d=t.lastRenderedState,g=c(d,n);if(r.hasEagerState=!0,r.eagerState=g,Gt(g,d))return Tn(e,t,r,0),Xe===null&&Es(),!1}catch{}finally{}if(n=Ot(e,t,r,s),n!==null)return on(n,e,s),qf(n,t,s),!0}return!1}function Jc(e,t,n,s){if(s={lane:2,revertLane:Mu(),action:s,hasEagerState:!1,eagerState:null,next:null},Lo(e)){if(t)throw Error(T(479))}else t=Ot(e,n,s,2),t!==null&&on(t,e,2)}function Lo(e){var t=e.alternate;return e===ge||t!==null&&t===ge}function Bf(e,t){Oi=qs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function qf(e,t,n){if((n&4194048)!==0){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,It(e,n)}}var Bo={readContext:vt,use:p,useCallback:it,useContext:it,useEffect:it,useImperativeHandle:it,useLayoutEffect:it,useInsertionEffect:it,useMemo:it,useReducer:it,useRef:it,useState:it,useDebugValue:it,useDeferredValue:it,useTransition:it,useSyncExternalStore:it,useId:it,useHostTransitionStatus:it,useFormState:it,useActionState:it,useOptimistic:it,useMemoCache:it,useCacheRefresh:it},zf={readContext:vt,use:p,useCallback:function(e,t){return o().memoizedState=[e,t===void 0?null:t],e},useContext:vt,useEffect:Af,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,ko(4194308,4,_f.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ko(4194308,4,e,t)},useInsertionEffect:function(e,t){ko(4,2,e,t)},useMemo:function(e,t){var n=o();t=t===void 0?null:t;var s=e();if(nn){st(!0);try{e()}finally{st(!1)}}return n.memoizedState=[s,t],s},useReducer:function(e,t,n){var s=o();if(n!==void 0){var r=n(t);if(nn){st(!0);try{n(t)}finally{st(!1)}}}else r=t;return s.memoizedState=s.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},s.queue=e,e=e.dispatch=$d.bind(null,ge,e),[s.memoizedState,e]},useRef:function(e){var t=o();return e={current:e},t.memoizedState=e},useState:function(e){e=qe(e);var t=e.queue,n=Lf.bind(null,ge,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Qc,useDeferredValue:function(e,t){var n=o();return Xc(n,e,t)},useTransition:function(){var e=qe(!1);return e=Nf.bind(null,ge,e.queue,!0,!1),o().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=ge,r=o();if(de){if(n===void 0)throw Error(T(407));n=n()}else{if(n=t(),Xe===null)throw Error(T(349));(Ne&124)!==0||Q(s,t,n)}r.memoizedState=n;var c={value:n,getSnapshot:t};return r.queue=c,Af(ae.bind(null,s,c,e),[e]),s.flags|=2048,zs(9,Do(),X.bind(null,s,c,n,t),null),n},useId:function(){var e=o(),t=Xe.identifierPrefix;if(de){var n=Mn,s=En;n=(s&~(1<<32-Je(s)-1)).toString(32)+n,t=""+t+"R"+n,n=$n++,0<n&&(t+="H"+n.toString(32)),t+=""}else n=Yc++,t=""+t+"r"+n.toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:Zc,useFormState:pf,useActionState:pf,useOptimistic:function(e){var t=o();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Jc.bind(null,ge,!0,n),n.dispatch=t,[e,t]},useMemoCache:R,useCacheRefresh:function(){return o().memoizedState=Fd.bind(null,ge)}},Gf={readContext:vt,use:p,useCallback:Ef,useContext:vt,useEffect:Of,useImperativeHandle:Cf,useInsertionEffect:Rf,useLayoutEffect:Tf,useMemo:Mf,useReducer:k,useRef:Sf,useState:function(){return k(S)},useDebugValue:Qc,useDeferredValue:function(e,t){var n=u();return wf(n,Be.memoizedState,e,t)},useTransition:function(){var e=k(S)[0],t=u().memoizedState;return[typeof e=="boolean"?e:m(e),t]},useSyncExternalStore:B,useId:Df,useHostTransitionStatus:Zc,useFormState:yf,useActionState:yf,useOptimistic:function(e,t){var n=u();return oe(n,Be,e,t)},useMemoCache:R,useCacheRefresh:kf},eg={readContext:vt,use:p,useCallback:Ef,useContext:vt,useEffect:Of,useImperativeHandle:Cf,useInsertionEffect:Rf,useLayoutEffect:Tf,useMemo:Mf,useReducer:I,useRef:Sf,useState:function(){return I(S)},useDebugValue:Qc,useDeferredValue:function(e,t){var n=u();return Be===null?Xc(n,e,t):wf(n,Be.memoizedState,e,t)},useTransition:function(){var e=I(S)[0],t=u().memoizedState;return[typeof e=="boolean"?e:m(e),t]},useSyncExternalStore:B,useId:Df,useHostTransitionStatus:Zc,useFormState:bf,useActionState:bf,useOptimistic:function(e,t){var n=u();return Be!==null?oe(n,Be,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:R,useCacheRefresh:kf},Gs=null,Jl=0;function qo(e){var t=Jl;return Jl+=1,Gs===null&&(Gs=[]),wo(Gs,e,t)}function Wl(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function zo(e,t){throw t.$$typeof===Te?Error(T(525)):(e=Object.prototype.toString.call(t),Error(T(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Hf(e){var t=e._init;return t(e._payload)}function jf(e){function t(A,b){if(e){var O=A.deletions;O===null?(A.deletions=[b],A.flags|=16):O.push(b)}}function n(A,b){if(!e)return null;for(;b!==null;)t(A,b),b=b.sibling;return null}function s(A){for(var b=new Map;A!==null;)A.key!==null?b.set(A.key,A):b.set(A.index,A),A=A.sibling;return b}function r(A,b){return A=_n(A,b),A.index=0,A.sibling=null,A}function c(A,b,O){return A.index=O,e?(O=A.alternate,O!==null?(O=O.index,O<b?(A.flags|=67108866,b):O):(A.flags|=67108866,b)):(A.flags|=1048576,b)}function d(A){return e&&A.alternate===null&&(A.flags|=67108866),A}function g(A,b,O,q){return b===null||b.tag!==6?(b=Ul(O,A.mode,q),b.return=A,b):(b=r(b,O),b.return=A,b)}function y(A,b,O,q){var J=O.type;return J===Ue?x(A,b,O.props.children,q,O.key):b!==null&&(b.elementType===J||typeof J=="object"&&J!==null&&J.$$typeof===nt&&Hf(J)===b.type)?(b=r(b,O.props),Wl(b,O),b.return=A,b):(b=Ga(O.type,O.key,O.props,null,A.mode,q),Wl(b,O),b.return=A,b)}function _(A,b,O,q){return b===null||b.tag!==4||b.stateNode.containerInfo!==O.containerInfo||b.stateNode.implementation!==O.implementation?(b=ws(O,A.mode,q),b.return=A,b):(b=r(b,O.children||[]),b.return=A,b)}function x(A,b,O,q,J){return b===null||b.tag!==7?(b=vi(O,A.mode,q,J),b.return=A,b):(b=r(b,O),b.return=A,b)}function z(A,b,O){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return b=Ul(""+b,A.mode,O),b.return=A,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case ye:return O=Ga(b.type,b.key,b.props,null,A.mode,O),Wl(O,b),O.return=A,O;case fe:return b=ws(b,A.mode,O),b.return=A,b;case nt:var q=b._init;return b=q(b._payload),z(A,b,O)}if(_e(b)||Ze(b))return b=vi(b,A.mode,O,null),b.return=A,b;if(typeof b.then=="function")return z(A,qo(b),O);if(b.$$typeof===Me)return z(A,Wt(A,b),O);zo(A,b)}return null}function C(A,b,O,q){var J=b!==null?b.key:null;if(typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint")return J!==null?null:g(A,b,""+O,q);if(typeof O=="object"&&O!==null){switch(O.$$typeof){case ye:return O.key===J?y(A,b,O,q):null;case fe:return O.key===J?_(A,b,O,q):null;case nt:return J=O._init,O=J(O._payload),C(A,b,O,q)}if(_e(O)||Ze(O))return J!==null?null:x(A,b,O,q,null);if(typeof O.then=="function")return C(A,b,qo(O),q);if(O.$$typeof===Me)return C(A,b,Wt(A,O),q);zo(A,O)}return null}function M(A,b,O,q,J){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return A=A.get(O)||null,g(b,A,""+q,J);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case ye:return A=A.get(q.key===null?O:q.key)||null,y(b,A,q,J);case fe:return A=A.get(q.key===null?O:q.key)||null,_(b,A,q,J);case nt:var ve=q._init;return q=ve(q._payload),M(A,b,O,q,J)}if(_e(q)||Ze(q))return A=A.get(O)||null,x(b,A,q,J,null);if(typeof q.then=="function")return M(A,b,O,qo(q),J);if(q.$$typeof===Me)return M(A,b,O,Wt(b,q),J);zo(b,q)}return null}function ce(A,b,O,q){for(var J=null,ve=null,ee=b,le=b=0,Ct=null;ee!==null&&le<O.length;le++){ee.index>le?(Ct=ee,ee=null):Ct=ee.sibling;var ke=C(A,ee,O[le],q);if(ke===null){ee===null&&(ee=Ct);break}e&&ee&&ke.alternate===null&&t(A,ee),b=c(ke,b,le),ve===null?J=ke:ve.sibling=ke,ve=ke,ee=Ct}if(le===O.length)return n(A,ee),de&&bi(A,le),J;if(ee===null){for(;le<O.length;le++)ee=z(A,O[le],q),ee!==null&&(b=c(ee,b,le),ve===null?J=ee:ve.sibling=ee,ve=ee);return de&&bi(A,le),J}for(ee=s(ee);le<O.length;le++)Ct=M(ee,A,le,O[le],q),Ct!==null&&(e&&Ct.alternate!==null&&ee.delete(Ct.key===null?le:Ct.key),b=c(Ct,b,le),ve===null?J=Ct:ve.sibling=Ct,ve=Ct);return e&&ee.forEach(function(Oa){return t(A,Oa)}),de&&bi(A,le),J}function se(A,b,O,q){if(O==null)throw Error(T(151));for(var J=null,ve=null,ee=b,le=b=0,Ct=null,ke=O.next();ee!==null&&!ke.done;le++,ke=O.next()){ee.index>le?(Ct=ee,ee=null):Ct=ee.sibling;var Oa=C(A,ee,ke.value,q);if(Oa===null){ee===null&&(ee=Ct);break}e&&ee&&Oa.alternate===null&&t(A,ee),b=c(Oa,b,le),ve===null?J=Oa:ve.sibling=Oa,ve=Oa,ee=Ct}if(ke.done)return n(A,ee),de&&bi(A,le),J;if(ee===null){for(;!ke.done;le++,ke=O.next())ke=z(A,ke.value,q),ke!==null&&(b=c(ke,b,le),ve===null?J=ke:ve.sibling=ke,ve=ke);return de&&bi(A,le),J}for(ee=s(ee);!ke.done;le++,ke=O.next())ke=M(ee,A,le,ke.value,q),ke!==null&&(e&&ke.alternate!==null&&ee.delete(ke.key===null?le:ke.key),b=c(ke,b,le),ve===null?J=ke:ve.sibling=ke,ve=ke);return e&&ee.forEach(function(tm){return t(A,tm)}),de&&bi(A,le),J}function Ie(A,b,O,q){if(typeof O=="object"&&O!==null&&O.type===Ue&&O.key===null&&(O=O.props.children),typeof O=="object"&&O!==null){switch(O.$$typeof){case ye:e:{for(var J=O.key;b!==null;){if(b.key===J){if(J=O.type,J===Ue){if(b.tag===7){n(A,b.sibling),q=r(b,O.props.children),q.return=A,A=q;break e}}else if(b.elementType===J||typeof J=="object"&&J!==null&&J.$$typeof===nt&&Hf(J)===b.type){n(A,b.sibling),q=r(b,O.props),Wl(q,O),q.return=A,A=q;break e}n(A,b);break}else t(A,b);b=b.sibling}O.type===Ue?(q=vi(O.props.children,A.mode,q,O.key),q.return=A,A=q):(q=Ga(O.type,O.key,O.props,null,A.mode,q),Wl(q,O),q.return=A,A=q)}return d(A);case fe:e:{for(J=O.key;b!==null;){if(b.key===J)if(b.tag===4&&b.stateNode.containerInfo===O.containerInfo&&b.stateNode.implementation===O.implementation){n(A,b.sibling),q=r(b,O.children||[]),q.return=A,A=q;break e}else{n(A,b);break}else t(A,b);b=b.sibling}q=ws(O,A.mode,q),q.return=A,A=q}return d(A);case nt:return J=O._init,O=J(O._payload),Ie(A,b,O,q)}if(_e(O))return ce(A,b,O,q);if(Ze(O)){if(J=Ze(O),typeof J!="function")throw Error(T(150));return O=J.call(O),se(A,b,O,q)}if(typeof O.then=="function")return Ie(A,b,qo(O),q);if(O.$$typeof===Me)return Ie(A,b,Wt(A,O),q);zo(A,O)}return typeof O=="string"&&O!==""||typeof O=="number"||typeof O=="bigint"?(O=""+O,b!==null&&b.tag===6?(n(A,b.sibling),q=r(b,O),q.return=A,A=q):(n(A,b),q=Ul(O,A.mode,q),q.return=A,A=q),d(A)):n(A,b)}return function(A,b,O,q){try{Jl=0;var J=Ie(A,b,O,q);return Gs=null,J}catch(ee){if(ee===Pa||ee===xs)throw ee;var ve=Ht(29,ee,null,A.mode);return ve.lanes=q,ve.return=A,ve}finally{}}}var Hs=jf(!0),Vf=jf(!1),mn=G(null),ei=null;function ra(e){var t=e.alternate;P(St,St.current&1),P(mn,e),ei===null&&(t===null||Wn.current!==null||t.memoizedState!==null)&&(ei=e)}function If(e){if(e.tag===22){if(P(St,St.current),P(mn,e),ei===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(ei=e)}}else oa()}function oa(){P(St,St.current),P(mn,mn.current)}function _i(e){V(mn),ei===e&&(ei=null),V(St)}var St=G(0);function Go(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||Hu(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Wc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:W({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Fc={enqueueSetState:function(e,t,n){e=e._reactInternals;var s=rn(),r=Zn(s);r.payload=t,n!=null&&(r.callback=n),t=Jn(e,r,s),t!==null&&(on(t,e,s),Ka(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=rn(),r=Zn(s);r.tag=1,r.payload=t,n!=null&&(r.callback=n),t=Jn(e,r,s),t!==null&&(on(t,e,s),Ka(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=rn(),s=Zn(n);s.tag=2,t!=null&&(s.callback=t),t=Jn(e,s,n),t!==null&&(on(t,e,n),Ka(t,e,n))}};function Yf(e,t,n,s,r,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,c,d):t.prototype&&t.prototype.isPureReactComponent?!In(n,s)||!In(r,c):!0}function Pf(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Fc.enqueueReplaceState(t,t.state,null)}function Fa(e,t){var n=t;if("ref"in t){n={};for(var s in t)s!=="ref"&&(n[s]=t[s])}if(e=e.defaultProps){n===t&&(n=W({},n));for(var r in e)n[r]===void 0&&(n[r]=e[r])}return n}var Ho=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Qf(e){Ho(e)}function Xf(e){console.error(e)}function Kf(e){Ho(e)}function jo(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function Zf(e,t,n){try{var s=e.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function $c(e,t,n){return n=Zn(n),n.tag=3,n.payload={element:null},n.callback=function(){jo(e,t)},n}function Jf(e){return e=Zn(e),e.tag=3,e}function Wf(e,t,n,s){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var c=s.value;e.payload=function(){return r(c)},e.callback=function(){Zf(t,n,s)}}var d=n.stateNode;d!==null&&typeof d.componentDidCatch=="function"&&(e.callback=function(){Zf(t,n,s),typeof r!="function"&&(ga===null?ga=new Set([this]):ga.add(this));var g=s.stack;this.componentDidCatch(s.value,{componentStack:g!==null?g:""})})}function tg(e,t,n,s,r){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=n.alternate,t!==null&&ja(t,n,r,!0),n=mn.current,n!==null){switch(n.tag){case 13:return ei===null?Ru():n.alternate===null&&rt===0&&(rt=3),n.flags&=-257,n.flags|=65536,n.lanes=r,s===Gl?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([s]):t.add(s),_u(e,s,r)),!1;case 22:return n.flags|=65536,s===Gl?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([s]):n.add(s)),_u(e,s,r)),!1}throw Error(T(435,n.tag))}return _u(e,s,r),Ru(),!1}if(de)return t=mn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=r,s!==Si&&(e=Error(T(422),{cause:s}),xn(Kt(e,n)))):(s!==Si&&(t=Error(T(423),{cause:s}),xn(Kt(t,n))),e=e.current.alternate,e.flags|=65536,r&=-r,e.lanes|=r,s=Kt(s,n),r=$c(e.stateNode,s,r),jl(e,r),rt!==4&&(rt=2)),!1;var c=Error(T(520),{cause:s});if(c=Kt(c,n),ar===null?ar=[c]:ar.push(c),rt!==4&&(rt=2),t===null)return!0;s=Kt(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,e=$c(n.stateNode,s,e),jl(n,e),!1;case 1:if(t=n.type,c=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||c!==null&&typeof c.componentDidCatch=="function"&&(ga===null||!ga.has(c))))return n.flags|=65536,r&=-r,n.lanes|=r,r=Jf(r),Wf(r,e,n,s),jl(n,r),!1}n=n.return}while(n!==null);return!1}var Ff=Error(T(461)),Tt=!1;function wt(e,t,n,s){t.child=e===null?Vf(t,null,n,s):Hs(t,e.child,n,s)}function $f(e,t,n,s,r){n=n.render;var c=t.ref;if("ref"in s){var d={};for(var g in s)g!=="ref"&&(d[g]=s[g])}else d=s;return Ai(t),s=Ql(e,t,n,d,c,r),g=i(),e!==null&&!Tt?(a(e,t,r),Ci(e,t,r)):(de&&g&&xl(t),t.flags|=1,wt(e,t,s,r),t.child)}function eh(e,t,n,s,r){if(e===null){var c=n.type;return typeof c=="function"&&!za(c)&&c.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=c,th(e,t,c,s,r)):(e=Ga(n.type,null,s,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!ru(e,r)){var d=c.memoizedProps;if(n=n.compare,n=n!==null?n:In,n(d,s)&&e.ref===t.ref)return Ci(e,t,r)}return t.flags|=1,e=_n(c,s),e.ref=t.ref,e.return=t,t.child=e}function th(e,t,n,s,r){if(e!==null){var c=e.memoizedProps;if(In(c,s)&&e.ref===t.ref)if(Tt=!1,t.pendingProps=s=c,ru(e,r))(e.flags&131072)!==0&&(Tt=!0);else return t.lanes=e.lanes,Ci(e,t,r)}return eu(e,t,n,s,r)}function nh(e,t,n){var s=t.pendingProps,r=s.children,c=e!==null?e.memoizedState:null;if(s.mode==="hidden"){if((t.flags&128)!==0){if(s=c!==null?c.baseLanes|n:n,e!==null){for(r=t.child=e.child,c=0;r!==null;)c=c|r.lanes|r.childLanes,r=r.sibling;t.childLanes=c&~s}else t.childLanes=0,t.child=null;return ih(e,t,s,n)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ia(t,c!==null?c.cachePool:null),c!==null?Ls(t,c):Bs(),If(t);else return t.lanes=t.childLanes=536870912,ih(e,t,c!==null?c.baseLanes|n:n,n)}else c!==null?(ia(t,c.cachePool),Ls(t,c),oa(),t.memoizedState=null):(e!==null&&ia(t,null),Bs(),oa());return wt(e,t,r,n),t.child}function ih(e,t,n,s){var r=zl();return r=r===null?null:{parent:Qe._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},e!==null&&ia(t,null),Bs(),If(t),e!==null&&ja(e,t,s,!0),null}function Vo(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(T(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function eu(e,t,n,s,r){return Ai(t),n=Ql(e,t,n,s,void 0,r),s=i(),e!==null&&!Tt?(a(e,t,r),Ci(e,t,r)):(de&&s&&xl(t),t.flags|=1,wt(e,t,n,r),t.child)}function ah(e,t,n,s,r,c){return Ai(t),t.updateQueue=null,n=xo(t,s,n,r),Xl(e),s=i(),e!==null&&!Tt?(a(e,t,c),Ci(e,t,c)):(de&&s&&xl(t),t.flags|=1,wt(e,t,n,c),t.child)}function sh(e,t,n,s,r){if(Ai(t),t.stateNode===null){var c=yi,d=n.contextType;typeof d=="object"&&d!==null&&(c=vt(d)),c=new n(s,c),t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Fc,t.stateNode=c,c._reactInternals=t,c=t.stateNode,c.props=s,c.state=t.memoizedState,c.refs={},Ds(t),d=n.contextType,c.context=typeof d=="object"&&d!==null?vt(d):yi,c.state=t.memoizedState,d=n.getDerivedStateFromProps,typeof d=="function"&&(Wc(t,n,d,s),c.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(d=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),d!==c.state&&Fc.enqueueReplaceState(c,c.state,null),Ja(t,s,c,r),Za(),c.state=t.memoizedState),typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(e===null){c=t.stateNode;var g=t.memoizedProps,y=Fa(n,g);c.props=y;var _=c.context,x=n.contextType;d=yi,typeof x=="object"&&x!==null&&(d=vt(x));var z=n.getDerivedStateFromProps;x=typeof z=="function"||typeof c.getSnapshotBeforeUpdate=="function",g=t.pendingProps!==g,x||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(g||_!==d)&&Pf(t,c,s,d),kn=!1;var C=t.memoizedState;c.state=C,Ja(t,s,c,r),Za(),_=t.memoizedState,g||C!==_||kn?(typeof z=="function"&&(Wc(t,n,z,s),_=t.memoizedState),(y=kn||Yf(t,n,y,s,C,_,d))?(x||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=_),c.props=s,c.state=_,c.context=d,s=y):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{c=t.stateNode,Hl(e,t),d=t.memoizedProps,x=Fa(n,d),c.props=x,z=t.pendingProps,C=c.context,_=n.contextType,y=yi,typeof _=="object"&&_!==null&&(y=vt(_)),g=n.getDerivedStateFromProps,(_=typeof g=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(d!==z||C!==y)&&Pf(t,c,s,y),kn=!1,C=t.memoizedState,c.state=C,Ja(t,s,c,r),Za();var M=t.memoizedState;d!==z||C!==M||kn||e!==null&&e.dependencies!==null&&Va(e.dependencies)?(typeof g=="function"&&(Wc(t,n,g,s),M=t.memoizedState),(x=kn||Yf(t,n,x,s,C,M,y)||e!==null&&e.dependencies!==null&&Va(e.dependencies))?(_||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(s,M,y),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(s,M,y)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&C===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&C===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=M),c.props=s,c.state=M,c.context=y,s=x):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&C===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&C===e.memoizedState||(t.flags|=1024),s=!1)}return c=s,Vo(e,t),s=(t.flags&128)!==0,c||s?(c=t.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:c.render(),t.flags|=1,e!==null&&s?(t.child=Hs(t,e.child,null,r),t.child=Hs(t,null,n,r)):wt(e,t,n,r),t.memoizedState=c.state,e=t.child):e=Ci(e,t,r),e}function lh(e,t,n,s){return Wi(),t.flags|=256,wt(e,t,n,s),t.child}var tu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function nu(e){return{baseLanes:e,cachePool:Co()}}function iu(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=pn),e}function rh(e,t,n){var s=t.pendingProps,r=!1,c=(t.flags&128)!==0,d;if((d=c)||(d=e!==null&&e.memoizedState===null?!1:(St.current&2)!==0),d&&(r=!0,t.flags&=-129),d=(t.flags&32)!==0,t.flags&=-33,e===null){if(de){if(r?ra(t):oa(),de){var g=$e,y;if(y=g){e:{for(y=g,g=Jt;y.nodeType!==8;){if(!g){g=null;break e}if(y=Bn(y.nextSibling),y===null){g=null;break e}}g=y}g!==null?(t.memoizedState={dehydrated:g,treeContext:Cn!==null?{id:En,overflow:Mn}:null,retryLane:536870912,hydrationErrors:null},y=Ht(18,null,null,0),y.stateNode=g,y.return=t,t.child=y,Rt=t,$e=null,y=!0):y=!1}y||Nn(t)}if(g=t.memoizedState,g!==null&&(g=g.dehydrated,g!==null))return Hu(g)?t.lanes=32:t.lanes=536870912,null;_i(t)}return g=s.children,s=s.fallback,r?(oa(),r=t.mode,g=Io({mode:"hidden",children:g},r),s=vi(s,r,n,null),g.return=t,s.return=t,g.sibling=s,t.child=g,r=t.child,r.memoizedState=nu(n),r.childLanes=iu(e,d,n),t.memoizedState=tu,s):(ra(t),au(t,g))}if(y=e.memoizedState,y!==null&&(g=y.dehydrated,g!==null)){if(c)t.flags&256?(ra(t),t.flags&=-257,t=su(e,t,n)):t.memoizedState!==null?(oa(),t.child=e.child,t.flags|=128,t=null):(oa(),r=s.fallback,g=t.mode,s=Io({mode:"visible",children:s.children},g),r=vi(r,g,n,null),r.flags|=2,s.return=t,r.return=t,s.sibling=r,t.child=s,Hs(t,e.child,null,n),s=t.child,s.memoizedState=nu(n),s.childLanes=iu(e,d,n),t.memoizedState=tu,t=r);else if(ra(t),Hu(g)){if(d=g.nextSibling&&g.nextSibling.dataset,d)var _=d.dgst;d=_,s=Error(T(419)),s.stack="",s.digest=d,xn({value:s,source:null,stack:null}),t=su(e,t,n)}else if(Tt||ja(e,t,n,!1),d=(n&e.childLanes)!==0,Tt||d){if(d=Xe,d!==null&&(s=n&-n,s=(s&42)!==0?1:sl(s),s=(s&(d.suspendedLanes|n))!==0?0:s,s!==0&&s!==y.retryLane))throw y.retryLane=s,Ki(e,s),on(d,e,s),Ff;g.data==="$?"||Ru(),t=su(e,t,n)}else g.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=y.treeContext,$e=Bn(g.nextSibling),Rt=t,de=!0,wn=null,Jt=!1,e!==null&&(Bt[Zt++]=En,Bt[Zt++]=Mn,Bt[Zt++]=Cn,En=e.id,Mn=e.overflow,Cn=t),t=au(t,s.children),t.flags|=4096);return t}return r?(oa(),r=s.fallback,g=t.mode,y=e.child,_=y.sibling,s=_n(y,{mode:"hidden",children:s.children}),s.subtreeFlags=y.subtreeFlags&65011712,_!==null?r=_n(_,r):(r=vi(r,g,n,null),r.flags|=2),r.return=t,s.return=t,s.sibling=r,t.child=s,s=r,r=t.child,g=e.child.memoizedState,g===null?g=nu(n):(y=g.cachePool,y!==null?(_=Qe._currentValue,y=y.parent!==_?{parent:_,pool:_}:y):y=Co(),g={baseLanes:g.baseLanes|n,cachePool:y}),r.memoizedState=g,r.childLanes=iu(e,d,n),t.memoizedState=tu,s):(ra(t),n=e.child,e=n.sibling,n=_n(n,{mode:"visible",children:s.children}),n.return=t,n.sibling=null,e!==null&&(d=t.deletions,d===null?(t.deletions=[e],t.flags|=16):d.push(e)),t.child=n,t.memoizedState=null,n)}function au(e,t){return t=Io({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Io(e,t){return e=Ht(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function su(e,t,n){return Hs(t,e.child,null,n),e=au(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function oh(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),$i(e.return,t,n)}function lu(e,t,n,s,r){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=n,c.tailMode=r)}function ch(e,t,n){var s=t.pendingProps,r=s.revealOrder,c=s.tail;if(wt(e,t,s.children,n),s=St.current,(s&2)!==0)s=s&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&oh(e,n,t);else if(e.tag===19)oh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}switch(P(St,s),r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&Go(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),lu(t,!1,r,n,c);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&Go(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}lu(t,!0,n,null,c);break;case"together":lu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ci(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),da|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(ja(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(T(153));if(t.child!==null){for(e=t.child,n=_n(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=_n(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function ru(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&Va(e)))}function ng(e,t,n){switch(t.tag){case 3:Ye(t,t.stateNode.containerInfo),gn(t,Qe,e.memoizedState.cache),Wi();break;case 27:case 5:ns(t);break;case 4:Ye(t,t.stateNode.containerInfo);break;case 10:gn(t,t.type,t.memoizedProps.value);break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(ra(t),t.flags|=128,null):(n&t.child.childLanes)!==0?rh(e,t,n):(ra(t),e=Ci(e,t,n),e!==null?e.sibling:null);ra(t);break;case 19:var r=(e.flags&128)!==0;if(s=(n&t.childLanes)!==0,s||(ja(e,t,n,!1),s=(n&t.childLanes)!==0),r){if(s)return ch(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),P(St,St.current),s)break;return null;case 22:case 23:return t.lanes=0,nh(e,t,n);case 24:gn(t,Qe,e.memoizedState.cache)}return Ci(e,t,n)}function uh(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Tt=!0;else{if(!ru(e,n)&&(t.flags&128)===0)return Tt=!1,ng(e,t,n);Tt=(e.flags&131072)!==0}else Tt=!1,de&&(t.flags&1048576)!==0&&Ao(t,Us,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var s=t.elementType,r=s._init;if(s=r(s._payload),t.type=s,typeof s=="function")za(s)?(e=Fa(s,e),t.tag=1,t=sh(null,t,s,e,n)):(t.tag=0,t=eu(null,t,s,e,n));else{if(s!=null){if(r=s.$$typeof,r===N){t.tag=11,t=$f(null,t,s,e,n);break e}else if(r===ft){t.tag=14,t=eh(null,t,s,e,n);break e}}throw t=w(s)||s,Error(T(306,t,""))}}return t;case 0:return eu(e,t,t.type,t.pendingProps,n);case 1:return s=t.type,r=Fa(s,t.pendingProps),sh(e,t,s,r,n);case 3:e:{if(Ye(t,t.stateNode.containerInfo),e===null)throw Error(T(387));s=t.pendingProps;var c=t.memoizedState;r=c.element,Hl(e,t),Ja(t,s,null,n);var d=t.memoizedState;if(s=d.cache,gn(t,Qe,s),s!==c.cache&&Bl(t,[Qe],n,!0),Za(),s=d.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:d.cache},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){t=lh(e,t,s,n);break e}else if(s!==r){r=Kt(Error(T(424)),t),xn(r),t=lh(e,t,s,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for($e=Bn(e.firstChild),Rt=t,de=!0,wn=null,Jt=!0,n=Vf(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(Wi(),s===r){t=Ci(e,t,n);break e}wt(e,t,s,n)}t=t.child}return t;case 26:return Vo(e,t),e===null?(n=gd(t.type,null,t.pendingProps,null))?t.memoizedState=n:de||(n=t.type,e=t.pendingProps,s=ic(he.current).createElement(n),s[yt]=t,s[Et]=e,Ut(s,n,e),dt(s),t.stateNode=s):t.memoizedState=gd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return ns(t),e===null&&de&&(s=t.stateNode=fd(t.type,t.pendingProps,he.current),Rt=t,Jt=!0,r=$e,ya(t.type)?(ju=r,$e=Bn(s.firstChild)):$e=r),wt(e,t,t.pendingProps.children,n),Vo(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&de&&((r=s=$e)&&(s=Ng(s,t.type,t.pendingProps,Jt),s!==null?(t.stateNode=s,Rt=t,$e=Bn(s.firstChild),Jt=!1,r=!0):r=!1),r||Nn(t)),ns(t),r=t.type,c=t.pendingProps,d=e!==null?e.memoizedProps:null,s=c.children,qu(r,c)?s=null:d!==null&&qu(r,d)&&(t.flags|=32),t.memoizedState!==null&&(r=Ql(e,t,Pc,null,null,n),dr._currentValue=r),Vo(e,t),wt(e,t,s,n),t.child;case 6:return e===null&&de&&((e=n=$e)&&(n=Ug(n,t.pendingProps,Jt),n!==null?(t.stateNode=n,Rt=t,$e=null,e=!0):e=!1),e||Nn(t)),null;case 13:return rh(e,t,n);case 4:return Ye(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Hs(t,null,s,n):wt(e,t,s,n),t.child;case 11:return $f(e,t,t.type,t.pendingProps,n);case 7:return wt(e,t,t.pendingProps,n),t.child;case 8:return wt(e,t,t.pendingProps.children,n),t.child;case 12:return wt(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,gn(t,t.type,s.value),wt(e,t,s.children,n),t.child;case 9:return r=t.type._context,s=t.pendingProps.children,Ai(t),r=vt(r),s=s(r),t.flags|=1,wt(e,t,s,n),t.child;case 14:return eh(e,t,t.type,t.pendingProps,n);case 15:return th(e,t,t.type,t.pendingProps,n);case 19:return ch(e,t,n);case 31:return s=t.pendingProps,n=t.mode,s={mode:s.mode,children:s.children},e===null?(n=Io(s,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=_n(e.child,s),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return nh(e,t,n);case 24:return Ai(t),s=vt(Qe),e===null?(r=zl(),r===null&&(r=Xe,c=Xn(),r.pooledCache=c,c.refCount++,c!==null&&(r.pooledCacheLanes|=n),r=c),t.memoizedState={parent:s,cache:r},Ds(t),gn(t,Qe,r)):((e.lanes&n)!==0&&(Hl(e,t),Ja(t,null,null,n),Za()),r=e.memoizedState,c=t.memoizedState,r.parent!==s?(r={parent:s,cache:s},t.memoizedState=r,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=r),gn(t,Qe,s)):(s=c.cache,gn(t,Qe,s),s!==r.cache&&Bl(t,[Qe],n,!0))),wt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(T(156,t.tag))}function Ei(e){e.flags|=4}function fh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!bd(t)){if(t=mn.current,t!==null&&((Ne&4194048)===Ne?ei!==null:(Ne&62914560)!==Ne&&(Ne&536870912)===0||t!==ei))throw Xa=Gl,Eo;e.flags|=8192}}function Yo(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Ma():536870912,e.lanes|=t,Ys|=t)}function Fl(e,t){if(!de)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function at(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&65011712,s|=r.flags&65011712,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function ig(e,t,n){var s=t.pendingProps;switch(Dl(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return at(t),null;case 1:return at(t),null;case 3:return n=t.stateNode,s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),pt(Qe),vn(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Un(t)?Ei(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,Fi())),at(t),null;case 26:return n=t.memoizedState,e===null?(Ei(t),n!==null?(at(t),fh(t,n)):(at(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Ei(t),at(t),fh(t,n)):(at(t),t.flags&=-16777217):(e.memoizedProps!==s&&Ei(t),at(t),t.flags&=-16777217),null;case 27:is(t),n=he.current;var r=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Ei(t);else{if(!s){if(t.stateNode===null)throw Error(T(166));return at(t),null}e=ne.current,Un(t)?kl(t):(e=fd(r,s,n),t.stateNode=e,Ei(t))}return at(t),null;case 5:if(is(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Ei(t);else{if(!s){if(t.stateNode===null)throw Error(T(166));return at(t),null}if(e=ne.current,Un(t))kl(t);else{switch(r=ic(he.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof s.is=="string"?r.createElement("select",{is:s.is}):r.createElement("select"),s.multiple?e.multiple=!0:s.size&&(e.size=s.size);break;default:e=typeof s.is=="string"?r.createElement(n,{is:s.is}):r.createElement(n)}}e[yt]=t,e[Et]=s;e:for(r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(Ut(e,n,s),n){case"button":case"input":case"select":case"textarea":e=!!s.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Ei(t)}}return at(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==s&&Ei(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(T(166));if(e=he.current,Un(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,r=Rt,r!==null)switch(r.tag){case 27:case 5:s=r.memoizedProps}e[yt]=t,e=!!(e.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||ad(e.nodeValue,n)),e||Nn(t)}else e=ic(e).createTextNode(s),e[yt]=t,t.stateNode=e}return at(t),null;case 13:if(s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(r=Un(t),s!==null&&s.dehydrated!==null){if(e===null){if(!r)throw Error(T(318));if(r=t.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(T(317));r[yt]=t}else Wi(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;at(t),r=!1}else r=Fi(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return t.flags&256?(_i(t),t):(_i(t),null)}if(_i(t),(t.flags&128)!==0)return t.lanes=n,t;if(n=s!==null,e=e!==null&&e.memoizedState!==null,n){s=t.child,r=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(r=s.alternate.memoizedState.cachePool.pool);var c=null;s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==r&&(s.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Yo(t,t.updateQueue),at(t),null;case 4:return vn(),e===null&&xu(t.stateNode.containerInfo),at(t),null;case 10:return pt(t.type),at(t),null;case 19:if(V(St),r=t.memoizedState,r===null)return at(t),null;if(s=(t.flags&128)!==0,c=r.rendering,c===null)if(s)Fl(r,!1);else{if(rt!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(c=Go(e),c!==null){for(t.flags|=128,Fl(r,!1),e=c.updateQueue,t.updateQueue=e,Yo(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)So(n,e),n=n.sibling;return P(St,St.current&1|2),t.child}e=e.sibling}r.tail!==null&&Vt()>Xo&&(t.flags|=128,s=!0,Fl(r,!1),t.lanes=4194304)}else{if(!s)if(e=Go(c),e!==null){if(t.flags|=128,s=!0,e=e.updateQueue,t.updateQueue=e,Yo(t,e),Fl(r,!0),r.tail===null&&r.tailMode==="hidden"&&!c.alternate&&!de)return at(t),null}else 2*Vt()-r.renderingStartTime>Xo&&n!==536870912&&(t.flags|=128,s=!0,Fl(r,!1),t.lanes=4194304);r.isBackwards?(c.sibling=t.child,t.child=c):(e=r.last,e!==null?e.sibling=c:t.child=c,r.last=c)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Vt(),t.sibling=null,e=St.current,P(St,s?e&1|2:e&1),t):(at(t),null);case 22:case 23:return _i(t),Yl(),s=t.memoizedState!==null,e!==null?e.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?(n&536870912)!==0&&(t.flags&128)===0&&(at(t),t.subtreeFlags&6&&(t.flags|=8192)):at(t),n=t.updateQueue,n!==null&&Yo(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),e!==null&&V(Kn),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),pt(Qe),at(t),null;case 25:return null;case 30:return null}throw Error(T(156,t.tag))}function ag(e,t){switch(Dl(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return pt(Qe),vn(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return is(t),null;case 13:if(_i(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(T(340));Wi()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return V(St),null;case 4:return vn(),null;case 10:return pt(t.type),null;case 22:case 23:return _i(t),Yl(),e!==null&&V(Kn),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return pt(Qe),null;case 25:return null;default:return null}}function hh(e,t){switch(Dl(t),t.tag){case 3:pt(Qe),vn();break;case 26:case 27:case 5:is(t);break;case 4:vn();break;case 13:_i(t);break;case 19:V(St);break;case 10:pt(t.type);break;case 22:case 23:_i(t),Yl(),e!==null&&V(Kn);break;case 24:pt(Qe)}}function $l(e,t){try{var n=t.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var r=s.next;n=r;do{if((n.tag&e)===e){s=void 0;var c=n.create,d=n.inst;s=c(),d.destroy=s}n=n.next}while(n!==r)}}catch(g){Pe(t,t.return,g)}}function ca(e,t,n){try{var s=t.updateQueue,r=s!==null?s.lastEffect:null;if(r!==null){var c=r.next;s=c;do{if((s.tag&e)===e){var d=s.inst,g=d.destroy;if(g!==void 0){d.destroy=void 0,r=t;var y=n,_=g;try{_()}catch(x){Pe(r,y,x)}}}s=s.next}while(s!==c)}}catch(x){Pe(t,t.return,x)}}function dh(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Il(t,n)}catch(s){Pe(e,e.return,s)}}}function gh(e,t,n){n.props=Fa(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(s){Pe(e,t,s)}}function er(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;case 30:s=e.stateNode;break;default:s=e.stateNode}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(r){Pe(e,t,r)}}function ti(e,t){var n=e.ref,s=e.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(r){Pe(e,t,r)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){Pe(e,t,r)}else n.current=null}function mh(e){var t=e.type,n=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(r){Pe(e,e.return,r)}}function ou(e,t,n){try{var s=e.stateNode;_g(s,e.type,n,t),s[Et]=t}catch(r){Pe(e,e.return,r)}}function ph(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&ya(e.type)||e.tag===4}function cu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ph(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&ya(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function uu(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=nc));else if(s!==4&&(s===27&&ya(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(uu(e,t,n),e=e.sibling;e!==null;)uu(e,t,n),e=e.sibling}function Po(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(s===27&&ya(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Po(e,t,n),e=e.sibling;e!==null;)Po(e,t,n),e=e.sibling}function yh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var s=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);Ut(t,s,n),t[yt]=e,t[Et]=n}catch(c){Pe(e,e.return,c)}}var Mi=!1,ct=!1,fu=!1,vh=typeof WeakSet=="function"?WeakSet:Set,_t=null;function sg(e,t){if(e=e.containerInfo,Lu=cc,e=Lt(e),qa(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var d=0,g=-1,y=-1,_=0,x=0,z=e,C=null;t:for(;;){for(var M;z!==n||r!==0&&z.nodeType!==3||(g=d+r),z!==c||s!==0&&z.nodeType!==3||(y=d+s),z.nodeType===3&&(d+=z.nodeValue.length),(M=z.firstChild)!==null;)C=z,z=M;for(;;){if(z===e)break t;if(C===n&&++_===r&&(g=d),C===c&&++x===s&&(y=d),(M=z.nextSibling)!==null)break;z=C,C=z.parentNode}z=M}n=g===-1||y===-1?null:{start:g,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bu={focusedElem:e,selectionRange:n},cc=!1,_t=t;_t!==null;)if(t=_t,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,_t=e;else for(;_t!==null;){switch(t=_t,c=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&c!==null){e=void 0,n=t,r=c.memoizedProps,c=c.memoizedState,s=n.stateNode;try{var ce=Fa(n.type,r,n.elementType===n.type);e=s.getSnapshotBeforeUpdate(ce,c),s.__reactInternalSnapshotBeforeUpdate=e}catch(se){Pe(n,n.return,se)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)Gu(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":Gu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(T(163))}if(e=t.sibling,e!==null){e.return=t.return,_t=e;break}_t=t.return}}function bh(e,t,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:ua(e,n),s&4&&$l(5,n);break;case 1:if(ua(e,n),s&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(d){Pe(n,n.return,d)}else{var r=Fa(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(d){Pe(n,n.return,d)}}s&64&&dh(n),s&512&&er(n,n.return);break;case 3:if(ua(e,n),s&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Il(e,t)}catch(d){Pe(n,n.return,d)}}break;case 27:t===null&&s&4&&yh(n);case 26:case 5:ua(e,n),t===null&&s&4&&mh(n),s&512&&er(n,n.return);break;case 12:ua(e,n);break;case 13:ua(e,n),s&4&&Oh(e,n),s&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=gg.bind(null,n),xg(e,n))));break;case 22:if(s=n.memoizedState!==null||Mi,!s){t=t!==null&&t.memoizedState!==null||ct,r=Mi;var c=ct;Mi=s,(ct=t)&&!c?fa(e,n,(n.subtreeFlags&8772)!==0):ua(e,n),Mi=r,ct=c}break;case 30:break;default:ua(e,n)}}function Sh(e){var t=e.alternate;t!==null&&(e.alternate=null,Sh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&cl(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var et=null,Ft=!1;function wi(e,t,n){for(n=n.child;n!==null;)Ah(e,t,n),n=n.sibling}function Ah(e,t,n){if(He&&typeof He.onCommitFiberUnmount=="function")try{He.onCommitFiberUnmount(xi,n)}catch{}switch(n.tag){case 26:ct||ti(n,t),wi(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:ct||ti(n,t);var s=et,r=Ft;ya(n.type)&&(et=n.stateNode,Ft=!1),wi(e,t,n),cr(n.stateNode),et=s,Ft=r;break;case 5:ct||ti(n,t);case 6:if(s=et,r=Ft,et=null,wi(e,t,n),et=s,Ft=r,et!==null)if(Ft)try{(et.nodeType===9?et.body:et.nodeName==="HTML"?et.ownerDocument.body:et).removeChild(n.stateNode)}catch(c){Pe(n,t,c)}else try{et.removeChild(n.stateNode)}catch(c){Pe(n,t,c)}break;case 18:et!==null&&(Ft?(e=et,cd(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),yr(e)):cd(et,n.stateNode));break;case 4:s=et,r=Ft,et=n.stateNode.containerInfo,Ft=!0,wi(e,t,n),et=s,Ft=r;break;case 0:case 11:case 14:case 15:ct||ca(2,n,t),ct||ca(4,n,t),wi(e,t,n);break;case 1:ct||(ti(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"&&gh(n,t,s)),wi(e,t,n);break;case 21:wi(e,t,n);break;case 22:ct=(s=ct)||n.memoizedState!==null,wi(e,t,n),ct=s;break;default:wi(e,t,n)}}function Oh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{yr(e)}catch(n){Pe(t,t.return,n)}}function lg(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new vh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new vh),t;default:throw Error(T(435,e.tag))}}function hu(e,t){var n=lg(e);t.forEach(function(s){var r=mg.bind(null,e,s);n.has(s)||(n.add(s),s.then(r,r))})}function an(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s],c=e,d=t,g=d;e:for(;g!==null;){switch(g.tag){case 27:if(ya(g.type)){et=g.stateNode,Ft=!1;break e}break;case 5:et=g.stateNode,Ft=!1;break e;case 3:case 4:et=g.stateNode.containerInfo,Ft=!0;break e}g=g.return}if(et===null)throw Error(T(160));Ah(c,d,r),et=null,Ft=!1,c=r.alternate,c!==null&&(c.return=null),r.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Rh(t,e),t=t.sibling}var Ln=null;function Rh(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:an(t,e),sn(e),s&4&&(ca(3,e,e.return),$l(3,e),ca(5,e,e.return));break;case 1:an(t,e),sn(e),s&512&&(ct||n===null||ti(n,n.return)),s&64&&Mi&&(e=e.updateQueue,e!==null&&(s=e.callbacks,s!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var r=Ln;if(an(t,e),sn(e),s&512&&(ct||n===null||ti(n,n.return)),s&4){var c=n!==null?n.memoizedState:null;if(s=e.memoizedState,n===null)if(s===null)if(e.stateNode===null){e:{s=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(s){case"title":c=r.getElementsByTagName("title")[0],(!c||c[wa]||c[yt]||c.namespaceURI==="http://www.w3.org/2000/svg"||c.hasAttribute("itemprop"))&&(c=r.createElement(s),r.head.insertBefore(c,r.querySelector("head > title"))),Ut(c,s,n),c[yt]=e,dt(c),s=c;break e;case"link":var d=yd("link","href",r).get(s+(n.href||""));if(d){for(var g=0;g<d.length;g++)if(c=d[g],c.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&c.getAttribute("rel")===(n.rel==null?null:n.rel)&&c.getAttribute("title")===(n.title==null?null:n.title)&&c.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){d.splice(g,1);break t}}c=r.createElement(s),Ut(c,s,n),r.head.appendChild(c);break;case"meta":if(d=yd("meta","content",r).get(s+(n.content||""))){for(g=0;g<d.length;g++)if(c=d[g],c.getAttribute("content")===(n.content==null?null:""+n.content)&&c.getAttribute("name")===(n.name==null?null:n.name)&&c.getAttribute("property")===(n.property==null?null:n.property)&&c.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&c.getAttribute("charset")===(n.charSet==null?null:n.charSet)){d.splice(g,1);break t}}c=r.createElement(s),Ut(c,s,n),r.head.appendChild(c);break;default:throw Error(T(468,s))}c[yt]=e,dt(c),s=c}e.stateNode=s}else vd(r,e.type,e.stateNode);else e.stateNode=pd(r,s,e.memoizedProps);else c!==s?(c===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):c.count--,s===null?vd(r,e.type,e.stateNode):pd(r,s,e.memoizedProps)):s===null&&e.stateNode!==null&&ou(e,e.memoizedProps,n.memoizedProps)}break;case 27:an(t,e),sn(e),s&512&&(ct||n===null||ti(n,n.return)),n!==null&&s&4&&ou(e,e.memoizedProps,n.memoizedProps);break;case 5:if(an(t,e),sn(e),s&512&&(ct||n===null||ti(n,n.return)),e.flags&32){r=e.stateNode;try{F(r,"")}catch(M){Pe(e,e.return,M)}}s&4&&e.stateNode!=null&&(r=e.memoizedProps,ou(e,r,n!==null?n.memoizedProps:r)),s&1024&&(fu=!0);break;case 6:if(an(t,e),sn(e),s&4){if(e.stateNode===null)throw Error(T(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(M){Pe(e,e.return,M)}}break;case 3:if(lc=null,r=Ln,Ln=ac(t.containerInfo),an(t,e),Ln=r,sn(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{yr(t.containerInfo)}catch(M){Pe(e,e.return,M)}fu&&(fu=!1,Th(e));break;case 4:s=Ln,Ln=ac(e.stateNode.containerInfo),an(t,e),sn(e),Ln=s;break;case 12:an(t,e),sn(e);break;case 13:an(t,e),sn(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(vu=Vt()),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,hu(e,s)));break;case 22:r=e.memoizedState!==null;var y=n!==null&&n.memoizedState!==null,_=Mi,x=ct;if(Mi=_||r,ct=x||y,an(t,e),ct=x,Mi=_,sn(e),s&8192)e:for(t=e.stateNode,t._visibility=r?t._visibility&-2:t._visibility|1,r&&(n===null||y||Mi||ct||$a(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){y=n=t;try{if(c=y.stateNode,r)d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none";else{g=y.stateNode;var z=y.memoizedProps.style,C=z!=null&&z.hasOwnProperty("display")?z.display:null;g.style.display=C==null||typeof C=="boolean"?"":(""+C).trim()}}catch(M){Pe(y,y.return,M)}}}else if(t.tag===6){if(n===null){y=t;try{y.stateNode.nodeValue=r?"":y.memoizedProps}catch(M){Pe(y,y.return,M)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=e.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,hu(e,n))));break;case 19:an(t,e),sn(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,hu(e,s)));break;case 30:break;case 21:break;default:an(t,e),sn(e)}}function sn(e){var t=e.flags;if(t&2){try{for(var n,s=e.return;s!==null;){if(ph(s)){n=s;break}s=s.return}if(n==null)throw Error(T(160));switch(n.tag){case 27:var r=n.stateNode,c=cu(e);Po(e,c,r);break;case 5:var d=n.stateNode;n.flags&32&&(F(d,""),n.flags&=-33);var g=cu(e);Po(e,g,d);break;case 3:case 4:var y=n.stateNode.containerInfo,_=cu(e);uu(e,_,y);break;default:throw Error(T(161))}}catch(x){Pe(e,e.return,x)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Th(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Th(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function ua(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)bh(e,t.alternate,t),t=t.sibling}function $a(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:ca(4,t,t.return),$a(t);break;case 1:ti(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&gh(t,t.return,n),$a(t);break;case 27:cr(t.stateNode);case 26:case 5:ti(t,t.return),$a(t);break;case 22:t.memoizedState===null&&$a(t);break;case 30:$a(t);break;default:$a(t)}e=e.sibling}}function fa(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,r=e,c=t,d=c.flags;switch(c.tag){case 0:case 11:case 15:fa(r,c,n),$l(4,c);break;case 1:if(fa(r,c,n),s=c,r=s.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(_){Pe(s,s.return,_)}if(s=c,r=s.updateQueue,r!==null){var g=s.stateNode;try{var y=r.shared.hiddenCallbacks;if(y!==null)for(r.shared.hiddenCallbacks=null,r=0;r<y.length;r++)aa(y[r],g)}catch(_){Pe(s,s.return,_)}}n&&d&64&&dh(c),er(c,c.return);break;case 27:yh(c);case 26:case 5:fa(r,c,n),n&&s===null&&d&4&&mh(c),er(c,c.return);break;case 12:fa(r,c,n);break;case 13:fa(r,c,n),n&&d&4&&Oh(r,c);break;case 22:c.memoizedState===null&&fa(r,c,n),er(c,c.return);break;case 30:break;default:fa(r,c,n)}t=t.sibling}}function du(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&Ya(n))}function gu(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ya(e))}function ni(e,t,n,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)_h(e,t,n,s),t=t.sibling}function _h(e,t,n,s){var r=t.flags;switch(t.tag){case 0:case 11:case 15:ni(e,t,n,s),r&2048&&$l(9,t);break;case 1:ni(e,t,n,s);break;case 3:ni(e,t,n,s),r&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&Ya(e)));break;case 12:if(r&2048){ni(e,t,n,s),e=t.stateNode;try{var c=t.memoizedProps,d=c.id,g=c.onPostCommit;typeof g=="function"&&g(d,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(y){Pe(t,t.return,y)}}else ni(e,t,n,s);break;case 13:ni(e,t,n,s);break;case 23:break;case 22:c=t.stateNode,d=t.alternate,t.memoizedState!==null?c._visibility&2?ni(e,t,n,s):tr(e,t):c._visibility&2?ni(e,t,n,s):(c._visibility|=2,js(e,t,n,s,(t.subtreeFlags&10256)!==0)),r&2048&&du(d,t);break;case 24:ni(e,t,n,s),r&2048&&gu(t.alternate,t);break;default:ni(e,t,n,s)}}function js(e,t,n,s,r){for(r=r&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var c=e,d=t,g=n,y=s,_=d.flags;switch(d.tag){case 0:case 11:case 15:js(c,d,g,y,r),$l(8,d);break;case 23:break;case 22:var x=d.stateNode;d.memoizedState!==null?x._visibility&2?js(c,d,g,y,r):tr(c,d):(x._visibility|=2,js(c,d,g,y,r)),r&&_&2048&&du(d.alternate,d);break;case 24:js(c,d,g,y,r),r&&_&2048&&gu(d.alternate,d);break;default:js(c,d,g,y,r)}t=t.sibling}}function tr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,s=t,r=s.flags;switch(s.tag){case 22:tr(n,s),r&2048&&du(s.alternate,s);break;case 24:tr(n,s),r&2048&&gu(s.alternate,s);break;default:tr(n,s)}t=t.sibling}}var nr=8192;function Vs(e){if(e.subtreeFlags&nr)for(e=e.child;e!==null;)Ch(e),e=e.sibling}function Ch(e){switch(e.tag){case 26:Vs(e),e.flags&nr&&e.memoizedState!==null&&Pg(Ln,e.memoizedState,e.memoizedProps);break;case 5:Vs(e);break;case 3:case 4:var t=Ln;Ln=ac(e.stateNode.containerInfo),Vs(e),Ln=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=nr,nr=16777216,Vs(e),nr=t):Vs(e));break;default:Vs(e)}}function Eh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function ir(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];_t=s,wh(s,e)}Eh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)Mh(e),e=e.sibling}function Mh(e){switch(e.tag){case 0:case 11:case 15:ir(e),e.flags&2048&&ca(9,e,e.return);break;case 3:ir(e);break;case 12:ir(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Qo(e)):ir(e);break;default:ir(e)}}function Qo(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];_t=s,wh(s,e)}Eh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:ca(8,t,t.return),Qo(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Qo(t));break;default:Qo(t)}e=e.sibling}}function wh(e,t){for(;_t!==null;){var n=_t;switch(n.tag){case 0:case 11:case 15:ca(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:Ya(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,_t=s;else e:for(n=e;_t!==null;){s=_t;var r=s.sibling,c=s.return;if(Sh(s),s===n){_t=null;break e}if(r!==null){r.return=c,_t=r;break e}_t=c}}}var rg={getCacheForType:function(e){var t=vt(Qe),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},og=typeof WeakMap=="function"?WeakMap:Map,ze=0,Xe=null,Se=null,Ne=0,Ge=0,ln=null,ha=!1,Is=!1,mu=!1,Ni=0,rt=0,da=0,es=0,pu=0,pn=0,Ys=0,ar=null,$t=null,yu=!1,vu=0,Xo=1/0,Ko=null,ga=null,Nt=0,ma=null,Ps=null,Qs=0,bu=0,Su=null,Nh=null,sr=0,Au=null;function rn(){if((ze&2)!==0&&Ne!==0)return Ne&-Ne;if(U.T!==null){var e=ta;return e!==0?e:Mu()}return rl()}function Uh(){pn===0&&(pn=(Ne&536870912)===0||de?al():536870912);var e=mn.current;return e!==null&&(e.flags|=32),pn}function on(e,t,n){(e===Xe&&(Ge===2||Ge===9)||e.cancelPendingCommit!==null)&&(Xs(e,0),pa(e,Ne,pn,!1)),Li(e,n),((ze&2)===0||e!==Xe)&&(e===Xe&&((ze&2)===0&&(es|=n),rt===4&&pa(e,Ne,pn,!1)),ii(e))}function xh(e,t,n){if((ze&6)!==0)throw Error(T(327));var s=!n&&(t&124)===0&&(t&e.expiredLanes)===0||ki(e,t),r=s?fg(e,t):Tu(e,t,!0),c=s;do{if(r===0){Is&&!s&&pa(e,t,0,!1);break}else{if(n=e.current.alternate,c&&!cg(n)){r=Tu(e,t,!1),c=!1;continue}if(r===2){if(c=t,e.errorRecoveryDisabledLanes&c)var d=0;else d=e.pendingLanes&-536870913,d=d!==0?d:d&536870912?536870912:0;if(d!==0){t=d;e:{var g=e;r=ar;var y=g.current.memoizedState.isDehydrated;if(y&&(Xs(g,d).flags|=256),d=Tu(g,d,!1),d!==2){if(mu&&!y){g.errorRecoveryDisabledLanes|=c,es|=c,r=4;break e}c=$t,$t=r,c!==null&&($t===null?$t=c:$t.push.apply($t,c))}r=d}if(c=!1,r!==2)continue}}if(r===1){Xs(e,0),pa(e,t,0,!0);break}e:{switch(s=e,c=r,c){case 0:case 1:throw Error(T(345));case 4:if((t&4194048)!==t)break;case 6:pa(s,t,pn,!ha);break e;case 2:$t=null;break;case 3:case 5:break;default:throw Error(T(329))}if((t&62914560)===t&&(r=vu+300-Vt(),10<r)){if(pa(s,t,pn,!ha),Ea(s,0,!0)!==0)break e;s.timeoutHandle=rd(Dh.bind(null,s,n,$t,Ko,yu,t,pn,es,Ys,ha,c,2,-0,0),r);break e}Dh(s,n,$t,Ko,yu,t,pn,es,Ys,ha,c,0,-0,0)}}break}while(!0);ii(e)}function Dh(e,t,n,s,r,c,d,g,y,_,x,z,C,M){if(e.timeoutHandle=-1,z=t.subtreeFlags,(z&8192||(z&16785408)===16785408)&&(hr={stylesheets:null,count:0,unsuspend:Yg},Ch(t),z=Qg(),z!==null)){e.cancelPendingCommit=z(Hh.bind(null,e,t,c,n,s,r,d,g,y,x,1,C,M)),pa(e,c,d,!_);return}Hh(e,t,c,n,s,r,d,g,y)}function cg(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var r=n[s],c=r.getSnapshot;r=r.value;try{if(!Gt(c(),r))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function pa(e,t,n,s){t&=~pu,t&=~es,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var r=t;0<r;){var c=31-Je(r),d=1<<c;s[c]=-1,r&=~d}n!==0&&Nr(e,n,t)}function Zo(){return(ze&6)===0?(lr(0),!1):!0}function Ou(){if(Se!==null){if(Ge===0)var e=Se.return;else e=Se,Dn=dn=null,l(e),Gs=null,Jl=0,e=Se;for(;e!==null;)hh(e.alternate,e),e=e.return;Se=null}}function Xs(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,Eg(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Ou(),Xe=e,Se=n=_n(e.current,null),Ne=t,Ge=0,ln=null,ha=!1,Is=ki(e,t),mu=!1,Ys=pn=pu=es=da=rt=0,$t=ar=null,yu=!1,(t&8)!==0&&(t|=t&32);var s=e.entangledLanes;if(s!==0)for(e=e.entanglements,s&=t;0<s;){var r=31-Je(s),c=1<<r;t|=e[r],s&=~c}return Ni=t,Es(),n}function kh(e,t){ge=null,U.H=Bo,t===Pa||t===xs?(t=No(),Ge=3):t===Eo?(t=No(),Ge=4):Ge=t===Ff?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,ln=t,Se===null&&(rt=1,jo(e,Kt(t,e.current)))}function Lh(){var e=U.H;return U.H=Bo,e===null?Bo:e}function Bh(){var e=U.A;return U.A=rg,e}function Ru(){rt=4,ha||(Ne&4194048)!==Ne&&mn.current!==null||(Is=!0),(da&134217727)===0&&(es&134217727)===0||Xe===null||pa(Xe,Ne,pn,!1)}function Tu(e,t,n){var s=ze;ze|=2;var r=Lh(),c=Bh();(Xe!==e||Ne!==t)&&(Ko=null,Xs(e,t)),t=!1;var d=rt;e:do try{if(Ge!==0&&Se!==null){var g=Se,y=ln;switch(Ge){case 8:Ou(),d=6;break e;case 3:case 2:case 9:case 6:mn.current===null&&(t=!0);var _=Ge;if(Ge=0,ln=null,Ks(e,g,y,_),n&&Is){d=0;break e}break;default:_=Ge,Ge=0,ln=null,Ks(e,g,y,_)}}ug(),d=rt;break}catch(x){kh(e,x)}while(!0);return t&&e.shellSuspendCounter++,Dn=dn=null,ze=s,U.H=r,U.A=c,Se===null&&(Xe=null,Ne=0,Es()),d}function ug(){for(;Se!==null;)qh(Se)}function fg(e,t){var n=ze;ze|=2;var s=Lh(),r=Bh();Xe!==e||Ne!==t?(Ko=null,Xo=Vt()+500,Xs(e,t)):Is=ki(e,t);e:do try{if(Ge!==0&&Se!==null){t=Se;var c=ln;t:switch(Ge){case 1:Ge=0,ln=null,Ks(e,t,c,1);break;case 2:case 9:if(Mo(c)){Ge=0,ln=null,zh(t);break}t=function(){Ge!==2&&Ge!==9||Xe!==e||(Ge=7),ii(e)},c.then(t,t);break e;case 3:Ge=7;break e;case 4:Ge=5;break e;case 7:Mo(c)?(Ge=0,ln=null,zh(t)):(Ge=0,ln=null,Ks(e,t,c,7));break;case 5:var d=null;switch(Se.tag){case 26:d=Se.memoizedState;case 5:case 27:var g=Se;if(!d||bd(d)){Ge=0,ln=null;var y=g.sibling;if(y!==null)Se=y;else{var _=g.return;_!==null?(Se=_,Jo(_)):Se=null}break t}}Ge=0,ln=null,Ks(e,t,c,5);break;case 6:Ge=0,ln=null,Ks(e,t,c,6);break;case 8:Ou(),rt=6;break e;default:throw Error(T(462))}}hg();break}catch(x){kh(e,x)}while(!0);return Dn=dn=null,U.H=s,U.A=r,ze=n,Se!==null?0:(Xe=null,Ne=0,Es(),rt)}function hg(){for(;Se!==null&&!Rr();)qh(Se)}function qh(e){var t=uh(e.alternate,e,Ni);e.memoizedProps=e.pendingProps,t===null?Jo(e):Se=t}function zh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=ah(n,t,t.pendingProps,t.type,void 0,Ne);break;case 11:t=ah(n,t,t.pendingProps,t.type.render,t.ref,Ne);break;case 5:l(t);default:hh(n,t),t=Se=So(t,Ni),t=uh(n,t,Ni)}e.memoizedProps=e.pendingProps,t===null?Jo(e):Se=t}function Ks(e,t,n,s){Dn=dn=null,l(t),Gs=null,Jl=0;var r=t.return;try{if(tg(e,r,t,n,Ne)){rt=1,jo(e,Kt(n,e.current)),Se=null;return}}catch(c){if(r!==null)throw Se=r,c;rt=1,jo(e,Kt(n,e.current)),Se=null;return}t.flags&32768?(de||s===1?e=!0:Is||(Ne&536870912)!==0?e=!1:(ha=e=!0,(s===2||s===9||s===3||s===6)&&(s=mn.current,s!==null&&s.tag===13&&(s.flags|=16384))),Gh(t,e)):Jo(t)}function Jo(e){var t=e;do{if((t.flags&32768)!==0){Gh(t,ha);return}e=t.return;var n=ig(t.alternate,t,Ni);if(n!==null){Se=n;return}if(t=t.sibling,t!==null){Se=t;return}Se=t=e}while(t!==null);rt===0&&(rt=5)}function Gh(e,t){do{var n=ag(e.alternate,e);if(n!==null){n.flags&=32767,Se=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){Se=e;return}Se=e=n}while(e!==null);rt=6,Se=null}function Hh(e,t,n,s,r,c,d,g,y){e.cancelPendingCommit=null;do Wo();while(Nt!==0);if((ze&6)!==0)throw Error(T(327));if(t!==null){if(t===e.current)throw Error(T(177));if(c=t.lanes|t.childLanes,c|=wl,wr(e,n,c,d,g,y),e===Xe&&(Se=Xe=null,Ne=0),Ps=t,ma=e,Qs=n,bu=c,Su=r,Nh=s,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,pg(De,function(){return Ph(),null})):(e.callbackNode=null,e.callbackPriority=0),s=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||s){s=U.T,U.T=null,r=E.p,E.p=2,d=ze,ze|=4;try{sg(e,t,n)}finally{ze=d,E.p=r,U.T=s}}Nt=1,jh(),Vh(),Ih()}}function jh(){if(Nt===1){Nt=0;var e=ma,t=Ps,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=U.T,U.T=null;var s=E.p;E.p=2;var r=ze;ze|=4;try{Rh(t,e);var c=Bu,d=Lt(e.containerInfo),g=c.focusedElem,y=c.selectionRange;if(d!==g&&g&&g.ownerDocument&&Cl(g.ownerDocument.documentElement,g)){if(y!==null&&qa(g)){var _=y.start,x=y.end;if(x===void 0&&(x=_),"selectionStart"in g)g.selectionStart=_,g.selectionEnd=Math.min(x,g.value.length);else{var z=g.ownerDocument||document,C=z&&z.defaultView||window;if(C.getSelection){var M=C.getSelection(),ce=g.textContent.length,se=Math.min(y.start,ce),Ie=y.end===void 0?se:Math.min(y.end,ce);!M.extend&&se>Ie&&(d=Ie,Ie=se,se=d);var A=Ts(g,se),b=Ts(g,Ie);if(A&&b&&(M.rangeCount!==1||M.anchorNode!==A.node||M.anchorOffset!==A.offset||M.focusNode!==b.node||M.focusOffset!==b.offset)){var O=z.createRange();O.setStart(A.node,A.offset),M.removeAllRanges(),se>Ie?(M.addRange(O),M.extend(b.node,b.offset)):(O.setEnd(b.node,b.offset),M.addRange(O))}}}}for(z=[],M=g;M=M.parentNode;)M.nodeType===1&&z.push({element:M,left:M.scrollLeft,top:M.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<z.length;g++){var q=z[g];q.element.scrollLeft=q.left,q.element.scrollTop=q.top}}cc=!!Lu,Bu=Lu=null}finally{ze=r,E.p=s,U.T=n}}e.current=t,Nt=2}}function Vh(){if(Nt===2){Nt=0;var e=ma,t=Ps,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=U.T,U.T=null;var s=E.p;E.p=2;var r=ze;ze|=4;try{bh(e,t.alternate,t)}finally{ze=r,E.p=s,U.T=n}}Nt=3}}function Ih(){if(Nt===4||Nt===3){Nt=0,Tr();var e=ma,t=Ps,n=Qs,s=Nh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Nt=5:(Nt=0,Ps=ma=null,Yh(e,e.pendingLanes));var r=e.pendingLanes;if(r===0&&(ga=null),ll(n),t=t.stateNode,He&&typeof He.onCommitFiberRoot=="function")try{He.onCommitFiberRoot(xi,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=U.T,r=E.p,E.p=2,U.T=null;try{for(var c=e.onRecoverableError,d=0;d<s.length;d++){var g=s[d];c(g.value,{componentStack:g.stack})}}finally{U.T=t,E.p=r}}(Qs&3)!==0&&Wo(),ii(e),r=e.pendingLanes,(n&4194090)!==0&&(r&42)!==0?e===Au?sr++:(sr=0,Au=e):sr=0,lr(0)}}function Yh(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,Ya(t)))}function Wo(e){return jh(),Vh(),Ih(),Ph()}function Ph(){if(Nt!==5)return!1;var e=ma,t=bu;bu=0;var n=ll(Qs),s=U.T,r=E.p;try{E.p=32>n?32:n,U.T=null,n=Su,Su=null;var c=ma,d=Qs;if(Nt=0,Ps=ma=null,Qs=0,(ze&6)!==0)throw Error(T(331));var g=ze;if(ze|=4,Mh(c.current),_h(c,c.current,d,n),ze=g,lr(0,!1),He&&typeof He.onPostCommitFiberRoot=="function")try{He.onPostCommitFiberRoot(xi,c)}catch{}return!0}finally{E.p=r,U.T=s,Yh(e,t)}}function Qh(e,t,n){t=Kt(n,t),t=$c(e.stateNode,t,2),e=Jn(e,t,2),e!==null&&(Li(e,2),ii(e))}function Pe(e,t,n){if(e.tag===3)Qh(e,e,n);else for(;t!==null;){if(t.tag===3){Qh(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ga===null||!ga.has(s))){e=Kt(n,e),n=Jf(2),s=Jn(t,n,2),s!==null&&(Wf(n,s,t,e),Li(s,2),ii(s));break}}t=t.return}}function _u(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new og;var r=new Set;s.set(t,r)}else r=s.get(t),r===void 0&&(r=new Set,s.set(t,r));r.has(n)||(mu=!0,r.add(n),e=dg.bind(null,e,t,n),t.then(e,e))}function dg(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,Xe===e&&(Ne&n)===n&&(rt===4||rt===3&&(Ne&62914560)===Ne&&300>Vt()-vu?(ze&2)===0&&Xs(e,0):pu|=n,Ys===Ne&&(Ys=0)),ii(e)}function Xh(e,t){t===0&&(t=Ma()),e=Ki(e,t),e!==null&&(Li(e,t),ii(e))}function gg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Xh(e,n)}function mg(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(T(314))}s!==null&&s.delete(t),Xh(e,n)}function pg(e,t){return as(e,t)}var Fo=null,Zs=null,Cu=!1,$o=!1,Eu=!1,ts=0;function ii(e){e!==Zs&&e.next===null&&(Zs===null?Fo=Zs=e:Zs=Zs.next=e),$o=!0,Cu||(Cu=!0,vg())}function lr(e,t){if(!Eu&&$o){Eu=!0;do for(var n=!1,s=Fo;s!==null;){if(e!==0){var r=s.pendingLanes;if(r===0)var c=0;else{var d=s.suspendedLanes,g=s.pingedLanes;c=(1<<31-Je(42|e)+1)-1,c&=r&~(d&~g),c=c&201326741?c&201326741|1:c?c|2:0}c!==0&&(n=!0,Wh(s,c))}else c=Ne,c=Ea(s,s===Xe?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),(c&3)===0||ki(s,c)||(n=!0,Wh(s,c));s=s.next}while(n);Eu=!1}}function yg(){Kh()}function Kh(){$o=Cu=!1;var e=0;ts!==0&&(Cg()&&(e=ts),ts=0);for(var t=Vt(),n=null,s=Fo;s!==null;){var r=s.next,c=Zh(s,t);c===0?(s.next=null,n===null?Fo=r:n.next=r,r===null&&(Zs=n)):(n=s,(e!==0||(c&3)!==0)&&($o=!0)),s=r}lr(e)}function Zh(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,c=e.pendingLanes&-62914561;0<c;){var d=31-Je(c),g=1<<d,y=r[d];y===-1?((g&n)===0||(g&s)!==0)&&(r[d]=os(g,t)):y<=t&&(e.expiredLanes|=g),c&=~g}if(t=Xe,n=Ne,n=Ea(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s=e.callbackNode,n===0||e===t&&(Ge===2||Ge===9)||e.cancelPendingCommit!==null)return s!==null&&s!==null&&ss(s),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||ki(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(s!==null&&ss(s),ll(n)){case 2:case 8:n=ls;break;case 32:n=De;break;case 268435456:n=nl;break;default:n=De}return s=Jh.bind(null,e),n=as(n,s),e.callbackPriority=t,e.callbackNode=n,t}return s!==null&&s!==null&&ss(s),e.callbackPriority=2,e.callbackNode=null,2}function Jh(e,t){if(Nt!==0&&Nt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Wo()&&e.callbackNode!==n)return null;var s=Ne;return s=Ea(e,e===Xe?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s===0?null:(xh(e,s,t),Zh(e,Vt()),e.callbackNode!=null&&e.callbackNode===n?Jh.bind(null,e):null)}function Wh(e,t){if(Wo())return null;xh(e,t,!0)}function vg(){Mg(function(){(ze&6)!==0?as(_a,yg):Kh()})}function Mu(){return ts===0&&(ts=al()),ts}function Fh(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:ms(""+e)}function $h(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function bg(e,t,n,s,r){if(t==="submit"&&n&&n.stateNode===r){var c=Fh((r[Et]||null).action),d=s.submitter;d&&(t=(t=d[Et]||null)?Fh(t.formAction):d.getAttribute("formAction"),t!==null&&(c=t,d=null));var g=new Ss("action","action",null,s,r);e.push({event:g,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(ts!==0){var y=d?$h(r,d):new FormData(r);Kc(n,{pending:!0,data:y,method:r.method,action:c},null,y)}}else typeof c=="function"&&(g.preventDefault(),y=d?$h(r,d):new FormData(r),Kc(n,{pending:!0,data:y,method:r.method,action:c},c,y))},currentTarget:r}]})}}for(var wu=0;wu<Qi.length;wu++){var Nu=Qi[wu],Sg=Nu.toLowerCase(),Ag=Nu[0].toUpperCase()+Nu.slice(1);gt(Sg,"on"+Ag)}gt(Pn,"onAnimationEnd"),gt(Cs,"onAnimationIteration"),gt(go,"onAnimationStart"),gt("dblclick","onDoubleClick"),gt("focusin","onFocus"),gt("focusout","onBlur"),gt(mo,"onTransitionRun"),gt(po,"onTransitionStart"),gt(jc,"onTransitionCancel"),gt(yo,"onTransitionEnd"),zn("onMouseEnter",["mouseout","mouseover"]),zn("onMouseLeave",["mouseout","mouseover"]),zn("onPointerEnter",["pointerout","pointerover"]),zn("onPointerLeave",["pointerout","pointerover"]),li("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),li("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),li("onBeforeInput",["compositionend","keypress","textInput","paste"]),li("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),li("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),li("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var rr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Og=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(rr));function ed(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;e:{var c=void 0;if(t)for(var d=s.length-1;0<=d;d--){var g=s[d],y=g.instance,_=g.currentTarget;if(g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=_;try{c(r)}catch(x){Ho(x)}r.currentTarget=null,c=y}else for(d=0;d<s.length;d++){if(g=s[d],y=g.instance,_=g.currentTarget,g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=_;try{c(r)}catch(x){Ho(x)}r.currentTarget=null,c=y}}}}function Ae(e,t){var n=t[cs];n===void 0&&(n=t[cs]=new Set);var s=e+"__bubble";n.has(s)||(td(t,e,2,!1),n.add(s))}function Uu(e,t,n){var s=0;t&&(s|=4),td(n,e,s,t)}var ec="_reactListening"+Math.random().toString(36).slice(2);function xu(e){if(!e[ec]){e[ec]=!0,re.forEach(function(n){n!=="selectionchange"&&(Og.has(n)||Uu(n,!1,e),Uu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ec]||(t[ec]=!0,Uu("selectionchange",!1,t))}}function td(e,t,n,s){switch(_d(t)){case 2:var r=Zg;break;case 8:r=Jg;break;default:r=Qu}n=r.bind(null,t,n,e),r=void 0,!Vn||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),s?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function Du(e,t,n,s,r){var c=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var g=s.stateNode.containerInfo;if(g===r)break;if(d===4)for(d=s.return;d!==null;){var y=d.tag;if((y===3||y===4)&&d.stateNode.containerInfo===r)return;d=d.return}for(;g!==null;){if(d=An(g),d===null)return;if(y=d.tag,y===5||y===6||y===26||y===27){s=c=d;continue e}g=g.parentNode}}s=s.return}yl(function(){var _=c,x=Na(n),z=[];e:{var C=vo.get(e);if(C!==void 0){var M=Ss,ce=e;switch(e){case"keypress":if(xa(n)===0)break e;case"keydown":case"keyup":M=Uc;break;case"focusin":ce="focus",M=Sl;break;case"focusout":ce="blur",M=Sl;break;case"beforeblur":case"afterblur":M=Sl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":M=bl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":M=Os;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":M=Kr;break;case Pn:case Cs:case go:M=Ec;break;case yo:M=kc;break;case"scroll":case"scrollend":M=Rc;break;case"wheel":M=Zr;break;case"copy":case"cut":case"paste":M=jr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":M=Xr;break;case"toggle":case"beforetoggle":M=Al}var se=(t&4)!==0,Ie=!se&&(e==="scroll"||e==="scrollend"),A=se?C!==null?C+"Capture":null:C;se=[];for(var b=_,O;b!==null;){var q=b;if(O=q.stateNode,q=q.tag,q!==5&&q!==26&&q!==27||O===null||A===null||(q=jn(b,A),q!=null&&se.push(or(b,q,O))),Ie)break;b=b.return}0<se.length&&(C=new M(C,ce,null,n,x),z.push({event:C,listeners:se}))}}if((t&7)===0){e:{if(C=e==="mouseover"||e==="pointerover",M=e==="mouseout"||e==="pointerout",C&&n!==ps&&(ce=n.relatedTarget||n.fromElement)&&(An(ce)||ce[Bi]))break e;if((M||C)&&(C=x.window===x?x:(C=x.ownerDocument)?C.defaultView||C.parentWindow:window,M?(ce=n.relatedTarget||n.toElement,M=_,ce=ce?An(ce):null,ce!==null&&(Ie=ue(ce),se=ce.tag,ce!==Ie||se!==5&&se!==27&&se!==6)&&(ce=null)):(M=null,ce=_),M!==ce)){if(se=bl,q="onMouseLeave",A="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(se=Xr,q="onPointerLeave",A="onPointerEnter",b="pointer"),Ie=M==null?C:qn(M),O=ce==null?C:qn(ce),C=new se(q,b+"leave",M,n,x),C.target=Ie,C.relatedTarget=O,q=null,An(x)===_&&(se=new se(A,b+"enter",ce,n,x),se.target=O,se.relatedTarget=Ie,q=se),Ie=q,M&&ce)t:{for(se=M,A=ce,b=0,O=se;O;O=Js(O))b++;for(O=0,q=A;q;q=Js(q))O++;for(;0<b-O;)se=Js(se),b--;for(;0<O-b;)A=Js(A),O--;for(;b--;){if(se===A||A!==null&&se===A.alternate)break t;se=Js(se),A=Js(A)}se=null}else se=null;M!==null&&nd(z,C,M,se,!1),ce!==null&&Ie!==null&&nd(z,Ie,ce,se,!0)}}e:{if(C=_?qn(_):window,M=C.nodeName&&C.nodeName.toLowerCase(),M==="select"||M==="input"&&C.type==="file")var J=so;else if(io(C))if(lo)J=Hc;else{J=oo;var ve=ro}else M=C.nodeName,!M||M.toLowerCase()!=="input"||C.type!=="checkbox"&&C.type!=="radio"?_&&gs(_.elementType)&&(J=so):J=co;if(J&&(J=J(e,_))){Ol(z,J,n,x);break e}ve&&ve(e,C,_),e==="focusout"&&_&&C.type==="number"&&_.memoizedProps.value!=null&&ml(C,"number",C.value)}switch(ve=_?qn(_):window,e){case"focusin":(io(ve)||ve.contentEditable==="true")&&(Pi=ve,Ml=_,di=null);break;case"focusout":di=Ml=Pi=null;break;case"mousedown":_s=!0;break;case"contextmenu":case"mouseup":case"dragend":_s=!1,fo(z,n,x);break;case"selectionchange":if(El)break;case"keydown":case"keyup":fo(z,n,x)}var ee;if(ui)e:{switch(e){case"compositionstart":var le="onCompositionStart";break e;case"compositionend":le="onCompositionEnd";break e;case"compositionupdate":le="onCompositionUpdate";break e}le=void 0}else fi?eo(e,n)&&(le="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(le="onCompositionStart");le&&(Wr&&n.locale!=="ko"&&(fi||le!=="onCompositionStart"?le==="onCompositionEnd"&&fi&&(ee=ci()):(Rn=x,ys="value"in Rn?Rn.value:Rn.textContent,fi=!0)),ve=tc(_,le),0<ve.length&&(le=new Ir(le,e,null,n,x),z.push({event:le,listeners:ve}),ee?le.data=ee:(ee=to(n),ee!==null&&(le.data=ee)))),(ee=qc?zc(e,n):no(e,n))&&(le=tc(_,"onBeforeInput"),0<le.length&&(ve=new Ir("onBeforeInput","beforeinput",null,n,x),z.push({event:ve,listeners:le}),ve.data=ee)),bg(z,e,_,n,x)}ed(z,t)})}function or(e,t,n){return{instance:e,listener:t,currentTarget:n}}function tc(e,t){for(var n=t+"Capture",s=[];e!==null;){var r=e,c=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||c===null||(r=jn(e,n),r!=null&&s.unshift(or(e,r,c)),r=jn(e,t),r!=null&&s.push(or(e,r,c))),e.tag===3)return s;e=e.return}return[]}function Js(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function nd(e,t,n,s,r){for(var c=t._reactName,d=[];n!==null&&n!==s;){var g=n,y=g.alternate,_=g.stateNode;if(g=g.tag,y!==null&&y===s)break;g!==5&&g!==26&&g!==27||_===null||(y=_,r?(_=jn(n,c),_!=null&&d.unshift(or(n,_,y))):r||(_=jn(n,c),_!=null&&d.push(or(n,_,y)))),n=n.return}d.length!==0&&e.push({event:t,listeners:d})}var Rg=/\r\n?/g,Tg=/\u0000|\uFFFD/g;function id(e){return(typeof e=="string"?e:""+e).replace(Rg,`
`).replace(Tg,"")}function ad(e,t){return t=id(t),id(e)===t}function nc(){}function Ve(e,t,n,s,r,c){switch(n){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||F(e,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&F(e,""+s);break;case"className":zi(e,"class",s);break;case"tabIndex":zi(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":zi(e,n,s);break;case"style":zr(e,s,c);break;case"data":if(t!=="object"){zi(e,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=ms(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof c=="function"&&(n==="formAction"?(t!=="input"&&Ve(e,t,"name",r.name,r,null),Ve(e,t,"formEncType",r.formEncType,r,null),Ve(e,t,"formMethod",r.formMethod,r,null),Ve(e,t,"formTarget",r.formTarget,r,null)):(Ve(e,t,"encType",r.encType,r,null),Ve(e,t,"method",r.method,r,null),Ve(e,t,"target",r.target,r,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=ms(""+s),e.setAttribute(n,s);break;case"onClick":s!=null&&(e.onclick=nc);break;case"onScroll":s!=null&&Ae("scroll",e);break;case"onScrollEnd":s!=null&&Ae("scrollend",e);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(T(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(T(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":e.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){e.removeAttribute("xlink:href");break}n=ms(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":s===!0?e.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":Ae("beforetoggle",e),Ae("toggle",e),ri(e,"popover",s);break;case"xlinkActuate":On(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":On(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":On(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":On(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":On(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":On(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":On(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":On(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":On(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":ri(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Oc.get(n)||n,ri(e,n,s))}}function ku(e,t,n,s,r,c){switch(n){case"style":zr(e,s,c);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(T(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(T(60));e.innerHTML=n}}break;case"children":typeof s=="string"?F(e,s):(typeof s=="number"||typeof s=="bigint")&&F(e,""+s);break;case"onScroll":s!=null&&Ae("scroll",e);break;case"onScrollEnd":s!=null&&Ae("scrollend",e);break;case"onClick":s!=null&&(e.onclick=nc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Dr.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),c=e[Et]||null,c=c!=null?c[n]:null,typeof c=="function"&&e.removeEventListener(t,c,r),typeof s=="function")){typeof c!="function"&&c!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,r);break e}n in e?e[n]=s:s===!0?e.setAttribute(n,""):ri(e,n,s)}}}function Ut(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ae("error",e),Ae("load",e);var s=!1,r=!1,c;for(c in n)if(n.hasOwnProperty(c)){var d=n[c];if(d!=null)switch(c){case"src":s=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(T(137,t));default:Ve(e,t,c,d,n,null)}}r&&Ve(e,t,"srcSet",n.srcSet,n,null),s&&Ve(e,t,"src",n.src,n,null);return;case"input":Ae("invalid",e);var g=c=d=r=null,y=null,_=null;for(s in n)if(n.hasOwnProperty(s)){var x=n[s];if(x!=null)switch(s){case"name":r=x;break;case"type":d=x;break;case"checked":y=x;break;case"defaultChecked":_=x;break;case"value":c=x;break;case"defaultValue":g=x;break;case"children":case"dangerouslySetInnerHTML":if(x!=null)throw Error(T(137,t));break;default:Ve(e,t,s,x,n,null)}}ds(e,c,g,y,_,d,r,!1),hs(e);return;case"select":Ae("invalid",e),s=d=c=null;for(r in n)if(n.hasOwnProperty(r)&&(g=n[r],g!=null))switch(r){case"value":c=g;break;case"defaultValue":d=g;break;case"multiple":s=g;default:Ve(e,t,r,g,n,null)}t=c,n=d,e.multiple=!!s,t!=null?Gn(e,!!s,t,!1):n!=null&&Gn(e,!!s,n,!0);return;case"textarea":Ae("invalid",e),c=r=s=null;for(d in n)if(n.hasOwnProperty(d)&&(g=n[d],g!=null))switch(d){case"value":s=g;break;case"defaultValue":r=g;break;case"children":c=g;break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(T(91));break;default:Ve(e,t,d,g,n,null)}ot(e,s,r,c),hs(e);return;case"option":for(y in n)if(n.hasOwnProperty(y)&&(s=n[y],s!=null))switch(y){case"selected":e.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:Ve(e,t,y,s,n,null)}return;case"dialog":Ae("beforetoggle",e),Ae("toggle",e),Ae("cancel",e),Ae("close",e);break;case"iframe":case"object":Ae("load",e);break;case"video":case"audio":for(s=0;s<rr.length;s++)Ae(rr[s],e);break;case"image":Ae("error",e),Ae("load",e);break;case"details":Ae("toggle",e);break;case"embed":case"source":case"link":Ae("error",e),Ae("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(_ in n)if(n.hasOwnProperty(_)&&(s=n[_],s!=null))switch(_){case"children":case"dangerouslySetInnerHTML":throw Error(T(137,t));default:Ve(e,t,_,s,n,null)}return;default:if(gs(t)){for(x in n)n.hasOwnProperty(x)&&(s=n[x],s!==void 0&&ku(e,t,x,s,n,void 0));return}}for(g in n)n.hasOwnProperty(g)&&(s=n[g],s!=null&&Ve(e,t,g,s,n,null))}function _g(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,c=null,d=null,g=null,y=null,_=null,x=null;for(M in n){var z=n[M];if(n.hasOwnProperty(M)&&z!=null)switch(M){case"checked":break;case"value":break;case"defaultValue":y=z;default:s.hasOwnProperty(M)||Ve(e,t,M,null,s,z)}}for(var C in s){var M=s[C];if(z=n[C],s.hasOwnProperty(C)&&(M!=null||z!=null))switch(C){case"type":c=M;break;case"name":r=M;break;case"checked":_=M;break;case"defaultChecked":x=M;break;case"value":d=M;break;case"defaultValue":g=M;break;case"children":case"dangerouslySetInnerHTML":if(M!=null)throw Error(T(137,t));break;default:M!==z&&Ve(e,t,C,M,s,z)}}gl(e,d,g,y,_,x,c,r);return;case"select":M=d=g=C=null;for(c in n)if(y=n[c],n.hasOwnProperty(c)&&y!=null)switch(c){case"value":break;case"multiple":M=y;default:s.hasOwnProperty(c)||Ve(e,t,c,null,s,y)}for(r in s)if(c=s[r],y=n[r],s.hasOwnProperty(r)&&(c!=null||y!=null))switch(r){case"value":C=c;break;case"defaultValue":g=c;break;case"multiple":d=c;default:c!==y&&Ve(e,t,r,c,s,y)}t=g,n=d,s=M,C!=null?Gn(e,!!n,C,!1):!!s!=!!n&&(t!=null?Gn(e,!!n,t,!0):Gn(e,!!n,n?[]:"",!1));return;case"textarea":M=C=null;for(g in n)if(r=n[g],n.hasOwnProperty(g)&&r!=null&&!s.hasOwnProperty(g))switch(g){case"value":break;case"children":break;default:Ve(e,t,g,null,s,r)}for(d in s)if(r=s[d],c=n[d],s.hasOwnProperty(d)&&(r!=null||c!=null))switch(d){case"value":C=r;break;case"defaultValue":M=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(T(91));break;default:r!==c&&Ve(e,t,d,r,s,c)}Br(e,C,M);return;case"option":for(var ce in n)if(C=n[ce],n.hasOwnProperty(ce)&&C!=null&&!s.hasOwnProperty(ce))switch(ce){case"selected":e.selected=!1;break;default:Ve(e,t,ce,null,s,C)}for(y in s)if(C=s[y],M=n[y],s.hasOwnProperty(y)&&C!==M&&(C!=null||M!=null))switch(y){case"selected":e.selected=C&&typeof C!="function"&&typeof C!="symbol";break;default:Ve(e,t,y,C,s,M)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var se in n)C=n[se],n.hasOwnProperty(se)&&C!=null&&!s.hasOwnProperty(se)&&Ve(e,t,se,null,s,C);for(_ in s)if(C=s[_],M=n[_],s.hasOwnProperty(_)&&C!==M&&(C!=null||M!=null))switch(_){case"children":case"dangerouslySetInnerHTML":if(C!=null)throw Error(T(137,t));break;default:Ve(e,t,_,C,s,M)}return;default:if(gs(t)){for(var Ie in n)C=n[Ie],n.hasOwnProperty(Ie)&&C!==void 0&&!s.hasOwnProperty(Ie)&&ku(e,t,Ie,void 0,s,C);for(x in s)C=s[x],M=n[x],!s.hasOwnProperty(x)||C===M||C===void 0&&M===void 0||ku(e,t,x,C,s,M);return}}for(var A in n)C=n[A],n.hasOwnProperty(A)&&C!=null&&!s.hasOwnProperty(A)&&Ve(e,t,A,null,s,C);for(z in s)C=s[z],M=n[z],!s.hasOwnProperty(z)||C===M||C==null&&M==null||Ve(e,t,z,C,s,M)}var Lu=null,Bu=null;function ic(e){return e.nodeType===9?e:e.ownerDocument}function sd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function ld(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function qu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var zu=null;function Cg(){var e=window.event;return e&&e.type==="popstate"?e===zu?!1:(zu=e,!0):(zu=null,!1)}var rd=typeof setTimeout=="function"?setTimeout:void 0,Eg=typeof clearTimeout=="function"?clearTimeout:void 0,od=typeof Promise=="function"?Promise:void 0,Mg=typeof queueMicrotask=="function"?queueMicrotask:typeof od<"u"?function(e){return od.resolve(null).then(e).catch(wg)}:rd;function wg(e){setTimeout(function(){throw e})}function ya(e){return e==="head"}function cd(e,t){var n=t,s=0,r=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"){if(0<s&&8>s){n=s;var d=e.ownerDocument;if(n&1&&cr(d.documentElement),n&2&&cr(d.body),n&4)for(n=d.head,cr(n),d=n.firstChild;d;){var g=d.nextSibling,y=d.nodeName;d[wa]||y==="SCRIPT"||y==="STYLE"||y==="LINK"&&d.rel.toLowerCase()==="stylesheet"||n.removeChild(d),d=g}}if(r===0){e.removeChild(c),yr(t);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:s=n.charCodeAt(0)-48;else s=0;n=c}while(n);yr(t)}function Gu(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":Gu(n),cl(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Ng(e,t,n,s){for(;e.nodeType===1;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(s){if(!e[wa])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(c=e.getAttribute("rel"),c==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(c!==r.rel||e.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||e.getAttribute("title")!==(r.title==null?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(c=e.getAttribute("src"),(c!==(r.src==null?null:r.src)||e.getAttribute("type")!==(r.type==null?null:r.type)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&c&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var c=r.name==null?null:""+r.name;if(r.type==="hidden"&&e.getAttribute("name")===c)return e}else return e;if(e=Bn(e.nextSibling),e===null)break}return null}function Ug(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Bn(e.nextSibling),e===null))return null;return e}function Hu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function xg(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var s=function(){t(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}function Bn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var ju=null;function ud(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function fd(e,t,n){switch(t=ic(n),e){case"html":if(e=t.documentElement,!e)throw Error(T(452));return e;case"head":if(e=t.head,!e)throw Error(T(453));return e;case"body":if(e=t.body,!e)throw Error(T(454));return e;default:throw Error(T(451))}}function cr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);cl(e)}var yn=new Map,hd=new Set;function ac(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Ui=E.d;E.d={f:Dg,r:kg,D:Lg,C:Bg,L:qg,m:zg,X:Hg,S:Gg,M:jg};function Dg(){var e=Ui.f(),t=Zo();return e||t}function kg(e){var t=si(e);t!==null&&t.tag===5&&t.type==="form"?xf(t):Ui.r(e)}var Ws=typeof document>"u"?null:document;function dd(e,t,n){var s=Ws;if(s&&typeof t=="string"&&t){var r=Pt(t);r='link[rel="'+e+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),hd.has(r)||(hd.add(r),e={rel:e,crossOrigin:n,href:t},s.querySelector(r)===null&&(t=s.createElement("link"),Ut(t,"link",e),dt(t),s.head.appendChild(t)))}}function Lg(e){Ui.D(e),dd("dns-prefetch",e,null)}function Bg(e,t){Ui.C(e,t),dd("preconnect",e,t)}function qg(e,t,n){Ui.L(e,t,n);var s=Ws;if(s&&e&&t){var r='link[rel="preload"][as="'+Pt(t)+'"]';t==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+Pt(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+Pt(n.imageSizes)+'"]')):r+='[href="'+Pt(e)+'"]';var c=r;switch(t){case"style":c=Fs(e);break;case"script":c=$s(e)}yn.has(c)||(e=W({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),yn.set(c,e),s.querySelector(r)!==null||t==="style"&&s.querySelector(ur(c))||t==="script"&&s.querySelector(fr(c))||(t=s.createElement("link"),Ut(t,"link",e),dt(t),s.head.appendChild(t)))}}function zg(e,t){Ui.m(e,t);var n=Ws;if(n&&e){var s=t&&typeof t.as=="string"?t.as:"script",r='link[rel="modulepreload"][as="'+Pt(s)+'"][href="'+Pt(e)+'"]',c=r;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":c=$s(e)}if(!yn.has(c)&&(e=W({rel:"modulepreload",href:e},t),yn.set(c,e),n.querySelector(r)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(fr(c)))return}s=n.createElement("link"),Ut(s,"link",e),dt(s),n.head.appendChild(s)}}}function Gg(e,t,n){Ui.S(e,t,n);var s=Ws;if(s&&e){var r=qi(s).hoistableStyles,c=Fs(e);t=t||"default";var d=r.get(c);if(!d){var g={loading:0,preload:null};if(d=s.querySelector(ur(c)))g.loading=5;else{e=W({rel:"stylesheet",href:e,"data-precedence":t},n),(n=yn.get(c))&&Vu(e,n);var y=d=s.createElement("link");dt(y),Ut(y,"link",e),y._p=new Promise(function(_,x){y.onload=_,y.onerror=x}),y.addEventListener("load",function(){g.loading|=1}),y.addEventListener("error",function(){g.loading|=2}),g.loading|=4,sc(d,t,s)}d={type:"stylesheet",instance:d,count:1,state:g},r.set(c,d)}}}function Hg(e,t){Ui.X(e,t);var n=Ws;if(n&&e){var s=qi(n).hoistableScripts,r=$s(e),c=s.get(r);c||(c=n.querySelector(fr(r)),c||(e=W({src:e,async:!0},t),(t=yn.get(r))&&Iu(e,t),c=n.createElement("script"),dt(c),Ut(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function jg(e,t){Ui.M(e,t);var n=Ws;if(n&&e){var s=qi(n).hoistableScripts,r=$s(e),c=s.get(r);c||(c=n.querySelector(fr(r)),c||(e=W({src:e,async:!0,type:"module"},t),(t=yn.get(r))&&Iu(e,t),c=n.createElement("script"),dt(c),Ut(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function gd(e,t,n,s){var r=(r=he.current)?ac(r):null;if(!r)throw Error(T(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=Fs(n.href),n=qi(r).hoistableStyles,s=n.get(t),s||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=Fs(n.href);var c=qi(r).hoistableStyles,d=c.get(e);if(d||(r=r.ownerDocument||r,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,d),(c=r.querySelector(ur(e)))&&!c._p&&(d.instance=c,d.state.loading=5),yn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},yn.set(e,n),c||Vg(r,e,n,d.state))),t&&s===null)throw Error(T(528,""));return d}if(t&&s!==null)throw Error(T(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=$s(n),n=qi(r).hoistableScripts,s=n.get(t),s||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(T(444,e))}}function Fs(e){return'href="'+Pt(e)+'"'}function ur(e){return'link[rel="stylesheet"]['+e+"]"}function md(e){return W({},e,{"data-precedence":e.precedence,precedence:null})}function Vg(e,t,n,s){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=e.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),Ut(t,"link",n),dt(t),e.head.appendChild(t))}function $s(e){return'[src="'+Pt(e)+'"]'}function fr(e){return"script[async]"+e}function pd(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+Pt(n.href)+'"]');if(s)return t.instance=s,dt(s),s;var r=W({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(e.ownerDocument||e).createElement("style"),dt(s),Ut(s,"style",r),sc(s,n.precedence,e),t.instance=s;case"stylesheet":r=Fs(n.href);var c=e.querySelector(ur(r));if(c)return t.state.loading|=4,t.instance=c,dt(c),c;s=md(n),(r=yn.get(r))&&Vu(s,r),c=(e.ownerDocument||e).createElement("link"),dt(c);var d=c;return d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),Ut(c,"link",s),t.state.loading|=4,sc(c,n.precedence,e),t.instance=c;case"script":return c=$s(n.src),(r=e.querySelector(fr(c)))?(t.instance=r,dt(r),r):(s=n,(r=yn.get(c))&&(s=W({},n),Iu(s,r)),e=e.ownerDocument||e,r=e.createElement("script"),dt(r),Ut(r,"link",s),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(T(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(s=t.instance,t.state.loading|=4,sc(s,n.precedence,e));return t.instance}function sc(e,t,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=s.length?s[s.length-1]:null,c=r,d=0;d<s.length;d++){var g=s[d];if(g.dataset.precedence===t)c=g;else if(c!==r)break}c?c.parentNode.insertBefore(e,c.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Vu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Iu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var lc=null;function yd(e,t,n){if(lc===null){var s=new Map,r=lc=new Map;r.set(n,s)}else r=lc,s=r.get(n),s||(s=new Map,r.set(n,s));if(s.has(e))return s;for(s.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var c=n[r];if(!(c[wa]||c[yt]||e==="link"&&c.getAttribute("rel")==="stylesheet")&&c.namespaceURI!=="http://www.w3.org/2000/svg"){var d=c.getAttribute(t)||"";d=e+d;var g=s.get(d);g?g.push(c):s.set(d,[c])}}return s}function vd(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Ig(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function bd(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var hr=null;function Yg(){}function Pg(e,t,n){if(hr===null)throw Error(T(475));var s=hr;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var r=Fs(n.href),c=e.querySelector(ur(r));if(c){e=c._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(s.count++,s=rc.bind(s),e.then(s,s)),t.state.loading|=4,t.instance=c,dt(c);return}c=e.ownerDocument||e,n=md(n),(r=yn.get(r))&&Vu(n,r),c=c.createElement("link"),dt(c);var d=c;d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),Ut(c,"link",n),t.instance=c}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(s.count++,t=rc.bind(s),e.addEventListener("load",t),e.addEventListener("error",t))}}function Qg(){if(hr===null)throw Error(T(475));var e=hr;return e.stylesheets&&e.count===0&&Yu(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Yu(e,e.stylesheets),e.unsuspend){var s=e.unsuspend;e.unsuspend=null,s()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function rc(){if(this.count--,this.count===0){if(this.stylesheets)Yu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var oc=null;function Yu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,oc=new Map,t.forEach(Xg,e),oc=null,rc.call(e))}function Xg(e,t){if(!(t.state.loading&4)){var n=oc.get(e);if(n)var s=n.get(null);else{n=new Map,oc.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),c=0;c<r.length;c++){var d=r[c];(d.nodeName==="LINK"||d.getAttribute("media")!=="not all")&&(n.set(d.dataset.precedence,d),s=d)}s&&n.set(null,s)}r=t.instance,d=r.getAttribute("data-precedence"),c=n.get(d)||s,c===s&&n.set(null,r),n.set(d,r),this.count++,s=rc.bind(this),r.addEventListener("load",s),r.addEventListener("error",s),c?c.parentNode.insertBefore(r,c.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(r,e.firstChild)),t.state.loading|=4}}var dr={$$typeof:Me,Provider:null,Consumer:null,_currentValue:j,_currentValue2:j,_threadCount:0};function Kg(e,t,n,s,r,c,d,g){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ht(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ht(0),this.hiddenUpdates=ht(null),this.identifierPrefix=s,this.onUncaughtError=r,this.onCaughtError=c,this.onRecoverableError=d,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=g,this.incompleteTransitions=new Map}function Sd(e,t,n,s,r,c,d,g,y,_,x,z){return e=new Kg(e,t,n,d,g,y,_,z),t=1,c===!0&&(t|=24),c=Ht(3,null,null,t),e.current=c,c.stateNode=e,t=Xn(),t.refCount++,e.pooledCache=t,t.refCount++,c.memoizedState={element:s,isDehydrated:n,cache:t},Ds(c),e}function Ad(e){return e?(e=yi,e):yi}function Od(e,t,n,s,r,c){r=Ad(r),s.context===null?s.context=r:s.pendingContext=r,s=Zn(t),s.payload={element:n},c=c===void 0?null:c,c!==null&&(s.callback=c),n=Jn(e,s,t),n!==null&&(on(n,e,t),Ka(n,e,t))}function Rd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Pu(e,t){Rd(e,t),(e=e.alternate)&&Rd(e,t)}function Td(e){if(e.tag===13){var t=Ki(e,67108864);t!==null&&on(t,e,67108864),Pu(e,67108864)}}var cc=!0;function Zg(e,t,n,s){var r=U.T;U.T=null;var c=E.p;try{E.p=2,Qu(e,t,n,s)}finally{E.p=c,U.T=r}}function Jg(e,t,n,s){var r=U.T;U.T=null;var c=E.p;try{E.p=8,Qu(e,t,n,s)}finally{E.p=c,U.T=r}}function Qu(e,t,n,s){if(cc){var r=Xu(s);if(r===null)Du(e,t,s,uc,n),Cd(e,s);else if(Fg(r,e,t,n,s))s.stopPropagation();else if(Cd(e,s),t&4&&-1<Wg.indexOf(e)){for(;r!==null;){var c=si(r);if(c!==null)switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var d=bn(c.pendingLanes);if(d!==0){var g=c;for(g.pendingLanes|=2,g.entangledLanes|=2;d;){var y=1<<31-Je(d);g.entanglements[1]|=y,d&=~y}ii(c),(ze&6)===0&&(Xo=Vt()+500,lr(0))}}break;case 13:g=Ki(c,2),g!==null&&on(g,c,2),Zo(),Pu(c,2)}if(c=Xu(s),c===null&&Du(e,t,s,uc,n),c===r)break;r=c}r!==null&&s.stopPropagation()}else Du(e,t,s,null,n)}}function Xu(e){return e=Na(e),Ku(e)}var uc=null;function Ku(e){if(uc=null,e=An(e),e!==null){var t=ue(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=Re(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return uc=e,null}function _d(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ta()){case _a:return 2;case ls:return 8;case De:case _r:return 32;case nl:return 268435456;default:return 32}default:return 32}}var Zu=!1,va=null,ba=null,Sa=null,gr=new Map,mr=new Map,Aa=[],Wg="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Cd(e,t){switch(e){case"focusin":case"focusout":va=null;break;case"dragenter":case"dragleave":ba=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":gr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mr.delete(t.pointerId)}}function pr(e,t,n,s,r,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:c,targetContainers:[r]},t!==null&&(t=si(t),t!==null&&Td(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function Fg(e,t,n,s,r){switch(t){case"focusin":return va=pr(va,e,t,n,s,r),!0;case"dragenter":return ba=pr(ba,e,t,n,s,r),!0;case"mouseover":return Sa=pr(Sa,e,t,n,s,r),!0;case"pointerover":var c=r.pointerId;return gr.set(c,pr(gr.get(c)||null,e,t,n,s,r)),!0;case"gotpointercapture":return c=r.pointerId,mr.set(c,pr(mr.get(c)||null,e,t,n,s,r)),!0}return!1}function Ed(e){var t=An(e.target);if(t!==null){var n=ue(t);if(n!==null){if(t=n.tag,t===13){if(t=Re(n),t!==null){e.blockedOn=t,Ur(e.priority,function(){if(n.tag===13){var s=rn();s=sl(s);var r=Ki(n,s);r!==null&&on(r,n,s),Pu(n,s)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function fc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Xu(e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);ps=s,n.target.dispatchEvent(s),ps=null}else return t=si(n),t!==null&&Td(t),e.blockedOn=n,!1;t.shift()}return!0}function Md(e,t,n){fc(e)&&n.delete(t)}function $g(){Zu=!1,va!==null&&fc(va)&&(va=null),ba!==null&&fc(ba)&&(ba=null),Sa!==null&&fc(Sa)&&(Sa=null),gr.forEach(Md),mr.forEach(Md)}function hc(e,t){e.blockedOn===t&&(e.blockedOn=null,Zu||(Zu=!0,H.unstable_scheduleCallback(H.unstable_NormalPriority,$g)))}var dc=null;function wd(e){dc!==e&&(dc=e,H.unstable_scheduleCallback(H.unstable_NormalPriority,function(){dc===e&&(dc=null);for(var t=0;t<e.length;t+=3){var n=e[t],s=e[t+1],r=e[t+2];if(typeof s!="function"){if(Ku(s||n)===null)continue;break}var c=si(n);c!==null&&(e.splice(t,3),t-=3,Kc(c,{pending:!0,data:r,method:n.method,action:s},s,r))}}))}function yr(e){function t(y){return hc(y,e)}va!==null&&hc(va,e),ba!==null&&hc(ba,e),Sa!==null&&hc(Sa,e),gr.forEach(t),mr.forEach(t);for(var n=0;n<Aa.length;n++){var s=Aa[n];s.blockedOn===e&&(s.blockedOn=null)}for(;0<Aa.length&&(n=Aa[0],n.blockedOn===null);)Ed(n),n.blockedOn===null&&Aa.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var r=n[s],c=n[s+1],d=r[Et]||null;if(typeof c=="function")d||wd(n);else if(d){var g=null;if(c&&c.hasAttribute("formAction")){if(r=c,d=c[Et]||null)g=d.formAction;else if(Ku(r)!==null)continue}else g=d.action;typeof g=="function"?n[s+1]=g:(n.splice(s,3),s-=3),wd(n)}}}function Ju(e){this._internalRoot=e}gc.prototype.render=Ju.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(T(409));var n=t.current,s=rn();Od(n,s,e,t,null,null)},gc.prototype.unmount=Ju.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Od(e.current,2,null,e,null,null),Zo(),t[Bi]=null}};function gc(e){this._internalRoot=e}gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=rl();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Aa.length&&t!==0&&t<Aa[n].priority;n++);Aa.splice(n,0,e),n===0&&Ed(e)}};var Nd=ie.version;if(Nd!=="19.1.0")throw Error(T(527,Nd,"19.1.0"));E.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(T(188)):(e=Object.keys(e).join(","),Error(T(268,e)));return e=Z(t),e=e!==null?D(e):null,e=e===null?null:e.stateNode,e};var em={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mc.isDisabled&&mc.supportsFiber)try{xi=mc.inject(em),He=mc}catch{}}return br.createRoot=function(e,t){if(!te(e))throw Error(T(299));var n=!1,s="",r=Qf,c=Xf,d=Kf,g=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(c=t.onCaughtError),t.onRecoverableError!==void 0&&(d=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(g=t.unstable_transitionCallbacks)),t=Sd(e,1,!1,null,null,n,s,r,c,d,g,null),e[Bi]=t.current,xu(e),new Ju(t)},br.hydrateRoot=function(e,t,n){if(!te(e))throw Error(T(299));var s=!1,r="",c=Qf,d=Xf,g=Kf,y=null,_=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(c=n.onUncaughtError),n.onCaughtError!==void 0&&(d=n.onCaughtError),n.onRecoverableError!==void 0&&(g=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(y=n.unstable_transitionCallbacks),n.formState!==void 0&&(_=n.formState)),t=Sd(e,1,!0,t,n??null,s,r,c,d,g,y,_),t.context=Ad(null),n=t.current,s=rn(),s=sl(s),r=Zn(s),r.callback=null,Jn(n,r,s),n=s,t.current.lanes=n,Li(t,n),ii(t),e[Bi]=t.current,xu(e),new gc(t)},br.version="19.1.0",br}var Hd;function fm(){if(Hd)return $u.exports;Hd=1;function H(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(H)}catch(ie){console.error(ie)}}return H(),$u.exports=um(),$u.exports}var hm=fm();const dm=Vd(hm);var pc={exports:{}};/*@license Copyright 2015-2022 Ably Real-time Ltd (ably.com)

Ably JavaScript Library v2.10.1
https://github.com/ably/ably-js

Released under the Apache Licence v2.0*/var gm=pc.exports,jd;function mm(){return jd||(jd=1,function(H,ie){(function($,T){H.exports=T()})(gm,()=>{var $={},T={exports:$},te=Object.defineProperty,ue=Object.defineProperties,Re=Object.getOwnPropertyDescriptor,Oe=Object.getOwnPropertyDescriptors,Z=Object.getOwnPropertyNames,D=Object.getOwnPropertySymbols,W=Object.prototype.hasOwnProperty,Te=Object.prototype.propertyIsEnumerable,ye=(i,a,l)=>a in i?te(i,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[a]=l,fe=(i,a)=>{for(var l in a||(a={}))W.call(a,l)&&ye(i,l,a[l]);if(D)for(var l of D(a))Te.call(a,l)&&ye(i,l,a[l]);return i},Ue=(i,a)=>ue(i,Oe(a)),At=(i,a)=>{var l={};for(var o in i)W.call(i,o)&&a.indexOf(o)<0&&(l[o]=i[o]);if(i!=null&&D)for(var o of D(i))a.indexOf(o)<0&&Te.call(i,o)&&(l[o]=i[o]);return l},Ke=(i,a)=>{for(var l in a)te(i,l,{get:a[l],enumerable:!0})},Ee=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of Z(a))!W.call(i,u)&&u!==l&&te(i,u,{get:()=>a[u],enumerable:!(o=Re(a,u))||o.enumerable});return i},ut=i=>Ee(te({},"__esModule",{value:!0}),i),Me={};Ke(Me,{ErrorInfo:()=>w,Realtime:()=>wn,Rest:()=>Cs,default:()=>xo,makeProtocolMessageFromDeserialized:()=>Cl,msgpack:()=>Ri}),T.exports=ut(Me);var N=class{},pe=typeof Ra<"u"?Ra:typeof window<"u"?window:self;function tt(i,a){return`${i}`.padStart(a?3:2,"0")}function ft(i){return N.Config.logTimestamps?function(a){const l=new Date;i(tt(l.getHours())+":"+tt(l.getMinutes())+":"+tt(l.getSeconds())+"."+tt(l.getMilliseconds(),1)+" "+a)}:function(a){i(a)}}var nt=()=>{var i;let a,l;return typeof((i=pe?.console)==null?void 0:i.log)=="function"?(a=function(...o){console.log.apply(console,o)},l=console.warn?function(...o){console.warn.apply(console,o)}:a):a=l=function(){},[a,l].map(ft)},xe=class Sr{constructor(){this.deprecated=(a,l)=>{this.deprecationWarning(`${a} is deprecated and will be removed in a future version. ${l}`)},this.shouldLog=a=>a<=this.logLevel,this.setLog=(a,l)=>{a!==void 0&&(this.logLevel=a),l!==void 0&&(this.logHandler=this.logErrorHandler=l)},this.logLevel=Sr.defaultLogLevel,this.logHandler=Sr.defaultLogHandler,this.logErrorHandler=Sr.defaultLogErrorHandler}static initLogHandlers(){const[a,l]=nt();this.defaultLogHandler=a,this.defaultLogErrorHandler=l,this.defaultLogger=new Sr}static logActionNoStrip(a,l,o,u){a.logAction(l,o,u)}logAction(a,l,o){this.shouldLog(a)&&(a===1?this.logErrorHandler:this.logHandler)("Ably: "+l+": "+o,a)}renamedClientOption(a,l){this.deprecationWarning(`The \`${a}\` client option has been renamed to \`${l}\`. Please update your code to use \`${l}\` instead. \`${a}\` will be removed in a future version.`)}renamedMethod(a,l,o){this.deprecationWarning(`\`${a}\`s \`${l}\` method has been renamed to \`${o}\`. Please update your code to use \`${o}\` instead. \`${l}\` will be removed in a future version.`)}deprecationWarning(a){this.shouldLog(1)&&this.logErrorHandler(`Ably: Deprecation warning - ${a}`,1)}};xe.defaultLogLevel=1,xe.LOG_NONE=0,xe.LOG_ERROR=1,xe.LOG_MAJOR=2,xe.LOG_MINOR=3,xe.LOG_MICRO=4,xe.logAction=(i,a,l,o)=>{xe.logActionNoStrip(i,a,l,o)};var tn=xe,h=tn,Ze={};Ke(Ze,{Format:()=>Tr,allSame:()=>Rr,allToLowerCase:()=>il,allToUpperCase:()=>Er,arrChooseN:()=>xi,arrDeleteValue:()=>ns,arrEquals:()=>al,arrIntersect:()=>Ye,arrIntersectOb:()=>vn,arrPopRandomElement:()=>Vt,arrWithoutValue:()=>is,cheapRandStr:()=>rs,containsValue:()=>he,copy:()=>j,createMissingPluginError:()=>Ma,dataSizeBytes:()=>nl,decodeBody:()=>st,encodeBody:()=>Je,ensureArray:()=>K,forInOwnNonNullProperties:()=>ss,getBackoffCoefficient:()=>Mr,getGlobalObject:()=>bn,getJitterCoefficient:()=>Ca,getRetryTime:()=>Di,inherits:()=>we,inspectBody:()=>_r,inspectError:()=>De,intersect:()=>Dt,isEmpty:()=>G,isErrorInfoOrPartialErrorInfo:()=>ls,isNil:()=>V,isObject:()=>v,keysArray:()=>ai,matchDerivedChannel:()=>ki,mixin:()=>E,parseQueryString:()=>_a,prototypicalClone:()=>ne,randomString:()=>Cr,shallowClone:()=>P,shallowEquals:()=>Ea,throwMissingPluginError:()=>ht,toBase64:()=>os,toQueryString:()=>Ta,valuesArray:()=>as,whenPromiseSettles:()=>He,withTimeoutAsync:()=>Li});function cn(i){let a="["+i.constructor.name;return i.message&&(a+=": "+i.message),i.statusCode&&(a+="; statusCode="+i.statusCode),i.code&&(a+="; code="+i.code),i.cause&&(a+="; cause="+De(i.cause)),i.href&&!(i.message&&i.message.indexOf("help.ably.io")>-1)&&(a+="; see "+i.href+" "),a+="]",a}var w=class af extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,af.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return cn(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||typeof o!="number"||typeof u!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+N.Config.inspect(a));const f=Object.assign(new af(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}},_e=class sf extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,sf.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return cn(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||!V(o)&&typeof o!="number"||!V(u)&&typeof u!="number")throw new Error("PartialErrorInfo.fromValues(): invalid values: "+N.Config.inspect(a));const f=Object.assign(new sf(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}};function U(i){return Math.floor(Math.random()*i.length)}function E(i,...a){for(let l=0;l<a.length;l++){const o=a[l];if(!o)break;for(const u in o)Object.prototype.hasOwnProperty.call(o,u)&&(i[u]=o[u])}return i}function j(i){return E({},i)}function K(i){return V(i)?[]:Array.isArray(i)?i:[i]}function v(i){return Object.prototype.toString.call(i)=="[object Object]"}function G(i){for(const a in i)return!1;return!0}function V(i){return i==null}function P(i){const a=new Object;for(const l in i)a[l]=i[l];return a}function ne(i,a){class l{}l.prototype=i;const o=new l;return a&&E(o,a),o}var we=function(i,a){if(N.Config.inherits){N.Config.inherits(i,a);return}i.super_=a,i.prototype=ne(a.prototype,{constructor:i})};function he(i,a){for(const l in i)if(i[l]==a)return!0;return!1}function Dt(i,a){return Array.isArray(a)?Ye(i,a):vn(i,a)}function Ye(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];a.indexOf(u)!=-1&&l.push(u)}return l}function vn(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];u in a&&l.push(u)}return l}function ns(i,a){const l=i.indexOf(a),o=l!=-1;return o&&i.splice(l,1),o}function is(i,a){const l=i.slice();return ns(l,a),l}function ai(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(o);return l}function as(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(i[o]);return l}function ss(i,a){for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&a(l)}function Rr(i,a){if(i.length===0)return!0;const l=i[0][a];return i.every(function(o){return o[a]===l})}var Tr=(i=>(i.msgpack="msgpack",i.json="json",i))(Tr||{});function Vt(i){return i.splice(U(i),1)[0]}function Ta(i){const a=[];if(i)for(const l in i)a.push(encodeURIComponent(l)+"="+encodeURIComponent(i[l]));return a.length?"?"+a.join("&"):""}function _a(i){let a;const l=/([^?&=]+)=?([^&]*)/g,o={};for(;a=l.exec(i);)o[decodeURIComponent(a[1])]=decodeURIComponent(a[2]);return o}function ls(i){return typeof i=="object"&&i!==null&&(i instanceof w||i instanceof _e)}function De(i){var a,l;return i instanceof Error||((a=i?.constructor)==null?void 0:a.name)==="ErrorInfo"||((l=i?.constructor)==null?void 0:l.name)==="PartialErrorInfo"?i.toString():N.Config.inspect(i)}function _r(i){return N.BufferUtils.isBuffer(i)?i.toString():typeof i=="string"?i:N.Config.inspect(i)}function nl(i){if(N.BufferUtils.isBuffer(i))return N.BufferUtils.byteLength(i);if(typeof i=="string")return N.Config.stringByteSize(i);if(typeof i=="number")return 8;if(typeof i=="boolean")return 1;throw new Error(`Expected input of Utils.dataSizeBytes to be a string, a number, a boolean or a buffer, but was: ${typeof i}`)}function rs(){return String(Math.random()).substr(2)}var Cr=async i=>{const a=await N.Config.getRandomArrayBuffer(i);return N.BufferUtils.base64Encode(a)};function xi(i,a){const l=Math.min(a,i.length),o=i.slice(),u=[];for(let f=0;f<l;f++)u.push(Vt(o));return u}function He(i,a){i.then(l=>{a?.(null,l)}).catch(l=>{a?.(l)})}function st(i,a,l){return l=="msgpack"?(a||ht("MsgPack"),a.decode(i)):JSON.parse(String(i))}function Je(i,a,l){return l=="msgpack"?(a||ht("MsgPack"),a.encode(i,!0)):JSON.stringify(i)}function il(i){return i.map(function(a){return a&&a.toLowerCase()})}function Er(i){return i.map(function(a){return a&&a.toUpperCase()})}function Mr(i){return Math.min((i+2)/3,2)}function Ca(){return 1-Math.random()*.2}function Di(i,a){return i*Mr(a)*Ca()}function bn(){return typeof Ra<"u"?Ra:typeof window<"u"?window:self}function Ea(i,a){return Object.keys(i).every(l=>i[l]===a[l])&&Object.keys(a).every(l=>a[l]===i[l])}function ki(i){const a=/^(\[([^?]*)(?:(.*))\])?(.+)$/,l=i.match(a);if(!l||!l.length||l.length<5)throw new w("regex match failed",400,40010);if(l[2])throw new w(`cannot use a derived option with a ${l[2]} channel`,400,40010);return{qualifierParam:l[3]||"",channelName:l[4]}}function os(i){const a=N.BufferUtils,l=a.utf8Encode(i);return a.base64Encode(l)}function al(i,a){return i.length===a.length&&i.every(function(l,o){return l===a[o]})}function Ma(i){return new w(`${i} plugin not provided`,40019,400)}function ht(i){throw Ma(i)}async function Li(i,a=5e3,l="Timeout expired"){const o=new w(l,5e4,500);return Promise.race([i,new Promise((u,f)=>setTimeout(()=>f(o),a))])}var wr="2.10.1",Nr="ably-js/"+wr,It={ENDPOINT:"main",ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["main.a.fallback.ably-realtime.com","main.b.fallback.ably-realtime.com","main.c.fallback.ably-realtime.com","main.d.fallback.ably-realtime.com","main.e.fallback.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:1e4,httpMaxRetryDuration:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,webSocketConnectTimeout:1e4,webSocketSlowTimeout:4e3},httpMaxRetryCount:3,maxMessageSize:65536,version:wr,protocolVersion:3,agent:Nr,getPort:sl,getHttpScheme:ll,getPrimaryDomainFromEndpoint:Ur,getEndpointFallbackHosts:Sn,getFallbackHosts:Et,getHosts:Bi,checkHost:cs,objectifyOptions:xr,normaliseOptions:cl,defaultGetHeaders:qi,defaultPostHeaders:dt};function sl(i,a){return a||i.tls?i.tlsPort:i.port}function ll(i){return i.tls?"https://":"http://"}function rl(i){return i.includes(".")||i.includes("::")||i==="localhost"}function Ur(i){return rl(i)?i:i.startsWith("nonprod:")?`${i.replace("nonprod:","")}.realtime.ably-nonprod.net`:`${i}.realtime.ably.net`}function Sn(i){if(rl(i))return[];if(i.startsWith("nonprod:")){const a=i.replace("nonprod:","");return yt(a,"ably-realtime-nonprod.com")}return yt(i,"ably-realtime.com")}function yt(i,a){return["a","b","c","d","e"].map(l=>`${i}.${l}.fallback.${a}`)}function Et(i){const a=i.fallbackHosts,l=typeof i.httpMaxRetryCount<"u"?i.httpMaxRetryCount:It.httpMaxRetryCount;return a?xi(a,l):[]}function Bi(i){return[i.primaryDomain].concat(Et(i))}function cs(i){if(typeof i!="string")throw new w("host must be a string; was a "+typeof i,4e4,400);if(!i.length)throw new w("host must not be zero-length",4e4,400)}function vc(i){const a={};for(const l in It.TIMEOUTS)a[l]=i[l]||It.TIMEOUTS[l];return a}function ol(i){let a=It.agent;if(i.agents)for(var l in i.agents)a+=" "+l+"/"+i.agents[l];return a}function xr(i,a,l,o,u){if(i===void 0){const m=a?`${l} must be initialized with either a client options object, an Ably API key, or an Ably Token`:`${l} must be initialized with a client options object`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,m),new Error(m)}let f;if(typeof i=="string")if(i.indexOf(":")==-1){if(!a){const m=`${l} cannot be initialized with just an Ably Token; you must provide a client options object with a \`plugins\` property. (Set this Ably Token as the objects \`token\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,m),new Error(m)}f={token:i}}else{if(!a){const m=`${l} cannot be initialized with just an Ably API key; you must provide a client options object with a \`plugins\` property. (Set this Ably API key as the objects \`key\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,m),new Error(m)}f={key:i}}else f=i;return u&&(f=Ue(fe({},f),{plugins:fe(fe({},u),f.plugins)})),f}function wa(i){if(i.endpoint&&(i.environment||i.restHost||i.realtimeHost))throw new w("The `endpoint` option cannot be used in conjunction with the `environment`, `restHost`, or `realtimeHost` options.",40106,400);if(i.environment&&(i.restHost||i.realtimeHost))throw new w("The `environment` option cannot be used in conjunction with the `restHost`, or `realtimeHost` options.",40106,400)}function cl(i,a,l){const o=l??h.defaultLogger;i.environment&&o.deprecated("The `environment` client option","Use the `endpoint` client option instead."),i.restHost&&o.deprecated("The `restHost` client option","Use the `endpoint` client option instead."),i.realtimeHost&&o.deprecated("The `realtimeHost` client option","Use the `endpoint` client option instead."),wa(i),typeof i.recover=="function"&&i.closeOnUnload===!0&&(h.logAction(o,h.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),i.recover=void 0),"closeOnUnload"in i||(i.closeOnUnload=!i.recover),"queueMessages"in i||(i.queueMessages=!0);const u=i.endpoint||It.ENDPOINT;!i.fallbackHosts&&!i.restHost&&!i.realtimeHost&&!i.port&&!i.tlsPort&&(i.fallbackHosts=Sn(i.environment||u));const f=i.environment&&`${i.environment}.realtime.ably.net`,p=i.restHost||i.realtimeHost||f||Ur(u);(i.fallbackHosts||[]).concat(p).forEach(cs),i.port=i.port||It.PORT,i.tlsPort=i.tlsPort||It.TLS_PORT,"tls"in i||(i.tls=!0);const R=vc(i);a?"useBinaryProtocol"in i?i.useBinaryProtocol=N.Config.supportsBinary&&i.useBinaryProtocol:i.useBinaryProtocol=N.Config.preferBinary:i.useBinaryProtocol=!1;const S={};i.clientId&&(S["X-Ably-ClientId"]=N.BufferUtils.base64Encode(N.BufferUtils.utf8Encode(i.clientId))),"idempotentRestPublishing"in i||(i.idempotentRestPublishing=!0);let k=null,L=i.connectivityCheckUrl;if(i.connectivityCheckUrl){let[B,Q]=i.connectivityCheckUrl.split("?");k=Q?_a(Q):{},B.indexOf("://")===-1&&(B="https://"+B),L=B}let I=i.wsConnectivityCheckUrl;return I&&I.indexOf("://")===-1&&(I="wss://"+I),Ue(fe({},i),{primaryDomain:p,maxMessageSize:i.maxMessageSize||It.maxMessageSize,timeouts:R,connectivityCheckParams:k,connectivityCheckUrl:L,wsConnectivityCheckUrl:I,headers:S})}function An(i,a,l){const o=l||{};if(o.cipher){i||ht("Crypto");const u=i.getCipher(o.cipher,a);o.cipher=u.cipherParams,o.channelCipher=u.cipher}else"cipher"in o&&(o.cipher=void 0,o.channelCipher=null);return o}var si={json:"application/json",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack",text:"text/plain"},qn={format:"json",protocolVersion:It.protocolVersion};function qi(i,{format:a=qn.format,protocolVersion:l=qn.protocolVersion}={}){return{accept:si[a],"X-Ably-Version":l.toString(),"Ably-Agent":ol(i)}}function dt(i,{format:a=qn.format,protocolVersion:l=qn.protocolVersion}={}){let o;return{accept:o=si[a],"content-type":o,"X-Ably-Version":l.toString(),"Ably-Agent":ol(i)}}var re=It;function Dr(i){return Object.assign(It,i)}var li=class Id{constructor(a,l){this.logger=a,this.members=l||[]}call(a,l){for(const o of this.members)if(o)try{o(a,l)}catch(u){h.logAction(this.logger,h.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+u+"; stack = "+u.stack)}}push(...a){this.members.push(...a)}createPromise(){return new Promise((a,l)=>{this.push((o,u)=>{o?l(o):a(u)})})}resolveAll(a){this.call(null,a)}rejectAll(a){this.call(a)}static create(a,l){const o=new Id(a,l);return Object.assign((u,f)=>o.call(u,f),{push:u=>o.push(u),createPromise:()=>o.createPromise(),resolveAll:u=>o.resolveAll(u),rejectAll:u=>o.rejectAll(u)})}},zn=li,kr=(i=>(i.Get="get",i.Delete="delete",i.Post="post",i.Put="put",i.Patch="patch",i))(kr||{}),Fe=kr,ul=(i=>(i[i.Success=200]="Success",i[i.NoContent=204]="NoContent",i[i.BadRequest=400]="BadRequest",i[i.Unauthorized=401]="Unauthorized",i[i.Forbidden=403]="Forbidden",i[i.RequestTimeout=408]="RequestTimeout",i[i.InternalServerError=500]="InternalServerError",i))(ul||{});function bc(i){return i>=200&&i<400}var ri=ul,zi=Math.pow(2,17);function On(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function fl(i){return!!i.connection}function hl(i){return ls(i)?(i.code||(i.statusCode===403?i.code=40300:(i.code=40170,i.statusCode=401)),i):new w(De(i),i.code||40170,i.statusCode||401)}var Gi=(i,a)=>{const l=N.BufferUtils,o=l.utf8Encode(i),u=l.utf8Encode(a),f=l.hmacSha256(o,u);return l.base64Encode(f)};function us(i){if(!i)return"";typeof i=="string"&&(i=JSON.parse(i));const a=Object.create(null),l=ai(i,!0);if(!l)return"";l.sort();for(let o=0;o<l.length;o++)a[l[o]]=i[l[o]].sort();return JSON.stringify(a)}function fs(i,a){if(i.authCallback)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authCallback");else if(i.authUrl)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authUrl");else if(i.key)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(i.tokenDetails)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with supplied token only");else{const l="authOptions must include valid authentication parameters";throw h.logAction(a,h.LOG_ERROR,"Auth()",l),new Error(l)}}function Sc(i){return"useTokenAuth"in i&&!i.useTokenAuth}function dl(i){return i.useTokenAuth||!Sc(i)&&(i.authCallback||i.authUrl||i.token||i.tokenDetails)}function Yt(i){return!i.key&&!i.authCallback&&!i.authUrl}var Lr=0;function Ac(){return Lr++}var hs=class{constructor(i,a){if(this.authOptions={},this.client=i,this.tokenParams=a.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,dl(a))Yt(a)&&h.logAction(this.logger,h.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(a.defaultTokenParams,a),fs(this.authOptions,this.logger);else{if(!a.key){const l="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()",l),new w(l,40160,401)}h.logAction(this.logger,h.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(a)}}get logger(){return this.client.logger}async authorize(i,a){if(a&&a.key&&this.authOptions.key!==a.key)throw new w("Unable to update auth options with incompatible key",40102,401);try{let l=await this._forceNewToken(i??null,a??null);return fl(this.client)?new Promise((o,u)=>{this.client.connection.connectionManager.onAuthUpdated(l,(f,m)=>f?u(f):o(m))}):l}catch(l){throw this.client.connection&&l.statusCode===ri.Forbidden&&this.client.connection.connectionManager.actOnErrorFromAuthorize(l),l}}async _forceNewToken(i,a){this.tokenDetails=null,this._saveTokenOptions(i,a),fs(this.authOptions,this.logger);try{return this._ensureValidAuthCredentials(!0)}finally{delete this.tokenParams.timestamp,delete this.authOptions.queryTime}}async requestToken(i,a){const l=a||this.authOptions,o=i||j(this.tokenParams);let u,f=this.client;if(l.authCallback)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),u=l.authCallback;else if(l.authUrl)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),u=(p,R)=>{const S=E({accept:"application/json, text/plain"},l.authHeaders),k=l.authMethod&&l.authMethod.toLowerCase()==="post";let L;const I=l.authUrl.indexOf("?");I>-1&&(L=_a(l.authUrl.slice(I)),l.authUrl=l.authUrl.slice(0,I),k||(l.authParams=E(L,l.authParams)));const B=E({},l.authParams||{},p),Q=X=>{var ae,Ce;let Le=(ae=X.body)!=null?ae:null,qe=null;if(X.error)h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+De(X.error));else{const bt=(Ce=X.headers["content-type"])!=null?Ce:null;Array.isArray(bt)?qe=bt.join(", "):qe=bt,h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+qe+"; body: "+_r(Le))}if(X.error){R(X.error,null);return}if(X.unpacked){R(null,Le);return}if(N.BufferUtils.isBuffer(Le)&&(Le=Le.toString()),!qe){R(new w("authUrl response is missing a content-type header",40170,401),null);return}const oe=qe.indexOf("application/json")>-1,jt=qe.indexOf("text/plain")>-1||qe.indexOf("application/jwt")>-1;if(!oe&&!jt){R(new w("authUrl responded with unacceptable content-type "+qe+", should be either text/plain, application/jwt or application/json",40170,401),null);return}if(oe){if(Le.length>zi){R(new w("authUrl response exceeded max permitted length",40170,401),null);return}try{Le=JSON.parse(Le)}catch(bt){R(new w("Unexpected error processing authURL response; err = "+bt.message,40170,401),null);return}}R(null,Le,qe)};if(h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+l.authUrl+"; Params: "+JSON.stringify(B)+"; method: "+(k?"POST":"GET")),k){const X=S||{};X["content-type"]="application/x-www-form-urlencoded";const ae=Ta(B).slice(1);He(this.client.http.doUri(Fe.Post,l.authUrl,X,ae,L),(Ce,Le)=>Q(Ce||Le))}else He(this.client.http.doUri(Fe.Get,l.authUrl,S||{},null,B),(X,ae)=>Q(X||ae))};else if(l.key)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),u=(p,R)=>{He(this.createTokenRequest(p,l),(S,k)=>R(S,k??null))};else{const p="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),new w(p,40171,403)}"capability"in o&&(o.capability=us(o.capability));const m=(p,R)=>{const S=p.keyName,k="/keys/"+S+"/requestToken",L=function(B){return f.baseUri(B)+k},I=re.defaultPostHeaders(this.client.options);l.requestHeaders&&E(I,l.requestHeaders),h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+k+"; Token params: "+JSON.stringify(p)),He(this.client.http.do(Fe.Post,L,I,JSON.stringify(p),null),(B,Q)=>B?R(B):R(Q.error,Q.body,Q.unpacked))};return new Promise((p,R)=>{let S=!1,k=this.client.options.timeouts.realtimeRequestTimeout,L=setTimeout(()=>{S=!0;const I="Token request callback timed out after "+k/1e3+" seconds";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",I),R(new w(I,40170,401))},k);u(o,(I,B,Q)=>{if(S)return;if(clearTimeout(L),I){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+De(I)),R(hl(I));return}if(typeof B=="string"){B.length===0?R(new w("Token string is empty",40170,401)):B.length>zi?R(new w("Token string exceeded max permitted length (was "+B.length+" bytes)",40170,401)):B==="undefined"||B==="null"?R(new w("Token string was literal null/undefined",40170,401)):B[0]==="{"&&!(Q&&Q.indexOf("application/jwt")>-1)?R(new w("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):p({token:B});return}if(typeof B!="object"||B===null){const ae="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof B;h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",ae),R(new w(ae,40170,401));return}const X=JSON.stringify(B).length;if(X>zi&&!l.suppressMaxLengthCheck){R(new w("Token request/details object exceeded max permitted stringified size (was "+X+" bytes)",40170,401));return}if("issued"in B){p(B);return}if(!("keyName"in B)){const ae="Expected token request callback to call back with a token string, token request object, or token details object";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",ae),R(new w(ae,40170,401));return}m(B,(ae,Ce,Le)=>{if(ae){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+De(ae)),R(hl(ae));return}Le||(Ce=JSON.parse(Ce)),h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","token received"),p(Ce)})})})}async createTokenRequest(i,a){a=a||this.authOptions,i=i||j(this.tokenParams);const l=a.key;if(!l)throw new w("No key specified",40101,403);const o=l.split(":"),u=o[0],f=o[1];if(!f)throw new w("Invalid key specified",40101,403);if(i.clientId==="")throw new w("clientId cant be an empty string",40012,400);"capability"in i&&(i.capability=us(i.capability));const m=E({keyName:u},i),p=i.clientId||"",R=i.ttl||"",S=i.capability||"";m.timestamp||(m.timestamp=await this._getTimestamp(a&&a.queryTime));const k=m.nonce||(m.nonce=On()),L=m.timestamp,I=m.keyName+`
`+R+`
`+S+`
`+p+`
`+L+`
`+k+`
`;return m.mac=m.mac||Gi(I,f),h.logAction(this.logger,h.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),m}async getAuthParams(){if(this.method=="basic")return{key:this.key};{let i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{access_token:i.token}}}async getAuthHeaders(){if(this.method=="basic")return{authorization:"Basic "+this.basicKey};{const i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{authorization:"Bearer "+os(i.token)}}}_saveBasicOptions(i){this.method="basic",this.key=i.key,this.basicKey=os(i.key),this.authOptions=i||{},"clientId"in i&&this._userSetClientId(i.clientId)}_saveTokenOptions(i,a){this.method="token",i&&(this.tokenParams=i),a&&(a.token&&(a.tokenDetails=typeof a.token=="string"?{token:a.token}:a.token),a.tokenDetails&&(this.tokenDetails=a.tokenDetails),"clientId"in a&&this._userSetClientId(a.clientId),this.authOptions=a)}async _ensureValidAuthCredentials(i){const a=this.tokenDetails;if(a){if(this._tokenClientIdMismatch(a.clientId))throw new w("Mismatch between clientId in token ("+a.clientId+") and current clientId ("+this.clientId+")",40102,403);if(!this.client.isTimeOffsetSet()||!a.expires||a.expires>=this.client.getTimestampUsingOffset())return h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+a.expires),a;h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}const l=(this.waitingForTokenRequest||(this.waitingForTokenRequest=zn.create(this.logger))).createPromise();if(this.currentTokenRequestId!==null&&!i)return l;const o=this.currentTokenRequestId=Ac();let u,f=null;try{u=await this.requestToken(this.tokenParams,this.authOptions)}catch(p){f=p}if(this.currentTokenRequestId>o)return h.logAction(this.logger,h.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one"),l;this.currentTokenRequestId=null;const m=this.waitingForTokenRequest;return this.waitingForTokenRequest=null,f?(m?.rejectAll(f),l):(m?.resolveAll(this.tokenDetails=u),l)}_userSetClientId(i){if(typeof i=="string"||i===null){if(i==="*")throw new w('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);{const a=this._uncheckedSetClientId(i);if(a)throw a}}else throw new w("clientId must be either a string or null",40012,400)}_uncheckedSetClientId(i){if(this._tokenClientIdMismatch(i)){const a="Unexpected clientId mismatch: client has "+this.clientId+", requested "+i,l=new w(a,40102,401);return h.logAction(this.logger,h.LOG_ERROR,"Auth._uncheckedSetClientId()",a),l}else return this.clientId=this.tokenParams.clientId=i,null}_tokenClientIdMismatch(i){return!!(this.clientId&&this.clientId!=="*"&&i&&i!=="*"&&this.clientId!==i)}static isTokenErr(i){return i.code&&i.code>=40140&&i.code<40150}revokeTokens(i,a){return this.client.rest.revokeTokens(i,a)}async _getTimestamp(i){return this.client.getTimestamp(i||!!this.authOptions.queryTime)}},un=hs;function Hi(i){const a=[];if(i)for(const l in i)a.push(l+"="+i[l]);return a.join("&")}function ji(i,a){return i+(a?"?":"")+Hi(a)}function Pt(i,a,l,o,u){i.error?h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received Error; "+ji(l,o)+"; Error: "+De(i.error)):h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received; "+ji(l,o)+"; Headers: "+Hi(i.headers)+"; StatusCode: "+i.statusCode+"; Body"+(N.BufferUtils.isBuffer(i.body)?" (Base64): "+N.BufferUtils.base64Encode(i.body):": "+i.body))}function gl(i,a,l,o,u){u.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(u,h.LOG_MICRO,"Http."+i+"()","Sending; "+ji(a,o)+"; Body"+(N.BufferUtils.isBuffer(l)?" (Base64): "+N.BufferUtils.base64Encode(l):": "+l))}var ds=class{constructor(i){this.client=i,this.platformHttp=new N.Http(i),this.checkConnectivity=this.platformHttp.checkConnectivity?()=>this.platformHttp.checkConnectivity():void 0}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}get supportsAuthHeaders(){return this.platformHttp.supportsAuthHeaders}get supportsLinkHeaders(){return this.platformHttp.supportsLinkHeaders}_getHosts(i){const a=i.connection,l=a&&a.connectionManager.host;return l?[l].concat(re.getFallbackHosts(i.options)):re.getHosts(i.options)}async do(i,a,l,o,u){try{const f=this.client;if(!f)return{error:new w("http.do called without client",5e4,500)};const m=typeof a=="function"?a:function(L){return f.baseUri(L)+a},p=f._currentFallback;if(p)if(p.validUntil>Date.now()){const L=await this.doUri(i,m(p.host),l,o,u);return L.error&&this.platformHttp.shouldFallback(L.error)?(f._currentFallback=null,this.do(i,a,l,o,u)):L}else f._currentFallback=null;const R=this._getHosts(f);if(R.length===1)return this.doUri(i,m(R[0]),l,o,u);let S=null;const k=async(L,I)=>{const B=L.shift();S=S??new Date;const Q=await this.doUri(i,m(B),l,o,u);return Q.error&&this.platformHttp.shouldFallback(Q.error)&&L.length?Date.now()-S.getTime()>f.options.timeouts.httpMaxRetryDuration?{error:new w(`Timeout for trying fallback hosts retries. Total elapsed time exceeded the ${f.options.timeouts.httpMaxRetryDuration}ms limit`,50003,500)}:k(L,!0):(I&&(f._currentFallback={host:B,validUntil:Date.now()+f.options.timeouts.fallbackRetryTimeout}),Q)};return k(R)}catch(f){return{error:new w(`Unexpected error in Http.do: ${De(f)}`,500,5e4)}}}async doUri(i,a,l,o,u){try{gl(i,a,o,u,this.logger);const f=await this.platformHttp.doUri(i,a,l,o,u);return this.logger.shouldLog(h.LOG_MICRO)&&Pt(f,i,a,u,this.logger),f}catch(f){return{error:new w(`Unexpected error in Http.doUri: ${De(f)}`,500,5e4)}}}};function ml(i,a,l,o){try{l.apply(a,o)}catch(u){h.logAction(i,h.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+u+"; stack = "+(u&&u.stack))}}function Gn(i,a,l){let o,u,f;for(let m=0;m<i.length;m++)if(o=i[m],l&&(o=o[l]),Array.isArray(o)){for(;(u=o.indexOf(a))!==-1;)o.splice(u,1);l&&o.length===0&&delete i[m][l]}else if(v(o))for(f in o)Object.prototype.hasOwnProperty.call(o,f)&&Array.isArray(o[f])&&Gn([o],a,f)}var Br=class{constructor(i){this.logger=i,this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}on(...i){if(i.length===1){const a=i[0];if(typeof a=="function")this.any.push(a);else throw new Error("EventListener.on(): Invalid arguments: "+N.Config.inspect(i))}if(i.length===2){const[a,l]=i;if(typeof l!="function")throw new Error("EventListener.on(): Invalid arguments: "+N.Config.inspect(i));if(V(a))this.any.push(l);else if(Array.isArray(a))a.forEach(o=>{this.on(o,l)});else{if(typeof a!="string")throw new Error("EventListener.on(): Invalid arguments: "+N.Config.inspect(i));(this.events[a]||(this.events[a]=[])).push(l)}}}off(...i){if(i.length==0||V(i[0])&&V(i[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}const[a,l]=i;let o=null,u=null;if(i.length===1||!l)typeof a=="function"?o=a:u=a;else{if(typeof l!="function")throw new Error("EventEmitter.off(): invalid arguments:"+N.Config.inspect(i));[u,o]=[a,l]}if(o&&V(u)){Gn([this.any,this.events,this.anyOnce,this.eventsOnce],o);return}if(Array.isArray(u)){u.forEach(f=>{this.off(f,o)});return}if(typeof u!="string")throw new Error("EventEmitter.off(): invalid arguments:"+N.Config.inspect(i));o?Gn([this.events,this.eventsOnce],o,u):(delete this.events[u],delete this.eventsOnce[u])}listeners(i){if(i){const a=this.events[i]||[];return this.eventsOnce[i]&&Array.prototype.push.apply(a,this.eventsOnce[i]),a.length?a:null}return this.any.length?this.any:null}emit(i,...a){const l={event:i},o=[];this.anyOnce.length&&(Array.prototype.push.apply(o,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(o,this.any);const u=this.eventsOnce[i];u&&(Array.prototype.push.apply(o,u),delete this.eventsOnce[i]);const f=this.events[i];f&&Array.prototype.push.apply(o,f),o.forEach(m=>{ml(this.logger,l,m,a)})}once(...i){const a=i.length;if(a===0||a===1&&typeof i[0]!="function"){const u=i[0];return new Promise(f=>{this.once(u,f)})}const[l,o]=i;if(i.length===1&&typeof l=="function")this.anyOnce.push(l);else if(V(l)){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+N.Config.inspect(i));this.anyOnce.push(o)}else if(Array.isArray(l)){const u=this,f=function(){const m=Array.prototype.slice.call(arguments);if(l.forEach(function(p){u.off(p,f)}),typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+N.Config.inspect(i));o.apply(this,m)};l.forEach(function(m){u.on(m,f)})}else{if(typeof l!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+N.Config.inspect(i));const u=this.eventsOnce[l]||(this.eventsOnce[l]=[]);if(o){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+N.Config.inspect(i));u.push(o)}}}async whenState(i,a){if(typeof i!="string"||typeof a!="string")throw new Error("whenState requires a valid state String argument");return i===a?null:this.once(i)}},ot=Br,F={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18,OBJECT:19,OBJECT_SYNC:20,ANNOTATION:21},qr=[];Object.keys(F).forEach(function(i){qr[F[i]]=i});var Mt={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,HAS_OBJECTS:128,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19,ANNOTATION_PUBLISH:1<<21,ANNOTATION_SUBSCRIBE:1<<22,OBJECT_SUBSCRIBE:1<<24,OBJECT_PUBLISH:1<<25},zr=Object.keys(Mt);Mt.MODE_ALL=Mt.PRESENCE|Mt.PUBLISH|Mt.SUBSCRIBE|Mt.PRESENCE_SUBSCRIBE|Mt.ANNOTATION_PUBLISH|Mt.ANNOTATION_SUBSCRIBE|Mt.OBJECT_SUBSCRIBE|Mt.OBJECT_PUBLISH;var gs=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE","ANNOTATION_PUBLISH","ANNOTATION_SUBSCRIBE","OBJECT_SUBSCRIBE","OBJECT_PUBLISH"];function Oc(i){return!i||!i.channelOptions?{channelOptions:i,plugins:{},baseEncodedPreviousPayload:void 0}:i}function Gr(i,a,l){if(l&&l.cipher){i||ht("Crypto");const o=i.getCipher(l.cipher,a);return{cipher:o.cipherParams,channelCipher:o.cipher}}return l??{}}async function ms(i,a){const{data:l,encoding:o}=await ps(i.data,i.encoding,a);return i.data=l,i.encoding=o,i}async function ps(i,a,l){let o=l.channelCipher,u=i,f=a?a+"/":"";N.BufferUtils.isBuffer(u)||(u=N.BufferUtils.utf8Encode(String(u)),f=f+"utf-8/");const m=await o.encrypt(u);return f=f+"cipher+"+o.algorithm,{data:m,encoding:f}}async function Na(i,a){const l=typeof i.data=="string"||N.BufferUtils.isBuffer(i.data)||i.data===null||i.data===void 0,{data:o,encoding:u}=oi(i.data,i.encoding,l);return i.data=o,i.encoding=u,a!=null&&a.cipher?ms(i,a):i}function oi(i,a,l){if(l)return{data:i,encoding:a};if(v(i)||Array.isArray(i))return{data:JSON.stringify(i),encoding:a?a+"/json":"json"};throw new w("Data type is unsupported",40013,400)}async function Hn(i,a){const{data:l,encoding:o,error:u}=await pl(i.data,i.encoding,a);if(i.data=l,i.encoding=o,u)throw u}async function pl(i,a,l){const o=Oc(l);let u=i,f=i,m=a,p;if(a){const R=a.split("/");let S,k=R.length,L="";try{for(;(S=k)>0;){const I=R[--k].match(/([-\w]+)(\+([\w-]+))?/);if(!I)break;switch(L=I[1],L){case"base64":f=N.BufferUtils.base64Decode(String(f)),S==R.length&&(u=f);continue;case"utf-8":f=N.BufferUtils.utf8Decode(f);continue;case"json":f=JSON.parse(f);continue;case"cipher":if(o.channelOptions!=null&&o.channelOptions.cipher&&o.channelOptions.channelCipher){const B=I[3],Q=o.channelOptions.channelCipher;if(B!=Q.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");f=await Q.decrypt(f);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!o.plugins||!o.plugins.vcdiff)throw new w("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new w("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{let B=o.baseEncodedPreviousPayload;typeof B=="string"&&(B=N.BufferUtils.utf8Encode(B));const Q=N.BufferUtils.toBuffer(B);f=N.BufferUtils.toBuffer(f),f=N.BufferUtils.arrayBufferViewToBuffer(o.plugins.vcdiff.decode(f,Q)),u=f}catch(B){throw new w("Vcdiff delta decode failed with "+B,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(I){const B=I;p=new w(`Error processing the ${L} encoding, decoder returned ${B.message}`,B.code||40013,400)}finally{m=S<=0?null:R.slice(0,S).join("/")}}return p?{error:p,data:f,encoding:m}:(o.baseEncodedPreviousPayload=u,{data:f,encoding:m})}function Ua(...i){const a=i.length>0?"json":"msgpack",{data:l,encoding:o}=yl(this.data,this.encoding,a);return Object.assign({},this,{encoding:o,data:l})}function yl(i,a,l){return!i||!N.BufferUtils.isBuffer(i)?{data:i,encoding:a}:l==="msgpack"?{data:N.BufferUtils.toBuffer(i),encoding:a}:{data:N.BufferUtils.base64Encode(i),encoding:a?a+"/base64":"base64"}}var jn={encryptData:ps,encodeData:oi,encodeDataForWire:yl,decodeData:pl};function Qt(i){const{id:a,connectionId:l,timestamp:o}=i;let u;switch(i.action){case F.MESSAGE:{u=i.messages;break}case F.PRESENCE:case F.SYNC:u=i.presence;break;case F.ANNOTATION:u=i.annotations;break;case F.OBJECT:case F.OBJECT_SYNC:u=i.state;break;default:throw new w("Unexpected action "+i.action,4e4,400)}for(let f=0;f<u.length;f++){const m=u[f];m.connectionId||(m.connectionId=l),m.timestamp||(m.timestamp=o),a&&!m.id&&(m.id=a+":"+f)}}function Vn(i,a){let l="["+a;for(const o in i)o==="data"?typeof i.data=="string"?l+="; data="+i.data:N.BufferUtils.isBuffer(i.data)?l+="; data (buffer)="+N.BufferUtils.base64Encode(i.data):typeof i.data<"u"&&(l+="; data (json)="+JSON.stringify(i.data)):o&&(o==="extras"||o==="operation")?l+="; "+o+"="+JSON.stringify(i[o]):i[o]!==void 0&&(l+="; "+o+"="+i[o]);return l+="]",l}var fn=class{},Rn=class{constructor(i){this.Platform=N,this.ErrorInfo=w,this.Logger=h,this.Defaults=re,this.Utils=Ze,this.EventEmitter=ot,this.MessageEncoding=jn;var a,l,o,u,f,m,p,R,S,k;this._additionalHTTPRequestImplementations=(a=i.plugins)!=null?a:null,this.logger=new h,this.logger.setLog(i.logLevel,i.logHandler),h.logAction(this.logger,h.LOG_MICRO,"BaseClient()","initialized with clientOptions "+N.Config.inspect(i)),this._MsgPack=(o=(l=i.plugins)==null?void 0:l.MsgPack)!=null?o:null;const L=this.options=re.normaliseOptions(i,this._MsgPack,this.logger);if(L.key){const I=L.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!I){const B="invalid key parameter";throw h.logAction(this.logger,h.LOG_ERROR,"BaseClient()",B),new w(B,40400,404)}L.keyName=I[1],L.keySecret=I[2]}if("clientId"in L)if(typeof L.clientId=="string"||L.clientId===null){if(L.clientId==="*")throw new w('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new w("clientId must be either a string or null",40012,400);h.logAction(this.logger,h.LOG_MINOR,"BaseClient()","started; version = "+re.version),this._currentFallback=null,this.serverTimeOffset=null,this.http=new ds(this),this.auth=new un(this,L),this._rest=(u=i.plugins)!=null&&u.Rest?new i.plugins.Rest(this):null,this._Crypto=(m=(f=i.plugins)==null?void 0:f.Crypto)!=null?m:null,this.__FilteredSubscriptions=(R=(p=i.plugins)==null?void 0:p.MessageInteractions)!=null?R:null,this._Annotations=(k=(S=i.plugins)==null?void 0:S.Annotations)!=null?k:null}get rest(){return this._rest||ht("Rest"),this._rest}get _FilteredSubscriptions(){return this.__FilteredSubscriptions||ht("MessageInteractions"),this.__FilteredSubscriptions}get channels(){return this.rest.channels}get push(){return this.rest.push}device(){var i;return(!((i=this.options.plugins)!=null&&i.Push)||!this.push.LocalDevice)&&ht("Push"),this._device||(this._device=this.push.LocalDevice.load(this)),this._device}baseUri(i){return re.getHttpScheme(this.options)+i+":"+re.getPort(this.options,!1)}async stats(i){return this.rest.stats(i)}async time(i){return this.rest.time(i)}async request(i,a,l,o,u,f){return this.rest.request(i,a,l,o,u,f)}batchPublish(i){return this.rest.batchPublish(i)}batchPresence(i){return this.rest.batchPresence(i)}setLog(i){this.logger.setLog(i.level,i.handler)}async getTimestamp(i){return!this.isTimeOffsetSet()&&i?this.time():this.getTimestampUsingOffset()}getTimestampUsingOffset(){return Date.now()+(this.serverTimeOffset||0)}isTimeOffsetSet(){return this.serverTimeOffset!==null}};Rn.Platform=N;var ys=Rn,vs=class el{toJSON(){var a,l,o;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(a=this.push)==null?void 0:a.recipient,state:(l=this.push)==null?void 0:l.state,error:(o=this.push)==null?void 0:o.error}}}toString(){var a,l,o,u;let f="[DeviceDetails";return this.id&&(f+="; id="+this.id),this.platform&&(f+="; platform="+this.platform),this.formFactor&&(f+="; formFactor="+this.formFactor),this.clientId&&(f+="; clientId="+this.clientId),this.metadata&&(f+="; metadata="+this.metadata),this.deviceIdentityToken&&(f+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),(a=this.push)!=null&&a.recipient&&(f+="; push.recipient="+JSON.stringify(this.push.recipient)),(l=this.push)!=null&&l.state&&(f+="; push.state="+this.push.state),(o=this.push)!=null&&o.error&&(f+="; push.error="+JSON.stringify(this.push.error)),(u=this.push)!=null&&u.metadata&&(f+="; push.metadata="+this.push.metadata),f+="]",f}static toRequestBody(a,l,o){return Je(a,l,o)}static fromResponseBody(a,l,o){return o&&(a=st(a,l,o)),Array.isArray(a)?el.fromValuesArray(a):el.fromValues(a)}static fromValues(a){return a.error=a.error&&w.fromValues(a.error),Object.assign(new el,a)}static fromLocalDevice(a){return Object.assign(new el,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=el.fromValues(a[u]);return o}},ci=vs;async function xa(i,a,l,o){if(i.http.supportsAuthHeaders){const u=await i.auth.getAuthHeaders();return o(E(u,a),l)}else{const u=await i.auth.getAuthParams();return o(a,E(u,l))}}function bs(i,a,l){if(i.err&&!i.body)return{err:i.err};if(i.statusCode===ri.NoContent)return Ue(fe({},i),{body:[],unpacked:!0});let o=i.body;if(!i.unpacked)try{o=st(o,a,l)}catch(p){return ls(p)?{err:p}:{err:new _e(De(p),null)}}if(!o)return{err:new _e("unenvelope(): Response body is missing",null)};const{statusCode:u,response:f,headers:m}=o;if(u===void 0)return Ue(fe({},i),{body:o,unpacked:!0});if(u<200||u>=300){let p=f&&f.error||i.err;return p||(p=new Error("Error in unenveloping "+o),p.statusCode=u),{err:p,body:f,headers:m,unpacked:!0,statusCode:u}}return{err:i.err,body:f,headers:m,unpacked:!0,statusCode:u}}function Hr(i,a,l,o,u){i.err?h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received Error; "+ji(l,o)+"; Error: "+De(i.err)):h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received; "+ji(l,o)+"; Headers: "+Hi(i.headers)+"; StatusCode: "+i.statusCode+"; Body: "+(N.BufferUtils.isBuffer(i.body)?" (Base64): "+N.BufferUtils.base64Encode(i.body):": "+N.Config.inspect(i.body)))}var kt=class tl{static async get(a,l,o,u,f,m){return tl.do(Fe.Get,a,l,null,o,u,f,m??!1)}static async delete(a,l,o,u,f,m){return tl.do(Fe.Delete,a,l,null,o,u,f,m)}static async post(a,l,o,u,f,m,p){return tl.do(Fe.Post,a,l,o,u,f,m,p)}static async patch(a,l,o,u,f,m,p){return tl.do(Fe.Patch,a,l,o,u,f,m,p)}static async put(a,l,o,u,f,m,p){return tl.do(Fe.Put,a,l,o,u,f,m,p)}static async do(a,l,o,u,f,m,p,R){p&&((m=m||{}).envelope=p);const S=l.logger;async function k(I,B){var Q;if(S.shouldLog(h.LOG_MICRO)){let ae=u;if(((Q=I["content-type"])==null?void 0:Q.indexOf("msgpack"))>0)try{l._MsgPack||ht("MsgPack"),ae=l._MsgPack.decode(u)}catch(Ce){h.logAction(S,h.LOG_MICRO,"Resource."+a+"()","Sending MsgPack Decoding Error: "+De(Ce))}h.logAction(S,h.LOG_MICRO,"Resource."+a+"()","Sending; "+ji(o,B)+"; Body: "+ae)}const X=await l.http.do(a,o,I,u,B);return X.error&&un.isTokenErr(X.error)?(await l.auth.authorize(null,null),xa(l,I,B,k)):{err:X.error,body:X.body,headers:X.headers,unpacked:X.unpacked,statusCode:X.statusCode}}let L=await xa(l,f,m,k);if(p&&(L=bs(L,l._MsgPack,p)),S.shouldLog(h.LOG_MICRO)&&Hr(L,a,o,m,S),R){if(L.err)throw L.err;{const I=fe({},L);return delete I.err,I}}return L}},je=kt;function Ss(i){const a=i.match(/^\.\/(\w+)\?(.*)$/);return a&&a[2]&&_a(a[2])}function Da(i){typeof i=="string"&&(i=i.split(","));const a={};for(let l=0;l<i.length;l++){const o=i[l].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(o){const u=Ss(o[1]);u&&(a[o[2]]=u)}}return a}function Rc(i,a,l){return!(l&&(a||typeof i.code=="number"))}var vl=class{constructor(i,a,l,o,u,f){this.client=i,this.path=a,this.headers=l,this.envelope=o??null,this.bodyHandler=u,this.useHttpPaginatedResponse=f||!1}get logger(){return this.client.logger}async get(i){const a=await je.get(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async delete(i){const a=await je.delete(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async post(i,a){const l=await je.post(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async put(i,a){const l=await je.put(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async patch(i,a){const l=await je.patch(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async handlePage(i){if(i.err&&Rc(i.err,i.body,this.useHttpPaginatedResponse))throw h.logAction(this.logger,h.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+De(i.err)),i.err;let a,l,o;try{a=i.statusCode==ri.NoContent?[]:await this.bodyHandler(i.body,i.headers||{},i.unpacked)}catch(u){throw i.err||u}return i.headers&&(l=i.headers.Link||i.headers.link)&&(o=Da(l)),this.useHttpPaginatedResponse?new ka(this,a,i.headers||{},i.statusCode,o,i.err):new As(this,a,o)}},As=class{constructor(i,a,l){this.resource=i,this.items=a,this._relParams=l}async first(){if(this.hasFirst())return this.get(this._relParams.first);throw new w("No link to the first page of results",40400,404)}async current(){if(this.hasCurrent())return this.get(this._relParams.current);throw new w("No link to the current page of results",40400,404)}async next(){return this.hasNext()?this.get(this._relParams.next):null}hasFirst(){return this._relParams!=null&&"first"in this._relParams}hasCurrent(){return this._relParams!=null&&"current"in this._relParams}hasNext(){return this._relParams!=null&&"next"in this._relParams}isLast(){return!this.hasNext()}async get(i){const a=this.resource,l=await je.get(a.client,a.path,a.headers,i,a.envelope,!1);return a.handlePage(l)}},ka=class extends As{constructor(i,a,l,o,u,f){super(i,a,u),this.statusCode=o,this.success=o<300&&o>=200,this.headers=l,this.errorCode=f&&f.code,this.errorMessage=f&&f.message}toJSON(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}}},zt=vl,bl=class Ar{toJSON(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}}toString(){let a="[PushChannelSubscription";return this.channel&&(a+="; channel="+this.channel),this.deviceId&&(a+="; deviceId="+this.deviceId),this.clientId&&(a+="; clientId="+this.clientId),a+="]",a}static fromResponseBody(a,l,o){return o&&(a=st(a,l,o)),Array.isArray(a)?Ar.fromValuesArray(a):Ar.fromValues(a)}static fromValues(a){return Object.assign(new Ar,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=Ar.fromValues(a[u]);return o}};bl.toRequestBody=Je;var Tc=bl,Os=Tc,_c=class{constructor(i){var a;this.client=i,this.admin=new Sl(i),N.Config.push&&((a=i.options.plugins)!=null&&a.Push)&&(this.stateMachine=new i.options.plugins.Push.ActivationStateMachine(i),this.LocalDevice=i.options.plugins.Push.localDeviceFactory(ci))}async activate(i,a){await new Promise((l,o)=>{var u;if(!((u=this.client.options.plugins)!=null&&u.Push)){o(Ma("Push"));return}if(!this.stateMachine){o(new w("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.activatedCallback){o(new w("Activation already in progress",4e4,400));return}this.stateMachine.activatedCallback=f=>{if(f){o(f);return}l()},this.stateMachine.updateFailedCallback=a,this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledActivate(this.stateMachine,i))})}async deactivate(i){await new Promise((a,l)=>{var o;if(!((o=this.client.options.plugins)!=null&&o.Push)){l(Ma("Push"));return}if(!this.stateMachine){l(new w("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.deactivatedCallback){l(new w("Deactivation already in progress",4e4,400));return}this.stateMachine.deactivatedCallback=u=>{if(u){l(u);return}a()},this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledDeactivate(this.stateMachine,i))})}},Sl=class{constructor(i){this.client=i,this.deviceRegistrations=new Cc(i),this.channelSubscriptions=new Ec(i)}async publish(i,a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=re.defaultPostHeaders(l.options,{format:o}),f={},m=E({recipient:i},a);E(u,l.options.headers),l.options.pushFullWait&&E(f,{fullWait:"true"});const p=Je(m,l._MsgPack,o);await je.post(l,"/push/publish",p,u,f,null,!0)}},Cc=class{constructor(i){this.client=i}async save(i){const a=this.client,l=ci.fromValues(i),o=a.options.useBinaryProtocol?"msgpack":"json",u=re.defaultPostHeaders(a.options,{format:o}),f={};E(u,a.options.headers),a.options.pushFullWait&&E(f,{fullWait:"true"});const m=Je(l,a._MsgPack,o),p=await je.put(a,"/push/deviceRegistrations/"+encodeURIComponent(i.id),m,u,f,null,!0);return ci.fromResponseBody(p.body,a._MsgPack,p.unpacked?void 0:o)}async get(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=re.defaultGetHeaders(a.options,{format:l}),u=i.id||i;if(typeof u!="string"||!u.length)throw new w("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400);E(o,a.options.headers);const f=await je.get(a,"/push/deviceRegistrations/"+encodeURIComponent(u),o,{},null,!0);return ci.fromResponseBody(f.body,a._MsgPack,f.unpacked?void 0:l)}async list(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l,u=re.defaultGetHeaders(a.options,{format:l});return E(u,a.options.headers),new zt(a,"/push/deviceRegistrations",u,o,async function(f,m,p){return ci.fromResponseBody(f,a._MsgPack,p?void 0:l)}).get(i)}async remove(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=re.defaultGetHeaders(a.options,{format:l}),u={},f=i.id||i;if(typeof f!="string"||!f.length)throw new w("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400);E(o,a.options.headers),a.options.pushFullWait&&E(u,{fullWait:"true"}),await je.delete(a,"/push/deviceRegistrations/"+encodeURIComponent(f),o,u,null,!0)}async removeWhere(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=re.defaultGetHeaders(a.options,{format:l});E(o,a.options.headers),a.options.pushFullWait&&E(i,{fullWait:"true"}),await je.delete(a,"/push/deviceRegistrations",o,i,null,!0)}},Ec=class Yd{constructor(a){this.remove=Yd.prototype.removeWhere,this.client=a}async save(a){const l=this.client,o=Os.fromValues(a),u=l.options.useBinaryProtocol?"msgpack":"json",f=re.defaultPostHeaders(l.options,{format:u}),m={};E(f,l.options.headers),l.options.pushFullWait&&E(m,{fullWait:"true"});const p=Je(o,l._MsgPack,u),R=await je.post(l,"/push/channelSubscriptions",p,f,m,null,!0);return Os.fromResponseBody(R.body,l._MsgPack,R.unpacked?void 0:u)}async list(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=re.defaultGetHeaders(l.options,{format:o});return E(f,l.options.headers),new zt(l,"/push/channelSubscriptions",f,u,async function(m,p,R){return Os.fromResponseBody(m,l._MsgPack,R?void 0:o)}).get(a)}async removeWhere(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=re.defaultGetHeaders(l.options,{format:o});E(u,l.options.headers),l.options.pushFullWait&&E(a,{fullWait:"true"}),await je.delete(l,"/push/channelSubscriptions",u,a,null,!0)}async listChannels(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=re.defaultGetHeaders(l.options,{format:o});return E(f,l.options.headers),l.options.pushFullWait&&E(a,{fullWait:"true"}),new zt(l,"/push/channels",f,u,async function(m,p,R){const S=!R&&o?st(m,l._MsgPack,o):m;for(let k=0;k<S.length;k++)S[k]=String(S[k]);return S}).get(a)}},Mc=_c,jr=["absent","present","enter","leave","update"];async function Vr(i,a,l,o){const u=Gr(a,i,o??null);return La.fromValues(l).decode(u,i)}async function Ir(i,a,l,o){return Promise.all(l.map(function(u){return Vr(i,a,u,o)}))}async function wc(i,a){return La.fromValues(i).decode(a.channelOptions,a.logger)}async function Yr(i,a){return Promise.all(i.map(function(l){return wc(l,a)}))}var Pr=class Or extends fn{isSynthesized(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId}parseId(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");const a=this.id.split(":");return{connectionId:a[0],msgSerial:parseInt(a[1],10),index:parseInt(a[2],10)}}async encode(a){const l=Object.assign(new La,this,{action:jr.indexOf(this.action||"present")});return Na(l,a)}static fromValues(a){return Object.assign(new Or,a)}static fromValuesArray(a){return a.map(l=>Or.fromValues(l))}static fromData(a){return a instanceof Or?a:Or.fromValues({data:a})}toString(){return Vn(this,"PresenceMessage")}},La=class lf extends fn{toJSON(...a){return Ua.call(this,...a)}static fromValues(a){return Object.assign(new lf,a)}static fromValuesArray(a){return a.map(l=>lf.fromValues(l))}async decode(a,l){const o=Object.assign(new Pr,Ue(fe({},this),{action:jr[this.action]}));try{await Hn(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WirePresenceMessage.decode()",De(u))}return o}toString(){return Vn(this,"WirePresenceMessage")}},hn=Pr,Nc=class{constructor(i){this.channel=i}get logger(){return this.channel.logger}async get(i){h.logAction(this.logger,h.LOG_MICRO,"RestPresence.get()","channel = "+this.channel.name);const a=this.channel.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.channel.client.http.supportsLinkHeaders?void 0:l,u=re.defaultGetHeaders(a.options,{format:l});return E(u,a.options.headers),new zt(a,this.channel.client.rest.presenceMixin.basePath(this),u,o,async(f,m,p)=>{const R=p?f:st(f,a._MsgPack,l);return Yr(R,this.channel)}).get(i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestPresence.history()","channel = "+this.channel.name),this.channel.client.rest.presenceMixin.history(this,i)}},Uc=Nc,Qr=["message.create","message.update","message.delete","meta","message.summary"];function Xr(i){return Qr[i||0]||"unknown"}function xc(i){let a=0;return i.name&&(a+=i.name.length),i.clientId&&(a+=i.clientId.length),i.extras&&(a+=JSON.stringify(i.extras).length),i.data&&(a+=nl(i.data)),a}async function Kr(i,a,l,o){const u=Gr(a,i,o??null);return ui.fromValues(l).decode(u,i)}async function Dc(i,a,l,o){return Promise.all(l.map(function(u){return Kr(i,a,u,o)}))}async function kc(i,a){return ui.fromValues(i).decode(a.channelOptions,a.logger)}async function Lc(i,a){return Promise.all(i.map(function(l){return kc(l,a)}))}async function Zr(i,a){return Promise.all(i.map(l=>l.encode(a)))}var Bc=Je;function Al(i){let a,l=0;for(let o=0;o<i.length;o++)a=i[o],l+=a.size||(a.size=xc(a));return l}var Jr=class rf extends fn{expandFields(){this.action==="message.create"&&(this.version&&!this.serial&&(this.serial=this.version),this.timestamp&&!this.createdAt&&(this.createdAt=this.timestamp))}async encode(a){const l=Object.assign(new ui,this,{action:Qr.indexOf(this.action||"message.create")});return Na(l,a)}static fromValues(a){return Object.assign(new rf,a)}static fromValuesArray(a){return a.map(l=>rf.fromValues(l))}toString(){return Vn(this,"Message")}},ui=class of extends fn{toJSON(...a){return Ua.call(this,...a)}static fromValues(a){return Object.assign(new of,a)}static fromValuesArray(a){return a.map(l=>of.fromValues(l))}async decodeWithErr(a,l){const o=Object.assign(new Jr,Ue(fe({},this),{action:Xr(this.action)}));let u;try{await Hn(o,a)}catch(f){h.logAction(l,h.LOG_ERROR,"WireMessage.decode()",De(f)),u=f}return o.expandFields(),{decoded:o,err:u}}async decode(a,l){const{decoded:o}=await this.decodeWithErr(a,l);return o}toString(){return Vn(this,"WireMessage")}},Xt=Jr,qc=9;function Wr(i){return i.every(function(a){return!a.id})}var Fr=class{constructor(i,a,l){this._annotations=null;var o,u;h.logAction(i.logger,h.LOG_MINOR,"RestChannel()","started; name = "+a),this.name=a,this.client=i,this.presence=new Uc(this),this.channelOptions=An((o=i._Crypto)!=null?o:null,this.logger,l),(u=i.options.plugins)!=null&&u.Push&&(this._push=new i.options.plugins.Push.PushChannel(this)),i._Annotations&&(this._annotations=new i._Annotations.RestAnnotations(this))}get annotations(){return this._annotations||ht("Annotations"),this._annotations}get push(){return this._push||ht("Push"),this._push}get logger(){return this.client.logger}setOptions(i){var a;this.channelOptions=An((a=this.client._Crypto)!=null?a:null,this.logger,i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestChannel.history()","channel = "+this.name),this.client.rest.channelMixin.history(this,i)}async publish(...i){const a=i[0],l=i[1];let o,u;if(typeof a=="string"||a===null)o=[Xt.fromValues({name:a,data:l})],u=i[2];else if(v(a))o=[Xt.fromValues(a)],u=i[1];else if(Array.isArray(a))o=Xt.fromValuesArray(a),u=i[1];else throw new w("The single-argument form of publish() expects a message object or an array of message objects",40013,400);u||(u={});const f=this.client,m=f.options,p=m.useBinaryProtocol?"msgpack":"json",R=f.options.idempotentRestPublishing,S=re.defaultPostHeaders(f.options,{format:p});if(E(S,m.headers),R&&Wr(o)){const B=await Cr(qc);o.forEach(function(Q,X){Q.id=B+":"+X.toString()})}const k=await Zr(o,this.channelOptions),L=Al(k),I=m.maxMessageSize;if(L>I)throw new w(`Maximum size of messages that can be published at once exceeded (was ${L} bytes; limit is ${I} bytes)`,40009,400);await this._publish(Bc(k,f._MsgPack,p),S,u)}async _publish(i,a,l){await je.post(this.client,this.client.rest.channelMixin.basePath(this)+"/messages",i,a,l,null,!0)}async status(){return this.client.rest.channelMixin.status(this)}},$r=Fr,eo=class Pd{constructor(a){this.entries=a&&a.entries||void 0,this.schema=a&&a.schema||void 0,this.appId=a&&a.appId||void 0,this.inProgress=a&&a.inProgress||void 0,this.unit=a&&a.unit||void 0,this.intervalId=a&&a.intervalId||void 0}static fromValues(a){return new Pd(a)}},to=eo,fi=class{static basePath(i){return"/channels/"+encodeURIComponent(i.name)}static history(i,a){const l=i.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.client.http.supportsLinkHeaders?void 0:o,f=re.defaultGetHeaders(l.options,{format:o});return E(f,l.options.headers),new zt(l,this.basePath(i)+"/messages",f,u,async function(m,p,R){const S=R?m:st(m,l._MsgPack,o);return Lc(S,i)}).get(a)}static async status(i){const a=i.client.options.useBinaryProtocol?"msgpack":"json",l=re.defaultPostHeaders(i.client.options,{format:a});return(await je.get(i.client,this.basePath(i),l,{},a,!0)).body}},zc=class{static basePath(i){return fi.basePath(i.channel)+"/presence"}static async history(i,a){const l=i.channel.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.channel.client.http.supportsLinkHeaders?void 0:o,f=re.defaultGetHeaders(l.options,{format:o});return E(f,l.options.headers),new zt(l,this.basePath(i)+"/history",f,u,async(m,p,R)=>{const S=R?m:st(m,l._MsgPack,o);return Yr(S,i.channel)}).get(a)}},no=class{constructor(i){this.channelMixin=fi,this.presenceMixin=zc,this.Resource=je,this.PaginatedResource=zt,this.DeviceDetails=ci,this.PushChannelSubscription=Os,this.client=i,this.channels=new Gc(this.client),this.push=new Mc(this.client)}async stats(i){const a=re.defaultGetHeaders(this.client.options),l=this.client.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l;return E(a,this.client.options.headers),new zt(this.client,"/stats",a,o,function(u,f,m){const p=m?u:JSON.parse(u);for(let R=0;R<p.length;R++)p[R]=to.fromValues(p[R]);return p}).get(i)}async time(i){const a=re.defaultGetHeaders(this.client.options);this.client.options.headers&&E(a,this.client.options.headers);const l=p=>this.client.baseUri(p)+"/time";let{error:o,body:u,unpacked:f}=await this.client.http.do(Fe.Get,l,a,null,i);if(o)throw o;f||(u=JSON.parse(u));const m=u[0];if(!m)throw new w("Internal error (unexpected result type from GET /time)",5e4,500);return this.client.serverTimeOffset=m-Date.now(),m}async request(i,a,l,o,u,f){var m;const[p,R,S]=this.client.options.useBinaryProtocol?(this.client._MsgPack||ht("MsgPack"),[this.client._MsgPack.encode,this.client._MsgPack.decode,"msgpack"]):[JSON.stringify,JSON.parse,"json"],k=this.client.http.supportsLinkHeaders?void 0:S;o=o||{};const L=i.toLowerCase(),I=L=="get"?re.defaultGetHeaders(this.client.options,{format:S,protocolVersion:l}):re.defaultPostHeaders(this.client.options,{format:S,protocolVersion:l});typeof u!="string"&&(u=(m=p(u))!=null?m:null),E(I,this.client.options.headers),f&&E(I,f);const B=new zt(this.client,a,I,k,async function(Q,X,ae){return K(ae?Q:R(Q))},!0);if(!N.Http.methods.includes(L))throw new w("Unsupported method "+L,40500,405);return N.Http.methodsWithBody.includes(L)?B[L](o,u):B[L](o)}async batchPublish(i){let a,l;Array.isArray(i)?(a=i,l=!1):(a=[i],l=!0);const o=this.client.options.useBinaryProtocol?"msgpack":"json",u=re.defaultPostHeaders(this.client.options,{format:o});this.client.options.headers&&E(u,this.client.options.headers);const f=Je(a,this.client._MsgPack,o),m=await je.post(this.client,"/messages",f,u,{},null,!0),p=m.unpacked?m.body:st(m.body,this.client._MsgPack,o);return l?p[0]:p}async batchPresence(i){const a=this.client.options.useBinaryProtocol?"msgpack":"json",l=re.defaultPostHeaders(this.client.options,{format:a});this.client.options.headers&&E(l,this.client.options.headers);const o=i.join(","),u=await je.get(this.client,"/presence",l,{channels:o},null,!0);return u.unpacked?u.body:st(u.body,this.client._MsgPack,a)}async revokeTokens(i,a){if(dl(this.client.options))throw new w("Cannot revoke tokens when using token auth",40162,401);const l=this.client.options.keyName;let o=a??{};const u=fe({targets:i.map(S=>`${S.type}:${S.value}`)},o),f=this.client.options.useBinaryProtocol?"msgpack":"json",m=re.defaultPostHeaders(this.client.options,{format:f});this.client.options.headers&&E(m,this.client.options.headers);const p=Je(u,this.client._MsgPack,f),R=await je.post(this.client,`/keys/${l}/revokeTokens`,p,m,{},null,!0);return R.unpacked?R.body:st(R.body,this.client._MsgPack,f)}},Gc=class{constructor(i){this.client=i,this.all=Object.create(null)}get(i,a){i=String(i);let l=this.all[i];return l?a&&l.setOptions(a):this.all[i]=l=new $r(this.client,i,a),l}release(i){delete this.all[String(i)]}},io=class extends ys{constructor(i){super(re.objectifyOptions(i,!1,"BaseRest",h.defaultLogger,{Rest:no}))}},Ol={Rest:no},Vi=class extends Xt{static async fromEncoded(i,a){return Kr(h.defaultLogger,N.Crypto,i,a)}static async fromEncodedArray(i,a){return Dc(h.defaultLogger,N.Crypto,i,a)}static fromValues(i){return Xt.fromValues(i)}},Ii=class extends hn{static async fromEncoded(i,a){return Vr(h.defaultLogger,N.Crypto,i,a)}static async fromEncodedArray(i,a){return Ir(h.defaultLogger,N.Crypto,i,a)}static fromValues(i){return hn.fromValues(i)}},ao=["annotation.create","annotation.delete"];async function Ba(i,a,l){return hi.fromValues(a).decode(l||{},i)}async function so(i,a,l){return Promise.all(a.map(function(o){return Ba(i,o,l)}))}async function lo(i,a){return hi.fromValues(i).decode(a.channelOptions,a.logger)}async function Rl(i,a){return Promise.all(i.map(function(l){return lo(l,a)}))}var Rs=class cf extends fn{async encode(){const a=Object.assign(new hi,this,{action:ao.indexOf(this.action||"annotation.create")});return Na(a,{})}static fromValues(a){return Object.assign(new cf,a)}static fromValuesArray(a){return a.map(l=>cf.fromValues(l))}toString(){return Vn(this,"Annotation")}},hi=class uf extends fn{toJSON(...a){return Ua.call(this,...a)}static fromValues(a){return Object.assign(new uf,a)}static fromValuesArray(a){return a.map(l=>uf.fromValues(l))}async decode(a,l){const o=Object.assign(new Rs,Ue(fe({},this),{action:ao[this.action]}));try{await Hn(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WireAnnotation.decode()",De(u))}return o}toString(){return Vn(this,"WireAnnotation")}},Yi=Rs,Tl=class extends Yi{static async fromEncoded(i,a){return Ba(h.defaultLogger,i,a)}static async fromEncodedArray(i,a){return so(h.defaultLogger,i,a)}static fromValues(i){return Yi.fromValues(i)}};function ro(i){let a;switch(typeof i){case"string":a=i;break;case"object":a=i.serial;break}if(!a||typeof a!="string")throw new w("First argument of annotations.publish() must be either a Message (or at least an object with a string `serial` property) or a message serial (string)",40003,400);return a}function oo(i,a){const l=ro(i);if(!a||typeof a!="object")throw new w("Second argument of annotations.publish() must be an object (the intended annotation to publish)",40003,400);const o=Yi.fromValues(a);return o.messageSerial=l,o.action||(o.action="annotation.create"),o}function co(i,a){return i.client.rest.channelMixin.basePath(i)+"/messages/"+encodeURIComponent(a)+"/annotations"}var Hc=class{constructor(i){this.channel=i}async publish(i,a){const l=oo(i,a),o=await l.encode(),u=this.channel.client,f=u.options,m=f.useBinaryProtocol?"msgpack":"json",p=re.defaultPostHeaders(u.options,{format:m}),R={};E(p,u.options.headers);const S=Je([o],u._MsgPack,m);await je.post(u,co(this.channel,l.messageSerial),S,p,R,null,!0)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async get(i,a){const l=this.channel.client,o=ro(i),u=l.options.useBinaryProtocol?"msgpack":"json",f=l.http.supportsLinkHeaders?void 0:u,m=re.defaultGetHeaders(l.options,{format:u});return E(m,l.options.headers),new zt(l,co(this.channel,o),m,f,async(p,R,S)=>{const k=S?p:st(p,l._MsgPack,u);return Rl(k,this.channel)}).get(a)}},_l=Hc,Gt=Je;function In(i){const a=[];if(i)for(let l=0;l<i.length;l++)a.push(i[l].toString());return"[ "+a.join(", ")+" ]"}function uo(i,a,l,o,u,f){const m=st(i,a,f);return Ts(m,l,o,u)}function Ts(i,a,l,o){let u;i.error&&(u=w.fromValues(i.error));let f;i.messages&&(f=ui.fromValuesArray(i.messages));let m;a&&i.presence&&(m=a.WirePresenceMessage.fromValuesArray(i.presence));let p;l&&i.annotations&&(p=l.WireAnnotation.fromValuesArray(i.annotations));let R;return o&&i.state&&(R=o.ObjectMessage.fromValuesArray(i.state,Ze,jn)),Object.assign(new El,Ue(fe({},i),{presence:m,messages:f,annotations:p,state:R,error:u}))}function Cl(i){return a=>{var l;return Ts(a,{WirePresenceMessage:La},{WireAnnotation:hi},(l=i?.ObjectsPlugin)!=null?l:null)}}function Lt(i){return Object.assign(new El,i)}function qa(i,a,l,o){let u="[ProtocolMessage";i.action!==void 0&&(u+="; action="+qr[i.action]||i.action);const f=["id","channel","channelSerial","connectionId","count","msgSerial","timestamp"];let m;for(let p=0;p<f.length;p++)m=f[p],i[m]!==void 0&&(u+="; "+m+"="+i[m]);if(i.messages&&(u+="; messages="+In(ui.fromValuesArray(i.messages))),i.presence&&a&&(u+="; presence="+In(a.WirePresenceMessage.fromValuesArray(i.presence))),i.annotations&&l&&(u+="; annotations="+In(l.WireAnnotation.fromValuesArray(i.annotations))),i.state&&o&&(u+="; state="+In(o.ObjectMessage.fromValuesArray(i.state,Ze,jn))),i.error&&(u+="; error="+w.fromValues(i.error).toString()),i.auth&&i.auth.accessToken&&(u+="; token="+i.auth.accessToken),i.flags&&(u+="; flags="+zr.filter(i.hasFlag).join(",")),i.params){let p="";ss(i.params,function(R){p.length>0&&(p+="; "),p+=R+"="+i.params[R]}),p.length>0&&(u+="; params=["+p+"]")}return u+="]",u}var El=class{constructor(){this.hasFlag=i=>(this.flags&Mt[i])>0}setFlag(i){return this.flags=this.flags|Mt[i]}getMode(){return(this.flags||0)&Mt.MODE_ALL}encodeModesToFlags(i){i.forEach(a=>this.setFlag(a))}decodeModesFromFlags(){const i=[];return gs.forEach(a=>{this.hasFlag(a)&&i.push(a)}),i.length>0?i:void 0}},Pi=El,Ml=class{constructor(i,a,l,o,u){this.previous=i,this.current=a,a==="attached"&&(this.resumed=l,this.hasBacklog=o),u&&(this.reason=u)}},di=Ml,_s=function(){};function fo(i){if(i&&"params"in i&&!v(i.params))return new w("options.params must be an object",4e4,400);if(i&&"modes"in i){if(!Array.isArray(i.modes))return new w("options.modes must be an array",4e4,400);for(let a=0;a<i.modes.length;a++){const l=i.modes[a];if(!l||typeof l!="string"||!gs.includes(String.prototype.toUpperCase.call(l)))return new w("Invalid channel mode: "+l,4e4,400)}}}var gi=class ff extends ot{constructor(a,l,o){var u,f,m;super(a.logger),this._annotations=null,this._mode=0,this.retryCount=0,this.history=async function(p){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name);const R=this.client.rest.channelMixin;if(p&&p.untilAttach){if(this.state!=="attached")throw new w("option untilAttach requires the channel to be attached",4e4,400);if(!this.properties.attachSerial)throw new w("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400);delete p.untilAttach,p.from_serial=this.properties.attachSerial}return R.history(this,p)},this.whenState=p=>ot.prototype.whenState.call(this,p,this.state),h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel()","started; name = "+l),this.name=l,this.channelOptions=An((u=a._Crypto)!=null?u:null,this.logger,o),this.client=a,this._presence=a._RealtimePresence?new a._RealtimePresence.RealtimePresence(this):null,a._Annotations&&(this._annotations=new a._Annotations.RealtimeAnnotations(this)),this.connectionManager=a.connection.connectionManager,this.state="initialized",this.subscriptions=new ot(this.logger),this.syncChannelSerial=void 0,this.properties={attachSerial:void 0,channelSerial:void 0},this.setOptions(o),this.errorReason=null,this._attachResume=!1,this._decodingContext={channelOptions:this.channelOptions,plugins:a.options.plugins||{},baseEncodedPreviousPayload:void 0},this._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},this._allChannelChanges=new ot(this.logger),(f=a.options.plugins)!=null&&f.Push&&(this._push=new a.options.plugins.Push.PushChannel(this)),(m=a.options.plugins)!=null&&m.Objects&&(this._objects=new a.options.plugins.Objects.Objects(this))}get presence(){return this._presence||ht("RealtimePresence"),this._presence}get annotations(){return this._annotations||ht("Annotations"),this._annotations}get push(){return this._push||ht("Push"),this._push}get objects(){return this._objects||ht("Objects"),this._objects}invalidStateError(){return new w("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)}static processListenerArgs(a){return a=Array.prototype.slice.call(a),typeof a[0]=="function"&&a.unshift(null),a}async setOptions(a){var l;const o=this.channelOptions,u=fo(a);if(u)throw u;if(this.channelOptions=An((l=this.client._Crypto)!=null?l:null,this.logger,a),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(a,o))return this.attachImpl(),new Promise((f,m)=>{this._allChannelChanges.once(["attached","update","detached","failed"],function(p){switch(this.event){case"update":case"attached":f();break;default:m(p.reason)}})})}_shouldReattachToSetOptions(a,l){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(a?.params){const o=mi(a.params),u=mi(l.params);if(Object.keys(o).length!==Object.keys(u).length||!Ea(u,o))return!0}return!!(a?.modes&&(!l.modes||!al(a.modes,l.modes)))}async publish(...a){let l;if(a.length==1)if(v(a[0]))l=[Xt.fromValues(a[0])];else if(Array.isArray(a[0]))l=Xt.fromValuesArray(a[0]);else throw new w("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else l=[Xt.fromValues({name:a[0],data:a[1]})];const u=this.client.options.maxMessageSize,f=await Zr(l,this.channelOptions),m=Al(f);if(m>u)throw new w(`Maximum size of messages that can be published at once exceeded (was ${m} bytes; limit is ${u} bytes)`,40009,400);this.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+this.state+", message count = "+f.length);const p=Lt({action:F.MESSAGE,channel:this.name,messages:f});return this.sendMessage(p)}throwIfUnpublishableState(){if(!this.connectionManager.activeState())throw this.connectionManager.getError();if(this.state==="failed"||this.state==="suspended")throw this.invalidStateError()}onEvent(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.onEvent()","received message");const l=this.subscriptions;for(let o=0;o<a.length;o++){const u=a[o];l.emit(u.name,u)}}async attach(){return this.state==="attached"?null:new Promise((a,l)=>{this._attach(!1,null,(o,u)=>o?l(o):a(u))})}_attach(a,l,o){o||(o=f=>{f&&h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+f.toString())});const u=this.connectionManager;if(!u.activeState()){o(u.getError());return}(this.state!=="attaching"||a)&&this.requestState("attaching",l),this.once(function(f){switch(this.event){case"attached":o?.(null,f);break;case"detached":case"suspended":case"failed":o?.(f.reason||u.getError()||new w("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":o?.(new w("Attach request superseded by a subsequent detach request",9e4,409));break}})}attachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");const a=Lt({action:F.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this.channelOptions.modes&&a.encodeModesToFlags(Er(this.channelOptions.modes)),this._attachResume&&a.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(a.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(a).catch(_s)}async detach(){const a=this.connectionManager;if(!a.activeState())throw a.getError();switch(this.state){case"suspended":this.notifyState("detached");return;case"detached":return;case"failed":throw new w("Unable to detach; channel state = failed",90001,400);default:this.requestState("detaching");case"detaching":return new Promise((l,o)=>{this.once(function(u){switch(this.event){case"detached":l();break;case"attached":case"suspended":case"failed":o(u.reason||a.getError()||new w("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":o(new w("Detach request superseded by a subsequent attach request",9e4,409));break}})})}}detachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");const a=Lt({action:F.DETACH,channel:this.name});this.sendMessage(a).catch(_s)}async subscribe(...a){const[l,o]=ff.processListenerArgs(a);if(this.state==="failed")throw w.fromValues(this.invalidStateError());return l&&typeof l=="object"&&!Array.isArray(l)?this.client._FilteredSubscriptions.subscribeFilter(this,l,o):this.subscriptions.on(l,o),this.channelOptions.attachOnSubscribe!==!1?this.attach():null}unsubscribe(...a){var l;const[o,u]=ff.processListenerArgs(a);if(typeof o=="object"&&!u||(l=this.filteredSubscriptions)!=null&&l.has(u)){this.client._FilteredSubscriptions.getAndDeleteFilteredSubscriptions(this,o,u).forEach(f=>this.subscriptions.off(f));return}this.subscriptions.off(o,u)}sync(){switch(this.state){case"initialized":case"detaching":case"detached":throw new _e("Unable to sync to channel; not attached",4e4)}const a=this.connectionManager;if(!a.activeState())throw a.getError();const l=Lt({action:F.SYNC,channel:this.name});this.syncChannelSerial&&(l.channelSerial=this.syncChannelSerial),a.send(l)}async sendMessage(a){return new Promise((l,o)=>{this.connectionManager.send(a,this.client.options.queueMessages,u=>{u?o(u):l()})})}async sendPresence(a){const l=Lt({action:F.PRESENCE,channel:this.name,presence:a});return this.sendMessage(l)}sendState(a){const l=Lt({action:F.OBJECT,channel:this.name,state:a});return this.sendMessage(l)}async processMessage(a){(a.action===F.ATTACHED||a.action===F.MESSAGE||a.action===F.PRESENCE||a.action===F.OBJECT||a.action===F.ANNOTATION)&&this.setChannelSerial(a.channelSerial);let l,o=!1;switch(a.action){case F.ATTACHED:{this.properties.attachSerial=a.channelSerial,this._mode=a.getMode(),this.params=a.params||{};const u=a.decodeModesFromFlags();this.modes=u&&il(u)||void 0;const f=a.hasFlag("RESUMED"),m=a.hasFlag("HAS_PRESENCE"),p=a.hasFlag("HAS_BACKLOG"),R=a.hasFlag("HAS_OBJECTS");if(this.state==="attached"){f||(this._presence&&this._presence.onAttached(m),this._objects&&this._objects.onAttached(R));const S=new di(this.state,this.state,f,p,a.error);this._allChannelChanges.emit("update",S),(!f||this.channelOptions.updateOnAttached)&&this.emit("update",S)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",a.error,f,m,p,R);break}case F.DETACHED:{const u=a.error?w.fromValues(a.error):new w("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",u):this.state==="attaching"?this.notifyState("suspended",u):(this.state==="attached"||this.state==="suspended")&&this.requestState("attaching",u);break}case F.SYNC:if(o=!0,l=this.syncChannelSerial=a.channelSerial,!a.presence)break;case F.PRESENCE:{if(!a.presence)break;Qt(a);const u=this.channelOptions;if(this._presence){const f=await Promise.all(a.presence.map(m=>m.decode(u,this.logger)));this._presence.setPresence(f,o,l)}break}case F.OBJECT:case F.OBJECT_SYNC:{if(!this._objects||!a.state)return;Qt(a);const u=a.state,f=this.client.connection.connectionManager.getActiveTransportFormat();await Promise.all(u.map(m=>this.client._objectsPlugin.ObjectMessage.decode(m,this.client,this.logger,h,Ze,f))),a.action===F.OBJECT?this._objects.handleObjectMessages(u):this._objects.handleObjectSyncMessages(u,a.channelSerial);break}case F.MESSAGE:{if(this.state!=="attached"){h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()",'Message "'+a.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}Qt(a);const u=a.messages,f=u[0],m=u[u.length-1];if(f.extras&&f.extras.delta&&f.extras.delta.from!==this._lastPayload.messageId){const R='Delta message decode failure - previous message not available for message "'+a.id+'" on this channel "'+this.name+'".';h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel.processMessage()",R),this._startDecodeFailureRecovery(new w(R,40018,400));break}let p=[];for(let R=0;R<u.length;R++){const{decoded:S,err:k}=await u[R].decodeWithErr(this._decodingContext,this.logger);if(p[R]=S,k)switch(k.code){case 40018:this._startDecodeFailureRecovery(k);return;case 40019:case 40021:this.notifyState("failed",k);return}}this._lastPayload.messageId=m.id,this._lastPayload.protocolMessageChannelSerial=a.channelSerial,this.onEvent(p);break}case F.ANNOTATION:{Qt(a);const u=this.channelOptions;if(this._annotations){const f=await Promise.all((a.annotations||[]).map(m=>m.decode(u,this.logger)));this._annotations._processIncoming(f)}break}case F.ERROR:{const u=a.error;u&&u.code==80016?this.checkPendingState():this.notifyState("failed",w.fromValues(u));break}default:h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Protocol error: unrecognised message action ("+a.action+")")}}_startDecodeFailureRecovery(a){this._lastPayload.decodeFailureRecoveryInProgress||(h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,a,()=>{this._lastPayload.decodeFailureRecoveryInProgress=!1}))}onAttached(){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)}notifyState(a,l,o,u,f,m){if(h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+a),this.clearStateTimer(),["detached","suspended","failed"].includes(a)&&(this.properties.channelSerial=null),a===this.state)return;this._presence&&this._presence.actOnChannelState(a,u,l),this._objects&&this._objects.actOnChannelState(a,m),a==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),l&&(this.errorReason=l);const p=new di(this.state,a,o,f,l),R='Channel state for channel "'+this.name+'"',S=a+(l?"; reason: "+l:"");a==="failed"?h.logAction(this.logger,h.LOG_ERROR,R,S):h.logAction(this.logger,h.LOG_MAJOR,R,S),a!=="attaching"&&a!=="suspended"&&(this.retryCount=0),a==="attached"&&this.onAttached(),a==="attached"?this._attachResume=!0:(a==="detaching"||a==="failed")&&(this._attachResume=!1),this.state=a,this._allChannelChanges.emit(a,p),this.emit(a,p)}requestState(a,l){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+a),this.notifyState(a,l),this.checkPendingState()}checkPendingState(){if(!this.connectionManager.state.sendEvents){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}}timeoutPendingState(){switch(this.state){case"attaching":{const a=new w("Channel attach timed out",90007,408);this.notifyState("suspended",a);break}case"detaching":{const a=new w("Channel detach timed out",90007,408);this.notifyState("attached",a);break}default:this.checkPendingState();break}}startStateTimerIfNotRunning(){this.stateTimer||(this.stateTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),this.stateTimer=null,this.timeoutPendingState()},this.client.options.timeouts.realtimeRequestTimeout))}clearStateTimer(){const a=this.stateTimer;a&&(clearTimeout(a),this.stateTimer=null)}startRetryTimer(){if(this.retryTimer)return;this.retryCount++;const a=Di(this.client.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(()=>{this.state==="suspended"&&this.connectionManager.state.sendEvents&&(this.retryTimer=null,h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),this.requestState("attaching"))},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}getReleaseErr(){const a=this.state;return a==="initialized"||a==="detached"||a==="failed"?null:new w("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+a,90001,400)}setChannelSerial(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+a+"; previous = "+this.properties.channelSerial),a&&(this.properties.channelSerial=a)}async status(){return this.client.rest.channelMixin.status(this)}};function mi(i){const a=i||{},{agent:l}=a;return At(a,["agent"])}var pi=gi,ho=class{constructor(i){this.channel=i,this.logger=i.logger,this.subscriptions=new ot(this.logger)}async publish(i,a){const l=this.channel.name,o=oo(i,a),u=await o.encode();this.channel.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeAnnotations.publish()","channelName = "+l+", sending annotation with messageSerial = "+o.messageSerial+", type = "+o.type);const f=Lt({action:F.ANNOTATION,channel:l,annotations:[u]});return this.channel.sendMessage(f)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async subscribe(...i){const a=pi.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw w.fromValues(u.invalidStateError());if(this.subscriptions.on(l,o),this.channel.channelOptions.attachOnSubscribe!==!1&&await u.attach(),(this.channel.state==="attached"&&this.channel._mode&Mt.ANNOTATION_SUBSCRIBE)===0)throw new w("You are trying to add an annotation listener, but you haven't requested the annotation_subscribe channel mode in ChannelOptions, so this won't do anything (we only deliver annotations to clients who have explicitly requested them)",93001,400)}unsubscribe(...i){const a=pi.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}_processIncoming(i){for(const a of i)this.subscriptions.emit(a.type||"",a)}async get(i,a){return _l.prototype.get.call(this,i,a)}},Yn=ho,Pn=class yc extends io{constructor(a){var l,o;if(!yc._MsgPack)throw new Error("Expected DefaultRest._MsgPack to have been set");super(re.objectifyOptions(a,!0,"Rest",h.defaultLogger,Ue(fe({},Ol),{Crypto:(l=yc.Crypto)!=null?l:void 0,MsgPack:(o=yc._MsgPack)!=null?o:void 0,Annotations:{Annotation:Yi,WireAnnotation:hi,RealtimeAnnotations:Yn,RestAnnotations:_l}})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};Pn._Crypto=null,Pn.Message=Vi,Pn.PresenceMessage=Ii,Pn.Annotation=Tl,Pn._MsgPack=null,Pn._Http=ds;var Cs=Pn,go=class extends ot{constructor(i){super(i),this.messages=[]}count(){return this.messages.length}push(i){this.messages.push(i)}shift(){return this.messages.shift()}last(){return this.messages[this.messages.length-1]}copyAll(){return this.messages.slice()}append(i){this.messages.push.apply(this.messages,i)}prepend(i){this.messages.unshift.apply(this.messages,i)}completeMessages(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+i+"; count = "+a),l=l||null;const o=this.messages;if(o.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");const u=o[0];if(u){const f=u.message.msgSerial,m=i+a;if(m>f){const p=o.splice(0,m-f);for(const R of p)R.callback(l)}o.length==0&&this.emit("idle")}}completeAllMessages(i){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,i)}resetSendAttempted(){for(let i of this.messages)i.sendAttempted=!1}clear(){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")}},mo=go,po=class{constructor(i,a){this.message=i,this.callback=a,this.merged=!1;const l=i.action;this.sendAttempted=!1,this.ackRequired=typeof l=="number"&&[F.MESSAGE,F.PRESENCE,F.ANNOTATION,F.OBJECT].includes(l)}},jc=class extends ot{constructor(i){super(i.logger),this.transport=i,this.messageQueue=new mo(this.logger),i.on("ack",(a,l)=>{this.onAck(a,l)}),i.on("nack",(a,l,o)=>{this.onNack(a,l,o)})}onAck(i,a){h.logAction(this.logger,h.LOG_MICRO,"Protocol.onAck()","serial = "+i+"; count = "+a),this.messageQueue.completeMessages(i,a)}onNack(i,a,l){h.logAction(this.logger,h.LOG_ERROR,"Protocol.onNack()","serial = "+i+"; count = "+a+"; err = "+De(l)),l||(l=new w("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(i,a,l)}onceIdle(i){const a=this.messageQueue;if(a.count()===0){i();return}a.once("idle",i)}send(i){i.ackRequired&&this.messageQueue.push(i),this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Protocol.send()","sending msg; "+qa(i.message,this.transport.connectionManager.realtime._RealtimePresence,this.transport.connectionManager.realtime._Annotations,this.transport.connectionManager.realtime._objectsPlugin)),i.sendAttempted=!0,this.transport.send(i.message)}getTransport(){return this.transport}getPendingMessages(){return this.messageQueue.copyAll()}clearPendingMessages(){return this.messageQueue.clear()}finish(){const i=this.transport;this.onceIdle(function(){i.disconnect()})}},yo=jc,vo=class{constructor(i,a,l,o){this.previous=i,this.current=a,l&&(this.retryIn=l),o&&(this.reason=o)}},Qi=vo,gt={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},bo={disconnected:()=>w.fromValues({statusCode:400,code:gt.DISCONNECTED,message:"Connection to server temporarily unavailable"}),suspended:()=>w.fromValues({statusCode:400,code:gt.SUSPENDED,message:"Connection to server unavailable"}),failed:()=>w.fromValues({statusCode:400,code:gt.FAILED,message:"Connection failed or disconnected by server"}),closing:()=>w.fromValues({statusCode:400,code:gt.CLOSING,message:"Connection closing"}),closed:()=>w.fromValues({statusCode:400,code:gt.CLOSED,message:"Connection closed"}),unknownConnectionErr:()=>w.fromValues({statusCode:500,code:gt.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"}),unknownChannelErr:()=>w.fromValues({statusCode:500,code:gt.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})};function Kt(i){return!i.statusCode||!i.code||i.statusCode>=500?!0:Object.values(gt).includes(i.code)}var mt=bo,Xi=Lt({action:F.CLOSE}),wl=Lt({action:F.DISCONNECT}),Es=class extends ot{constructor(i,a,l,o){super(i.logger),o&&(l.format=void 0,l.heartbeats=!0),this.connectionManager=i,this.auth=a,this.params=l,this.timeouts=l.options.timeouts,this.format=l.format,this.isConnected=!1,this.isFinished=!1,this.isDisposed=!1,this.maxIdleInterval=null,this.idleTimer=null,this.lastActivity=null}connect(){}close(){this.isConnected&&this.requestClose(),this.finish("closed",mt.closed())}disconnect(i){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",i||mt.disconnected())}fail(i){this.isConnected&&this.requestDisconnect(),this.finish("failed",i||mt.failed())}finish(i,a){var l;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((l=this.idleTimer)!=null?l:void 0),this.idleTimer=null,this.emit(i,a),this.dispose())}onProtocolMessage(i){switch(this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+qa(i,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),i.action){case F.HEARTBEAT:h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",i.id);break;case F.CONNECTED:this.onConnect(i),this.emit("connected",i.error,i.connectionId,i.connectionDetails,i);break;case F.CLOSED:this.onClose(i);break;case F.DISCONNECTED:this.onDisconnect(i);break;case F.ACK:this.emit("ack",i.msgSerial,i.count);break;case F.NACK:this.emit("nack",i.msgSerial,i.count,i.error);break;case F.SYNC:this.connectionManager.onChannelMessage(i,this);break;case F.ACTIVATE:break;case F.AUTH:He(this.auth.authorize(),a=>{a&&h.logAction(this.logger,h.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+De(a))});break;case F.ERROR:if(h.logAction(this.logger,h.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+N.Config.inspect(i.error)+(i.channel?", channel: "+i.channel:"")),i.channel===void 0){this.onFatalError(i);break}this.connectionManager.onChannelMessage(i,this);break;default:this.connectionManager.onChannelMessage(i,this)}}onConnect(i){if(this.isConnected=!0,!i.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");const a=i.connectionDetails.maxIdleInterval;a&&(this.maxIdleInterval=a+this.timeouts.realtimeRequestTimeout,this.onActivity())}onDisconnect(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onDisconnect()","err = "+De(a)),this.finish("disconnected",a)}onFatalError(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onFatalError()","err = "+De(a)),this.finish("failed",a)}onClose(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onClose()","err = "+De(a)),this.finish("closed",a)}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestClose()",""),this.send(Xi)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(wl)}ping(i){const a={action:F.HEARTBEAT};i&&(a.id=i),this.send(Lt(a))}dispose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()}onActivity(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=Date.now(),this.setIdleTimer(this.maxIdleInterval+100))}setIdleTimer(i){this.idleTimer||(this.idleTimer=setTimeout(()=>{this.onIdleTimerExpire()},i))}onIdleTimerExpire(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;const i=Date.now()-this.lastActivity,a=this.maxIdleInterval-i;if(a<=0){const l="No activity seen from realtime in "+i+"ms; assuming connection has dropped";h.logAction(this.logger,h.LOG_ERROR,"Transport.onIdleTimerExpire()",l),this.disconnect(new w(l,80003,408))}else this.setIdleTimer(a+100)}static tryConnect(i,a,l,o,u){const f=new i(a,l,o);let m;const p=function(S){clearTimeout(m),u({event:this.event,error:S})},R=a.options.timeouts.realtimeRequestTimeout;return m=setTimeout(()=>{f.off(["preconnect","disconnected","failed"]),f.dispose(),p.call({event:"disconnected"},new w("Timeout waiting for transport to indicate itself viable",5e4,500))},R),f.on(["failed","disconnected"],p),f.on("preconnect",function(){h.logAction(a.logger,h.LOG_MINOR,"Transport.tryConnect()","viable transport "+f),clearTimeout(m),f.off(["failed","disconnected"],p),u(null,f)}),f.connect(),f}static isAvailable(){throw new w("isAvailable not implemented for transport",5e4,500)}},Tn=Es,Ot;(i=>{i.WebSocket="web_socket",i.Comet="comet",i.XhrPolling="xhr_polling"})(Ot||(Ot={}));var Ki=typeof Ra<"u"?Ra:typeof window<"u"?window:self,Ms=()=>{var i;return typeof N.WebStorage<"u"&&((i=N.WebStorage)==null?void 0:i.localSupported)},Qn=()=>{var i;return typeof N.WebStorage<"u"&&((i=N.WebStorage)==null?void 0:i.sessionSupported)},yi=function(){},Nl="ably-transport-preference";function Ht(i,a,l){let o;if(i.channel!==a.channel||(o=i.action)!==F.PRESENCE&&o!==F.MESSAGE||o!==a.action)return!1;const u=o===F.PRESENCE?"presence":"messages",f=i[u].concat(a[u]);return Al(f)>l||!Rr(f,"clientId")||!f.every(function(p){return!p.id})?!1:(i[u]=f,!0)}function za(i){try{return JSON.parse(i)}catch{return null}}var _n=class{constructor(i,a,l,o){this.options=i,this.host=a,this.mode=l,this.connectionKey=o,this.format=i.useBinaryProtocol?"msgpack":"json"}getConnectParams(i){const a=i?j(i):{},l=this.options;switch(this.mode){case"resume":a.resume=this.connectionKey;break;case"recover":{const o=za(l.recover);o&&(a.recover=o.connectionKey);break}}return l.clientId!==void 0&&(a.clientId=l.clientId),l.echoMessages===!1&&(a.echo="false"),this.format!==void 0&&(a.format=this.format),this.stream!==void 0&&(a.stream=this.stream),this.heartbeats!==void 0&&(a.heartbeats=this.heartbeats),a.v=re.protocolVersion,a.agent=ol(this.options),l.transportParams!==void 0&&E(a,l.transportParams),a}toString(){let i="[mode="+this.mode;return this.host&&(i+=",host="+this.host),this.connectionKey&&(i+=",connectionKey="+this.connectionKey),this.format&&(i+=",format="+this.format),i+="]",i}},So=class Qd extends ot{constructor(a,l){super(a.logger),this.supportedTransports={},this.disconnectedRetryCount=0,this.pendingChannelMessagesState={isProcessing:!1,queue:[]},this.realtime=a,this.initTransports(),this.options=l;const o=l.timeouts,u=o.webSocketConnectTimeout+o.realtimeRequestTimeout;if(this.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:u,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:o.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},this.state=this.states.initialized,this.errorReason=null,this.queuedMessages=new mo(this.logger),this.msgSerial=0,this.connectionDetails=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.connectionStateTtl=o.connectionStateTtl,this.maxIdleInterval=null,this.transports=Dt(l.transports||re.defaultTransports,this.supportedTransports),this.transportPreference=null,this.transports.includes(Ot.WebSocket)&&(this.webSocketTransportAvailable=!0),this.transports.includes(Ot.XhrPolling)?this.baseTransport=Ot.XhrPolling:this.transports.includes(Ot.Comet)&&(this.baseTransport=Ot.Comet),this.domains=re.getHosts(l),this.activeProtocol=null,this.host=null,this.lastAutoReconnectAttempt=null,this.lastActivity=null,this.forceFallbackHost=!1,this.connectCounter=0,this.wsCheckResult=null,this.webSocketSlowTimer=null,this.webSocketGiveUpTimer=null,this.abandonedWebSocket=!1,h.logAction(this.logger,h.LOG_MINOR,"Realtime.ConnectionManager()","started"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(l.transports||re.defaultTransports)+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+this.transports+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","http domains = ["+this.domains+"]"),!this.transports.length){const m="no requested transports available";throw h.logAction(this.logger,h.LOG_ERROR,"realtime.ConnectionManager()",m),new Error(m)}const f=N.Config.addEventListener;f&&(Qn()&&typeof l.recover=="function"&&f("beforeunload",this.persistConnection.bind(this)),l.closeOnUnload===!0&&f("beforeunload",()=>{h.logAction(this.logger,h.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),this.requestState({state:"closing"})}),f("online",()=>{var m;this.state==this.states.disconnected||this.state==this.states.suspended?(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser online event","reattempting connection"),this.requestState({state:"connecting"})):this.state==this.states.connecting&&((m=this.pendingTransport)==null||m.off(),this.disconnectAllTransports(),this.startConnect())}),f("offline",()=>{this.state==this.states.connected&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser offline event","disconnecting active transport"),this.disconnectAllTransports())}))}static supportedTransports(a){const l={supportedTransports:{}};return this.initTransports(a,l),l.supportedTransports}static initTransports(a,l){const o=fe(fe({},N.Transports.bundledImplementations),a);[Ot.WebSocket,...N.Transports.order].forEach(u=>{const f=o[u];f&&f.isAvailable()&&(l.supportedTransports[u]=f)})}initTransports(){Qd.initTransports(this.realtime._additionalTransportImplementations,this)}createTransportParams(a,l){return new _n(this.options,a,l,this.connectionKey)}getTransportParams(a){(o=>{if(this.connectionKey){o("resume");return}if(typeof this.options.recover=="string"){o("recover");return}const u=this.options.recover,f=this.getSessionRecoverData(),m=this.sessionRecoveryName();if(f&&typeof u=="function"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data (recovery scope: "+m+")"),u(f,p=>{p?(this.options.recover=f.recoveryKey,o("recover")):o("clean")});return}o("clean")})(o=>{const u=this.createTransportParams(null,o);if(o==="recover"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+this.options.recover);const f=za(this.options.recover);f&&(this.msgSerial=f.msgSerial)}else h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+u.toString());a(u)})}tryATransport(a,l,o){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+l),this.proposedTransport=Tn.tryConnect(this.supportedTransports[l],this,this.realtime.auth,a,(u,f)=>{const m=this.state;if(m==this.states.closing||m==this.states.closed||m==this.states.failed){f&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+m.state+" while we were attempting the transport; closing "+f),f.close()),o(!0);return}if(u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+l+" "+u.event+", err: "+u.error.toString()),un.isTokenErr(u.error)&&!(this.errorReason&&un.isTokenErr(this.errorReason))?(this.errorReason=u.error,He(this.realtime.auth._forceNewToken(null,null),p=>{if(p){this.actOnErrorFromAuthorize(p);return}this.tryATransport(a,l,o)})):u.event==="failed"?(this.notifyState({state:"failed",error:u.error}),o(!0)):u.event==="disconnected"&&(Kt(u.error)?o(!1):(this.notifyState({state:this.states.connecting.failState,error:u.error}),o(!0)));return}h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+l+"; setting pending"),this.setTransportPending(f,a),o(null,f)})}setTransportPending(a,l){const o=l.mode;h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+a+"; mode = "+o),this.pendingTransport=a,this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),a.once("connected",(f,m,p)=>{this.activateTransport(f,a,m,p),o==="recover"&&this.options.recover&&(delete this.options.recover,this.unpersistConnection())});const u=this;a.on(["disconnected","closed","failed"],function(f){u.deactivateTransport(a,this.event,f)}),this.emit("transport.pending",a)}activateTransport(a,l,o,u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+l),a&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+a),o&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+o),u&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(u)),this.persistTransportPreference(l);const f=this.state,m=this.states.connected.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+f.state),f.state==this.states.closing.state||f.state==this.states.closed.state||f.state==this.states.failed.state)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),l.disconnect(),!1;if(delete this.pendingTransport,!l.isConnected)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+l+" since it appears to no longer be connected"),!1;const p=this.activeProtocol;this.activeProtocol=new yo(l),this.host=l.params.host;const R=u.connectionKey;if(R&&this.connectionKey!=R&&this.setConnection(o,u,!!a),this.onConnectionDetailsUpdate(u,l),N.Config.nextTick(()=>{l.on("connected",(S,k,L)=>{this.onConnectionDetailsUpdate(L,l),this.emit("update",new Qi(m,m,null,S))})}),f.state===this.states.connected.state?a&&(this.errorReason=this.realtime.connection.errorReason=a,this.emit("update",new Qi(m,m,null,a))):(this.notifyState({state:"connected",error:a}),this.errorReason=this.realtime.connection.errorReason=a||null),this.emit("transport.active",l),p)if(p.messageQueue.count()>0&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+p.transport.shortName+", new one is "+l.shortName+") finishing with "+p.messageQueue.count()+" messages still pending"),p.transport===l){const S="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+l.shortName+"; stack = "+new Error().stack;h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()",S)}else p.finish();return!0}deactivateTransport(a,l,o){const u=this.activeProtocol,f=u&&u.getTransport()===a,m=a===this.pendingTransport,p=this.noTransportsScheduledForActivation();if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+a),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+l+(f?"; was active":m?"; was pending":"")+(p?"":"; another transport is scheduled for activation")),o&&o.message&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+o.message),f&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(u.getPendingMessages()),u.clearPendingMessages(),this.activeProtocol=this.host=null),this.emit("transport.inactive",a),f&&p||f&&l==="failed"||l==="closed"||u===null&&m){if(l==="disconnected"&&o&&o.statusCode>500&&this.domains.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:l,error:o,retryImmediately:!0});return}const R=l==="failed"&&un.isTokenErr(o)?"disconnected":l;this.notifyState({state:R,error:o});return}}noTransportsScheduledForActivation(){return!this.pendingTransport||!this.pendingTransport.isConnected}setConnection(a,l,o){const u=this.connectionId;(u&&u!==a||!u&&o)&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==a&&h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=a,this.realtime.connection.key=this.connectionKey=l.connectionKey}clearConnection(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()}createRecoveryKey(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null}checkConnectionStateFreshness(){if(!this.lastActivity||!this.connectionId)return;const a=Date.now()-this.lastActivity;a>this.connectionStateTtl+this.maxIdleInterval&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+a+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}persistConnection(){if(Qn()){const a=this.createRecoveryKey();a&&this.setSessionRecoverData({recoveryKey:a,disconnectedAt:Date.now(),location:Ki.location,clientId:this.realtime.auth.clientId})}}unpersistConnection(){this.clearSessionRecoverData()}getActiveTransportFormat(){var a;return(a=this.activeProtocol)==null?void 0:a.getTransport().format}getError(){if(this.errorReason){const a=_e.fromValues(this.errorReason);return a.cause=this.errorReason,a}return this.getStateError()}getStateError(){var a,l;return(l=(a=mt)[this.state.state])==null?void 0:l.call(a)}activeState(){return this.state.queueEvents||this.state.sendEvents}enactStateChange(a){const l="Connection state",o=a.current+(a.reason?"; reason: "+a.reason:"");a.current==="failed"?h.logAction(this.logger,h.LOG_ERROR,l,o):h.logAction(this.logger,h.LOG_MAJOR,l,o),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+a.current+"; reason = "+(a.reason&&a.reason.message));const u=this.state=this.states[a.current];a.reason&&(this.errorReason=a.reason,this.realtime.connection.errorReason=a.reason),(u.terminal||u.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",a)}startTransitionTimer(a){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+a.state),this.transitionTimer&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(()=>{this.transitionTimer&&(this.transitionTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager "+a.state+" timer expired","requesting new state: "+a.failState),this.notifyState({state:a.failState}))},a.retryDelay)}cancelTransitionTimer(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)}startSuspendTimer(){this.suspendTimer||(this.suspendTimer=setTimeout(()=>{this.suspendTimer&&(this.suspendTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),this.states.connecting.failState="suspended",this.notifyState({state:"suspended"}))},this.connectionStateTtl))}checkSuspendTimer(a){a!=="disconnected"&&a!=="suspended"&&a!=="connecting"&&this.cancelSuspendTimer()}cancelSuspendTimer(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)}startRetryTimer(a){this.retryTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),this.retryTimer=null,this.requestState({state:"connecting"})},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}startWebSocketSlowTimer(){this.webSocketSlowTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","checking connectivity"),this.checkWsConnectivity().then(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","ws connectivity check succeeded"),this.wsCheckResult=!0}).catch(()=>{h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","ws connectivity check failed"),this.wsCheckResult=!1}),this.realtime.http.checkConnectivity&&He(this.realtime.http.checkConnectivity(),(a,l)=>{a||!l?(h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","http connectivity check failed"),this.cancelWebSocketGiveUpTimer(),this.notifyState({state:"disconnected",error:new w("Unable to connect (network unreachable)",80003,404)})):h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","http connectivity check succeeded")})},this.options.timeouts.webSocketSlowTimeout)}cancelWebSocketSlowTimer(){this.webSocketSlowTimer&&(clearTimeout(this.webSocketSlowTimer),this.webSocketSlowTimer=null)}startWebSocketGiveUpTimer(a){this.webSocketGiveUpTimer=setTimeout(()=>{var l,o;this.wsCheckResult||(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket give up timer","websocket connection took more than 10s; "+(this.baseTransport?"trying base transport":"")),this.baseTransport?(this.abandonedWebSocket=!0,(l=this.proposedTransport)==null||l.dispose(),(o=this.pendingTransport)==null||o.dispose(),this.connectBase(a,++this.connectCounter)):h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket give up timer","websocket connectivity appears to be unavailable but no other transports to try"))},this.options.timeouts.webSocketConnectTimeout)}cancelWebSocketGiveUpTimer(){this.webSocketGiveUpTimer&&(clearTimeout(this.webSocketGiveUpTimer),this.webSocketGiveUpTimer=null)}notifyState(a){var l,o;const u=a.state,f=u==="disconnected"&&(this.state===this.states.connected||a.retryImmediately||this.state===this.states.connecting&&a.error&&un.isTokenErr(a.error)&&!(this.errorReason&&un.isTokenErr(this.errorReason)));if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+u+(f?"; will retry connection immediately":"")),u==this.state.state||(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.checkSuspendTimer(a.state),(u==="suspended"||u==="connected")&&(this.disconnectedRetryCount=0),this.state.terminal))return;const m=this.states[a.state];let p=m.retryDelay;m.state==="disconnected"&&(this.disconnectedRetryCount++,p=Di(m.retryDelay,this.disconnectedRetryCount));const R=new Qi(this.state.state,m.state,p,a.error||((o=(l=mt)[m.state])==null?void 0:o.call(l)));if(f){const S=()=>{this.state===this.states.disconnected&&(this.lastAutoReconnectAttempt=Date.now(),this.requestState({state:"connecting"}))},k=this.lastAutoReconnectAttempt&&Date.now()-this.lastAutoReconnectAttempt+1;k&&k<1e3?(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+k+"ms ago, waiting another "+(1e3-k)+"ms before trying again"),setTimeout(S,1e3-k)):N.Config.nextTick(S)}else(u==="disconnected"||u==="suspended")&&this.startRetryTimer(p);(u==="disconnected"&&!f||u==="suspended"||m.terminal)&&N.Config.nextTick(()=>{this.disconnectAllTransports()}),u=="connected"&&!this.activeProtocol&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(R),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(u,R.reason),this.failQueuedMessages(R.reason))}requestState(a){var l,o;const u=a.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+u+"; current state: "+this.state.state),u==this.state.state||(this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(u),u=="connecting"&&this.state.state=="connected")||u=="closing"&&this.state.state=="closed")return;const f=this.states[u],m=new Qi(this.state.state,f.state,null,a.error||((o=(l=mt)[f.state])==null?void 0:o.call(l)));this.enactStateChange(m),u=="connecting"&&N.Config.nextTick(()=>{this.startConnect()}),u=="closing"&&this.closeImpl()}startConnect(){if(this.state!==this.states.connecting){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}const a=this.realtime.auth,l=++this.connectCounter,o=()=>{this.checkConnectionStateFreshness(),this.getTransportParams(u=>{if(u.mode==="recover"&&u.options.recover){const f=za(u.options.recover);f&&this.realtime.channels.recoverChannels(f.channelSerials)}l===this.connectCounter&&this.connectImpl(u,l)})};if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),a.method==="basic")o();else{const u=f=>{l===this.connectCounter&&(f?this.actOnErrorFromAuthorize(f):o())};this.errorReason&&un.isTokenErr(this.errorReason)?He(a._forceNewToken(null,null),u):He(a._ensureValidAuthCredentials(!1),u)}}connectImpl(a,l){const o=this.state.state;if(o!==this.states.connecting.state){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect, but was "+o);return}const u=this.getTransportPreference();u&&u===this.baseTransport&&this.webSocketTransportAvailable&&this.checkWsConnectivity().then(()=>{this.unpersistTransportPreference(),this.state===this.states.connecting&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl():","web socket connectivity available, cancelling connection attempt with "+this.baseTransport),this.disconnectAllTransports(),this.connectWs(a,++this.connectCounter))}).catch(yi),u&&u===this.baseTransport||this.baseTransport&&!this.webSocketTransportAvailable?this.connectBase(a,l):this.connectWs(a,l)}connectWs(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectWs()"),this.wsCheckResult=null,this.abandonedWebSocket=!1,this.startWebSocketSlowTimer(),this.startWebSocketGiveUpTimer(a),this.tryTransportWithFallbacks("web_socket",a,!0,l,()=>this.wsCheckResult!==!1&&!this.abandonedWebSocket)}connectBase(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectBase()"),this.baseTransport?this.tryTransportWithFallbacks(this.baseTransport,a,!1,l,()=>!0):this.notifyState({state:"disconnected",error:new w("No transports left to try",8e4,404)})}tryTransportWithFallbacks(a,l,o,u,f){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryTransportWithFallbacks()",a);const m=L=>{this.notifyState({state:this.states.connecting.failState,error:L})},p=this.domains.slice(),R=(L,I)=>{if(u===this.connectCounter){if(!f()){I&&I.dispose();return}!I&&!L&&k()}},S=p.shift();if(!S){m(new w("Unable to connect (no available host)",80003,404));return}l.host=S;const k=()=>{if(!p.length){m(new w("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!this.realtime.http.checkConnectivity){m(new _e("Internal error: Http.checkConnectivity not set",null,500));return}He(this.realtime.http.checkConnectivity(),(L,I)=>{if(u===this.connectCounter&&f()){if(L){m(L);return}if(!I){m(new w("Unable to connect (network unreachable)",80003,404));return}l.host=Vt(p),this.tryATransport(l,a,R)}})};if(this.forceFallbackHost&&p.length){this.forceFallbackHost=!1,k();return}this.tryATransport(l,a,R)}closeImpl(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+this.pendingTransport),this.pendingTransport.close()),this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})}onAuthUpdated(a,l){var o;switch(this.state.state){case"connected":{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport");const u=(o=this.activeProtocol)==null?void 0:o.getTransport();u&&u.onAuthUpdated&&u.onAuthUpdated(a);const f=Lt({action:F.AUTH,auth:{accessToken:a.token}});this.send(f);const m=()=>{this.off(p),l(null,a)},p=R=>{R.current==="failed"&&(this.off(m),this.off(p),l(R.reason||this.getStateError()))};this.once("connectiondetails",m),this.on("connectionstate",p);break}case"connecting":h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");const u=f=>{switch(f.current){case"connected":this.off(u),l(null,a);break;case"failed":case"closed":case"suspended":this.off(u),l(f.reason||this.getStateError());break}};this.on("connectionstate",u),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}}disconnectAllTransports(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"),this.connectCounter++,this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+this.pendingTransport),this.pendingTransport.disconnect()),delete this.pendingTransport,this.proposedTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting proposed transport: "+this.pendingTransport),this.proposedTransport.disconnect()),delete this.pendingTransport,this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())}send(a,l,o){o=o||yi;const u=this.state;if(u.sendEvents){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new po(a,o));return}if(!(l&&u.queueEvents)){const m="rejecting event, queueEvent was "+l+", state was "+u.state;h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()",m),o(this.errorReason||new w(m,9e4,400));return}this.logger.shouldLog(h.LOG_MICRO)&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+qa(a,this.realtime._RealtimePresence,this.realtime._Annotations,this.realtime._objectsPlugin)),this.queue(a,o)}sendImpl(a){const l=a.message;a.ackRequired&&!a.sendAttempted&&(l.msgSerial=this.msgSerial++);try{this.activeProtocol.send(a)}catch(o){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+o.stack)}}queue(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queue()","queueing event");const o=this.queuedMessages.last(),u=this.options.maxMessageSize;o&&!o.sendAttempted&&Ht(o.message,a,u)?(o.merged||(o.callback=zn.create(this.logger,[o.callback]),o.merged=!0),o.callback.push(l)):this.queuedMessages.push(new po(a,l))}sendQueuedMessages(){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");let a;for(;a=this.queuedMessages.shift();)this.sendImpl(a)}queuePendingMessages(a){a&&a.length&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+a.length+" pending messages"),this.queuedMessages.prepend(a))}failQueuedMessages(a){const l=this.queuedMessages.count();l>0&&(h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+l+" queued messages, err = "+De(a)),this.queuedMessages.completeAllMessages(a))}onChannelMessage(a,l){this.pendingChannelMessagesState.queue.push({message:a,transport:l}),this.pendingChannelMessagesState.isProcessing||this.processNextPendingChannelMessage()}processNextPendingChannelMessage(){if(this.pendingChannelMessagesState.queue.length>0){this.pendingChannelMessagesState.isProcessing=!0;const a=this.pendingChannelMessagesState.queue.shift();this.processChannelMessage(a.message).catch(l=>{h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.processNextPendingChannelMessage() received error ",l)}).finally(()=>{this.pendingChannelMessagesState.isProcessing=!1,this.processNextPendingChannelMessage()})}}async processChannelMessage(a){await this.realtime.channels.processChannelMessage(a)}async ping(){var a;if(this.state.state!=="connected")throw new w("Unable to ping service; not connected",4e4,400);const l=(a=this.activeProtocol)==null?void 0:a.getTransport();if(!l)throw this.getStateError();h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.ping()","transport = "+l);const o=Date.now(),u=rs();return Li(new Promise(f=>{const m=p=>{p===u&&(l.off("heartbeat",m),f(Date.now()-o))};l.on("heartbeat",m),l.ping(u)}),this.options.timeouts.realtimeRequestTimeout,"Timeout waiting for heartbeat response")}abort(a){this.activeProtocol.getTransport().fail(a)}getTransportPreference(){var a,l;return this.transportPreference||Ms()&&((l=(a=N.WebStorage)==null?void 0:a.get)==null?void 0:l.call(a,Nl))}persistTransportPreference(a){var l,o;this.transportPreference=a.shortName,Ms()&&((o=(l=N.WebStorage)==null?void 0:l.set)==null||o.call(l,Nl,a.shortName))}unpersistTransportPreference(){var a,l;this.transportPreference=null,Ms()&&((l=(a=N.WebStorage)==null?void 0:a.remove)==null||l.call(a,Nl))}actOnErrorFromAuthorize(a){if(a.code===40171)this.notifyState({state:"failed",error:a});else if(a.code===40102)this.notifyState({state:"failed",error:a});else if(a.statusCode===ri.Forbidden){const l="Client configured authentication provider returned 403; failing the connection";h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",l),this.notifyState({state:"failed",error:new w(l,80019,403,a)})}else{const l="Client configured authentication provider request failed";h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",l),this.notifyState({state:this.state.failState,error:new w(l,80019,401,a)})}}onConnectionDetailsUpdate(a,l){if(!a)return;this.connectionDetails=a,a.maxMessageSize&&(this.options.maxMessageSize=a.maxMessageSize);const o=a.clientId;if(o){const f=this.realtime.auth._uncheckedSetClientId(o);if(f){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",f.message),l.fail(f);return}}const u=a.connectionStateTtl;u&&(this.connectionStateTtl=u),this.maxIdleInterval=a.maxIdleInterval,this.emit("connectiondetails",a)}checkWsConnectivity(){const a=this.options.wsConnectivityCheckUrl||re.wsConnectivityCheckUrl,l=new N.Config.WebSocket(a);return new Promise((o,u)=>{let f=!1;l.onopen=()=>{f||(f=!0,o(),l.close())},l.onclose=l.onerror=()=>{f||(f=!0,u())}})}sessionRecoveryName(){return this.options.recoveryKeyStorageName||"ably-connection-recovery"}getSessionRecoverData(){var a,l;return Qn()&&((l=(a=N.WebStorage)==null?void 0:a.getSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}setSessionRecoverData(a){var l,o;return Qn()&&((o=(l=N.WebStorage)==null?void 0:l.setSession)==null?void 0:o.call(l,this.sessionRecoveryName(),a))}clearSessionRecoverData(){var a,l;return Qn()&&((l=(a=N.WebStorage)==null?void 0:a.removeSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}},Ga=So,vi=class extends ot{constructor(i,a){super(i.logger),this.whenState=l=>ot.prototype.whenState.call(this,l,this.state),this.ably=i,this.connectionManager=new Ga(i,a),this.state=this.connectionManager.state.state,this.key=void 0,this.id=void 0,this.errorReason=null,this.connectionManager.on("connectionstate",l=>{const o=this.state=l.current;N.Config.nextTick(()=>{this.emit(o,l)})}),this.connectionManager.on("update",l=>{N.Config.nextTick(()=>{this.emit("update",l)})})}connect(){h.logAction(this.logger,h.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})}async ping(){return h.logAction(this.logger,h.LOG_MINOR,"Connection.ping()",""),this.connectionManager.ping()}close(){h.logAction(this.logger,h.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})}get recoveryKey(){return this.logger.deprecationWarning("The `Connection.recoveryKey` attribute has been replaced by the `Connection.createRecoveryKey()` method. Replace your usage of `recoveryKey` with the return value of `createRecoveryKey()`. `recoveryKey` will be removed in a future version."),this.createRecoveryKey()}createRecoveryKey(){return this.connectionManager.createRecoveryKey()}},Ul=vi,ws=class Xd extends ys{constructor(a){var l,o,u,f;if(super(re.objectifyOptions(a,!1,"BaseRealtime",h.defaultLogger)),h.logAction(this.logger,h.LOG_MINOR,"Realtime()",""),typeof EdgeRuntime=="string")throw new w(`Ably.Realtime instance cannot be used in Vercel Edge runtime. If you are running Vercel Edge functions, please replace your "new Ably.Realtime()" with "new Ably.Rest()" and use Ably Rest API instead of the Realtime API. If you are server-rendering your application in the Vercel Edge runtime, please use the condition "if (typeof EdgeRuntime === 'string')" to prevent instantiating Ably.Realtime instance during SSR in the Vercel Edge runtime.`,4e4,400);this._additionalTransportImplementations=Xd.transportImplementationsFromPlugins(this.options.plugins),this._RealtimePresence=(o=(l=this.options.plugins)==null?void 0:l.RealtimePresence)!=null?o:null,this._objectsPlugin=(f=(u=this.options.plugins)==null?void 0:u.Objects)!=null?f:null,this.connection=new Ul(this,this.options),this._channels=new Ji(this),this.options.autoConnect!==!1&&this.connect()}static transportImplementationsFromPlugins(a){const l={};return a?.WebSocketTransport&&(l[Ot.WebSocket]=a.WebSocketTransport),a?.XHRPolling&&(l[Ot.XhrPolling]=a.XHRPolling),l}get channels(){return this._channels}connect(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()}close(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.close()",""),this.connection.close()}};ws.EventEmitter=ot;var Zi=ws,Ji=class extends ot{constructor(i){super(i.logger),this.realtime=i,this.all=Object.create(null),i.connection.connectionManager.on("transport.active",()=>{this.onTransportActive()})}channelSerials(){let i={};for(const a of ai(this.all,!0)){const l=this.all[a];l.properties.channelSerial&&(i[a]=l.properties.channelSerial)}return i}recoverChannels(i){for(const a of ai(i,!0)){const l=this.get(a);l.properties.channelSerial=i[a]}}async processChannelMessage(i){const a=i.channel;if(a===void 0){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event unspecified channel, action = "+i.action);return}const l=this.all[a];if(!l){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event for non-existent channel: "+a);return}await l.processMessage(i)}onTransportActive(){for(const i in this.all){const a=this.all[i];a.state==="attaching"||a.state==="detaching"?a.checkPendingState():a.state==="suspended"?a._attach(!1,null):a.state==="attached"&&a.requestState("attaching")}}propogateConnectionInterruption(i,a){const l={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},o=["attaching","attached","detaching","suspended"],u=l[i];for(const f in this.all){const m=this.all[f];o.includes(m.state)&&m.notifyState(u,a)}}get(i,a){i=String(i);let l=this.all[i];if(!l)l=this.all[i]=new pi(this.realtime,i,a);else if(a){if(l._shouldReattachToSetOptions(a,l.channelOptions))throw new w("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);l.setOptions(a)}return l}getDerived(i,a,l){if(a.filter){const o=os(a.filter),u=ki(i);i=`[filter=${o}${u.qualifierParam}]${u.channelName}`}return this.get(i,l)}release(i){i=String(i);const a=this.all[i];if(!a)return;const l=a.getReleaseErr();if(l)throw l;delete this.all[i]}},Ns=Zi;function Us(i,a){if(i.isSynthesized()||a.isSynthesized())return i.timestamp>=a.timestamp;const l=i.parseId(),o=a.parseId();return l.msgSerial===o.msgSerial?l.index>o.index:l.msgSerial>o.msgSerial}var Bt=class extends ot{constructor(i,a,l=Us){super(i.logger),this.presence=i,this.map=Object.create(null),this.syncInProgress=!1,this.residualMembers=null,this.memberKey=a,this.newerThan=l}get(i){return this.map[i]}getClient(i){const a=this.map,l=[];for(const o in a){const u=a[o];u.clientId==i&&u.action!="absent"&&l.push(u)}return l}list(i){const a=this.map,l=i&&i.clientId,o=i&&i.connectionId,u=[];for(const f in a){const m=a[f];m.action!=="absent"&&(l&&l!=m.clientId||o&&o!=m.connectionId||u.push(m))}return u}put(i){(i.action==="enter"||i.action==="update")&&(i=hn.fromValues(i),i.action="present");const a=this.map,l=this.memberKey(i);this.residualMembers&&delete this.residualMembers[l];const o=a[l];return o&&!this.newerThan(i,o)?!1:(a[l]=i,!0)}values(){const i=this.map,a=[];for(const l in i){const o=i[l];o.action!="absent"&&a.push(o)}return a}remove(i){const a=this.map,l=this.memberKey(i),o=a[l];return o&&!this.newerThan(i,o)?!1:(this.syncInProgress?(i=hn.fromValues(i),i.action="absent",a[l]=i):delete a[l],!!o)}startSync(){const i=this.map,a=this.syncInProgress;h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),this.syncInProgress||(this.residualMembers=j(i),this.setInProgress(!0))}endSync(){const i=this.map,a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),a){for(const l in i)i[l].action==="absent"&&delete i[l];this.presence._synthesizeLeaves(as(this.residualMembers));for(const l in this.residualMembers)delete i[l];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")}waitSync(i){const a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),!a){i();return}this.once("sync",i)}clear(){this.map={},this.setInProgress(!1),this.residualMembers=null}setInProgress(i){h.logAction(this.logger,h.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+i),this.syncInProgress=i,this.presence.syncComplete=!i}};function Zt(i){return i.channel.client.auth.clientId}function Cn(i){const a=i.channel.client,l=a.auth.clientId;return(!l||l==="*")&&a.connection.state==="connected"}function En(i,a,l){switch(i.state){case"attached":case"suspended":l();break;case"initialized":case"detached":case"detaching":case"attaching":He(i.attach(),function(o){o?a(o):l()});break;default:a(w.fromValues(i.invalidStateError()))}}var Mn=class extends ot{constructor(i){super(i.logger),this.channel=i,this.syncComplete=!1,this.members=new Bt(this,a=>a.clientId+":"+a.connectionId),this._myMembers=new Bt(this,a=>a.clientId),this.subscriptions=new ot(this.logger),this.pendingPresence=[]}async enter(i){if(Cn(this))throw new w("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"enter")}async update(i){if(Cn(this))throw new w("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"update")}async enterClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"enter")}async updateClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"update")}async _enterOrUpdateClient(i,a,l,o){const u=this.channel;if(!u.connectionManager.activeState())throw u.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence."+o+"Client()","channel = "+u.name+", id = "+i+", client = "+(a||"(implicit) "+Zt(this)));const f=hn.fromData(l);f.action=o,i&&(f.id=i),a&&(f.clientId=a);const m=await f.encode(u.channelOptions);switch(u.state){case"attached":return u.sendPresence([m]);case"initialized":case"detached":u.attach();case"attaching":return new Promise((p,R)=>{this.pendingPresence.push({presence:m,callback:S=>S?R(S):p()})});default:{const p=new _e("Unable to "+o+" presence channel while in "+u.state+" state",90001);throw p.code=90001,p}}}async leave(i){if(Cn(this))throw new w("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,i)}async leaveClient(i,a){const l=this.channel;if(!l.connectionManager.activeState())throw l.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+i);const o=hn.fromData(a);o.action="leave",i&&(o.clientId=i);const u=await o.encode(l.channelOptions);switch(l.state){case"attached":return l.sendPresence([u]);case"attaching":return new Promise((f,m)=>{this.pendingPresence.push({presence:u,callback:p=>p?m(p):f()})});case"initialized":case"failed":throw new _e("Unable to leave presence channel (incompatible state)",90001);default:throw l.invalidStateError()}}async get(i){const a=!i||("waitForSync"in i?i.waitForSync:!0);return new Promise((l,o)=>{function u(f){l(i?f.list(i):f.values())}if(this.channel.state==="suspended"){a?o(w.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):u(this.members);return}En(this.channel,f=>o(f),()=>{const f=this.members;a?f.waitSync(function(){u(f)}):u(f)})})}async history(i){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name);const a=this.channel.client.rest.presenceMixin;if(i&&i.untilAttach)if(this.channel.state==="attached")delete i.untilAttach,i.from_serial=this.channel.properties.attachSerial;else throw new w("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400);return a.history(this,i)}setPresence(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+i.length+" participants; syncChannelSerial = "+l);let o,u;const f=this.members,m=this._myMembers,p=[],R=this.channel.connectionManager.connectionId;a&&(this.members.startSync(),l&&(u=l.match(/^[\w-]+:(.*)$/))&&(o=u[1]));for(let S of i)switch(S.action){case"leave":f.remove(S)&&p.push(S),S.connectionId===R&&!S.isSynthesized()&&m.remove(S);break;case"enter":case"present":case"update":f.put(S)&&p.push(S),S.connectionId===R&&m.put(S);break}a&&!o&&(f.endSync(),this.channel.syncChannelSerial=null);for(let S=0;S<p.length;S++){const k=p[S];this.subscriptions.emit(k.action,k)}}onAttached(i){h.logAction(this.logger,h.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+i),i?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();const a=this.pendingPresence,l=a.length;if(l){this.pendingPresence=[];const o=[],u=zn.create(this.logger);h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.onAttached","sending "+l+" queued presence messages");for(let f=0;f<l;f++){const m=a[f];o.push(m.presence),u.push(m.callback)}this.channel.sendPresence(o).then(()=>u()).catch(f=>u(f))}}actOnChannelState(i,a,l){switch(i){case"attached":this.onAttached(a);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(l);break}}failPendingPresence(i){if(this.pendingPresence.length){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+De(i));for(let a=0;a<this.pendingPresence.length;a++)try{this.pendingPresence[a].callback(i)}catch{}this.pendingPresence=[]}}_clearMyMembers(){this._myMembers.clear()}_ensureMyMembersPresent(){const i=this._myMembers,a=this.channel.connectionManager.connectionId;for(const l in i.map){const o=i.map[l];h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+o.clientId+'" into the presence set');const u=o.connectionId===a?o.id:void 0;this._enterOrUpdateClient(u,o.clientId,o.data,"enter").catch(f=>{const m=new w("Presence auto re-enter failed",91004,400,f);h.logAction(this.logger,h.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()","Presence auto re-enter failed; reason = "+De(f));const p=new di(this.channel.state,this.channel.state,!0,!1,m);this.channel.emit("update",p)})}}_synthesizeLeaves(i){const a=this.subscriptions;i.forEach(function(l){const o=hn.fromValues({action:"leave",connectionId:l.connectionId,clientId:l.clientId,data:l.data,encoding:l.encoding,timestamp:Date.now()});a.emit("leave",o)})}async subscribe(...i){const a=pi.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw w.fromValues(u.invalidStateError());this.subscriptions.on(l,o),u.channelOptions.attachOnSubscribe!==!1&&await u.attach()}unsubscribe(...i){const a=pi.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}},bi=Mn,Ao=Ot.WebSocket;function xl(i){return!!i.on}var Dl=class extends Tn{constructor(i,a,l){super(i,a,l),this.shortName=Ao,l.heartbeats=N.Config.useProtocolHeartbeats,this.wsHost=l.host}static isAvailable(){return!!N.Config.WebSocket}createWebSocket(i,a){return this.uri=i+Ta(a),new N.Config.WebSocket(this.uri)}toString(){return"WebSocketTransport; uri="+this.uri}connect(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","starting"),Tn.prototype.connect.call(this);const i=this,a=this.params,l=a.options,u=(l.tls?"wss://":"ws://")+this.wsHost+":"+re.getPort(l)+"/";h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","uri: "+u),He(this.auth.getAuthParams(),function(f,m){if(i.isDisposed)return;let p="";for(const S in m)p+=" "+S+": "+m[S]+";";if(h.logAction(i.logger,h.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+p+" err: "+f),f){i.disconnect(f);return}const R=a.getConnectParams(m);try{const S=i.wsConnection=i.createWebSocket(u,R);S.binaryType=N.Config.binaryType,S.onopen=function(){i.onWsOpen()},S.onclose=function(k){i.onWsClose(k)},S.onmessage=function(k){i.onWsData(k.data)},S.onerror=function(k){i.onWsError(k)},xl(S)&&S.on("ping",function(){i.onActivity()})}catch(S){h.logAction(i.logger,h.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(S.stack||S.message)),i.disconnect(S)}})}send(i){const a=this.wsConnection;if(!a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{a.send(Gt(i,this.connectionManager.realtime._MsgPack,this.params.format))}catch(l){const o="Exception from ws connection when trying to send: "+De(l);h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()",o),this.finish("disconnected",new w(o,5e4,500))}}onWsData(i){h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+i.length+"; type = "+typeof i);try{this.onProtocolMessage(uo(i,this.connectionManager.realtime._MsgPack,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin,this.format))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+a.stack)}}onWsOpen(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")}onWsClose(i){let a,l;if(typeof i=="object"?(l=i.code,a=i.wasClean||l===1e3):(l=i,a=l==1e3),delete this.wsConnection,a){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");const o=new w("Websocket closed",80003,400);this.finish("disconnected",o)}else{const o="Unclean disconnection of WebSocket ; code = "+l,u=new w(o,80003,400);h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()",o),this.finish("disconnected",u)}this.emit("disposed")}onWsError(i){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+i.message),N.Config.nextTick(()=>{this.disconnect(Error(i.message))})}dispose(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;const i=this.wsConnection;i&&(i.onmessage=function(){},delete this.wsConnection,N.Config.nextTick(()=>{if(h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!i)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");i.close()}))}},Rt=Dl,$e=class{static subscribeFilter(i,a,l){const o=u=>{var f,m,p,R,S,k;const L={name:u.name,refTimeserial:(m=(f=u.extras)==null?void 0:f.ref)==null?void 0:m.timeserial,refType:(R=(p=u.extras)==null?void 0:p.ref)==null?void 0:R.type,isRef:!!((k=(S=u.extras)==null?void 0:S.ref)!=null&&k.timeserial),clientId:u.clientId};Object.entries(a).find(([I,B])=>B!==void 0?L[I]!==B:!1)||l(u)};this.addFilteredSubscription(i,a,l,o),i.subscriptions.on(o)}static addFilteredSubscription(i,a,l,o){var u;if(i.filteredSubscriptions||(i.filteredSubscriptions=new Map),i.filteredSubscriptions.has(l)){const f=i.filteredSubscriptions.get(l);f.set(a,((u=f?.get(a))==null?void 0:u.concat(o))||[o])}else i.filteredSubscriptions.set(l,new Map([[a,[o]]]))}static getAndDeleteFilteredSubscriptions(i,a,l){if(!i.filteredSubscriptions)return[];if(!l&&a)return Array.from(i.filteredSubscriptions.entries()).map(([f,m])=>{var p;let R=m.get(a);return m.delete(a),m.size===0&&((p=i.filteredSubscriptions)==null||p.delete(f)),R}).reduce((f,m)=>m?f.concat(...m):f,[]);if(!l||!i.filteredSubscriptions.has(l))return[];const o=i.filteredSubscriptions.get(l);if(!a){const f=Array.from(o.values()).reduce((m,p)=>m.concat(...p),[]);return i.filteredSubscriptions.delete(l),f}let u=o.get(a);return o.delete(a),u||[]}},de=class hf extends Ns{constructor(a){var l;const o=hf._MsgPack;if(!o)throw new Error("Expected DefaultRealtime._MsgPack to have been set");super(re.objectifyOptions(a,!0,"Realtime",h.defaultLogger,Ue(fe({},Ol),{Crypto:(l=hf.Crypto)!=null?l:void 0,MsgPack:o,RealtimePresence:{RealtimePresence:bi,PresenceMessage:hn,WirePresenceMessage:La},Annotations:{Annotation:Yi,WireAnnotation:hi,RealtimeAnnotations:Yn,RestAnnotations:_l},WebSocketTransport:Rt,MessageInteractions:$e})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};de.Utils=Ze,de.ConnectionManager=Ga,de.ProtocolMessage=Pi,de._Crypto=null,de.Message=Vi,de.PresenceMessage=Ii,de.Annotation=Tl,de._MsgPack=null,de._Http=ds,de._PresenceMap=Bt,de._MessageEncoding=jn;var wn=de,Jt=Uint8Array,Si=Uint32Array,Nn=Math.pow,kl=new Si(8),Ll=[],Un=new Si(64);function Wi(i){return(i-(i|0))*Nn(2,32)|0}for(var Fi=2,xn=0;xn<64;){for(Ha=!0,dn=2;dn<=Fi/2;dn++)Fi%dn===0&&(Ha=!1);Ha&&(xn<8&&(kl[xn]=Wi(Nn(Fi,1/2))),Ll[xn]=Wi(Nn(Fi,1/3)),xn++),Fi++}var Ha,dn,Dn=!!new Jt(new Si([1]).buffer)[0];function gn(i){return Dn?i>>>24|(i>>>16&255)<<8|(i&65280)<<8|i<<24:i}function pt(i,a){return i>>>a|i<<32-a}function $i(i){var a=kl.slice(),l=i.length,o=l*8,u=512-(o+64)%512-1+o+65,f=new Jt(u/8),m=new Si(f.buffer);f.set(i,0),f[l]=128,m[m.length-1]=gn(o);for(var p,R=0;R<u/32;R+=16){var S=a.slice();for(p=0;p<64;p++){var k;if(p<16)k=gn(m[R+p]);else{var L=Un[p-15],I=Un[p-2];k=Un[p-7]+Un[p-16]+(pt(L,7)^pt(L,18)^L>>>3)+(pt(I,17)^pt(I,19)^I>>>10)}Un[p]=k|=0;for(var B=(pt(S[4],6)^pt(S[4],11)^pt(S[4],25))+(S[4]&S[5]^~S[4]&S[6])+S[7]+k+Ll[p],Q=(pt(S[0],2)^pt(S[0],13)^pt(S[0],22))+(S[0]&S[1]^S[2]&(S[0]^S[1])),X=7;X>0;X--)S[X]=S[X-1];S[0]=B+Q|0,S[4]=S[4]+B|0}for(p=0;p<8;p++)a[p]=a[p]+S[p]|0}return new Jt(new Si(a.map(function(ae){return gn(ae)})).buffer)}function Bl(i,a){if(i.length>64&&(i=$i(i)),i.length<64){const p=new Uint8Array(64);p.set(i,0),i=p}for(var l=new Uint8Array(64),o=new Uint8Array(64),u=0;u<64;u++)l[u]=54^i[u],o[u]=92^i[u];var f=new Uint8Array(a.length+64);f.set(l,0),f.set(a,64);var m=new Uint8Array(96);return m.set(o,0),m.set($i(f),64),$i(m)}var ja=class{constructor(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}uint8ViewToBase64(i){let a="";const l=this.base64CharSet,o=i.byteLength,u=o%3,f=o-u;let m,p,R,S,k;for(let L=0;L<f;L=L+3)k=i[L]<<16|i[L+1]<<8|i[L+2],m=(k&16515072)>>18,p=(k&258048)>>12,R=(k&4032)>>6,S=k&63,a+=l[m]+l[p]+l[R]+l[S];return u==1?(k=i[f],m=(k&252)>>2,p=(k&3)<<4,a+=l[m]+l[p]+"=="):u==2&&(k=i[f]<<8|i[f+1],m=(k&64512)>>10,p=(k&1008)>>4,R=(k&15)<<2,a+=l[m]+l[p]+l[R]+"="),a}base64ToArrayBuffer(i){const a=atob?.(i),l=a.length,o=new Uint8Array(l);for(let u=0;u<l;u++){const f=a.charCodeAt(u);o[u]=f}return this.toArrayBuffer(o)}isBuffer(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)}toBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(this.toArrayBuffer(i));throw new Error("BufferUtils.toBuffer expected an ArrayBuffer or a view onto one")}toArrayBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to ArrayBuffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return i;if(ArrayBuffer.isView(i))return i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength);throw new Error("BufferUtils.toArrayBuffer expected an ArrayBuffer or a view onto one")}base64Encode(i){return this.uint8ViewToBase64(this.toBuffer(i))}base64UrlEncode(i){return this.base64Encode(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}base64Decode(i){if(ArrayBuffer&&N.Config.atob)return this.base64ToArrayBuffer(i);throw new Error("Expected ArrayBuffer to exist and Platform.Config.atob to be configured")}hexEncode(i){return this.toBuffer(i).reduce((l,o)=>l+o.toString(16).padStart(2,"0"),"")}hexDecode(i){if(i.length%2!==0)throw new Error("Can't create a byte array from a hex string of odd length");const a=new Uint8Array(i.length/2);for(let l=0;l<a.length;l++)a[l]=parseInt(i.slice(2*l,2*(l+1)),16);return this.toArrayBuffer(a)}utf8Encode(i){if(N.Config.TextEncoder){const a=new N.Config.TextEncoder().encode(i);return this.toArrayBuffer(a)}else throw new Error("Expected TextEncoder to be configured")}utf8Decode(i){if(!this.isBuffer(i))throw new Error("Expected input of utf8decode to be an arraybuffer or typed array");if(TextDecoder)return new TextDecoder().decode(i);throw new Error("Expected TextDecoder to be configured")}areBuffersEqual(i,a){if(!i||!a)return!1;const l=this.toArrayBuffer(i),o=this.toArrayBuffer(a);if(l.byteLength!=o.byteLength)return!1;const u=new Uint8Array(l),f=new Uint8Array(o);for(var m=0;m<u.length;m++)if(u[m]!=f[m])return!1;return!0}byteLength(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)?i.byteLength:-1}arrayBufferViewToBuffer(i){return this.toArrayBuffer(i)}concat(i){const a=i.reduce((u,f)=>u+f.byteLength,0),l=new Uint8Array(a);let o=0;for(const u of i){const f=this.toBuffer(u);l.set(f,o),o+=f.byteLength}return l.buffer}sha256(i){const a=$i(this.toBuffer(i));return this.toArrayBuffer(a)}hmacSha256(i,a){const l=Bl(this.toBuffer(a),this.toBuffer(i));return this.toArrayBuffer(l)}},Va=new ja,Ai=function(i,a){var l="aes",o=256,u="cbc",f=16;function m(I){if(I.algorithm==="aes"&&I.mode==="cbc"){if(I.keyLength===128||I.keyLength===256)return;throw new Error("Unsupported key length "+I.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function p(I){return I.replace("_","/").replace("-","+")}function R(I){return I instanceof S}class S{constructor(B,Q,X,ae){this.algorithm=B,this.keyLength=Q,this.mode=X,this.key=ae}}class k{static getDefaultParams(B){var Q;if(!B.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof B.key=="string"?Q=a.toArrayBuffer(a.base64Decode(p(B.key))):B.key instanceof ArrayBuffer?Q=B.key:Q=a.toArrayBuffer(B.key);var X=B.algorithm||l,ae=Q.byteLength*8,Ce=B.mode||u,Le=new S(X,ae,Ce,Q);if(B.keyLength&&B.keyLength!==Le.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+B.keyLength+" was specified, but the key actually has length "+Le.keyLength);return m(Le),Le}static async generateRandomKey(B){try{return i.getRandomArrayBuffer((B||o)/8)}catch(Q){throw new w("Failed to generate random key: "+Q.message,400,5e4,Q)}}static getCipher(B,Q){var X,ae=R(B)?B:this.getDefaultParams(B);return{cipherParams:ae,cipher:new L(ae,(X=B.iv)!=null?X:null,Q)}}}k.CipherParams=S;class L{constructor(B,Q,X){if(this.logger=X,!crypto.subtle)throw isSecureContext?new Error("Crypto operations are not possible since the browsers SubtleCrypto class is unavailable (reason unknown)."):new Error("Crypto operations are is not possible since the current environment is a non-secure context and hence the browsers SubtleCrypto class is not available.");this.algorithm=B.algorithm+"-"+String(B.keyLength)+"-"+B.mode,this.webCryptoAlgorithm=B.algorithm+"-"+B.mode,this.key=a.toArrayBuffer(B.key),this.iv=Q?a.toArrayBuffer(Q):null}concat(B,Q){const X=new ArrayBuffer(B.byteLength+Q.byteLength),ae=new DataView(X),Ce=new DataView(a.toArrayBuffer(B));for(let qe=0;qe<Ce.byteLength;qe++)ae.setInt8(qe,Ce.getInt8(qe));const Le=new DataView(a.toArrayBuffer(Q));for(let qe=0;qe<Le.byteLength;qe++)ae.setInt8(Ce.byteLength+qe,Le.getInt8(qe));return X}async encrypt(B){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.encrypt()","");const Q=await this.getIv(),X=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["encrypt"]),ae=await crypto.subtle.encrypt({name:this.webCryptoAlgorithm,iv:Q},X,B);return this.concat(Q,ae)}async decrypt(B){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.decrypt()","");const Q=a.toArrayBuffer(B),X=Q.slice(0,f),ae=Q.slice(f),Ce=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["decrypt"]);return crypto.subtle.decrypt({name:this.webCryptoAlgorithm,iv:X},Ce,ae)}async getIv(){if(this.iv){var B=this.iv;return this.iv=null,B}const Q=await i.getRandomArrayBuffer(f);return a.toArrayBuffer(Q)}}return k},vt=(i=>(i[i.REQ_SEND=0]="REQ_SEND",i[i.REQ_RECV=1]="REQ_RECV",i[i.REQ_RECV_POLL=2]="REQ_RECV_POLL",i[i.REQ_RECV_STREAM=3]="REQ_RECV_STREAM",i))(vt||{}),Wt=vt;function ql(){return new w("No HTTP request plugin provided. Provide at least one of the FetchRequest or XHRRequest plugins.",400,4e4)}var Ia,Oo=(Ia=class{constructor(i){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1;var a;this.client=i??null;const l=i?.options.connectivityCheckUrl||re.connectivityCheckUrl,o=(a=i?.options.connectivityCheckParams)!=null?a:null,u=!i?.options.connectivityCheckUrl,f=fe(fe({},Oo.bundledRequestImplementations),i?._additionalHTTPRequestImplementations),m=f.XHRRequest,p=f.FetchRequest,R=!!(m||p);if(!R)throw ql();N.Config.xhrSupported&&m?(this.supportsAuthHeaders=!0,this.Request=async function(S,k,L,I,B){return new Promise(Q=>{var X;const ae=m.createRequest(k,L,I,B,Wt.REQ_SEND,(X=i&&i.options.timeouts)!=null?X:null,this.logger,S);ae.once("complete",(Ce,Le,qe,oe,jt)=>Q({error:Ce,body:Le,headers:qe,unpacked:oe,statusCode:jt})),ae.exec()})},i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var S;h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+l);const k=await this.doUri(Fe.Get,l,null,null,o);let L=!1;return u?L=!k.error&&((S=k.body)==null?void 0:S.replace(/\n/,""))=="yes":L=!k.error&&bc(k.statusCode),h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+L),L}):N.Config.fetchSupported&&p?(this.supportsAuthHeaders=!0,this.Request=async(S,k,L,I,B)=>p(S,i??null,k,L,I,B),i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var S;h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+l);const k=await this.doUri(Fe.Get,l,null,null,null),L=!k.error&&((S=k.body)==null?void 0:S.replace(/\n/,""))=="yes";return h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+L),L}):this.Request=async()=>({error:R?new _e("no supported HTTP transports available",null,400):ql()})}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}async doUri(i,a,l,o,u){return this.Request?this.Request(i,a,l,u,o):{error:new _e("Request invoked before assigned to",null,500)}}shouldFallback(i){const a=i.statusCode;return a===408&&!i.code||a===400&&!i.code||a>=500&&a<=504}},Ia.methods=[Fe.Get,Fe.Delete,Fe.Post,Fe.Put,Fe.Patch],Ia.methodsWithoutBody=[Fe.Get,Fe.Delete],Ia.methodsWithBody=[Fe.Post,Fe.Put,Fe.Patch],Ia),Ro=Oo,Qe="ablyjs-storage-test",Xn=typeof Ra<"u"?Ra:typeof window<"u"?window:self,Ya=class{constructor(){try{Xn.sessionStorage.setItem(Qe,Qe),Xn.sessionStorage.removeItem(Qe),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{Xn.localStorage.setItem(Qe,Qe),Xn.localStorage.removeItem(Qe),this.localSupported=!0}catch{this.localSupported=!1}}get(i){return this._get(i,!1)}getSession(i){return this._get(i,!0)}remove(i){return this._remove(i,!1)}removeSession(i){return this._remove(i,!0)}set(i,a,l){return this._set(i,a,l,!1)}setSession(i,a,l){return this._set(i,a,l,!0)}_set(i,a,l,o){const u={value:a};return l&&(u.expires=Date.now()+l),this.storageInterface(o).setItem(i,JSON.stringify(u))}_get(i,a){if(a&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!a&&!this.localSupported)throw new Error("Local Storage not supported");const l=this.storageInterface(a).getItem(i);if(!l)return null;const o=JSON.parse(l);return o.expires&&o.expires<Date.now()?(this.storageInterface(a).removeItem(i),null):o.value}_remove(i,a){return this.storageInterface(a).removeItem(i)}storageInterface(i){return i?Xn.sessionStorage:Xn.localStorage}},ea=new Ya,We=bn(),ta=typeof EdgeRuntime=="string";typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&!ta&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function na(){const i=We.location;return!We.WebSocket||!i||!i.origin||i.origin.indexOf("http")>-1}function Vc(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}var To=We.navigator&&We.navigator.userAgent.toString(),Ic=We.location&&We.location.href,_o={agent:"browser",logTimestamps:!0,userAgent:To,currentUrl:Ic,binaryType:"arraybuffer",WebSocket:We.WebSocket,fetchSupported:!!We.fetch,xhrSupported:We.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,allowComet:na(),useProtocolHeartbeats:!0,supportsBinary:!!We.TextDecoder,preferBinary:!1,ArrayBuffer:We.ArrayBuffer,atob:We.atob,nextTick:typeof We.setImmediate<"u"?We.setImmediate.bind(We):function(i){setTimeout(i,0)},addEventListener:We.addEventListener,inspect:JSON.stringify,stringByteSize:function(i){return We.TextDecoder&&new We.TextEncoder().encode(i).length||i.length},TextEncoder:We.TextEncoder,TextDecoder:We.TextDecoder,getRandomArrayBuffer:async function(i){const a=new Uint8Array(i);return We.crypto.getRandomValues(a),a.buffer},isWebworker:Vc(),push:{platform:"browser",formFactor:"desktop",storage:ea}},Kn=_o;function zl(i){const a=[80015,80017,80030];return i.code?un.isTokenErr(i)?!1:a.includes(i.code)?!0:i.code>=4e4&&i.code<5e4:!1}function ia(i){return zl(i)?[Lt({action:F.ERROR,error:i})]:[Lt({action:F.DISCONNECTED,error:i})]}var Co=class extends Tn{constructor(i,a,l){super(i,a,l,!0),this.onAuthUpdated=o=>{this.authParams={access_token:o.token}},this.stream="stream"in l?l.stream:!0,this.sendRequest=null,this.recvRequest=null,this.pendingCallback=null,this.pendingItems=null}connect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","starting"),Tn.prototype.connect.call(this);const i=this.params,a=i.options,l=i.host||a.primaryDomain,o=re.getPort(a),u=a.tls?"https://":"http://";this.baseUri=u+l+":"+o+"/comet/";const f=this.baseUri+"connect";h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","uri: "+f),He(this.auth.getAuthParams(),(m,p)=>{if(m){this.disconnect(m);return}if(this.isDisposed)return;this.authParams=p;const R=this.params.getConnectParams(p);"stream"in R&&(this.stream=R.stream),h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","connectParams:"+Ta(R));let S=!1;const k=this.recvRequest=this.createRequest(f,null,R,null,this.stream?Wt.REQ_RECV_STREAM:Wt.REQ_RECV);k.on("data",L=>{this.recvRequest&&(S||(S=!0,this.emit("preconnect")),this.onData(L))}),k.on("complete",L=>{if(this.recvRequest||(L=L||new w("Request cancelled",80003,400)),this.recvRequest=null,!S&&!L&&(S=!0,this.emit("preconnect")),this.onActivity(),L){L.code?this.onData(ia(L)):this.disconnect(L);return}N.Config.nextTick(()=>{this.recv()})}),k.exec()})}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)}_requestCloseOrDisconnect(i){const a=i?this.closeUri:this.disconnectUri;if(a){const l=this.createRequest(a,null,this.authParams,null,Wt.REQ_SEND);l.on("complete",o=>{o&&(h.logAction(this.logger,h.LOG_ERROR,"CometTransport.request"+(i?"Close()":"Disconnect()"),"request returned err = "+De(o)),this.finish("disconnected",o))}),l.exec()}}dispose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",mt.disconnected()),N.Config.nextTick(()=>{this.emit("disposed")}))}onConnect(i){var a;if(this.isDisposed)return;const l=(a=i.connectionDetails)==null?void 0:a.connectionKey;Tn.prototype.onConnect.call(this,i);const o=this.baseUri+l;h.logAction(this.logger,h.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+o),this.sendUri=o+"/send",this.recvUri=o+"/recv",this.closeUri=o+"/close",this.disconnectUri=o+"/disconnect"}send(i){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(i);return}const a=this.pendingItems||[];a.push(i),this.pendingItems=null,this.sendItems(a)}sendAnyPending(){const i=this.pendingItems;i&&(this.pendingItems=null,this.sendItems(i))}sendItems(i){const a=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(i),Wt.REQ_SEND);a.on("complete",(l,o)=>{if(l&&h.logAction(this.logger,h.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+De(l)),this.sendRequest=null,l){l.code?this.onData(ia(l)):this.disconnect(l);return}o&&this.onData(o),this.pendingItems&&N.Config.nextTick(()=>{this.sendRequest||this.sendAnyPending()})}),a.exec()}recv(){if(this.recvRequest||!this.isConnected)return;const i=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?Wt.REQ_RECV_STREAM:Wt.REQ_RECV_POLL);i.on("data",a=>{this.onData(a)}),i.on("complete",a=>{if(this.recvRequest=null,this.onActivity(),a){a.code?this.onData(ia(a)):this.disconnect(a);return}N.Config.nextTick(()=>{this.recv()})}),i.exec()}onData(i){try{const a=this.decodeResponse(i);if(a&&a.length)for(let l=0;l<a.length;l++)this.onProtocolMessage(Ts(a[l],this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+a.stack)}}encodeRequest(i){return JSON.stringify(i)}decodeResponse(i){return typeof i=="string"?JSON.parse(i):i}},Pa=Co;function Eo(i,a){return il(ai(a)).includes("x-ably-errorcode")}function xs(i,a){if(Eo(i,a))return i.error&&w.fromValues(i.error)}var Gl=function(){},Mo=0,Qa={};function wo(i,a){return i.getResponseHeader&&i.getResponseHeader(a)}function Xa(i){return i.getResponseHeader&&(i.getResponseHeader("transfer-encoding")||!i.getResponseHeader("content-length"))}function No(i){const a=i.getAllResponseHeaders().trim().split(`\r
`),l={};for(let o=0;o<a.length;o++){const u=a[o].split(":").map(f=>f.trim());l[u[0].toLowerCase()]=u[1]}return l}var Uo=class Kd extends ot{constructor(a,l,o,u,f,m,p,R){super(p),o=o||{},o.rnd=rs(),this.uri=a+Ta(o),this.headers=l||{},this.body=u,this.method=R?R.toUpperCase():V(u)?"GET":"POST",this.requestMode=f,this.timeouts=m,this.timedOut=!1,this.requestComplete=!1,this.id=String(++Mo),Qa[this.id]=this}static createRequest(a,l,o,u,f,m,p,R){const S=m||re.TIMEOUTS;return new Kd(a,l,j(o),u,f,S,p,R)}complete(a,l,o,u,f){this.requestComplete||(this.requestComplete=!0,!a&&l&&this.emit("data",l),this.emit("complete",a,l,o,u,f),this.dispose())}abort(){this.dispose()}exec(){let a=this.headers;const l=this.requestMode==Wt.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,o=this.timer=setTimeout(()=>{this.timedOut=!0,f.abort()},l),u=this.method,f=this.xhr=new XMLHttpRequest,m=a.accept;let p=this.body,R="text";m?m.indexOf("application/x-msgpack")===0&&(R="arraybuffer"):a.accept="application/json",p&&(a["content-type"]||(a["content-type"]="application/json")).indexOf("application/json")>-1&&typeof p!="string"&&(p=JSON.stringify(p)),f.open(u,this.uri,!0),f.responseType=R,"authorization"in a&&(f.withCredentials=!0);for(const oe in a)f.setRequestHeader(oe,a[oe]);const S=(oe,jt,bt,la)=>{var Ti;let Wa=jt+" (event type: "+oe.type+")";(Ti=this==null?void 0:this.xhr)!=null&&Ti.statusText&&(Wa+=", current statusText is "+this.xhr.statusText),h.logAction(this.logger,h.LOG_ERROR,"Request.on"+oe.type+"()",Wa),this.complete(new _e(Wa,bt,la))};f.onerror=oe=>{S(oe,"XHR error occurred",null,400)},f.onabort=oe=>{this.timedOut?S(oe,"Request aborted due to request timeout expiring",null,408):S(oe,"Request cancelled",null,400)},f.ontimeout=oe=>{S(oe,"Request timed out",null,408)};let k,L,I,B=0,Q=!1;const X=()=>{if(clearTimeout(o),I=L<400,L==204){this.complete(null,null,null,null,L);return}k=this.requestMode==Wt.REQ_RECV_STREAM&&I&&Xa(f)},ae=()=>{let oe;try{const bt=wo(f,"content-type");if(bt?bt.indexOf("application/json")>=0:f.responseType=="text"){const Ti=f.responseType==="arraybuffer"?N.BufferUtils.utf8Decode(f.response):String(f.responseText);Ti.length?oe=JSON.parse(Ti):oe=Ti,Q=!0}else oe=f.response;oe.response!==void 0?(L=oe.statusCode,I=L<400,a=oe.headers,oe=oe.response):a=No(f)}catch(bt){this.complete(new _e("Malformed response body from server: "+bt.message,null,400));return}if(I||Array.isArray(oe)){this.complete(null,oe,a,Q,L);return}let jt=xs(oe,a);jt||(jt=new _e("Error response received from server: "+L+" body was: "+N.Config.inspect(oe),null,L)),this.complete(jt,oe,a,Q,L)};function Ce(){const oe=f.responseText,jt=oe.length-1;let bt,la;for(;B<jt&&(bt=oe.indexOf(`
`,B))>-1;)la=oe.slice(B,bt),B=bt+1,Le(la)}const Le=oe=>{try{oe=JSON.parse(oe)}catch(jt){this.complete(new _e("Malformed response body from server: "+jt.message,null,400));return}this.emit("data",oe)},qe=()=>{Ce(),this.streamComplete=!0,N.Config.nextTick(()=>{this.complete()})};f.onreadystatechange=()=>{const oe=f.readyState;oe<3||f.status!==0&&(L===void 0&&(L=f.status,X()),oe==3&&k?Ce():oe==4&&(k?qe():ae()))},f.send(p)}dispose(){const a=this.xhr;if(a){a.onreadystatechange=a.onerror=a.onabort=a.ontimeout=Gl,this.xhr=null;const l=this.timer;l&&(clearTimeout(l),this.timer=null),this.requestComplete||a.abort()}delete Qa[this.id]}},kn=Uo,Ds=Ot.XhrPolling,Hl=class extends Pa{constructor(i,a,l){super(i,a,l),this.shortName=Ds,l.stream=!1,this.shortName=Ds}static isAvailable(){return!!(N.Config.xhrSupported&&N.Config.allowComet)}toString(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected}createRequest(i,a,l,o,u){return kn.createRequest(i,a,l,o,u,this.timeouts,this.logger)}},Zn=Hl,Jn=["xhr_polling"],Ka={order:Jn,bundledImplementations:{web_socket:Rt,xhr_polling:Zn}},jl=Ka,Vl={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",wsConnectivityCheckUrl:"wss://ws-up.ably-realtime.com",defaultTransports:[Ot.XhrPolling,Ot.WebSocket]},Za=Vl;function Ja(i){if(i===void 0)return"undefined";let a,l;if(i instanceof ArrayBuffer?(l="ArrayBuffer",a=new DataView(i)):i instanceof DataView&&(l="DataView",a=i),!a)return JSON.stringify(i);const o=[];for(let u=0;u<i.byteLength;u++){if(u>20){o.push("...");break}let f=a.getUint8(u).toString(16);f.length===1&&(f="0"+f),o.push(f)}return"<"+l+" "+o.join(" ")+">"}function aa(i,a,l){for(let o=0,u=l.length;o<u;o++){const f=l.charCodeAt(o);if(f<128){i.setUint8(a++,f>>>0&127|0);continue}if(f<2048){i.setUint8(a++,f>>>6&31|192),i.setUint8(a++,f>>>0&63|128);continue}if(f<65536){i.setUint8(a++,f>>>12&15|224),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}if(f<1114112){i.setUint8(a++,f>>>18&7|240),i.setUint8(a++,f>>>12&63|128),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}throw new Error("bad codepoint "+f)}}function Il(i,a,l){let o="";for(let u=a,f=a+l;u<f;u++){const m=i.getUint8(u);if((m&128)===0){o+=String.fromCharCode(m);continue}if((m&224)===192){o+=String.fromCharCode((m&15)<<6|i.getUint8(++u)&63);continue}if((m&240)===224){o+=String.fromCharCode((m&15)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}if((m&248)===240){o+=String.fromCharCode((m&7)<<18|(i.getUint8(++u)&63)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}throw new Error("Invalid byte "+m.toString(16))}return o}function Wn(i){let a=0;for(let l=0,o=i.length;l<o;l++){const u=i.charCodeAt(l);if(u<128){a+=1;continue}if(u<2048){a+=2;continue}if(u<65536){a+=3;continue}if(u<1114112){a+=4;continue}throw new Error("bad codepoint "+u)}return a}function ks(i,a){const l=$n(i,a);if(l===0)return;const o=new ArrayBuffer(l),u=new DataView(o);return nn(i,u,0,a),o}var Ls=65536*65536,Bs=1/Ls;function Yl(i,a){return a=a||0,i.getInt32(a)*Ls+i.getUint32(a+4)}function Fn(i,a){return a=a||0,i.getUint32(a)*Ls+i.getUint32(a+4)}function ge(i,a,l){l<9223372036854776e3?(i.setInt32(a,Math.floor(l*Bs)),i.setInt32(a+4,l&-1)):(i.setUint32(a,2147483647),i.setUint32(a+4,2147483647))}function Be(i,a,l){l<18446744073709552e3?(i.setUint32(a,Math.floor(l*Bs)),i.setInt32(a+4,l&-1)):(i.setUint32(a,4294967295),i.setUint32(a+4,4294967295))}var lt=class{constructor(i,a){this.map=l=>{const o={};for(let u=0;u<l;u++){const f=this.parse();o[f]=this.parse()}return o},this.bin=l=>{const o=new ArrayBuffer(l);return new Uint8Array(o).set(new Uint8Array(this.view.buffer,this.offset,l),0),this.offset+=l,o},this.buf=this.bin,this.str=l=>{const o=Il(this.view,this.offset,l);return this.offset+=l,o},this.array=l=>{const o=new Array(l);for(let u=0;u<l;u++)o[u]=this.parse();return o},this.ext=l=>(this.offset+=l,{type:this.view.getInt8(this.offset),data:this.buf(l)}),this.parse=()=>{const l=this.view.getUint8(this.offset);let o,u;if((l&128)===0)return this.offset++,l;if((l&240)===128)return u=l&15,this.offset++,this.map(u);if((l&240)===144)return u=l&15,this.offset++,this.array(u);if((l&224)===160)return u=l&31,this.offset++,this.str(u);if((l&224)===224)return o=this.view.getInt8(this.offset),this.offset++,o;switch(l){case 192:return this.offset++,null;case 193:this.offset++;return;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(u);case 197:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(u);case 198:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(u);case 199:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.ext(u);case 200:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.ext(u);case 201:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.ext(u);case 202:return o=this.view.getFloat32(this.offset+1),this.offset+=5,o;case 203:return o=this.view.getFloat64(this.offset+1),this.offset+=9,o;case 204:return o=this.view.getUint8(this.offset+1),this.offset+=2,o;case 205:return o=this.view.getUint16(this.offset+1),this.offset+=3,o;case 206:return o=this.view.getUint32(this.offset+1),this.offset+=5,o;case 207:return o=Fn(this.view,this.offset+1),this.offset+=9,o;case 208:return o=this.view.getInt8(this.offset+1),this.offset+=2,o;case 209:return o=this.view.getInt16(this.offset+1),this.offset+=3,o;case 210:return o=this.view.getInt32(this.offset+1),this.offset+=5,o;case 211:return o=Yl(this.view,this.offset+1),this.offset+=9,o;case 212:return u=1,this.offset++,this.ext(u);case 213:return u=2,this.offset++,this.ext(u);case 214:return u=4,this.offset++,this.ext(u);case 215:return u=8,this.offset++,this.ext(u);case 216:return u=16,this.offset++,this.ext(u);case 217:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.str(u);case 218:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.str(u);case 219:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.str(u);case 220:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.array(u);case 221:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.array(u);case 222:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.map(u);case 223:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.map(u)}throw new Error("Unknown type 0x"+l.toString(16))},this.offset=a||0,this.view=i}};function qs(i){const a=new DataView(i),l=new lt(a),o=l.parse();if(l.offset!==i.byteLength)throw new Error(i.byteLength-l.offset+" trailing bytes");return o}function Oi(i,a){return Object.keys(i).filter(function(l){const o=i[l],u=typeof o;return(!a||o!=null)&&(u!=="function"||!!o.toJSON)})}function nn(i,a,l,o){const u=typeof i;if(typeof i=="string"){const f=Wn(i);if(f<32)return a.setUint8(l,f|160),aa(a,l+1,i),1+f;if(f<256)return a.setUint8(l,217),a.setUint8(l+1,f),aa(a,l+2,i),2+f;if(f<65536)return a.setUint8(l,218),a.setUint16(l+1,f),aa(a,l+3,i),3+f;if(f<4294967296)return a.setUint8(l,219),a.setUint32(l+1,f),aa(a,l+5,i),5+f}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const f=i.byteLength;if(f<256)return a.setUint8(l,196),a.setUint8(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+2),2+f;if(f<65536)return a.setUint8(l,197),a.setUint16(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+3),3+f;if(f<4294967296)return a.setUint8(l,198),a.setUint32(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+5),5+f}if(typeof i=="number"){if(Math.floor(i)!==i)return a.setUint8(l,203),a.setFloat64(l+1,i),9;if(i>=0){if(i<128)return a.setUint8(l,i),1;if(i<256)return a.setUint8(l,204),a.setUint8(l+1,i),2;if(i<65536)return a.setUint8(l,205),a.setUint16(l+1,i),3;if(i<4294967296)return a.setUint8(l,206),a.setUint32(l+1,i),5;if(i<18446744073709552e3)return a.setUint8(l,207),Be(a,l+1,i),9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return a.setInt8(l,i),1;if(i>=-128)return a.setUint8(l,208),a.setInt8(l+1,i),2;if(i>=-32768)return a.setUint8(l,209),a.setInt16(l+1,i),3;if(i>=-2147483648)return a.setUint8(l,210),a.setInt32(l+1,i),5;if(i>=-9223372036854776e3)return a.setUint8(l,211),ge(a,l+1,i),9;throw new Error("Number too small -0x"+(-i).toString(16).substr(1))}if(u==="undefined")return o?0:(a.setUint8(l,212),a.setUint8(l+1,0),a.setUint8(l+2,0),3);if(i===null)return o?0:(a.setUint8(l,192),1);if(u==="boolean")return a.setUint8(l,i?195:194),1;if(typeof i.toJSON=="function")return nn(i.toJSON(),a,l,o);if(u==="object"){let f,m=0,p;const R=Array.isArray(i);if(R?f=i.length:(p=Oi(i,o),f=p.length),f<16?(a.setUint8(l,f|(R?144:128)),m=1):f<65536?(a.setUint8(l,R?220:222),a.setUint16(l+1,f),m=3):f<4294967296&&(a.setUint8(l,R?221:223),a.setUint32(l+1,f),m=5),R)for(let S=0;S<f;S++)m+=nn(i[S],a,l+m,o);else if(p)for(let S=0;S<f;S++){const k=p[S];m+=nn(k,a,l+m),m+=nn(i[k],a,l+m,o)}return m}if(u==="function")return 0;throw new Error("Unknown type "+u)}function $n(i,a){const l=typeof i;if(l==="string"){const o=Wn(i);if(o<32)return 1+o;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const o=i.byteLength;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(typeof i=="number"){if(Math.floor(i)!==i)return 9;if(i>=0){if(i<128)return 1;if(i<256)return 2;if(i<65536)return 3;if(i<4294967296)return 5;if(i<18446744073709552e3)return 9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return 1;if(i>=-128)return 2;if(i>=-32768)return 3;if(i>=-2147483648)return 5;if(i>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+i.toString(16).substr(1))}if(l==="boolean")return 1;if(i===null)return a?0:1;if(i===void 0)return a?0:3;if(typeof i.toJSON=="function")return $n(i.toJSON(),a);if(l==="object"){let o,u=0;if(Array.isArray(i)){o=i.length;for(let f=0;f<o;f++)u+=$n(i[f],a)}else{const f=Oi(i,a);o=f.length;for(let m=0;m<o;m++){const p=f[m];u+=$n(p)+$n(i[p],a)}}if(o<16)return 1+u;if(o<65536)return 3+u;if(o<4294967296)return 5+u;throw new Error("Array or object too long 0x"+o.toString(16))}if(l==="function")return 0;throw new Error("Unknown type "+l)}var Ri={encode:ks,decode:qs,inspect:Ja,utf8Write:aa,utf8Read:Il,utf8ByteCount:Wn};function sa(i,a){return!!a.get("x-ably-errorcode")}function Yc(i,a){if(sa(i,a))return i.error&&w.fromValues(i.error)}function it(i){const a={};return i.forEach((l,o)=>{a[o]=l}),a}async function Pl(i,a,l,o,u,f){const m=new Headers(o||{}),p=i?i.toUpperCase():V(f)?"GET":"POST",R=new AbortController;let S;const k=new Promise(B=>{S=setTimeout(()=>{R.abort(),B({error:new _e("Request timed out",null,408)})},a?a.options.timeouts.httpRequestTimeout:re.TIMEOUTS.httpRequestTimeout)}),L={method:p,headers:m,body:f,signal:R.signal};N.Config.isWebworker||(L.credentials=m.has("authorization")?"include":"same-origin");const I=(async()=>{try{const B=new URLSearchParams(u||{});B.set("rnd",rs());const Q=l+"?"+B,X=await bn().fetch(Q,L);if(clearTimeout(S),X.status==204)return{error:null,statusCode:X.status};const ae=X.headers.get("Content-Type");let Ce;ae&&ae.indexOf("application/x-msgpack")>-1?Ce=await X.arrayBuffer():ae&&ae.indexOf("application/json")>-1?Ce=await X.json():Ce=await X.text();const Le=!!ae&&ae.indexOf("application/x-msgpack")===-1,qe=it(X.headers);return X.ok?{error:null,body:Ce,headers:qe,unpacked:Le,statusCode:X.status}:{error:Yc(Ce,X.headers)||new _e("Error response received from server: "+X.status+" body was: "+N.Config.inspect(Ce),null,X.status),body:Ce,headers:qe,unpacked:Le,statusCode:X.status}}catch(B){return clearTimeout(S),{error:B}}})();return Promise.race([k,I])}var Ql={XHRRequest:kn,FetchRequest:Pl},Xl=Ai(Kn,Va);N.Crypto=Xl,N.BufferUtils=Va,N.Http=Ro,N.Config=Kn,N.Transports=jl,N.WebStorage=ea;for(const i of[Cs,wn])i.Crypto=Xl,i._MsgPack=Ri;Ro.bundledRequestImplementations=Ql,h.initLogHandlers(),N.Defaults=Dr(Za),N.Config.agent&&(N.Defaults.agent+=" "+N.Config.agent);var xo={ErrorInfo:w,Rest:Cs,Realtime:wn,msgpack:Ri,makeProtocolMessageFromDeserialized:Cl};if(typeof T.exports=="object"&&typeof $=="object"){var Pc=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of Object.getOwnPropertyNames(a))!Object.prototype.hasOwnProperty.call(i,u)&&u!==l&&Object.defineProperty(i,u,{get:()=>a[u],enumerable:!(o=Object.getOwnPropertyDescriptor(a,u))||o.enumerable});return i};T.exports=Pc(T.exports,$)}return T.exports})}(pc)),pc.exports}var pm=mm();const ym={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"}]},vm=H=>{const[ie,$]=be.useState(null),[T,te]=be.useState(null),[ue,Re]=be.useState([]),[Oe,Z]=be.useState(!1),[D,W]=be.useState(!1),[Te,ye]=be.useState(!0),[fe,Ue]=be.useState(!1),[At,Ke]=be.useState(null),Ee=be.useRef(null),ut=be.useRef(null),Me=be.useRef(null),N=be.useRef([]),pe=be.useCallback(E=>{const j=new RTCPeerConnection(ym);j.onicecandidate=K=>{if(K.candidate&&Me.current){const v={type:"ice-candidate",candidate:K.candidate.toJSON(),from:E};Me.current.publish("webrtc-signal",v)}},j.ontrack=K=>{console.log("Remote track received"),te(K.streams[0])},j.ondatachannel=K=>{console.log("Data channel received"),ut.current=K.channel,tt(K.channel)},j.onconnectionstatechange=()=>{const K=j.connectionState;console.log(`Connection state changed to: ${K}`),K==="connected"?Z(!0):K==="failed"||K==="closed"?(Z(!1),console.log("Peer connection failed or closed."),w()):K==="disconnected"&&(Z(!1),console.log("Peer connection temporarily disconnected."))},Ee.current=j},[]),tt=E=>{E.onopen=()=>console.log("Data channel is open"),E.onmessage=j=>{const K=JSON.parse(j.data);Re(v=>[...v,{...K,sender:"peer"}])},E.onclose=()=>console.log("Data channel is closed")},ft=be.useCallback(async(E,j)=>{if(!Ee.current)return null;try{const K=await navigator.mediaDevices.getUserMedia({video:E,audio:j});return $(K),ye(E),K.getTracks().forEach(v=>Ee.current?.addTrack(v,K)),Ke(null),K}catch(K){return console.error("Error accessing media devices.",K),K.name==="NotFoundError"?Ke("No camera or microphone found. Voice and video calls are disabled."):K.name==="NotAllowedError"?Ke("Permission for camera and microphone was denied. Voice and video calls are disabled."):Ke("Could not access camera or microphone."),$(null),null}},[]),nt=be.useCallback(async E=>{if(!Ee.current||!Me.current)return;ut.current=Ee.current.createDataChannel("chat"),tt(ut.current);const j=await Ee.current.createOffer();await Ee.current.setLocalDescription(j);const K={type:"offer",sdp:j.sdp,from:E};await Me.current.publish("webrtc-signal",K)},[]),xe=be.useCallback(async E=>{if(Ee.current)if(Ee.current.remoteDescription)try{await Ee.current.addIceCandidate(new RTCIceCandidate(E))}catch(j){console.error("Error adding received ICE candidate",j)}else N.current.push(E)},[]),tn=be.useCallback(async(E,j)=>{if(!Ee.current||!Me.current)return;await Ee.current.setRemoteDescription({type:"offer",sdp:E});for(const G of N.current)await xe(G);N.current=[];const K=await Ee.current.createAnswer();await Ee.current.setLocalDescription(K);const v={type:"answer",sdp:K.sdp,from:j};await Me.current.publish("webrtc-signal",v)},[xe]),h=be.useCallback(async E=>{if(Ee.current){await Ee.current.setRemoteDescription({type:"answer",sdp:E});for(const j of N.current)await xe(j);N.current=[]}},[xe]),Ze=be.useCallback(async E=>{if(!H)return;Ue(!0);const j=H.auth.clientId;pe(j),await ft(!0,!0);const K=H.channels.get(`p2p-chat:${E}`);Me.current=K,await K.subscribe("webrtc-signal",V=>{const P=V.data;if(P.from!==j)switch(P.type){case"offer":tn(P.sdp,j);break;case"answer":h(P.sdp);break;case"ice-candidate":xe(P.candidate);break}}),K.presence.subscribe("enter",async V=>{V.clientId!==j&&j<V.clientId&&Ee.current?.signalingState==="stable"&&(console.log(`Peer ${V.clientId} entered. Creating offer.`),await nt(j))}),await K.presence.enter();const G=(await K.presence.get()).find(V=>V.clientId!==j);G&&j<G.clientId&&Ee.current?.signalingState==="stable"&&(console.log(`Peer ${G.clientId} was already present. Creating offer.`),await nt(j)),Ue(!1)},[H,pe,ft,nt,tn,h,xe]),cn=be.useCallback(E=>{if(ut.current?.readyState==="open"){const j={id:Date.now().toString(),text:E,timestamp:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})};ut.current.send(JSON.stringify(j)),Re(K=>[...K,{...j,sender:"me"}])}},[]),w=be.useCallback(()=>{Me.current?.presence.leave(),Me.current?.unsubscribe(),Me.current=null,Ee.current?.close(),ie?.getTracks().forEach(E=>E.stop()),T?.getTracks().forEach(E=>E.stop()),Ee.current=null,$(null),te(null),Z(!1),Ue(!1),Re([]),Ke(null),N.current=[],console.log("Call ended and resources cleaned up.")},[ie,T]),_e=be.useCallback(()=>{ie&&(ie.getAudioTracks().forEach(E=>{E.enabled=!E.enabled}),W(E=>!E))},[ie]),U=be.useCallback(()=>{if(ie){const E=!Te;ie.getVideoTracks().forEach(j=>{j.enabled=E}),ye(E)}},[ie,Te]);return be.useEffect(()=>()=>w(),[]),{localStream:ie,remoteStream:T,messages:ue,isConnected:Oe,isMuted:D,isVideoEnabled:Te,isJoining:fe,mediaError:At,joinRoom:Ze,sendMessage:cn,hangUp:w,toggleMute:_e,toggleVideo:U}},en=({path:H,className:ie="w-6 h-6"})=>Y.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:ie,"aria-hidden":"true",children:Y.jsx("path",{fillRule:"evenodd",d:H,clipRule:"evenodd"})}),xt={logo:"M17 7h-4v2h4c1.65 0 3 1.35 3 3s-1.35 3-3 3h-4v2h4c2.76 0 5-2.24 5-5s-2.24-5-5-5zm-6 8H7c-1.65 0-3-1.35-3-3s1.35-3 3-3h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-2zM8 11h8v2H8v-2z",chat:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z",phone:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z",hangup:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.57c-2.83-1.35-5.21-3.73-6.56-6.56l1.57-1.57c.28-.28.36-.67.24-1.01-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.01c-.55 0-.99.45-.99.99 0 9.32 7.53 16.85 16.85 16.85.54 0 .99-.45.99-.99v-3.54c0-.54-.45-.99-.99-.99z",video:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z",videoOff:"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.22 0 .42-.08.58-.2L20.73 21 22 19.73 3.27 2z",send:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",mic:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5-3c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z",micOff:"M10.8 4.9c0-.66.54-1.2 1.2-1.2.66 0 1.2.54 1.2 1.2l-.01 3.18 1.66 1.66 0-.02c0-1.55-1.11-2.82-2.6-3.15v-1.1c0-.41-.34-.75-.75-.75s-.75.34-.75.75v1.1C9.01 4.58 8 5.85 8 7.4v.02l1.66 1.66L10.8 4.9zM19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zM3.41 1.86L2 3.27 4.73 6H5c0 3.53 2.61 6.43 6 6.92V17h2v-4.08c.12 0 .23-.01.35-.02l2.54 2.54c-.69.44-1.46.77-2.28.98V17h2v-1.08c1.99-.43 3.61-1.78 4.29-3.48l1.45 1.45L20.73 15l-17.32-17.14z"},bm=({onJoin:H,isJoining:ie})=>{const[$,T]=be.useState(""),te=ue=>{ue.preventDefault(),$.trim()&&!ie&&H($.trim())};return Y.jsxs("div",{className:"p-6 bg-dark-surface rounded-lg shadow-lg max-w-md mx-auto text-center",children:[Y.jsx(en,{path:xt.logo,className:"w-16 h-16 text-blue-400 mx-auto mb-4"}),Y.jsx("h2",{className:"text-2xl font-bold text-dark-text-primary mb-2",children:"Connect with a Peer"}),Y.jsx("p",{className:"text-dark-text-secondary mb-6",children:"Enter a unique room name to start or join a call. Share the same room name with your friend."}),Y.jsxs("form",{onSubmit:te,className:"flex flex-col gap-4",children:[Y.jsx("input",{type:"text",value:$,onChange:ue=>T(ue.target.value),placeholder:"Enter room name...",className:"w-full bg-gray-900 border border-dark-border rounded-lg py-3 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500 text-dark-text-primary transition","aria-label":"Room name"}),Y.jsx("button",{type:"submit",disabled:ie||!$.trim(),className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded-lg transition-colors disabled:bg-gray-500 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:ie?Y.jsxs(Y.Fragment,{children:[Y.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[Y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),Y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Joining..."]}):"Join Room"})]})]})},Sm=({messages:H,sendMessage:ie})=>{const[$,T]=be.useState(""),te=be.useRef(null),ue=()=>{te.current?.scrollIntoView({behavior:"smooth"})};be.useEffect(ue,[H]);const Re=Oe=>{Oe.preventDefault(),$.trim()&&(ie($.trim()),T(""))};return Y.jsxs("div",{className:"flex flex-col h-full bg-dark-surface rounded-b-lg",children:[Y.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-4",children:[H.map(Oe=>Y.jsx("div",{className:`flex items-end gap-2 ${Oe.sender==="me"?"justify-end":"justify-start"}`,children:Y.jsxs("div",{className:`max-w-xs lg:max-w-md px-4 py-2 rounded-2xl ${Oe.sender==="me"?"bg-blue-600 text-white rounded-br-none":"bg-gray-600 text-dark-text-primary rounded-bl-none"}`,children:[Y.jsx("p",{className:"text-sm",children:Oe.text}),Y.jsx("p",{className:"text-xs text-right mt-1 opacity-70",children:Oe.timestamp})]})},Oe.id)),Y.jsx("div",{ref:te})]}),Y.jsx("div",{className:"p-4 border-t border-dark-border",children:Y.jsxs("form",{onSubmit:Re,className:"flex items-center gap-4",children:[Y.jsx("input",{type:"text",value:$,onChange:Oe=>T(Oe.target.value),placeholder:"Type a message...",className:"flex-1 bg-gray-700 border border-gray-600 rounded-full py-2 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500 text-dark-text-primary"}),Y.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full p-3 transition-colors disabled:bg-gray-500 disabled:cursor-not-allowed","aria-label":"Send message",children:Y.jsx(en,{path:xt.send,className:"w-6 h-6"})})]})})]})},Am=({localStream:H,remoteStream:ie,isMuted:$,isVideoEnabled:T,onToggleMute:te,onToggleVideo:ue,onHangUp:Re})=>{const Oe=be.useRef(null),Z=be.useRef(null);return be.useEffect(()=>{Oe.current&&H&&(Oe.current.srcObject=H)},[H]),be.useEffect(()=>{Z.current&&ie&&(Z.current.srcObject=ie)},[ie]),Y.jsxs("div",{className:"relative h-full w-full bg-black rounded-b-lg overflow-hidden",children:[Y.jsx("video",{ref:Z,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),!ie&&Y.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900",children:Y.jsxs("div",{className:"text-center",children:[Y.jsx(en,{path:xt.video,className:"w-16 h-16 mx-auto text-gray-500"}),Y.jsx("p",{className:"mt-2 text-dark-text-secondary",children:"Waiting for peer to connect..."})]})}),Y.jsx("video",{ref:Oe,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute bottom-4 right-4 w-1/4 max-w-[200px] rounded-lg border-2 border-dark-border shadow-lg",style:{display:H?"block":"none"}}),!H&&Y.jsx("div",{className:"absolute bottom-4 right-4 w-1/4 max-w-[200px] h-auto aspect-video rounded-lg border-2 border-dark-border bg-gray-800 flex items-center justify-center",children:Y.jsx(en,{path:xt.videoOff,className:"w-8 h-8 text-gray-500"})}),Y.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-black bg-opacity-50 flex justify-center items-center gap-4",children:[Y.jsx("button",{onClick:te,className:`p-3 rounded-full transition-colors ${$?"bg-red-600":"bg-gray-600 hover:bg-gray-500"}`,"aria-label":$?"Unmute":"Mute",children:Y.jsx(en,{path:$?xt.micOff:xt.mic})}),Y.jsx("button",{onClick:ue,className:`p-3 rounded-full transition-colors ${T?"bg-gray-600 hover:bg-gray-500":"bg-red-600"}`,"aria-label":T?"Disable Video":"Enable Video",children:Y.jsx(en,{path:T?xt.video:xt.videoOff})}),Y.jsx("button",{onClick:Re,className:"p-3 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Hang up",children:Y.jsx(en,{path:xt.hangup})})]})]})},Om=({isMuted:H,onToggleMute:ie,onHangUp:$})=>Y.jsxs("div",{className:"flex flex-col h-full w-full items-center justify-center bg-dark-surface rounded-b-lg p-8",children:[Y.jsxs("div",{className:"text-center",children:[Y.jsxs("div",{className:"relative inline-block",children:[Y.jsx("div",{className:"w-40 h-40 rounded-full bg-gray-700 flex items-center justify-center",children:Y.jsx(en,{path:xt.phone,className:"w-20 h-20 text-blue-400"})}),Y.jsx("span",{className:"absolute bottom-0 right-0 block h-8 w-8 rounded-full bg-green-500 border-4 border-dark-surface animate-pulse"})]}),Y.jsx("h2",{className:"text-2xl font-bold mt-6 text-dark-text-primary",children:"Voice Call in Progress"}),Y.jsx("p",{className:"text-dark-text-secondary mt-2",children:"You are connected to your peer."})]}),Y.jsxs("div",{className:"mt-12 flex justify-center items-center gap-6",children:[Y.jsx("button",{onClick:ie,className:`p-4 rounded-full transition-colors ${H?"bg-red-600":"bg-gray-600 hover:bg-gray-500"}`,"aria-label":H?"Unmute":"Mute",children:Y.jsx(en,{path:H?xt.micOff:xt.mic,className:"w-8 h-8"})}),Y.jsx("button",{onClick:$,className:"p-4 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Hang up",children:Y.jsx(en,{path:xt.hangup,className:"w-8 h-8"})})]})]}),Rm=()=>{const[H,ie]=be.useState("chat"),[$,T]=be.useState(null),[te,ue]=be.useState(null);be.useEffect(()=>{const nt="I2tDaw.8aYbrA:AL3WVoe9M-LCuy9Fr4b14LuVnsoVUmQuj1t_6_2-a4k",xe=new pm.Realtime({key:nt,clientId:`user-${Math.random().toString(36).substring(2,9)}`});return xe.connection.on("connected",()=>{T(xe),ue(null)}),xe.connection.on("failed",tn=>{ue(`Ably connection failed: ${tn.reason}`)}),()=>{xe.close()}},[]);const{localStream:Re,remoteStream:Oe,messages:Z,isConnected:D,isMuted:W,isVideoEnabled:Te,isJoining:ye,mediaError:fe,joinRoom:Ue,sendMessage:At,hangUp:Ke,toggleMute:Ee,toggleVideo:ut}=vm($),Me=()=>{Ke(),ie("chat")},N=nt=>{$&&Ue(nt)},pe=be.useMemo(()=>{if(te)return Y.jsx("div",{className:"p-8 text-center text-red-400",children:te});if(!$||!D&&!ye)return Y.jsx("div",{className:"p-4 md:p-8 flex items-center justify-center h-full",children:Y.jsx(bm,{onJoin:N,isJoining:ye})});if(ye&&!Re)return Y.jsxs("div",{className:"p-8 text-center text-dark-text-secondary",children:[Y.jsxs("div",{className:"flex items-center justify-center gap-2",children:[Y.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[Y.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),Y.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Joining room..."]}),fe&&Y.jsx("p",{className:"mt-4 text-sm text-yellow-400",children:fe})]});switch(H){case"video":return Y.jsx(Am,{localStream:Re,remoteStream:Oe,isMuted:W,isVideoEnabled:Te,onToggleMute:Ee,onToggleVideo:ut,onHangUp:Me});case"voice":return Y.jsx(Om,{isMuted:W,onToggleMute:Ee,onHangUp:Me});case"chat":default:return Y.jsx(Sm,{messages:Z,sendMessage:At})}},[$,te,D,ye,H,Re,Oe,W,Te,Ee,ut,Me,Z,At,N,fe]),tt=ye?"Joining...":D?"Connected":"Disconnected",ft=ye?"bg-yellow-500":D?"bg-green-500":"bg-red-500";return Y.jsx("div",{className:"antialiased min-h-screen flex flex-col items-center justify-center p-4 bg-dark-bg",children:Y.jsxs("div",{className:"w-full max-w-4xl h-[90vh] flex flex-col bg-dark-surface rounded-lg shadow-2xl border border-dark-border",children:[Y.jsxs("header",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:[Y.jsxs("div",{className:"flex items-center gap-3",children:[Y.jsx(en,{path:xt.logo,className:"w-8 h-8 text-blue-400"}),Y.jsx("h1",{className:"text-xl font-bold text-dark-text-primary",children:"P2P Connect"})]}),Y.jsx("div",{className:`absolute top-5 left-1/2 -translate-x-1/2 px-3 py-1 rounded-full text-xs font-medium text-white ${ft}`,children:tt}),Y.jsxs("nav",{className:"flex items-center gap-2",children:[Y.jsx("button",{onClick:()=>ie("chat"),disabled:!D,className:`p-2 rounded-full transition-colors ${H==="chat"?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:Y.jsx(en,{path:xt.chat})}),Y.jsx("button",{onClick:()=>ie("voice"),disabled:!D||!!fe,title:fe??(D?"Switch to voice call":"Connect to enable"),className:`p-2 rounded-full transition-colors ${H==="voice"?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:Y.jsx(en,{path:xt.phone})}),Y.jsx("button",{onClick:()=>ie("video"),disabled:!D||!!fe,title:fe??(D?"Switch to video call":"Connect to enable"),className:`p-2 rounded-full transition-colors ${H==="video"?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:Y.jsx(en,{path:xt.video})})]})]}),Y.jsxs("main",{className:"flex-1 overflow-hidden relative",children:[fe&&D&&Y.jsx("div",{className:"absolute top-0 left-0 right-0 p-2 bg-yellow-600 text-white text-center text-sm z-10 animate-pulse",children:Y.jsx("p",{children:fe})}),pe]})]})})},Zd=document.getElementById("root");if(!Zd)throw new Error("Could not find root element to mount to");const Tm=dm.createRoot(Zd);Tm.render(Y.jsx(sm.StrictMode,{children:Y.jsx(Rm,{})}));
