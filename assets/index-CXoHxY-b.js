(function(){const oe=document.createElement("link").relList;if(oe&&oe.supports&&oe.supports("modulepreload"))return;for(const te of document.querySelectorAll('link[rel="modulepreload"]'))A(te);new MutationObserver(te=>{for(const W of te)if(W.type==="childList")for(const Ne of W.addedNodes)Ne.tagName==="LINK"&&Ne.rel==="modulepreload"&&A(Ne)}).observe(document,{childList:!0,subtree:!0});function ce(te){const W={};return te.integrity&&(W.integrity=te.integrity),te.referrerPolicy&&(W.referrerPolicy=te.referrerPolicy),te.crossOrigin==="use-credentials"?W.credentials="include":te.crossOrigin==="anonymous"?W.credentials="omit":W.credentials="same-origin",W}function A(te){if(te.ep)return;te.ep=!0;const W=ce(te);fetch(te.href,W)}})();var Ha=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function gf(k){return k&&k.__esModule&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k}var Wu={exports:{}},Rr={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kd;function sp(){if(kd)return Rr;kd=1;var k=Symbol.for("react.transitional.element"),oe=Symbol.for("react.fragment");function ce(A,te,W){var Ne=null;if(W!==void 0&&(Ne=""+W),te.key!==void 0&&(Ne=""+te.key),"key"in te){W={};for(var ze in te)ze!=="key"&&(W[ze]=te[ze])}else W=te;return te=W.ref,{$$typeof:k,type:A,key:Ne,ref:te!==void 0?te:null,props:W}}return Rr.Fragment=oe,Rr.jsx=ce,Rr.jsxs=ce,Rr}var Dd;function lp(){return Dd||(Dd=1,Wu.exports=sp()),Wu.exports}var M=lp(),Fu={exports:{}},De={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ld;function rp(){if(Ld)return De;Ld=1;var k=Symbol.for("react.transitional.element"),oe=Symbol.for("react.portal"),ce=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),te=Symbol.for("react.profiler"),W=Symbol.for("react.consumer"),Ne=Symbol.for("react.context"),ze=Symbol.for("react.forward_ref"),ne=Symbol.for("react.suspense"),L=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),Le=Symbol.iterator;function we(v){return v===null||typeof v!="object"?null:(v=Le&&v[Le]||v["@@iterator"],typeof v=="function"?v:null)}var he={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Te=Object.assign,Fe={};function le(v,B,Y){this.props=v,this.context=B,this.refs=Fe,this.updater=Y||he}le.prototype.isReactComponent={},le.prototype.setState=function(v,B){if(typeof v!="object"&&typeof v!="function"&&v!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,v,B,"setState")},le.prototype.forceUpdate=function(v){this.updater.enqueueForceUpdate(this,v,"forceUpdate")};function dt(){}dt.prototype=le.prototype;function At(v,B,Y){this.props=v,this.context=B,this.refs=Fe,this.updater=Y||he}var Pe=At.prototype=new dt;Pe.constructor=At,Te(Pe,le.prototype),Pe.isPureReactComponent=!0;var x=Array.isArray,de={H:null,A:null,T:null,S:null,V:null},Se=Object.prototype.hasOwnProperty;function ie(v,B,Y,Q,se,Re){return Y=Re.ref,{$$typeof:k,type:v,key:B,ref:Y!==void 0?Y:null,props:Re}}function xe(v,B){return ie(v.type,B,void 0,void 0,void 0,v.props)}function je(v){return typeof v=="object"&&v!==null&&v.$$typeof===k}function bt(v){var B={"=":"=0",":":"=2"};return"$"+v.replace(/[=:]/g,function(Y){return B[Y]})}var h=/\/+/g;function Ve(v,B){return typeof v=="object"&&v!==null&&v.key!=null?bt(""+v.key):B.toString(36)}function Tt(){}function w(v){switch(v.status){case"fulfilled":return v.value;case"rejected":throw v.reason;default:switch(typeof v.status=="string"?v.then(Tt,Tt):(v.status="pending",v.then(function(B){v.status==="pending"&&(v.status="fulfilled",v.value=B)},function(B){v.status==="pending"&&(v.status="rejected",v.reason=B)})),v.status){case"fulfilled":return v.value;case"rejected":throw v.reason}}throw v}function Ce(v,B,Y,Q,se){var Re=typeof v;(Re==="undefined"||Re==="boolean")&&(v=null);var ge=!1;if(v===null)ge=!0;else switch(Re){case"bigint":case"string":case"number":ge=!0;break;case"object":switch(v.$$typeof){case k:case oe:ge=!0;break;case F:return ge=v._init,Ce(ge(v._payload),B,Y,Q,se)}}if(ge)return se=se(v),ge=Q===""?"."+Ve(v,0):Q,x(se)?(Y="",ge!=null&&(Y=ge.replace(h,"$&/")+"/"),Ce(se,B,Y,"",function(gt){return gt})):se!=null&&(je(se)&&(se=xe(se,Y+(se.key==null||v&&v.key===se.key?"":(""+se.key).replace(h,"$&/")+"/")+ge)),B.push(se)),1;ge=0;var ct=Q===""?".":Q+":";if(x(v))for(var _e=0;_e<v.length;_e++)Q=v[_e],Re=ct+Ve(Q,_e),ge+=Ce(Q,B,Y,Re,se);else if(_e=we(v),typeof _e=="function")for(v=_e.call(v),_e=0;!(Q=v.next()).done;)Q=Q.value,Re=ct+Ve(Q,_e++),ge+=Ce(Q,B,Y,Re,se);else if(Re==="object"){if(typeof v.then=="function")return Ce(w(v),B,Y,Q,se);throw B=String(v),Error("Objects are not valid as a React child (found: "+(B==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":B)+"). If you meant to render a collection of children, use an array instead.")}return ge}function N(v,B,Y){if(v==null)return v;var Q=[],se=0;return Ce(v,Q,"","",function(Re){return B.call(Y,Re,se++)}),Q}function U(v){if(v._status===-1){var B=v._result;B=B(),B.then(function(Y){(v._status===0||v._status===-1)&&(v._status=1,v._result=Y)},function(Y){(v._status===0||v._status===-1)&&(v._status=2,v._result=Y)}),v._status===-1&&(v._status=0,v._result=B)}if(v._status===1)return v._result.default;throw v._result}var ae=typeof reportError=="function"?reportError:function(v){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var B=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof v=="object"&&v!==null&&typeof v.message=="string"?String(v.message):String(v),error:v});if(!window.dispatchEvent(B))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",v);return}console.error(v)};function pe(){}return De.Children={map:N,forEach:function(v,B,Y){N(v,function(){B.apply(this,arguments)},Y)},count:function(v){var B=0;return N(v,function(){B++}),B},toArray:function(v){return N(v,function(B){return B})||[]},only:function(v){if(!je(v))throw Error("React.Children.only expected to receive a single React element child.");return v}},De.Component=le,De.Fragment=ce,De.Profiler=te,De.PureComponent=At,De.StrictMode=A,De.Suspense=ne,De.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=de,De.__COMPILER_RUNTIME={__proto__:null,c:function(v){return de.H.useMemoCache(v)}},De.cache=function(v){return function(){return v.apply(null,arguments)}},De.cloneElement=function(v,B,Y){if(v==null)throw Error("The argument must be a React element, but you passed "+v+".");var Q=Te({},v.props),se=v.key,Re=void 0;if(B!=null)for(ge in B.ref!==void 0&&(Re=void 0),B.key!==void 0&&(se=""+B.key),B)!Se.call(B,ge)||ge==="key"||ge==="__self"||ge==="__source"||ge==="ref"&&B.ref===void 0||(Q[ge]=B[ge]);var ge=arguments.length-2;if(ge===1)Q.children=Y;else if(1<ge){for(var ct=Array(ge),_e=0;_e<ge;_e++)ct[_e]=arguments[_e+2];Q.children=ct}return ie(v.type,se,void 0,void 0,Re,Q)},De.createContext=function(v){return v={$$typeof:Ne,_currentValue:v,_currentValue2:v,_threadCount:0,Provider:null,Consumer:null},v.Provider=v,v.Consumer={$$typeof:W,_context:v},v},De.createElement=function(v,B,Y){var Q,se={},Re=null;if(B!=null)for(Q in B.key!==void 0&&(Re=""+B.key),B)Se.call(B,Q)&&Q!=="key"&&Q!=="__self"&&Q!=="__source"&&(se[Q]=B[Q]);var ge=arguments.length-2;if(ge===1)se.children=Y;else if(1<ge){for(var ct=Array(ge),_e=0;_e<ge;_e++)ct[_e]=arguments[_e+2];se.children=ct}if(v&&v.defaultProps)for(Q in ge=v.defaultProps,ge)se[Q]===void 0&&(se[Q]=ge[Q]);return ie(v,Re,void 0,void 0,null,se)},De.createRef=function(){return{current:null}},De.forwardRef=function(v){return{$$typeof:ze,render:v}},De.isValidElement=je,De.lazy=function(v){return{$$typeof:F,_payload:{_status:-1,_result:v},_init:U}},De.memo=function(v,B){return{$$typeof:L,type:v,compare:B===void 0?null:B}},De.startTransition=function(v){var B=de.T,Y={};de.T=Y;try{var Q=v(),se=de.S;se!==null&&se(Y,Q),typeof Q=="object"&&Q!==null&&typeof Q.then=="function"&&Q.then(pe,ae)}catch(Re){ae(Re)}finally{de.T=B}},De.unstable_useCacheRefresh=function(){return de.H.useCacheRefresh()},De.use=function(v){return de.H.use(v)},De.useActionState=function(v,B,Y){return de.H.useActionState(v,B,Y)},De.useCallback=function(v,B){return de.H.useCallback(v,B)},De.useContext=function(v){return de.H.useContext(v)},De.useDebugValue=function(){},De.useDeferredValue=function(v,B){return de.H.useDeferredValue(v,B)},De.useEffect=function(v,B,Y){var Q=de.H;if(typeof Y=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Q.useEffect(v,B)},De.useId=function(){return de.H.useId()},De.useImperativeHandle=function(v,B,Y){return de.H.useImperativeHandle(v,B,Y)},De.useInsertionEffect=function(v,B){return de.H.useInsertionEffect(v,B)},De.useLayoutEffect=function(v,B){return de.H.useLayoutEffect(v,B)},De.useMemo=function(v,B){return de.H.useMemo(v,B)},De.useOptimistic=function(v,B){return de.H.useOptimistic(v,B)},De.useReducer=function(v,B,Y){return de.H.useReducer(v,B,Y)},De.useRef=function(v){return de.H.useRef(v)},De.useState=function(v){return de.H.useState(v)},De.useSyncExternalStore=function(v,B,Y){return de.H.useSyncExternalStore(v,B,Y)},De.useTransition=function(){return de.H.useTransition()},De.version="19.1.0",De}var Bd;function pf(){return Bd||(Bd=1,Fu.exports=rp()),Fu.exports}var I=pf();const op=gf(I);var $u={exports:{}},Cr={},ef={exports:{}},tf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jd;function cp(){return jd||(jd=1,function(k){function oe(N,U){var ae=N.length;N.push(U);e:for(;0<ae;){var pe=ae-1>>>1,v=N[pe];if(0<te(v,U))N[pe]=U,N[ae]=v,ae=pe;else break e}}function ce(N){return N.length===0?null:N[0]}function A(N){if(N.length===0)return null;var U=N[0],ae=N.pop();if(ae!==U){N[0]=ae;e:for(var pe=0,v=N.length,B=v>>>1;pe<B;){var Y=2*(pe+1)-1,Q=N[Y],se=Y+1,Re=N[se];if(0>te(Q,ae))se<v&&0>te(Re,Q)?(N[pe]=Re,N[se]=ae,pe=se):(N[pe]=Q,N[Y]=ae,pe=Y);else if(se<v&&0>te(Re,ae))N[pe]=Re,N[se]=ae,pe=se;else break e}}return U}function te(N,U){var ae=N.sortIndex-U.sortIndex;return ae!==0?ae:N.id-U.id}if(k.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var W=performance;k.unstable_now=function(){return W.now()}}else{var Ne=Date,ze=Ne.now();k.unstable_now=function(){return Ne.now()-ze}}var ne=[],L=[],F=1,Le=null,we=3,he=!1,Te=!1,Fe=!1,le=!1,dt=typeof setTimeout=="function"?setTimeout:null,At=typeof clearTimeout=="function"?clearTimeout:null,Pe=typeof setImmediate<"u"?setImmediate:null;function x(N){for(var U=ce(L);U!==null;){if(U.callback===null)A(L);else if(U.startTime<=N)A(L),U.sortIndex=U.expirationTime,oe(ne,U);else break;U=ce(L)}}function de(N){if(Fe=!1,x(N),!Te)if(ce(ne)!==null)Te=!0,Se||(Se=!0,Ve());else{var U=ce(L);U!==null&&Ce(de,U.startTime-N)}}var Se=!1,ie=-1,xe=5,je=-1;function bt(){return le?!0:!(k.unstable_now()-je<xe)}function h(){if(le=!1,Se){var N=k.unstable_now();je=N;var U=!0;try{e:{Te=!1,Fe&&(Fe=!1,At(ie),ie=-1),he=!0;var ae=we;try{t:{for(x(N),Le=ce(ne);Le!==null&&!(Le.expirationTime>N&&bt());){var pe=Le.callback;if(typeof pe=="function"){Le.callback=null,we=Le.priorityLevel;var v=pe(Le.expirationTime<=N);if(N=k.unstable_now(),typeof v=="function"){Le.callback=v,x(N),U=!0;break t}Le===ce(ne)&&A(ne),x(N)}else A(ne);Le=ce(ne)}if(Le!==null)U=!0;else{var B=ce(L);B!==null&&Ce(de,B.startTime-N),U=!1}}break e}finally{Le=null,we=ae,he=!1}U=void 0}}finally{U?Ve():Se=!1}}}var Ve;if(typeof Pe=="function")Ve=function(){Pe(h)};else if(typeof MessageChannel<"u"){var Tt=new MessageChannel,w=Tt.port2;Tt.port1.onmessage=h,Ve=function(){w.postMessage(null)}}else Ve=function(){dt(h,0)};function Ce(N,U){ie=dt(function(){N(k.unstable_now())},U)}k.unstable_IdlePriority=5,k.unstable_ImmediatePriority=1,k.unstable_LowPriority=4,k.unstable_NormalPriority=3,k.unstable_Profiling=null,k.unstable_UserBlockingPriority=2,k.unstable_cancelCallback=function(N){N.callback=null},k.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):xe=0<N?Math.floor(1e3/N):5},k.unstable_getCurrentPriorityLevel=function(){return we},k.unstable_next=function(N){switch(we){case 1:case 2:case 3:var U=3;break;default:U=we}var ae=we;we=U;try{return N()}finally{we=ae}},k.unstable_requestPaint=function(){le=!0},k.unstable_runWithPriority=function(N,U){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var ae=we;we=N;try{return U()}finally{we=ae}},k.unstable_scheduleCallback=function(N,U,ae){var pe=k.unstable_now();switch(typeof ae=="object"&&ae!==null?(ae=ae.delay,ae=typeof ae=="number"&&0<ae?pe+ae:pe):ae=pe,N){case 1:var v=-1;break;case 2:v=250;break;case 5:v=1073741823;break;case 4:v=1e4;break;default:v=5e3}return v=ae+v,N={id:F++,callback:U,priorityLevel:N,startTime:ae,expirationTime:v,sortIndex:-1},ae>pe?(N.sortIndex=ae,oe(L,N),ce(ne)===null&&N===ce(L)&&(Fe?(At(ie),ie=-1):Fe=!0,Ce(de,ae-pe))):(N.sortIndex=v,oe(ne,N),Te||he||(Te=!0,Se||(Se=!0,Ve()))),N},k.unstable_shouldYield=bt,k.unstable_wrapCallback=function(N){var U=we;return function(){var ae=we;we=U;try{return N.apply(this,arguments)}finally{we=ae}}}}(tf)),tf}var zd;function up(){return zd||(zd=1,ef.exports=cp()),ef.exports}var nf={exports:{}},an={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qd;function fp(){if(qd)return an;qd=1;var k=pf();function oe(ne){var L="https://react.dev/errors/"+ne;if(1<arguments.length){L+="?args[]="+encodeURIComponent(arguments[1]);for(var F=2;F<arguments.length;F++)L+="&args[]="+encodeURIComponent(arguments[F])}return"Minified React error #"+ne+"; visit "+L+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function ce(){}var A={d:{f:ce,r:function(){throw Error(oe(522))},D:ce,C:ce,L:ce,m:ce,X:ce,S:ce,M:ce},p:0,findDOMNode:null},te=Symbol.for("react.portal");function W(ne,L,F){var Le=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:te,key:Le==null?null:""+Le,children:ne,containerInfo:L,implementation:F}}var Ne=k.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function ze(ne,L){if(ne==="font")return"";if(typeof L=="string")return L==="use-credentials"?L:""}return an.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,an.createPortal=function(ne,L){var F=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!L||L.nodeType!==1&&L.nodeType!==9&&L.nodeType!==11)throw Error(oe(299));return W(ne,L,null,F)},an.flushSync=function(ne){var L=Ne.T,F=A.p;try{if(Ne.T=null,A.p=2,ne)return ne()}finally{Ne.T=L,A.p=F,A.d.f()}},an.preconnect=function(ne,L){typeof ne=="string"&&(L?(L=L.crossOrigin,L=typeof L=="string"?L==="use-credentials"?L:"":void 0):L=null,A.d.C(ne,L))},an.prefetchDNS=function(ne){typeof ne=="string"&&A.d.D(ne)},an.preinit=function(ne,L){if(typeof ne=="string"&&L&&typeof L.as=="string"){var F=L.as,Le=ze(F,L.crossOrigin),we=typeof L.integrity=="string"?L.integrity:void 0,he=typeof L.fetchPriority=="string"?L.fetchPriority:void 0;F==="style"?A.d.S(ne,typeof L.precedence=="string"?L.precedence:void 0,{crossOrigin:Le,integrity:we,fetchPriority:he}):F==="script"&&A.d.X(ne,{crossOrigin:Le,integrity:we,fetchPriority:he,nonce:typeof L.nonce=="string"?L.nonce:void 0})}},an.preinitModule=function(ne,L){if(typeof ne=="string")if(typeof L=="object"&&L!==null){if(L.as==null||L.as==="script"){var F=ze(L.as,L.crossOrigin);A.d.M(ne,{crossOrigin:F,integrity:typeof L.integrity=="string"?L.integrity:void 0,nonce:typeof L.nonce=="string"?L.nonce:void 0})}}else L==null&&A.d.M(ne)},an.preload=function(ne,L){if(typeof ne=="string"&&typeof L=="object"&&L!==null&&typeof L.as=="string"){var F=L.as,Le=ze(F,L.crossOrigin);A.d.L(ne,F,{crossOrigin:Le,integrity:typeof L.integrity=="string"?L.integrity:void 0,nonce:typeof L.nonce=="string"?L.nonce:void 0,type:typeof L.type=="string"?L.type:void 0,fetchPriority:typeof L.fetchPriority=="string"?L.fetchPriority:void 0,referrerPolicy:typeof L.referrerPolicy=="string"?L.referrerPolicy:void 0,imageSrcSet:typeof L.imageSrcSet=="string"?L.imageSrcSet:void 0,imageSizes:typeof L.imageSizes=="string"?L.imageSizes:void 0,media:typeof L.media=="string"?L.media:void 0})}},an.preloadModule=function(ne,L){if(typeof ne=="string")if(L){var F=ze(L.as,L.crossOrigin);A.d.m(ne,{as:typeof L.as=="string"&&L.as!=="script"?L.as:void 0,crossOrigin:F,integrity:typeof L.integrity=="string"?L.integrity:void 0})}else A.d.m(ne)},an.requestFormReset=function(ne){A.d.r(ne)},an.unstable_batchedUpdates=function(ne,L){return ne(L)},an.useFormState=function(ne,L,F){return Ne.H.useFormState(ne,L,F)},an.useFormStatus=function(){return Ne.H.useHostTransitionStatus()},an.version="19.1.0",an}var Hd;function hp(){if(Hd)return nf.exports;Hd=1;function k(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(k)}catch(oe){console.error(oe)}}return k(),nf.exports=fp(),nf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gd;function dp(){if(Gd)return Cr;Gd=1;var k=up(),oe=pf(),ce=hp();function A(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function te(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function W(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Ne(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function ze(e){if(W(e)!==e)throw Error(A(188))}function ne(e){var t=e.alternate;if(!t){if(t=W(e),t===null)throw Error(A(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(r===null)break;var c=r.alternate;if(c===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===c.child){for(c=r.child;c;){if(c===n)return ze(r),e;if(c===s)return ze(r),t;c=c.sibling}throw Error(A(188))}if(n.return!==s.return)n=r,s=c;else{for(var d=!1,g=r.child;g;){if(g===n){d=!0,n=r,s=c;break}if(g===s){d=!0,s=r,n=c;break}g=g.sibling}if(!d){for(g=c.child;g;){if(g===n){d=!0,n=c,s=r;break}if(g===s){d=!0,s=c,n=r;break}g=g.sibling}if(!d)throw Error(A(189))}}if(n.alternate!==s)throw Error(A(190))}if(n.tag!==3)throw Error(A(188));return n.stateNode.current===n?e:t}function L(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=L(e),t!==null)return t;e=e.sibling}return null}var F=Object.assign,Le=Symbol.for("react.element"),we=Symbol.for("react.transitional.element"),he=Symbol.for("react.portal"),Te=Symbol.for("react.fragment"),Fe=Symbol.for("react.strict_mode"),le=Symbol.for("react.profiler"),dt=Symbol.for("react.provider"),At=Symbol.for("react.consumer"),Pe=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),de=Symbol.for("react.suspense"),Se=Symbol.for("react.suspense_list"),ie=Symbol.for("react.memo"),xe=Symbol.for("react.lazy"),je=Symbol.for("react.activity"),bt=Symbol.for("react.memo_cache_sentinel"),h=Symbol.iterator;function Ve(e){return e===null||typeof e!="object"?null:(e=h&&e[h]||e["@@iterator"],typeof e=="function"?e:null)}var Tt=Symbol.for("react.client.reference");function w(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Tt?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Te:return"Fragment";case le:return"Profiler";case Fe:return"StrictMode";case de:return"Suspense";case Se:return"SuspenseList";case je:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case he:return"Portal";case Pe:return(e.displayName||"Context")+".Provider";case At:return(e._context.displayName||"Context")+".Consumer";case x:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case ie:return t=e.displayName||null,t!==null?t:w(e.type)||"Memo";case xe:t=e._payload,e=e._init;try{return w(e(t))}catch{}}return null}var Ce=Array.isArray,N=oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=ce.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ae={pending:!1,data:null,method:null,action:null},pe=[],v=-1;function B(e){return{current:e}}function Y(e){0>v||(e.current=pe[v],pe[v]=null,v--)}function Q(e,t){v++,pe[v]=e.current,e.current=t}var se=B(null),Re=B(null),ge=B(null),ct=B(null);function _e(e,t){switch(Q(ge,t),Q(Re,e),Q(se,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?rd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=rd(t),e=od(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}Y(se),Q(se,e)}function gt(){Y(se),Y(Re),Y(ge)}function _t(e){e.memoizedState!==null&&Q(ct,e);var t=se.current,n=od(t,e.type);t!==n&&(Q(Re,e),Q(se,n))}function sn(e){Re.current===e&&(Y(se),Y(Re)),ct.current===e&&(Y(ct),br._currentValue=ae)}var qt=Object.prototype.hasOwnProperty,V=k.unstable_scheduleCallback,P=k.unstable_cancelCallback,Be=k.unstable_shouldYield,ut=k.unstable_requestPaint,Ze=k.unstable_now,Xe=k.unstable_getCurrentPriorityLevel,Ht=k.unstable_ImmediatePriority,$t=k.unstable_UserBlockingPriority,Ue=k.unstable_NormalPriority,An=k.unstable_LowPriority,un=k.unstable_IdlePriority,zn=k.log,Ti=k.unstable_setDisableYieldValue,Tn=null,Z=null;function J(e){if(typeof zn=="function"&&Ti(e),Z&&typeof Z.setStrictMode=="function")try{Z.setStrictMode(Tn,e)}catch{}}var K=Math.clz32?Math.clz32:Ee,pt=Math.log,Ie=Math.LN2;function Ee(e){return e>>>=0,e===0?32:31-(pt(e)/Ie|0)|0}var wt=256,Gt=4194304;function Qt(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Ga(e,t,n){var s=e.pendingLanes;if(s===0)return 0;var r=0,c=e.suspendedLanes,d=e.pingedLanes;e=e.warmLanes;var g=s&134217727;return g!==0?(s=g&~c,s!==0?r=Qt(s):(d&=g,d!==0?r=Qt(d):n||(n=g&~e,n!==0&&(r=Qt(n))))):(g=s&~c,g!==0?r=Qt(g):d!==0?r=Qt(d):n||(n=s&~e,n!==0&&(r=Qt(n)))),r===0?0:t!==0&&t!==r&&(t&c)===0&&(c=r&-r,n=t&-t,c>=n||c===32&&(n&4194048)!==0)?t:r}function Wi(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function ms(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ul(){var e=wt;return wt<<=1,(wt&4194048)===0&&(wt=256),e}function Va(){var e=Gt;return Gt<<=1,(Gt&62914560)===0&&(Gt=4194304),e}function xt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Fi(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function wr(e,t,n,s,r,c){var d=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var g=e.entanglements,y=e.expirationTimes,C=e.hiddenUpdates;for(n=d&~n;0<n;){var D=31-K(n),G=1<<D;g[D]=0,y[D]=-1;var _=C[D];if(_!==null)for(C[D]=null,D=0;D<_.length;D++){var E=_[D];E!==null&&(E.lane&=-536870913)}n&=~G}s!==0&&xr(e,s,0),c!==0&&r===0&&e.tag!==0&&(e.suspendedLanes|=c&~(d&~t))}function xr(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-K(t);e.entangledLanes|=t,e.entanglements[s]=e.entanglements[s]|1073741824|n&4194090}function fn(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-K(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}function fl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function hl(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function dl(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:Ed(e.type))}function Nr(e,t){var n=U.p;try{return U.p=e,t()}finally{U.p=n}}var qn=Math.random().toString(36).slice(2),Lt="__reactFiber$"+qn,Zt="__reactProps$"+qn,$i="__reactContainer$"+qn,ys="__reactEvents$"+qn,vc="__reactListeners$"+qn,gl="__reactHandles$"+qn,Ur="__reactResources$"+qn,Ia="__reactMarker$"+qn;function pl(e){delete e[Lt],delete e[Zt],delete e[ys],delete e[vc],delete e[gl]}function Hn(e){var t=e[Lt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[$i]||n[Lt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=hd(e);e!==null;){if(n=e[Lt])return n;e=hd(e)}return t}e=n,n=e.parentNode}return null}function Ri(e){if(e=e[Lt]||e[$i]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function ni(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(A(33))}function ea(e){var t=e[Ur];return t||(t=e[Ur]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function Nt(e){e[Ia]=!0}var be=new Set,kr={};function Ci(e,t){ii(e,t),ii(e+"Capture",t)}function ii(e,t){for(kr[e]=t,e=0;e<t.length;e++)be.add(t[e])}var Dr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),mt={},ml={};function bc(e){return qt.call(ml,e)?!0:qt.call(mt,e)?!1:Dr.test(e)?ml[e]=!0:(mt[e]=!0,!1)}function _i(e,t,n){if(bc(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function ta(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Gn(e,t,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+s)}}var yl,vl;function na(e){if(yl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);yl=t&&t[1]||"",vl=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+yl+e+vl}var vs=!1;function bs(e,t){if(!e||vs)return"";vs=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var G=function(){throw Error()};if(Object.defineProperty(G.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(G,[])}catch(E){var _=E}Reflect.construct(e,[],G)}else{try{G.call()}catch(E){_=E}e.call(G.prototype)}}else{try{throw Error()}catch(E){_=E}(G=e())&&typeof G.catch=="function"&&G.catch(function(){})}}catch(E){if(E&&_&&typeof E.stack=="string")return[E.stack,_.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var c=s.DetermineComponentFrameRoot(),d=c[0],g=c[1];if(d&&g){var y=d.split(`
`),C=g.split(`
`);for(r=s=0;s<y.length&&!y[s].includes("DetermineComponentFrameRoot");)s++;for(;r<C.length&&!C[r].includes("DetermineComponentFrameRoot");)r++;if(s===y.length||r===C.length)for(s=y.length-1,r=C.length-1;1<=s&&0<=r&&y[s]!==C[r];)r--;for(;1<=s&&0<=r;s--,r--)if(y[s]!==C[r]){if(s!==1||r!==1)do if(s--,r--,0>r||y[s]!==C[r]){var D=`
`+y[s].replace(" at new "," at ");return e.displayName&&D.includes("<anonymous>")&&(D=D.replace("<anonymous>",e.displayName)),D}while(1<=s&&0<=r);break}}}finally{vs=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?na(n):""}function Sc(e){switch(e.tag){case 26:case 27:case 5:return na(e.type);case 16:return na("Lazy");case 13:return na("Suspense");case 19:return na("SuspenseList");case 0:case 15:return bs(e.type,!1);case 11:return bs(e.type.render,!1);case 1:return bs(e.type,!0);case 31:return na("Activity");default:return""}}function bl(e){try{var t="";do t+=Sc(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function hn(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Lr(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Oc(e){var t=Lr(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(d){s=""+d,c.call(this,d)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Ss(e){e._valueTracker||(e._valueTracker=Oc(e))}function xn(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Lr(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function ia(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var aa=/[\n"\\]/g;function dn(e){return e.replace(aa,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function Sl(e,t,n,s,r,c,d,g){e.name="",d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"?e.type=d:e.removeAttribute("type"),t!=null?d==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+hn(t)):e.value!==""+hn(t)&&(e.value=""+hn(t)):d!=="submit"&&d!=="reset"||e.removeAttribute("value"),t!=null?Ol(e,d,hn(t)):n!=null?Ol(e,d,hn(n)):s!=null&&e.removeAttribute("value"),r==null&&c!=null&&(e.defaultChecked=!!c),r!=null&&(e.checked=r&&typeof r!="function"&&typeof r!="symbol"),g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"?e.name=""+hn(g):e.removeAttribute("name")}function Os(e,t,n,s,r,c,d,g){if(c!=null&&typeof c!="function"&&typeof c!="symbol"&&typeof c!="boolean"&&(e.type=c),t!=null||n!=null){if(!(c!=="submit"&&c!=="reset"||t!=null))return;n=n!=null?""+hn(n):"",t=t!=null?""+hn(t):n,g||t===e.value||(e.value=t),e.defaultValue=t}s=s??r,s=typeof s!="function"&&typeof s!="symbol"&&!!s,e.checked=g?e.checked:!!s,e.defaultChecked=!!s,d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.name=d)}function Ol(e,t,n){t==="number"&&ia(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function ai(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+hn(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,s&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Br(e,t,n){if(t!=null&&(t=""+hn(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+hn(n):""}function Et(e,t,n,s){if(t==null){if(s!=null){if(n!=null)throw Error(A(92));if(Ce(s)){if(1<s.length)throw Error(A(93));s=s[0]}n=s}n==null&&(n=""),t=n}n=hn(t),e.defaultValue=n,s=e.textContent,s===n&&s!==""&&s!==null&&(e.value=s)}function ue(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var jr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Kt(e,t,n){var s=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":s?e.setProperty(t,n):typeof n!="number"||n===0||jr.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function zr(e,t,n){if(t!=null&&typeof t!="object")throw Error(A(62));if(e=e.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="");for(var r in t)s=t[r],t.hasOwnProperty(r)&&n[r]!==s&&Kt(e,r,s)}else for(var c in t)t.hasOwnProperty(c)&&Kt(e,c,t[c])}function As(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ac=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ts(e){return qr.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Rs=null;function Ya(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ei=null,si=null;function Al(e){var t=Ri(e);if(t&&(e=t.stateNode)){var n=e[Zt]||null;e:switch(e=t.stateNode,t.type){case"input":if(Sl(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+dn(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=s[Zt]||null;if(!r)throw Error(A(90));Sl(s,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)s=n[t],s.form===e.form&&xn(s)}break e;case"textarea":Br(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&ai(e,!!n.multiple,t,!1)}}}var Pa=!1;function Tl(e,t,n){if(Pa)return e(t,n);Pa=!0;try{var s=e(t);return s}finally{if(Pa=!1,(Ei!==null||si!==null)&&(Ko(),Ei&&(t=Ei,e=si,si=Ei=null,Al(t),e)))for(t=0;t<e.length;t++)Al(e[t])}}function li(e,t){var n=e.stateNode;if(n===null)return null;var s=n[Zt]||null;if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(A(231,t,typeof n));return n}var gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ri=!1;if(gn)try{var Nn={};Object.defineProperty(Nn,"passive",{get:function(){ri=!0}}),window.addEventListener("test",Nn,Nn),window.removeEventListener("test",Nn,Nn)}catch{ri=!1}var Vn=null,Cs=null,_s=null;function Mi(){if(_s)return _s;var e,t=Cs,n=t.length,s,r="value"in Vn?Vn.value:Vn.textContent,c=r.length;for(e=0;e<n&&t[e]===r[e];e++);var d=n-e;for(s=1;s<=d&&t[n-s]===r[c-s];s++);return _s=r.slice(e,1<s?1-s:void 0)}function Xa(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Es(){return!0}function Hr(){return!1}function en(e){function t(n,s,r,c,d){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(n=e[g],this[g]=n?n(c):c[g]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?Es:Hr,this.isPropagationStopped=Hr,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Es)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Es)},persist:function(){},isPersistent:Es}),t}var it={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ms=en(it),Qa=F({},it,{view:0,detail:0}),Tc=en(Qa),Rl,ws,Za,ln=F({},Qa,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Un,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Za&&(Za&&e.type==="mousemove"?(Rl=e.screenX-Za.screenX,ws=e.screenY-Za.screenY):ws=Rl=0,Za=e),Rl)},movementY:function(e){return"movementY"in e?e.movementY:ws}}),Cl=en(ln),Rc=F({},ln,{dataTransfer:0}),xs=en(Rc),Cc=F({},Qa,{relatedTarget:0}),_l=en(Cc),_c=F({},it,{animationName:0,elapsedTime:0,pseudoElement:0}),Ec=en(_c),Mc=F({},it,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Gr=en(Mc),Vr=F({},it,{data:0}),Ir=en(Vr),wc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ka(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Pr[e])?!!t[e]:!1}function Un(){return Ka}var xc=F({},Qa,{key:function(e){if(e.key){var t=wc[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Xa(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Yr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Un,charCode:function(e){return e.type==="keypress"?Xa(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Xa(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nc=en(xc),Xr=F({},ln,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qr=en(Xr),Uc=F({},Qa,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Un}),Zr=en(Uc),kc=F({},it,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dc=en(kc),Lc=F({},ln,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Kr=en(Lc),Bc=F({},it,{newState:0,oldState:0}),El=en(Bc),Jr=[9,13,27,32],wi=gn&&"CompositionEvent"in window,pn=null;gn&&"documentMode"in document&&(pn=document.documentMode);var jc=gn&&"TextEvent"in window&&!pn,Wr=gn&&(!wi||pn&&8<pn&&11>=pn),Fr=" ",$r=!1;function eo(e,t){switch(e){case"keyup":return Jr.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function to(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var xi=!1;function zc(e,t){switch(e){case"compositionend":return to(t);case"keypress":return t.which!==32?null:($r=!0,Fr);case"textInput":return e=t.data,e===Fr&&$r?null:e;default:return null}}function no(e,t){if(xi)return e==="compositionend"||!wi&&eo(e,t)?(e=Mi(),_s=Cs=Vn=null,xi=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Wr&&t.locale!=="ko"?null:t.data;default:return null}}var qc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function io(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qc[e.type]:t==="textarea"}function Ml(e,t,n,s){Ei?si?si.push(s):si=[s]:Ei=s,t=tc(t,"onChange"),0<t.length&&(n=new Ms("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var sa=null,la=null;function ao(e){nd(e,0)}function Ja(e){var t=ni(e);if(xn(t))return e}function so(e,t){if(e==="change")return t}var lo=!1;if(gn){var wl;if(gn){var Ns="oninput"in document;if(!Ns){var Ni=document.createElement("div");Ni.setAttribute("oninput","return;"),Ns=typeof Ni.oninput=="function"}wl=Ns}else wl=!1;lo=wl&&(!document.documentMode||9<document.documentMode)}function ra(){sa&&(sa.detachEvent("onpropertychange",xl),la=sa=null)}function xl(e){if(e.propertyName==="value"&&Ja(la)){var t=[];Ml(t,la,e,Ya(e)),Tl(ao,t)}}function ro(e,t,n){e==="focusin"?(ra(),sa=t,la=n,sa.attachEvent("onpropertychange",xl)):e==="focusout"&&ra()}function oo(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Ja(la)}function co(e,t){if(e==="click")return Ja(t)}function Hc(e,t){if(e==="input"||e==="change")return Ja(t)}function Nl(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rn=typeof Object.is=="function"?Object.is:Nl;function oi(e,t){if(rn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!qt.call(t,r)||!rn(e[r],t[r]))return!1}return!0}function uo(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Us(e,t){var n=uo(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=uo(n)}}function Ul(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ul(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function tn(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=ia(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ia(e.document)}return t}function Wa(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var kl=gn&&"documentMode"in document&&11>=document.documentMode,oa=null,Dl=null,Ui=null,ks=!1;function fo(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ks||oa==null||oa!==ia(s)||(s=oa,"selectionStart"in s&&Wa(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Ui&&oi(Ui,s)||(Ui=s,s=tc(Dl,"onSelect"),0<s.length&&(t=new Ms("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=oa)))}function ki(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Di={animationend:ki("Animation","AnimationEnd"),animationiteration:ki("Animation","AnimationIteration"),animationstart:ki("Animation","AnimationStart"),transitionrun:ki("Transition","TransitionRun"),transitionstart:ki("Transition","TransitionStart"),transitioncancel:ki("Transition","TransitionCancel"),transitionend:ki("Transition","TransitionEnd")},Li={},ho={};gn&&(ho=document.createElement("div").style,"AnimationEvent"in window||(delete Di.animationend.animation,delete Di.animationiteration.animation,delete Di.animationstart.animation),"TransitionEvent"in window||delete Di.transitionend.transition);function ci(e){if(Li[e])return Li[e];if(!Di[e])return e;var t=Di[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ho)return Li[e]=t[n];return e}var ui=ci("animationend"),Ds=ci("animationiteration"),go=ci("animationstart"),po=ci("transitionrun"),mo=ci("transitionstart"),Gc=ci("transitioncancel"),yo=ci("transitionend"),vo=new Map,ca="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ca.push("scrollEnd");function Ut(e,t){vo.set(e,t),Ci(t,[e])}var bo=new WeakMap;function mn(e,t){if(typeof e=="object"&&e!==null){var n=bo.get(e);return n!==void 0?n:(t={value:e,source:t,stack:bl(t)},bo.set(e,t),t)}return{value:e,source:t,stack:bl(t)}}var kt=[],ua=0,Ll=0;function Ls(){for(var e=ua,t=Ll=ua=0;t<e;){var n=kt[t];kt[t++]=null;var s=kt[t];kt[t++]=null;var r=kt[t];kt[t++]=null;var c=kt[t];if(kt[t++]=null,s!==null&&r!==null){var d=s.pending;d===null?r.next=r:(r.next=d.next,d.next=r),s.pending=r}c!==0&&Bs(n,r,c)}}function In(e,t,n,s){kt[ua++]=e,kt[ua++]=t,kt[ua++]=n,kt[ua++]=s,Ll|=s,e.lanes|=s,e=e.alternate,e!==null&&(e.lanes|=s)}function Vt(e,t,n,s){return In(e,t,n,s),fi(e)}function fa(e,t){return In(e,null,null,t),fi(e)}function Bs(e,t,n){e.lanes|=n;var s=e.alternate;s!==null&&(s.lanes|=n);for(var r=!1,c=e.return;c!==null;)c.childLanes|=n,s=c.alternate,s!==null&&(s.childLanes|=n),c.tag===22&&(e=c.stateNode,e===null||e._visibility&1||(r=!0)),e=c,c=c.return;return e.tag===3?(c=e.stateNode,r&&t!==null&&(r=31-K(n),e=c.hiddenUpdates,s=e[r],s===null?e[r]=[t]:s.push(t),t.lane=n|536870912),c):null}function fi(e){if(50<fr)throw fr=0,Ou=null,Error(A(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Bi={};function Bl(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function on(e,t,n,s){return new Bl(e,t,n,s)}function Fa(e){return e=e.prototype,!(!e||!e.isReactComponent)}function Yn(e,t){var n=e.alternate;return n===null?(n=on(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function So(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function $a(e,t,n,s,r,c){var d=0;if(s=e,typeof e=="function")Fa(e)&&(d=1);else if(typeof e=="string")d=Xg(e,n,se.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case je:return e=on(31,n,t,r),e.elementType=je,e.lanes=c,e;case Te:return ji(n.children,r,c,t);case Fe:d=8,r|=24;break;case le:return e=on(12,n,t,r|2),e.elementType=le,e.lanes=c,e;case de:return e=on(13,n,t,r),e.elementType=de,e.lanes=c,e;case Se:return e=on(19,n,t,r),e.elementType=Se,e.lanes=c,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case dt:case Pe:d=10;break e;case At:d=9;break e;case x:d=11;break e;case ie:d=14;break e;case xe:d=16,s=null;break e}d=29,n=Error(A(130,e===null?"null":typeof e,"")),s=null}return t=on(d,n,t,r),t.elementType=e,t.type=s,t.lanes=c,t}function ji(e,t,n,s){return e=on(7,e,s,t),e.lanes=n,e}function jl(e,t,n){return e=on(6,e,null,t),e.lanes=n,e}function js(e,t,n){return t=on(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var ha=[],da=0,zs=null,qs=0,nn=[],yn=0,Pn=null,Xn=1,Qn="";function zi(e,t){ha[da++]=qs,ha[da++]=zs,zs=e,qs=t}function Oo(e,t,n){nn[yn++]=Xn,nn[yn++]=Qn,nn[yn++]=Pn,Pn=e;var s=Xn;e=Qn;var r=32-K(s)-1;s&=~(1<<r),n+=1;var c=32-K(t)+r;if(30<c){var d=r-r%5;c=(s&(1<<d)-1).toString(32),s>>=d,r-=d,Xn=1<<32-K(t)+r|n<<r|s,Qn=c+e}else Xn=1<<c|n<<r|s,Qn=e}function zl(e){e.return!==null&&(zi(e,1),Oo(e,1,0))}function ql(e){for(;e===zs;)zs=ha[--da],ha[da]=null,qs=ha[--da],ha[da]=null;for(;e===Pn;)Pn=nn[--yn],nn[yn]=null,Qn=nn[--yn],nn[yn]=null,Xn=nn[--yn],nn[yn]=null}var It=null,yt=null,Me=!1,Zn=null,vn=!1,qi=Error(A(519));function Kn(e){var t=Error(A(418,""));throw Wn(mn(t,e)),qi}function Hl(e){var t=e.stateNode,n=e.type,s=e.memoizedProps;switch(t[Lt]=e,t[Zt]=s,n){case"dialog":Ge("cancel",t),Ge("close",t);break;case"iframe":case"object":case"embed":Ge("load",t);break;case"video":case"audio":for(n=0;n<dr.length;n++)Ge(dr[n],t);break;case"source":Ge("error",t);break;case"img":case"image":case"link":Ge("error",t),Ge("load",t);break;case"details":Ge("toggle",t);break;case"input":Ge("invalid",t),Os(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0),Ss(t);break;case"select":Ge("invalid",t);break;case"textarea":Ge("invalid",t),Et(t,s.value,s.defaultValue,s.children),Ss(t)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||s.suppressHydrationWarning===!0||ld(t.textContent,n)?(s.popover!=null&&(Ge("beforetoggle",t),Ge("toggle",t)),s.onScroll!=null&&Ge("scroll",t),s.onScrollEnd!=null&&Ge("scrollend",t),s.onClick!=null&&(t.onclick=nc),t=!0):t=!1,t||Kn(e)}function Gl(e){for(It=e.return;It;)switch(It.tag){case 5:case 13:vn=!1;return;case 27:case 3:vn=!0;return;default:It=It.return}}function Jn(e){if(e!==It)return!1;if(!Me)return Gl(e),Me=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||ju(e.type,e.memoizedProps)),n=!n),n&&yt&&Kn(e),Gl(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(A(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){yt=ti(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}yt=null}}else t===27?(t=yt,Da(e.type)?(e=Gu,Gu=null,yt=e):yt=t):yt=It?ti(e.stateNode.nextSibling):null;return!0}function ga(){yt=It=null,Me=!1}function pa(){var e=Zn;return e!==null&&(On===null?On=e:On.push.apply(On,e),Zn=null),e}function Wn(e){Zn===null?Zn=[e]:Zn.push(e)}var es=B(null),kn=null,Fn=null;function Dn(e,t,n){Q(es,t._currentValue),t._currentValue=n}function Dt(e){e._currentValue=es.current,Y(es)}function ma(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Vl(e,t,n,s){var r=e.child;for(r!==null&&(r.return=e);r!==null;){var c=r.dependencies;if(c!==null){var d=r.child;c=c.firstContext;e:for(;c!==null;){var g=c;c=r;for(var y=0;y<t.length;y++)if(g.context===t[y]){c.lanes|=n,g=c.alternate,g!==null&&(g.lanes|=n),ma(c.return,n,e),s||(d=null);break e}c=g.next}}else if(r.tag===18){if(d=r.return,d===null)throw Error(A(341));d.lanes|=n,c=d.alternate,c!==null&&(c.lanes|=n),ma(d,n,e),d=null}else d=r.child;if(d!==null)d.return=r;else for(d=r;d!==null;){if(d===e){d=null;break}if(r=d.sibling,r!==null){r.return=d.return,d=r;break}d=d.return}r=d}}function ts(e,t,n,s){e=null;for(var r=t,c=!1;r!==null;){if(!c){if((r.flags&524288)!==0)c=!0;else if((r.flags&262144)!==0)break}if(r.tag===10){var d=r.alternate;if(d===null)throw Error(A(387));if(d=d.memoizedProps,d!==null){var g=r.type;rn(r.pendingProps.value,d.value)||(e!==null?e.push(g):e=[g])}}else if(r===ct.current){if(d=r.alternate,d===null)throw Error(A(387));d.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(e!==null?e.push(br):e=[br])}r=r.return}e!==null&&Vl(t,e,n,s),t.flags|=262144}function ns(e){for(e=e.firstContext;e!==null;){if(!rn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Hi(e){kn=e,Fn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Bt(e){return Il(kn,e)}function bn(e,t){return kn===null&&Hi(e),Il(e,t)}function Il(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Fn===null){if(e===null)throw Error(A(308));Fn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Fn=Fn.next=t;return n}var is=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,s){e.push(s)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Ao=k.unstable_scheduleCallback,To=k.unstable_NormalPriority,rt={$$typeof:Pe,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function hi(){return{controller:new is,data:new Map,refCount:0}}function as(e){e.refCount--,e.refCount===0&&Ao(To,function(){e.controller.abort()})}var ya=null,ft=0,va=0,ba=null;function Vc(e,t){if(ya===null){var n=ya=[];ft=0,va=Mu(),ba={status:"pending",value:void 0,then:function(s){n.push(s)}}}return ft++,t.then(Ro,Ro),t}function Ro(){if(--ft===0&&ya!==null){ba!==null&&(ba.status="fulfilled");var e=ya;ya=null,va=0,ba=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Ic(e,t){var n=[],s={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var r=0;r<n.length;r++)(0,n[r])(t)},function(r){for(s.status="rejected",s.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),s}var Co=N.S;N.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Vc(e,t),Co!==null&&Co(e,t)};var di=B(null);function Yl(){var e=di.current;return e!==null?e:ot.pooledCache}function Sa(e,t){t===null?Q(di,di.current):Q(di,t.pool)}function _o(){var e=Yl();return e===null?null:{parent:rt._currentValue,pool:e}}var ss=Error(A(460)),Eo=Error(A(474)),Hs=Error(A(542)),Pl={then:function(){}};function Mo(e){return e=e.status,e==="fulfilled"||e==="rejected"}function ls(){}function wo(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(ls,ls),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,No(e),e;default:if(typeof t.status=="string")t.then(ls,ls);else{if(e=ot,e!==null&&100<e.shellSuspendCounter)throw Error(A(482));e=t,e.status="pending",e.then(function(s){if(t.status==="pending"){var r=t;r.status="fulfilled",r.value=s}},function(s){if(t.status==="pending"){var r=t;r.status="rejected",r.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,No(e),e}throw rs=t,ss}}var rs=null;function xo(){if(rs===null)throw Error(A(459));var e=rs;return rs=null,e}function No(e){if(e===ss||e===Hs)throw Error(A(483))}var $n=!1;function Gs(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Xl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function gi(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function pi(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(tt&2)!==0){var r=s.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),s.pending=t,t=fi(e),Bs(e,null,n),t}return In(e,s,t,n),fi(e)}function os(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,fn(e,n)}}function Ql(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var d={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};c===null?r=c=d:c=c.next=d,n=n.next}while(n!==null);c===null?r=c=t:c=c.next=t}else r=c=t;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:c,shared:s.shared,callbacks:s.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Zl=!1;function cs(){if(Zl){var e=ba;if(e!==null)throw e}}function us(e,t,n,s){Zl=!1;var r=e.updateQueue;$n=!1;var c=r.firstBaseUpdate,d=r.lastBaseUpdate,g=r.shared.pending;if(g!==null){r.shared.pending=null;var y=g,C=y.next;y.next=null,d===null?c=C:d.next=C,d=y;var D=e.alternate;D!==null&&(D=D.updateQueue,g=D.lastBaseUpdate,g!==d&&(g===null?D.firstBaseUpdate=C:g.next=C,D.lastBaseUpdate=y))}if(c!==null){var G=r.baseState;d=0,D=C=y=null,g=c;do{var _=g.lane&-536870913,E=_!==g.lane;if(E?(Qe&_)===_:(s&_)===_){_!==0&&_===va&&(Zl=!0),D!==null&&(D=D.next={lane:0,tag:g.tag,payload:g.payload,callback:null,next:null});e:{var Ae=e,ye=g;_=t;var st=n;switch(ye.tag){case 1:if(Ae=ye.payload,typeof Ae=="function"){G=Ae.call(st,G,_);break e}G=Ae;break e;case 3:Ae.flags=Ae.flags&-65537|128;case 0:if(Ae=ye.payload,_=typeof Ae=="function"?Ae.call(st,G,_):Ae,_==null)break e;G=F({},G,_);break e;case 2:$n=!0}}_=g.callback,_!==null&&(e.flags|=64,E&&(e.flags|=8192),E=r.callbacks,E===null?r.callbacks=[_]:E.push(_))}else E={lane:_,tag:g.tag,payload:g.payload,callback:g.callback,next:null},D===null?(C=D=E,y=G):D=D.next=E,d|=_;if(g=g.next,g===null){if(g=r.shared.pending,g===null)break;E=g,g=E.next,E.next=null,r.lastBaseUpdate=E,r.shared.pending=null}}while(!0);D===null&&(y=G),r.baseState=y,r.firstBaseUpdate=C,r.lastBaseUpdate=D,c===null&&(r.shared.lanes=0),xa|=d,e.lanes=d,e.memoizedState=G}}function Oa(e,t){if(typeof e!="function")throw Error(A(191,e));e.call(t)}function Kl(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)Oa(n[e],t)}var mi=B(null),Vs=B(0);function Is(e,t){e=Ki,Q(Vs,e),Q(mi,t),Ki=e|t.baseLanes}function Ys(){Q(Vs,Ki),Q(mi,mi.current)}function Jl(){Ki=Vs.current,Y(mi),Y(Vs)}var yi=0,ke=null,$e=null,Rt=null,Ps=!1,Gi=!1,Rn=!1,vi=0,Vi=0,Aa=null,Yc=0;function St(){throw Error(A(321))}function Wl(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!rn(e[n],t[n]))return!1;return!0}function Fl(e,t,n,s,r,c){return yi=c,ke=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,N.H=e===null||e.memoizedState===null?Hf:Gf,Rn=!1,c=n(s,r),Rn=!1,Gi&&(c=Uo(t,n,s,r)),$l(e),c}function $l(e){N.H=Bo;var t=$e!==null&&$e.next!==null;if(yi=0,Rt=$e=ke=null,Ps=!1,Vi=0,Aa=null,t)throw Error(A(300));e===null||Yt||(e=e.dependencies,e!==null&&ns(e)&&(Yt=!0))}function Uo(e,t,n,s){ke=e;var r=0;do{if(Gi&&(Aa=null),Vi=0,Gi=!1,25<=r)throw Error(A(301));if(r+=1,Rt=$e=null,e.updateQueue!=null){var c=e.updateQueue;c.lastEffect=null,c.events=null,c.stores=null,c.memoCache!=null&&(c.memoCache.index=0)}N.H=ig,c=t(n,s)}while(Gi);return c}function Pc(){var e=N.H,t=e.useState()[0];return t=typeof t.then=="function"?p(t):t,e=e.useState()[0],($e!==null?$e.memoizedState:null)!==e&&(ke.flags|=1024),t}function i(){var e=vi!==0;return vi=0,e}function a(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function l(e){if(Ps){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Ps=!1}yi=0,Rt=$e=ke=null,Gi=!1,Vi=vi=0,Aa=null}function o(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Rt===null?ke.memoizedState=Rt=e:Rt=Rt.next=e,Rt}function u(){if($e===null){var e=ke.alternate;e=e!==null?e.memoizedState:null}else e=$e.next;var t=Rt===null?ke.memoizedState:Rt.next;if(t!==null)Rt=t,$e=e;else{if(e===null)throw ke.alternate===null?Error(A(467)):Error(A(310));$e=e,e={memoizedState:$e.memoizedState,baseState:$e.baseState,baseQueue:$e.baseQueue,queue:$e.queue,next:null},Rt===null?ke.memoizedState=Rt=e:Rt=Rt.next=e}return Rt}function f(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function p(e){var t=Vi;return Vi+=1,Aa===null&&(Aa=[]),e=wo(Aa,e,t),t=ke,(Rt===null?t.memoizedState:Rt.next)===null&&(t=t.alternate,N.H=t===null||t.memoizedState===null?Hf:Gf),e}function m(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return p(e);if(e.$$typeof===Pe)return Bt(e)}throw Error(A(438,String(e)))}function R(e){var t=null,n=ke.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var s=ke.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(r){return r.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=f(),ke.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),s=0;s<e;s++)n[s]=bt;return t.index++,n}function S(e,t){return typeof t=="function"?t(e):t}function j(e){var t=u();return z(t,$e,e)}function z(e,t,n){var s=e.queue;if(s===null)throw Error(A(311));s.lastRenderedReducer=n;var r=e.baseQueue,c=s.pending;if(c!==null){if(r!==null){var d=r.next;r.next=c.next,c.next=d}t.baseQueue=r=c,s.pending=null}if(c=e.baseState,r===null)e.memoizedState=c;else{t=r.next;var g=d=null,y=null,C=t,D=!1;do{var G=C.lane&-536870913;if(G!==C.lane?(Qe&G)===G:(yi&G)===G){var _=C.revertLane;if(_===0)y!==null&&(y=y.next={lane:0,revertLane:0,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null}),G===va&&(D=!0);else if((yi&_)===_){C=C.next,_===va&&(D=!0);continue}else G={lane:0,revertLane:C.revertLane,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null},y===null?(g=y=G,d=c):y=y.next=G,ke.lanes|=_,xa|=_;G=C.action,Rn&&n(c,G),c=C.hasEagerState?C.eagerState:n(c,G)}else _={lane:G,revertLane:C.revertLane,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null},y===null?(g=y=_,d=c):y=y.next=_,ke.lanes|=G,xa|=G;C=C.next}while(C!==null&&C!==t);if(y===null?d=c:y.next=g,!rn(c,e.memoizedState)&&(Yt=!0,D&&(n=ba,n!==null)))throw n;e.memoizedState=c,e.baseState=d,e.baseQueue=y,s.lastRenderedState=c}return r===null&&(s.lanes=0),[e.memoizedState,s.dispatch]}function X(e){var t=u(),n=t.queue;if(n===null)throw Error(A(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,c=t.memoizedState;if(r!==null){n.pending=null;var d=r=r.next;do c=e(c,d.action),d=d.next;while(d!==r);rn(c,t.memoizedState)||(Yt=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,s]}function q(e,t,n){var s=ke,r=u(),c=Me;if(c){if(n===void 0)throw Error(A(407));n=n()}else n=t();var d=!rn(($e||r).memoizedState,n);d&&(r.memoizedState=n,Yt=!0),r=r.queue;var g=me.bind(null,s,r,e);if(er(2048,8,g,[e]),r.getSnapshot!==t||d||Rt!==null&&Rt.memoizedState.tag&1){if(s.flags|=2048,Xs(9,ko(),ee.bind(null,s,r,n,t),null),ot===null)throw Error(A(349));c||(yi&124)!==0||$(s,t,n)}return n}function $(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ke.updateQueue,t===null?(t=f(),ke.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function ee(e,t,n,s){t.value=n,t.getSnapshot=s,Ye(t)&&We(e)}function me(e,t,n){return n(function(){Ye(t)&&We(e)})}function Ye(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!rn(e,n)}catch{return!0}}function We(e){var t=fa(e,2);t!==null&&wn(t,e,2)}function et(e){var t=o();if(typeof e=="function"){var n=e;if(e=n(),Rn){J(!0);try{n()}finally{J(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:e},t}function Oe(e,t,n,s){return e.baseState=n,z(e,$e,typeof s=="function"?s:S)}function cn(e,t,n,s,r){if(Lo(e))throw Error(A(485));if(e=t.action,e!==null){var c={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(d){c.listeners.push(d)}};N.T!==null?n(!0):c.isTransition=!1,s(c),n=t.pending,n===null?(c.next=t.pending=c,jt(t,c)):(c.next=n.next,t.pending=n.next=c)}}function jt(e,t){var n=t.action,s=t.payload,r=e.state;if(t.isTransition){var c=N.T,d={};N.T=d;try{var g=n(r,s),y=N.S;y!==null&&y(d,g),Ta(e,t,g)}catch(C){fs(e,t,C)}finally{N.T=c}}else try{c=n(r,s),Ta(e,t,c)}catch(C){fs(e,t,C)}}function Ta(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){Ii(e,t,s)},function(s){return fs(e,t,s)}):Ii(e,t,n)}function Ii(e,t,n){t.status="fulfilled",t.value=n,mf(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,jt(e,n)))}function fs(e,t,n){var s=e.pending;if(e.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=n,mf(t),t=t.next;while(t!==s)}e.action=null}function mf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function yf(e,t){return t}function vf(e,t){if(Me){var n=ot.formState;if(n!==null){e:{var s=ke;if(Me){if(yt){t:{for(var r=yt,c=vn;r.nodeType!==8;){if(!c){r=null;break t}if(r=ti(r.nextSibling),r===null){r=null;break t}}c=r.data,r=c==="F!"||c==="F"?r:null}if(r){yt=ti(r.nextSibling),s=r.data==="F!";break e}}Kn(s)}s=!1}s&&(t=n[0])}}return n=o(),n.memoizedState=n.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yf,lastRenderedState:t},n.queue=s,n=jf.bind(null,ke,s),s.dispatch=n,s=et(!1),c=Jc.bind(null,ke,!1,s.queue),s=o(),r={state:t,dispatch:null,action:e,pending:null},s.queue=r,n=cn.bind(null,ke,r,c,n),r.dispatch=n,s.memoizedState=e,[t,n,!1]}function bf(e){var t=u();return Sf(t,$e,e)}function Sf(e,t,n){if(t=z(e,t,yf)[0],e=j(S)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=p(t)}catch(d){throw d===ss?Hs:d}else s=t;t=u();var r=t.queue,c=r.dispatch;return n!==t.memoizedState&&(ke.flags|=2048,Xs(9,ko(),$d.bind(null,r,n),null)),[s,c,e]}function $d(e,t){e.action=t}function Of(e){var t=u(),n=$e;if(n!==null)return Sf(t,n,e);u(),t=t.memoizedState,n=u();var s=n.queue.dispatch;return n.memoizedState=e,[t,s,!1]}function Xs(e,t,n,s){return e={tag:e,create:n,deps:s,inst:t,next:null},t=ke.updateQueue,t===null&&(t=f(),ke.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function ko(){return{destroy:void 0,resource:void 0}}function Af(){return u().memoizedState}function Do(e,t,n,s){var r=o();s=s===void 0?null:s,ke.flags|=e,r.memoizedState=Xs(1|t,ko(),n,s)}function er(e,t,n,s){var r=u();s=s===void 0?null:s;var c=r.memoizedState.inst;$e!==null&&s!==null&&Wl(s,$e.memoizedState.deps)?r.memoizedState=Xs(t,c,n,s):(ke.flags|=e,r.memoizedState=Xs(1|t,c,n,s))}function Tf(e,t){Do(8390656,8,e,t)}function Rf(e,t){er(2048,8,e,t)}function Cf(e,t){return er(4,2,e,t)}function _f(e,t){return er(4,4,e,t)}function Ef(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Mf(e,t,n){n=n!=null?n.concat([e]):null,er(4,4,Ef.bind(null,t,e),n)}function Xc(){}function wf(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;return t!==null&&Wl(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function xf(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;if(t!==null&&Wl(t,s[1]))return s[0];if(s=e(),Rn){J(!0);try{e()}finally{J(!1)}}return n.memoizedState=[s,t],s}function Qc(e,t,n){return n===void 0||(yi&1073741824)!==0?e.memoizedState=t:(e.memoizedState=n,e=kh(),ke.lanes|=e,xa|=e,n)}function Nf(e,t,n,s){return rn(n,t)?n:mi.current!==null?(e=Qc(e,n,s),rn(e,t)||(Yt=!0),e):(yi&42)===0?(Yt=!0,e.memoizedState=n):(e=kh(),ke.lanes|=e,xa|=e,t)}function Uf(e,t,n,s,r){var c=U.p;U.p=c!==0&&8>c?c:8;var d=N.T,g={};N.T=g,Jc(e,!1,t,n);try{var y=r(),C=N.S;if(C!==null&&C(g,y),y!==null&&typeof y=="object"&&typeof y.then=="function"){var D=Ic(y,s);tr(e,t,D,Mn(e))}else tr(e,t,s,Mn(e))}catch(G){tr(e,t,{then:function(){},status:"rejected",reason:G},Mn())}finally{U.p=c,N.T=d}}function eg(){}function Zc(e,t,n,s){if(e.tag!==5)throw Error(A(476));var r=kf(e).queue;Uf(e,r,t,ae,n===null?eg:function(){return Df(e),n(s)})}function kf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ae,baseState:ae,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:ae},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function Df(e){var t=kf(e).next.queue;tr(e,t,{},Mn())}function Kc(){return Bt(br)}function Lf(){return u().memoizedState}function Bf(){return u().memoizedState}function tg(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=Mn();e=gi(n);var s=pi(t,e,n);s!==null&&(wn(s,t,n),os(s,t,n)),t={cache:hi()},e.payload=t;return}t=t.return}}function ng(e,t,n){var s=Mn();n={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Lo(e)?zf(t,n):(n=Vt(e,t,n,s),n!==null&&(wn(n,e,s),qf(n,t,s)))}function jf(e,t,n){var s=Mn();tr(e,t,n,s)}function tr(e,t,n,s){var r={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Lo(e))zf(t,r);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var d=t.lastRenderedState,g=c(d,n);if(r.hasEagerState=!0,r.eagerState=g,rn(g,d))return In(e,t,r,0),ot===null&&Ls(),!1}catch{}finally{}if(n=Vt(e,t,r,s),n!==null)return wn(n,e,s),qf(n,t,s),!0}return!1}function Jc(e,t,n,s){if(s={lane:2,revertLane:Mu(),action:s,hasEagerState:!1,eagerState:null,next:null},Lo(e)){if(t)throw Error(A(479))}else t=Vt(e,n,s,2),t!==null&&wn(t,e,2)}function Lo(e){var t=e.alternate;return e===ke||t!==null&&t===ke}function zf(e,t){Gi=Ps=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function qf(e,t,n){if((n&4194048)!==0){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,fn(e,n)}}var Bo={readContext:Bt,use:m,useCallback:St,useContext:St,useEffect:St,useImperativeHandle:St,useLayoutEffect:St,useInsertionEffect:St,useMemo:St,useReducer:St,useRef:St,useState:St,useDebugValue:St,useDeferredValue:St,useTransition:St,useSyncExternalStore:St,useId:St,useHostTransitionStatus:St,useFormState:St,useActionState:St,useOptimistic:St,useMemoCache:St,useCacheRefresh:St},Hf={readContext:Bt,use:m,useCallback:function(e,t){return o().memoizedState=[e,t===void 0?null:t],e},useContext:Bt,useEffect:Tf,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Do(4194308,4,Ef.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Do(4194308,4,e,t)},useInsertionEffect:function(e,t){Do(4,2,e,t)},useMemo:function(e,t){var n=o();t=t===void 0?null:t;var s=e();if(Rn){J(!0);try{e()}finally{J(!1)}}return n.memoizedState=[s,t],s},useReducer:function(e,t,n){var s=o();if(n!==void 0){var r=n(t);if(Rn){J(!0);try{n(t)}finally{J(!1)}}}else r=t;return s.memoizedState=s.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},s.queue=e,e=e.dispatch=ng.bind(null,ke,e),[s.memoizedState,e]},useRef:function(e){var t=o();return e={current:e},t.memoizedState=e},useState:function(e){e=et(e);var t=e.queue,n=jf.bind(null,ke,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Xc,useDeferredValue:function(e,t){var n=o();return Qc(n,e,t)},useTransition:function(){var e=et(!1);return e=Uf.bind(null,ke,e.queue,!0,!1),o().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=ke,r=o();if(Me){if(n===void 0)throw Error(A(407));n=n()}else{if(n=t(),ot===null)throw Error(A(349));(Qe&124)!==0||$(s,t,n)}r.memoizedState=n;var c={value:n,getSnapshot:t};return r.queue=c,Tf(me.bind(null,s,c,e),[e]),s.flags|=2048,Xs(9,ko(),ee.bind(null,s,c,n,t),null),n},useId:function(){var e=o(),t=ot.identifierPrefix;if(Me){var n=Qn,s=Xn;n=(s&~(1<<32-K(s)-1)).toString(32)+n,t=""+t+"R"+n,n=vi++,0<n&&(t+="H"+n.toString(32)),t+=""}else n=Yc++,t=""+t+"r"+n.toString(32)+"";return e.memoizedState=t},useHostTransitionStatus:Kc,useFormState:vf,useActionState:vf,useOptimistic:function(e){var t=o();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Jc.bind(null,ke,!0,n),n.dispatch=t,[e,t]},useMemoCache:R,useCacheRefresh:function(){return o().memoizedState=tg.bind(null,ke)}},Gf={readContext:Bt,use:m,useCallback:wf,useContext:Bt,useEffect:Rf,useImperativeHandle:Mf,useInsertionEffect:Cf,useLayoutEffect:_f,useMemo:xf,useReducer:j,useRef:Af,useState:function(){return j(S)},useDebugValue:Xc,useDeferredValue:function(e,t){var n=u();return Nf(n,$e.memoizedState,e,t)},useTransition:function(){var e=j(S)[0],t=u().memoizedState;return[typeof e=="boolean"?e:p(e),t]},useSyncExternalStore:q,useId:Lf,useHostTransitionStatus:Kc,useFormState:bf,useActionState:bf,useOptimistic:function(e,t){var n=u();return Oe(n,$e,e,t)},useMemoCache:R,useCacheRefresh:Bf},ig={readContext:Bt,use:m,useCallback:wf,useContext:Bt,useEffect:Rf,useImperativeHandle:Mf,useInsertionEffect:Cf,useLayoutEffect:_f,useMemo:xf,useReducer:X,useRef:Af,useState:function(){return X(S)},useDebugValue:Xc,useDeferredValue:function(e,t){var n=u();return $e===null?Qc(n,e,t):Nf(n,$e.memoizedState,e,t)},useTransition:function(){var e=X(S)[0],t=u().memoizedState;return[typeof e=="boolean"?e:p(e),t]},useSyncExternalStore:q,useId:Lf,useHostTransitionStatus:Kc,useFormState:Of,useActionState:Of,useOptimistic:function(e,t){var n=u();return $e!==null?Oe(n,$e,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:R,useCacheRefresh:Bf},Qs=null,nr=0;function jo(e){var t=nr;return nr+=1,Qs===null&&(Qs=[]),wo(Qs,e,t)}function ir(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function zo(e,t){throw t.$$typeof===Le?Error(A(525)):(e=Object.prototype.toString.call(t),Error(A(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Vf(e){var t=e._init;return t(e._payload)}function If(e){function t(O,b){if(e){var T=O.deletions;T===null?(O.deletions=[b],O.flags|=16):T.push(b)}}function n(O,b){if(!e)return null;for(;b!==null;)t(O,b),b=b.sibling;return null}function s(O){for(var b=new Map;O!==null;)O.key!==null?b.set(O.key,O):b.set(O.index,O),O=O.sibling;return b}function r(O,b){return O=Yn(O,b),O.index=0,O.sibling=null,O}function c(O,b,T){return O.index=T,e?(T=O.alternate,T!==null?(T=T.index,T<b?(O.flags|=67108866,b):T):(O.flags|=67108866,b)):(O.flags|=1048576,b)}function d(O){return e&&O.alternate===null&&(O.flags|=67108866),O}function g(O,b,T,H){return b===null||b.tag!==6?(b=jl(T,O.mode,H),b.return=O,b):(b=r(b,T),b.return=O,b)}function y(O,b,T,H){var re=T.type;return re===Te?D(O,b,T.props.children,H,T.key):b!==null&&(b.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===xe&&Vf(re)===b.type)?(b=r(b,T.props),ir(b,T),b.return=O,b):(b=$a(T.type,T.key,T.props,null,O.mode,H),ir(b,T),b.return=O,b)}function C(O,b,T,H){return b===null||b.tag!==4||b.stateNode.containerInfo!==T.containerInfo||b.stateNode.implementation!==T.implementation?(b=js(T,O.mode,H),b.return=O,b):(b=r(b,T.children||[]),b.return=O,b)}function D(O,b,T,H,re){return b===null||b.tag!==7?(b=ji(T,O.mode,H,re),b.return=O,b):(b=r(b,T),b.return=O,b)}function G(O,b,T){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return b=jl(""+b,O.mode,T),b.return=O,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case we:return T=$a(b.type,b.key,b.props,null,O.mode,T),ir(T,b),T.return=O,T;case he:return b=js(b,O.mode,T),b.return=O,b;case xe:var H=b._init;return b=H(b._payload),G(O,b,T)}if(Ce(b)||Ve(b))return b=ji(b,O.mode,T,null),b.return=O,b;if(typeof b.then=="function")return G(O,jo(b),T);if(b.$$typeof===Pe)return G(O,bn(O,b),T);zo(O,b)}return null}function _(O,b,T,H){var re=b!==null?b.key:null;if(typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint")return re!==null?null:g(O,b,""+T,H);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case we:return T.key===re?y(O,b,T,H):null;case he:return T.key===re?C(O,b,T,H):null;case xe:return re=T._init,T=re(T._payload),_(O,b,T,H)}if(Ce(T)||Ve(T))return re!==null?null:D(O,b,T,H,null);if(typeof T.then=="function")return _(O,b,jo(T),H);if(T.$$typeof===Pe)return _(O,b,bn(O,T),H);zo(O,T)}return null}function E(O,b,T,H,re){if(typeof H=="string"&&H!==""||typeof H=="number"||typeof H=="bigint")return O=O.get(T)||null,g(b,O,""+H,re);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case we:return O=O.get(H.key===null?T:H.key)||null,y(b,O,H,re);case he:return O=O.get(H.key===null?T:H.key)||null,C(b,O,H,re);case xe:var qe=H._init;return H=qe(H._payload),E(O,b,T,H,re)}if(Ce(H)||Ve(H))return O=O.get(T)||null,D(b,O,H,re,null);if(typeof H.then=="function")return E(O,b,T,jo(H),re);if(H.$$typeof===Pe)return E(O,b,T,bn(b,H),re);zo(b,H)}return null}function Ae(O,b,T,H){for(var re=null,qe=null,fe=b,ve=b=0,Xt=null;fe!==null&&ve<T.length;ve++){fe.index>ve?(Xt=fe,fe=null):Xt=fe.sibling;var Je=_(O,fe,T[ve],H);if(Je===null){fe===null&&(fe=Xt);break}e&&fe&&Je.alternate===null&&t(O,fe),b=c(Je,b,ve),qe===null?re=Je:qe.sibling=Je,qe=Je,fe=Xt}if(ve===T.length)return n(O,fe),Me&&zi(O,ve),re;if(fe===null){for(;ve<T.length;ve++)fe=G(O,T[ve],H),fe!==null&&(b=c(fe,b,ve),qe===null?re=fe:qe.sibling=fe,qe=fe);return Me&&zi(O,ve),re}for(fe=s(fe);ve<T.length;ve++)Xt=E(fe,O,ve,T[ve],H),Xt!==null&&(e&&Xt.alternate!==null&&fe.delete(Xt.key===null?ve:Xt.key),b=c(Xt,b,ve),qe===null?re=Xt:qe.sibling=Xt,qe=Xt);return e&&fe.forEach(function(qa){return t(O,qa)}),Me&&zi(O,ve),re}function ye(O,b,T,H){if(T==null)throw Error(A(151));for(var re=null,qe=null,fe=b,ve=b=0,Xt=null,Je=T.next();fe!==null&&!Je.done;ve++,Je=T.next()){fe.index>ve?(Xt=fe,fe=null):Xt=fe.sibling;var qa=_(O,fe,Je.value,H);if(qa===null){fe===null&&(fe=Xt);break}e&&fe&&qa.alternate===null&&t(O,fe),b=c(qa,b,ve),qe===null?re=qa:qe.sibling=qa,qe=qa,fe=Xt}if(Je.done)return n(O,fe),Me&&zi(O,ve),re;if(fe===null){for(;!Je.done;ve++,Je=T.next())Je=G(O,Je.value,H),Je!==null&&(b=c(Je,b,ve),qe===null?re=Je:qe.sibling=Je,qe=Je);return Me&&zi(O,ve),re}for(fe=s(fe);!Je.done;ve++,Je=T.next())Je=E(fe,O,ve,Je.value,H),Je!==null&&(e&&Je.alternate!==null&&fe.delete(Je.key===null?ve:Je.key),b=c(Je,b,ve),qe===null?re=Je:qe.sibling=Je,qe=Je);return e&&fe.forEach(function(ap){return t(O,ap)}),Me&&zi(O,ve),re}function st(O,b,T,H){if(typeof T=="object"&&T!==null&&T.type===Te&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case we:e:{for(var re=T.key;b!==null;){if(b.key===re){if(re=T.type,re===Te){if(b.tag===7){n(O,b.sibling),H=r(b,T.props.children),H.return=O,O=H;break e}}else if(b.elementType===re||typeof re=="object"&&re!==null&&re.$$typeof===xe&&Vf(re)===b.type){n(O,b.sibling),H=r(b,T.props),ir(H,T),H.return=O,O=H;break e}n(O,b);break}else t(O,b);b=b.sibling}T.type===Te?(H=ji(T.props.children,O.mode,H,T.key),H.return=O,O=H):(H=$a(T.type,T.key,T.props,null,O.mode,H),ir(H,T),H.return=O,O=H)}return d(O);case he:e:{for(re=T.key;b!==null;){if(b.key===re)if(b.tag===4&&b.stateNode.containerInfo===T.containerInfo&&b.stateNode.implementation===T.implementation){n(O,b.sibling),H=r(b,T.children||[]),H.return=O,O=H;break e}else{n(O,b);break}else t(O,b);b=b.sibling}H=js(T,O.mode,H),H.return=O,O=H}return d(O);case xe:return re=T._init,T=re(T._payload),st(O,b,T,H)}if(Ce(T))return Ae(O,b,T,H);if(Ve(T)){if(re=Ve(T),typeof re!="function")throw Error(A(150));return T=re.call(T),ye(O,b,T,H)}if(typeof T.then=="function")return st(O,b,jo(T),H);if(T.$$typeof===Pe)return st(O,b,bn(O,T),H);zo(O,T)}return typeof T=="string"&&T!==""||typeof T=="number"||typeof T=="bigint"?(T=""+T,b!==null&&b.tag===6?(n(O,b.sibling),H=r(b,T),H.return=O,O=H):(n(O,b),H=jl(T,O.mode,H),H.return=O,O=H),d(O)):n(O,b)}return function(O,b,T,H){try{nr=0;var re=st(O,b,T,H);return Qs=null,re}catch(fe){if(fe===ss||fe===Hs)throw fe;var qe=on(29,fe,null,O.mode);return qe.lanes=H,qe.return=O,qe}finally{}}}var Zs=If(!0),Yf=If(!1),Ln=B(null),bi=null;function Ra(e){var t=e.alternate;Q(zt,zt.current&1),Q(Ln,e),bi===null&&(t===null||mi.current!==null||t.memoizedState!==null)&&(bi=e)}function Pf(e){if(e.tag===22){if(Q(zt,zt.current),Q(Ln,e),bi===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(bi=e)}}else Ca()}function Ca(){Q(zt,zt.current),Q(Ln,Ln.current)}function Yi(e){Y(Ln),bi===e&&(bi=null),Y(zt)}var zt=B(0);function qo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||Hu(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Wc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:F({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Fc={enqueueSetState:function(e,t,n){e=e._reactInternals;var s=Mn(),r=gi(s);r.payload=t,n!=null&&(r.callback=n),t=pi(e,r,s),t!==null&&(wn(t,e,s),os(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=Mn(),r=gi(s);r.tag=1,r.payload=t,n!=null&&(r.callback=n),t=pi(e,r,s),t!==null&&(wn(t,e,s),os(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Mn(),s=gi(n);s.tag=2,t!=null&&(s.callback=t),t=pi(e,s,n),t!==null&&(wn(t,e,n),os(t,e,n))}};function Xf(e,t,n,s,r,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,c,d):t.prototype&&t.prototype.isPureReactComponent?!oi(n,s)||!oi(r,c):!0}function Qf(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Fc.enqueueReplaceState(t,t.state,null)}function hs(e,t){var n=t;if("ref"in t){n={};for(var s in t)s!=="ref"&&(n[s]=t[s])}if(e=e.defaultProps){n===t&&(n=F({},n));for(var r in e)n[r]===void 0&&(n[r]=e[r])}return n}var Ho=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Zf(e){Ho(e)}function Kf(e){console.error(e)}function Jf(e){Ho(e)}function Go(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function Wf(e,t,n){try{var s=e.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function $c(e,t,n){return n=gi(n),n.tag=3,n.payload={element:null},n.callback=function(){Go(e,t)},n}function Ff(e){return e=gi(e),e.tag=3,e}function $f(e,t,n,s){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var c=s.value;e.payload=function(){return r(c)},e.callback=function(){Wf(t,n,s)}}var d=n.stateNode;d!==null&&typeof d.componentDidCatch=="function"&&(e.callback=function(){Wf(t,n,s),typeof r!="function"&&(Na===null?Na=new Set([this]):Na.add(this));var g=s.stack;this.componentDidCatch(s.value,{componentStack:g!==null?g:""})})}function ag(e,t,n,s,r){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=n.alternate,t!==null&&ts(t,n,r,!0),n=Ln.current,n!==null){switch(n.tag){case 13:return bi===null?Tu():n.alternate===null&&Ct===0&&(Ct=3),n.flags&=-257,n.flags|=65536,n.lanes=r,s===Pl?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([s]):t.add(s),Cu(e,s,r)),!1;case 22:return n.flags|=65536,s===Pl?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([s]):n.add(s)),Cu(e,s,r)),!1}throw Error(A(435,n.tag))}return Cu(e,s,r),Tu(),!1}if(Me)return t=Ln.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=r,s!==qi&&(e=Error(A(422),{cause:s}),Wn(mn(e,n)))):(s!==qi&&(t=Error(A(423),{cause:s}),Wn(mn(t,n))),e=e.current.alternate,e.flags|=65536,r&=-r,e.lanes|=r,s=mn(s,n),r=$c(e.stateNode,s,r),Ql(e,r),Ct!==4&&(Ct=2)),!1;var c=Error(A(520),{cause:s});if(c=mn(c,n),ur===null?ur=[c]:ur.push(c),Ct!==4&&(Ct=2),t===null)return!0;s=mn(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,e=$c(n.stateNode,s,e),Ql(n,e),!1;case 1:if(t=n.type,c=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||c!==null&&typeof c.componentDidCatch=="function"&&(Na===null||!Na.has(c))))return n.flags|=65536,r&=-r,n.lanes|=r,r=Ff(r),$f(r,e,n,s),Ql(n,r),!1}n=n.return}while(n!==null);return!1}var eh=Error(A(461)),Yt=!1;function Jt(e,t,n,s){t.child=e===null?Yf(t,null,n,s):Zs(t,e.child,n,s)}function th(e,t,n,s,r){n=n.render;var c=t.ref;if("ref"in s){var d={};for(var g in s)g!=="ref"&&(d[g]=s[g])}else d=s;return Hi(t),s=Fl(e,t,n,d,c,r),g=i(),e!==null&&!Yt?(a(e,t,r),Pi(e,t,r)):(Me&&g&&zl(t),t.flags|=1,Jt(e,t,s,r),t.child)}function nh(e,t,n,s,r){if(e===null){var c=n.type;return typeof c=="function"&&!Fa(c)&&c.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=c,ih(e,t,c,s,r)):(e=$a(n.type,null,s,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!ru(e,r)){var d=c.memoizedProps;if(n=n.compare,n=n!==null?n:oi,n(d,s)&&e.ref===t.ref)return Pi(e,t,r)}return t.flags|=1,e=Yn(c,s),e.ref=t.ref,e.return=t,t.child=e}function ih(e,t,n,s,r){if(e!==null){var c=e.memoizedProps;if(oi(c,s)&&e.ref===t.ref)if(Yt=!1,t.pendingProps=s=c,ru(e,r))(e.flags&131072)!==0&&(Yt=!0);else return t.lanes=e.lanes,Pi(e,t,r)}return eu(e,t,n,s,r)}function ah(e,t,n){var s=t.pendingProps,r=s.children,c=e!==null?e.memoizedState:null;if(s.mode==="hidden"){if((t.flags&128)!==0){if(s=c!==null?c.baseLanes|n:n,e!==null){for(r=t.child=e.child,c=0;r!==null;)c=c|r.lanes|r.childLanes,r=r.sibling;t.childLanes=c&~s}else t.childLanes=0,t.child=null;return sh(e,t,s,n)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&Sa(t,c!==null?c.cachePool:null),c!==null?Is(t,c):Ys(),Pf(t);else return t.lanes=t.childLanes=536870912,sh(e,t,c!==null?c.baseLanes|n:n,n)}else c!==null?(Sa(t,c.cachePool),Is(t,c),Ca(),t.memoizedState=null):(e!==null&&Sa(t,null),Ys(),Ca());return Jt(e,t,r,n),t.child}function sh(e,t,n,s){var r=Yl();return r=r===null?null:{parent:rt._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},e!==null&&Sa(t,null),Ys(),Pf(t),e!==null&&ts(e,t,s,!0),null}function Vo(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(A(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function eu(e,t,n,s,r){return Hi(t),n=Fl(e,t,n,s,void 0,r),s=i(),e!==null&&!Yt?(a(e,t,r),Pi(e,t,r)):(Me&&s&&zl(t),t.flags|=1,Jt(e,t,n,r),t.child)}function lh(e,t,n,s,r,c){return Hi(t),t.updateQueue=null,n=Uo(t,s,n,r),$l(e),s=i(),e!==null&&!Yt?(a(e,t,c),Pi(e,t,c)):(Me&&s&&zl(t),t.flags|=1,Jt(e,t,n,c),t.child)}function rh(e,t,n,s,r){if(Hi(t),t.stateNode===null){var c=Bi,d=n.contextType;typeof d=="object"&&d!==null&&(c=Bt(d)),c=new n(s,c),t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Fc,t.stateNode=c,c._reactInternals=t,c=t.stateNode,c.props=s,c.state=t.memoizedState,c.refs={},Gs(t),d=n.contextType,c.context=typeof d=="object"&&d!==null?Bt(d):Bi,c.state=t.memoizedState,d=n.getDerivedStateFromProps,typeof d=="function"&&(Wc(t,n,d,s),c.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(d=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),d!==c.state&&Fc.enqueueReplaceState(c,c.state,null),us(t,s,c,r),cs(),c.state=t.memoizedState),typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(e===null){c=t.stateNode;var g=t.memoizedProps,y=hs(n,g);c.props=y;var C=c.context,D=n.contextType;d=Bi,typeof D=="object"&&D!==null&&(d=Bt(D));var G=n.getDerivedStateFromProps;D=typeof G=="function"||typeof c.getSnapshotBeforeUpdate=="function",g=t.pendingProps!==g,D||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(g||C!==d)&&Qf(t,c,s,d),$n=!1;var _=t.memoizedState;c.state=_,us(t,s,c,r),cs(),C=t.memoizedState,g||_!==C||$n?(typeof G=="function"&&(Wc(t,n,G,s),C=t.memoizedState),(y=$n||Xf(t,n,y,s,_,C,d))?(D||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=C),c.props=s,c.state=C,c.context=d,s=y):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{c=t.stateNode,Xl(e,t),d=t.memoizedProps,D=hs(n,d),c.props=D,G=t.pendingProps,_=c.context,C=n.contextType,y=Bi,typeof C=="object"&&C!==null&&(y=Bt(C)),g=n.getDerivedStateFromProps,(C=typeof g=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(d!==G||_!==y)&&Qf(t,c,s,y),$n=!1,_=t.memoizedState,c.state=_,us(t,s,c,r),cs();var E=t.memoizedState;d!==G||_!==E||$n||e!==null&&e.dependencies!==null&&ns(e.dependencies)?(typeof g=="function"&&(Wc(t,n,g,s),E=t.memoizedState),(D=$n||Xf(t,n,D,s,_,E,y)||e!==null&&e.dependencies!==null&&ns(e.dependencies))?(C||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(s,E,y),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(s,E,y)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=E),c.props=s,c.state=E,c.context=y,s=D):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&_===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&_===e.memoizedState||(t.flags|=1024),s=!1)}return c=s,Vo(e,t),s=(t.flags&128)!==0,c||s?(c=t.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:c.render(),t.flags|=1,e!==null&&s?(t.child=Zs(t,e.child,null,r),t.child=Zs(t,null,n,r)):Jt(e,t,n,r),t.memoizedState=c.state,e=t.child):e=Pi(e,t,r),e}function oh(e,t,n,s){return ga(),t.flags|=256,Jt(e,t,n,s),t.child}var tu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function nu(e){return{baseLanes:e,cachePool:_o()}}function iu(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=Bn),e}function ch(e,t,n){var s=t.pendingProps,r=!1,c=(t.flags&128)!==0,d;if((d=c)||(d=e!==null&&e.memoizedState===null?!1:(zt.current&2)!==0),d&&(r=!0,t.flags&=-129),d=(t.flags&32)!==0,t.flags&=-33,e===null){if(Me){if(r?Ra(t):Ca(),Me){var g=yt,y;if(y=g){e:{for(y=g,g=vn;y.nodeType!==8;){if(!g){g=null;break e}if(y=ti(y.nextSibling),y===null){g=null;break e}}g=y}g!==null?(t.memoizedState={dehydrated:g,treeContext:Pn!==null?{id:Xn,overflow:Qn}:null,retryLane:536870912,hydrationErrors:null},y=on(18,null,null,0),y.stateNode=g,y.return=t,t.child=y,It=t,yt=null,y=!0):y=!1}y||Kn(t)}if(g=t.memoizedState,g!==null&&(g=g.dehydrated,g!==null))return Hu(g)?t.lanes=32:t.lanes=536870912,null;Yi(t)}return g=s.children,s=s.fallback,r?(Ca(),r=t.mode,g=Io({mode:"hidden",children:g},r),s=ji(s,r,n,null),g.return=t,s.return=t,g.sibling=s,t.child=g,r=t.child,r.memoizedState=nu(n),r.childLanes=iu(e,d,n),t.memoizedState=tu,s):(Ra(t),au(t,g))}if(y=e.memoizedState,y!==null&&(g=y.dehydrated,g!==null)){if(c)t.flags&256?(Ra(t),t.flags&=-257,t=su(e,t,n)):t.memoizedState!==null?(Ca(),t.child=e.child,t.flags|=128,t=null):(Ca(),r=s.fallback,g=t.mode,s=Io({mode:"visible",children:s.children},g),r=ji(r,g,n,null),r.flags|=2,s.return=t,r.return=t,s.sibling=r,t.child=s,Zs(t,e.child,null,n),s=t.child,s.memoizedState=nu(n),s.childLanes=iu(e,d,n),t.memoizedState=tu,t=r);else if(Ra(t),Hu(g)){if(d=g.nextSibling&&g.nextSibling.dataset,d)var C=d.dgst;d=C,s=Error(A(419)),s.stack="",s.digest=d,Wn({value:s,source:null,stack:null}),t=su(e,t,n)}else if(Yt||ts(e,t,n,!1),d=(n&e.childLanes)!==0,Yt||d){if(d=ot,d!==null&&(s=n&-n,s=(s&42)!==0?1:fl(s),s=(s&(d.suspendedLanes|n))!==0?0:s,s!==0&&s!==y.retryLane))throw y.retryLane=s,fa(e,s),wn(d,e,s),eh;g.data==="$?"||Tu(),t=su(e,t,n)}else g.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=y.treeContext,yt=ti(g.nextSibling),It=t,Me=!0,Zn=null,vn=!1,e!==null&&(nn[yn++]=Xn,nn[yn++]=Qn,nn[yn++]=Pn,Xn=e.id,Qn=e.overflow,Pn=t),t=au(t,s.children),t.flags|=4096);return t}return r?(Ca(),r=s.fallback,g=t.mode,y=e.child,C=y.sibling,s=Yn(y,{mode:"hidden",children:s.children}),s.subtreeFlags=y.subtreeFlags&65011712,C!==null?r=Yn(C,r):(r=ji(r,g,n,null),r.flags|=2),r.return=t,s.return=t,s.sibling=r,t.child=s,s=r,r=t.child,g=e.child.memoizedState,g===null?g=nu(n):(y=g.cachePool,y!==null?(C=rt._currentValue,y=y.parent!==C?{parent:C,pool:C}:y):y=_o(),g={baseLanes:g.baseLanes|n,cachePool:y}),r.memoizedState=g,r.childLanes=iu(e,d,n),t.memoizedState=tu,s):(Ra(t),n=e.child,e=n.sibling,n=Yn(n,{mode:"visible",children:s.children}),n.return=t,n.sibling=null,e!==null&&(d=t.deletions,d===null?(t.deletions=[e],t.flags|=16):d.push(e)),t.child=n,t.memoizedState=null,n)}function au(e,t){return t=Io({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Io(e,t){return e=on(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function su(e,t,n){return Zs(t,e.child,null,n),e=au(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function uh(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),ma(e.return,t,n)}function lu(e,t,n,s,r){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=n,c.tailMode=r)}function fh(e,t,n){var s=t.pendingProps,r=s.revealOrder,c=s.tail;if(Jt(e,t,s.children,n),s=zt.current,(s&2)!==0)s=s&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&uh(e,n,t);else if(e.tag===19)uh(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}switch(Q(zt,s),r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&qo(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),lu(t,!1,r,n,c);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&qo(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}lu(t,!0,n,null,c);break;case"together":lu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Pi(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),xa|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(ts(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(A(153));if(t.child!==null){for(e=t.child,n=Yn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Yn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function ru(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&ns(e)))}function sg(e,t,n){switch(t.tag){case 3:_e(t,t.stateNode.containerInfo),Dn(t,rt,e.memoizedState.cache),ga();break;case 27:case 5:_t(t);break;case 4:_e(t,t.stateNode.containerInfo);break;case 10:Dn(t,t.type,t.memoizedProps.value);break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(Ra(t),t.flags|=128,null):(n&t.child.childLanes)!==0?ch(e,t,n):(Ra(t),e=Pi(e,t,n),e!==null?e.sibling:null);Ra(t);break;case 19:var r=(e.flags&128)!==0;if(s=(n&t.childLanes)!==0,s||(ts(e,t,n,!1),s=(n&t.childLanes)!==0),r){if(s)return fh(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Q(zt,zt.current),s)break;return null;case 22:case 23:return t.lanes=0,ah(e,t,n);case 24:Dn(t,rt,e.memoizedState.cache)}return Pi(e,t,n)}function hh(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Yt=!0;else{if(!ru(e,n)&&(t.flags&128)===0)return Yt=!1,sg(e,t,n);Yt=(e.flags&131072)!==0}else Yt=!1,Me&&(t.flags&1048576)!==0&&Oo(t,qs,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var s=t.elementType,r=s._init;if(s=r(s._payload),t.type=s,typeof s=="function")Fa(s)?(e=hs(s,e),t.tag=1,t=rh(null,t,s,e,n)):(t.tag=0,t=eu(null,t,s,e,n));else{if(s!=null){if(r=s.$$typeof,r===x){t.tag=11,t=th(null,t,s,e,n);break e}else if(r===ie){t.tag=14,t=nh(null,t,s,e,n);break e}}throw t=w(s)||s,Error(A(306,t,""))}}return t;case 0:return eu(e,t,t.type,t.pendingProps,n);case 1:return s=t.type,r=hs(s,t.pendingProps),rh(e,t,s,r,n);case 3:e:{if(_e(t,t.stateNode.containerInfo),e===null)throw Error(A(387));s=t.pendingProps;var c=t.memoizedState;r=c.element,Xl(e,t),us(t,s,null,n);var d=t.memoizedState;if(s=d.cache,Dn(t,rt,s),s!==c.cache&&Vl(t,[rt],n,!0),cs(),s=d.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:d.cache},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){t=oh(e,t,s,n);break e}else if(s!==r){r=mn(Error(A(424)),t),Wn(r),t=oh(e,t,s,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(yt=ti(e.firstChild),It=t,Me=!0,Zn=null,vn=!0,n=Yf(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(ga(),s===r){t=Pi(e,t,n);break e}Jt(e,t,s,n)}t=t.child}return t;case 26:return Vo(e,t),e===null?(n=md(t.type,null,t.pendingProps,null))?t.memoizedState=n:Me||(n=t.type,e=t.pendingProps,s=ic(ge.current).createElement(n),s[Lt]=t,s[Zt]=e,Ft(s,n,e),Nt(s),t.stateNode=s):t.memoizedState=md(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return _t(t),e===null&&Me&&(s=t.stateNode=dd(t.type,t.pendingProps,ge.current),It=t,vn=!0,r=yt,Da(t.type)?(Gu=r,yt=ti(s.firstChild)):yt=r),Jt(e,t,t.pendingProps.children,n),Vo(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Me&&((r=s=yt)&&(s=kg(s,t.type,t.pendingProps,vn),s!==null?(t.stateNode=s,It=t,yt=ti(s.firstChild),vn=!1,r=!0):r=!1),r||Kn(t)),_t(t),r=t.type,c=t.pendingProps,d=e!==null?e.memoizedProps:null,s=c.children,ju(r,c)?s=null:d!==null&&ju(r,d)&&(t.flags|=32),t.memoizedState!==null&&(r=Fl(e,t,Pc,null,null,n),br._currentValue=r),Vo(e,t),Jt(e,t,s,n),t.child;case 6:return e===null&&Me&&((e=n=yt)&&(n=Dg(n,t.pendingProps,vn),n!==null?(t.stateNode=n,It=t,yt=null,e=!0):e=!1),e||Kn(t)),null;case 13:return ch(e,t,n);case 4:return _e(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Zs(t,null,s,n):Jt(e,t,s,n),t.child;case 11:return th(e,t,t.type,t.pendingProps,n);case 7:return Jt(e,t,t.pendingProps,n),t.child;case 8:return Jt(e,t,t.pendingProps.children,n),t.child;case 12:return Jt(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,Dn(t,t.type,s.value),Jt(e,t,s.children,n),t.child;case 9:return r=t.type._context,s=t.pendingProps.children,Hi(t),r=Bt(r),s=s(r),t.flags|=1,Jt(e,t,s,n),t.child;case 14:return nh(e,t,t.type,t.pendingProps,n);case 15:return ih(e,t,t.type,t.pendingProps,n);case 19:return fh(e,t,n);case 31:return s=t.pendingProps,n=t.mode,s={mode:s.mode,children:s.children},e===null?(n=Io(s,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=Yn(e.child,s),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return ah(e,t,n);case 24:return Hi(t),s=Bt(rt),e===null?(r=Yl(),r===null&&(r=ot,c=hi(),r.pooledCache=c,c.refCount++,c!==null&&(r.pooledCacheLanes|=n),r=c),t.memoizedState={parent:s,cache:r},Gs(t),Dn(t,rt,r)):((e.lanes&n)!==0&&(Xl(e,t),us(t,null,null,n),cs()),r=e.memoizedState,c=t.memoizedState,r.parent!==s?(r={parent:s,cache:s},t.memoizedState=r,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=r),Dn(t,rt,s)):(s=c.cache,Dn(t,rt,s),s!==r.cache&&Vl(t,[rt],n,!0))),Jt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(A(156,t.tag))}function Xi(e){e.flags|=4}function dh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Od(t)){if(t=Ln.current,t!==null&&((Qe&4194048)===Qe?bi!==null:(Qe&62914560)!==Qe&&(Qe&536870912)===0||t!==bi))throw rs=Pl,Eo;e.flags|=8192}}function Yo(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?Va():536870912,e.lanes|=t,Fs|=t)}function ar(e,t){if(!Me)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Ot(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&65011712,s|=r.flags&65011712,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function lg(e,t,n){var s=t.pendingProps;switch(ql(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(t),null;case 1:return Ot(t),null;case 3:return n=t.stateNode,s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),Dt(rt),gt(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Jn(t)?Xi(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,pa())),Ot(t),null;case 26:return n=t.memoizedState,e===null?(Xi(t),n!==null?(Ot(t),dh(t,n)):(Ot(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Xi(t),Ot(t),dh(t,n)):(Ot(t),t.flags&=-16777217):(e.memoizedProps!==s&&Xi(t),Ot(t),t.flags&=-16777217),null;case 27:sn(t),n=ge.current;var r=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Xi(t);else{if(!s){if(t.stateNode===null)throw Error(A(166));return Ot(t),null}e=se.current,Jn(t)?Hl(t):(e=dd(r,s,n),t.stateNode=e,Xi(t))}return Ot(t),null;case 5:if(sn(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Xi(t);else{if(!s){if(t.stateNode===null)throw Error(A(166));return Ot(t),null}if(e=se.current,Jn(t))Hl(t);else{switch(r=ic(ge.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof s.is=="string"?r.createElement("select",{is:s.is}):r.createElement("select"),s.multiple?e.multiple=!0:s.size&&(e.size=s.size);break;default:e=typeof s.is=="string"?r.createElement(n,{is:s.is}):r.createElement(n)}}e[Lt]=t,e[Zt]=s;e:for(r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(Ft(e,n,s),n){case"button":case"input":case"select":case"textarea":e=!!s.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Xi(t)}}return Ot(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==s&&Xi(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(A(166));if(e=ge.current,Jn(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,r=It,r!==null)switch(r.tag){case 27:case 5:s=r.memoizedProps}e[Lt]=t,e=!!(e.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||ld(e.nodeValue,n)),e||Kn(t)}else e=ic(e).createTextNode(s),e[Lt]=t,t.stateNode=e}return Ot(t),null;case 13:if(s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(r=Jn(t),s!==null&&s.dehydrated!==null){if(e===null){if(!r)throw Error(A(318));if(r=t.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(A(317));r[Lt]=t}else ga(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Ot(t),r=!1}else r=pa(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return t.flags&256?(Yi(t),t):(Yi(t),null)}if(Yi(t),(t.flags&128)!==0)return t.lanes=n,t;if(n=s!==null,e=e!==null&&e.memoizedState!==null,n){s=t.child,r=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(r=s.alternate.memoizedState.cachePool.pool);var c=null;s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==r&&(s.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Yo(t,t.updateQueue),Ot(t),null;case 4:return gt(),e===null&&Uu(t.stateNode.containerInfo),Ot(t),null;case 10:return Dt(t.type),Ot(t),null;case 19:if(Y(zt),r=t.memoizedState,r===null)return Ot(t),null;if(s=(t.flags&128)!==0,c=r.rendering,c===null)if(s)ar(r,!1);else{if(Ct!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(c=qo(e),c!==null){for(t.flags|=128,ar(r,!1),e=c.updateQueue,t.updateQueue=e,Yo(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)So(n,e),n=n.sibling;return Q(zt,zt.current&1|2),t.child}e=e.sibling}r.tail!==null&&Ze()>Qo&&(t.flags|=128,s=!0,ar(r,!1),t.lanes=4194304)}else{if(!s)if(e=qo(c),e!==null){if(t.flags|=128,s=!0,e=e.updateQueue,t.updateQueue=e,Yo(t,e),ar(r,!0),r.tail===null&&r.tailMode==="hidden"&&!c.alternate&&!Me)return Ot(t),null}else 2*Ze()-r.renderingStartTime>Qo&&n!==536870912&&(t.flags|=128,s=!0,ar(r,!1),t.lanes=4194304);r.isBackwards?(c.sibling=t.child,t.child=c):(e=r.last,e!==null?e.sibling=c:t.child=c,r.last=c)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Ze(),t.sibling=null,e=zt.current,Q(zt,s?e&1|2:e&1),t):(Ot(t),null);case 22:case 23:return Yi(t),Jl(),s=t.memoizedState!==null,e!==null?e.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?(n&536870912)!==0&&(t.flags&128)===0&&(Ot(t),t.subtreeFlags&6&&(t.flags|=8192)):Ot(t),n=t.updateQueue,n!==null&&Yo(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),e!==null&&Y(di),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Dt(rt),Ot(t),null;case 25:return null;case 30:return null}throw Error(A(156,t.tag))}function rg(e,t){switch(ql(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Dt(rt),gt(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return sn(t),null;case 13:if(Yi(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(A(340));ga()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Y(zt),null;case 4:return gt(),null;case 10:return Dt(t.type),null;case 22:case 23:return Yi(t),Jl(),e!==null&&Y(di),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return Dt(rt),null;case 25:return null;default:return null}}function gh(e,t){switch(ql(t),t.tag){case 3:Dt(rt),gt();break;case 26:case 27:case 5:sn(t);break;case 4:gt();break;case 13:Yi(t);break;case 19:Y(zt);break;case 10:Dt(t.type);break;case 22:case 23:Yi(t),Jl(),e!==null&&Y(di);break;case 24:Dt(rt)}}function sr(e,t){try{var n=t.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var r=s.next;n=r;do{if((n.tag&e)===e){s=void 0;var c=n.create,d=n.inst;s=c(),d.destroy=s}n=n.next}while(n!==r)}}catch(g){lt(t,t.return,g)}}function _a(e,t,n){try{var s=t.updateQueue,r=s!==null?s.lastEffect:null;if(r!==null){var c=r.next;s=c;do{if((s.tag&e)===e){var d=s.inst,g=d.destroy;if(g!==void 0){d.destroy=void 0,r=t;var y=n,C=g;try{C()}catch(D){lt(r,y,D)}}}s=s.next}while(s!==c)}}catch(D){lt(t,t.return,D)}}function ph(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Kl(t,n)}catch(s){lt(e,e.return,s)}}}function mh(e,t,n){n.props=hs(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(s){lt(e,t,s)}}function lr(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;case 30:s=e.stateNode;break;default:s=e.stateNode}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(r){lt(e,t,r)}}function Si(e,t){var n=e.ref,s=e.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(r){lt(e,t,r)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){lt(e,t,r)}else n.current=null}function yh(e){var t=e.type,n=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(r){lt(e,e.return,r)}}function ou(e,t,n){try{var s=e.stateNode;Mg(s,e.type,n,t),s[Zt]=t}catch(r){lt(e,e.return,r)}}function vh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&Da(e.type)||e.tag===4}function cu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||vh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&Da(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function uu(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=nc));else if(s!==4&&(s===27&&Da(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(uu(e,t,n),e=e.sibling;e!==null;)uu(e,t,n),e=e.sibling}function Po(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(s===27&&Da(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Po(e,t,n),e=e.sibling;e!==null;)Po(e,t,n),e=e.sibling}function bh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var s=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);Ft(t,s,n),t[Lt]=e,t[Zt]=n}catch(c){lt(e,e.return,c)}}var Qi=!1,Mt=!1,fu=!1,Sh=typeof WeakSet=="function"?WeakSet:Set,Pt=null;function og(e,t){if(e=e.containerInfo,Lu=cc,e=tn(e),Wa(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var d=0,g=-1,y=-1,C=0,D=0,G=e,_=null;t:for(;;){for(var E;G!==n||r!==0&&G.nodeType!==3||(g=d+r),G!==c||s!==0&&G.nodeType!==3||(y=d+s),G.nodeType===3&&(d+=G.nodeValue.length),(E=G.firstChild)!==null;)_=G,G=E;for(;;){if(G===e)break t;if(_===n&&++C===r&&(g=d),_===c&&++D===s&&(y=d),(E=G.nextSibling)!==null)break;G=_,_=G.parentNode}G=E}n=g===-1||y===-1?null:{start:g,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bu={focusedElem:e,selectionRange:n},cc=!1,Pt=t;Pt!==null;)if(t=Pt,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,Pt=e;else for(;Pt!==null;){switch(t=Pt,c=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&c!==null){e=void 0,n=t,r=c.memoizedProps,c=c.memoizedState,s=n.stateNode;try{var Ae=hs(n.type,r,n.elementType===n.type);e=s.getSnapshotBeforeUpdate(Ae,c),s.__reactInternalSnapshotBeforeUpdate=e}catch(ye){lt(n,n.return,ye)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)qu(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":qu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(A(163))}if(e=t.sibling,e!==null){e.return=t.return,Pt=e;break}Pt=t.return}}function Oh(e,t,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:Ea(e,n),s&4&&sr(5,n);break;case 1:if(Ea(e,n),s&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(d){lt(n,n.return,d)}else{var r=hs(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(d){lt(n,n.return,d)}}s&64&&ph(n),s&512&&lr(n,n.return);break;case 3:if(Ea(e,n),s&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Kl(e,t)}catch(d){lt(n,n.return,d)}}break;case 27:t===null&&s&4&&bh(n);case 26:case 5:Ea(e,n),t===null&&s&4&&yh(n),s&512&&lr(n,n.return);break;case 12:Ea(e,n);break;case 13:Ea(e,n),s&4&&Rh(e,n),s&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=yg.bind(null,n),Lg(e,n))));break;case 22:if(s=n.memoizedState!==null||Qi,!s){t=t!==null&&t.memoizedState!==null||Mt,r=Qi;var c=Mt;Qi=s,(Mt=t)&&!c?Ma(e,n,(n.subtreeFlags&8772)!==0):Ea(e,n),Qi=r,Mt=c}break;case 30:break;default:Ea(e,n)}}function Ah(e){var t=e.alternate;t!==null&&(e.alternate=null,Ah(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&pl(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var vt=null,Sn=!1;function Zi(e,t,n){for(n=n.child;n!==null;)Th(e,t,n),n=n.sibling}function Th(e,t,n){if(Z&&typeof Z.onCommitFiberUnmount=="function")try{Z.onCommitFiberUnmount(Tn,n)}catch{}switch(n.tag){case 26:Mt||Si(n,t),Zi(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Mt||Si(n,t);var s=vt,r=Sn;Da(n.type)&&(vt=n.stateNode,Sn=!1),Zi(e,t,n),pr(n.stateNode),vt=s,Sn=r;break;case 5:Mt||Si(n,t);case 6:if(s=vt,r=Sn,vt=null,Zi(e,t,n),vt=s,Sn=r,vt!==null)if(Sn)try{(vt.nodeType===9?vt.body:vt.nodeName==="HTML"?vt.ownerDocument.body:vt).removeChild(n.stateNode)}catch(c){lt(n,t,c)}else try{vt.removeChild(n.stateNode)}catch(c){lt(n,t,c)}break;case 18:vt!==null&&(Sn?(e=vt,fd(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Tr(e)):fd(vt,n.stateNode));break;case 4:s=vt,r=Sn,vt=n.stateNode.containerInfo,Sn=!0,Zi(e,t,n),vt=s,Sn=r;break;case 0:case 11:case 14:case 15:Mt||_a(2,n,t),Mt||_a(4,n,t),Zi(e,t,n);break;case 1:Mt||(Si(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"&&mh(n,t,s)),Zi(e,t,n);break;case 21:Zi(e,t,n);break;case 22:Mt=(s=Mt)||n.memoizedState!==null,Zi(e,t,n),Mt=s;break;default:Zi(e,t,n)}}function Rh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Tr(e)}catch(n){lt(t,t.return,n)}}function cg(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new Sh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new Sh),t;default:throw Error(A(435,e.tag))}}function hu(e,t){var n=cg(e);t.forEach(function(s){var r=vg.bind(null,e,s);n.has(s)||(n.add(s),s.then(r,r))})}function Cn(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s],c=e,d=t,g=d;e:for(;g!==null;){switch(g.tag){case 27:if(Da(g.type)){vt=g.stateNode,Sn=!1;break e}break;case 5:vt=g.stateNode,Sn=!1;break e;case 3:case 4:vt=g.stateNode.containerInfo,Sn=!0;break e}g=g.return}if(vt===null)throw Error(A(160));Th(c,d,r),vt=null,Sn=!1,c=r.alternate,c!==null&&(c.return=null),r.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Ch(t,e),t=t.sibling}var ei=null;function Ch(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Cn(t,e),_n(e),s&4&&(_a(3,e,e.return),sr(3,e),_a(5,e,e.return));break;case 1:Cn(t,e),_n(e),s&512&&(Mt||n===null||Si(n,n.return)),s&64&&Qi&&(e=e.updateQueue,e!==null&&(s=e.callbacks,s!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var r=ei;if(Cn(t,e),_n(e),s&512&&(Mt||n===null||Si(n,n.return)),s&4){var c=n!==null?n.memoizedState:null;if(s=e.memoizedState,n===null)if(s===null)if(e.stateNode===null){e:{s=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(s){case"title":c=r.getElementsByTagName("title")[0],(!c||c[Ia]||c[Lt]||c.namespaceURI==="http://www.w3.org/2000/svg"||c.hasAttribute("itemprop"))&&(c=r.createElement(s),r.head.insertBefore(c,r.querySelector("head > title"))),Ft(c,s,n),c[Lt]=e,Nt(c),s=c;break e;case"link":var d=bd("link","href",r).get(s+(n.href||""));if(d){for(var g=0;g<d.length;g++)if(c=d[g],c.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&c.getAttribute("rel")===(n.rel==null?null:n.rel)&&c.getAttribute("title")===(n.title==null?null:n.title)&&c.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){d.splice(g,1);break t}}c=r.createElement(s),Ft(c,s,n),r.head.appendChild(c);break;case"meta":if(d=bd("meta","content",r).get(s+(n.content||""))){for(g=0;g<d.length;g++)if(c=d[g],c.getAttribute("content")===(n.content==null?null:""+n.content)&&c.getAttribute("name")===(n.name==null?null:n.name)&&c.getAttribute("property")===(n.property==null?null:n.property)&&c.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&c.getAttribute("charset")===(n.charSet==null?null:n.charSet)){d.splice(g,1);break t}}c=r.createElement(s),Ft(c,s,n),r.head.appendChild(c);break;default:throw Error(A(468,s))}c[Lt]=e,Nt(c),s=c}e.stateNode=s}else Sd(r,e.type,e.stateNode);else e.stateNode=vd(r,s,e.memoizedProps);else c!==s?(c===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):c.count--,s===null?Sd(r,e.type,e.stateNode):vd(r,s,e.memoizedProps)):s===null&&e.stateNode!==null&&ou(e,e.memoizedProps,n.memoizedProps)}break;case 27:Cn(t,e),_n(e),s&512&&(Mt||n===null||Si(n,n.return)),n!==null&&s&4&&ou(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Cn(t,e),_n(e),s&512&&(Mt||n===null||Si(n,n.return)),e.flags&32){r=e.stateNode;try{ue(r,"")}catch(E){lt(e,e.return,E)}}s&4&&e.stateNode!=null&&(r=e.memoizedProps,ou(e,r,n!==null?n.memoizedProps:r)),s&1024&&(fu=!0);break;case 6:if(Cn(t,e),_n(e),s&4){if(e.stateNode===null)throw Error(A(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(E){lt(e,e.return,E)}}break;case 3:if(lc=null,r=ei,ei=ac(t.containerInfo),Cn(t,e),ei=r,_n(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Tr(t.containerInfo)}catch(E){lt(e,e.return,E)}fu&&(fu=!1,_h(e));break;case 4:s=ei,ei=ac(e.stateNode.containerInfo),Cn(t,e),_n(e),ei=s;break;case 12:Cn(t,e),_n(e);break;case 13:Cn(t,e),_n(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(vu=Ze()),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,hu(e,s)));break;case 22:r=e.memoizedState!==null;var y=n!==null&&n.memoizedState!==null,C=Qi,D=Mt;if(Qi=C||r,Mt=D||y,Cn(t,e),Mt=D,Qi=C,_n(e),s&8192)e:for(t=e.stateNode,t._visibility=r?t._visibility&-2:t._visibility|1,r&&(n===null||y||Qi||Mt||ds(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){y=n=t;try{if(c=y.stateNode,r)d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none";else{g=y.stateNode;var G=y.memoizedProps.style,_=G!=null&&G.hasOwnProperty("display")?G.display:null;g.style.display=_==null||typeof _=="boolean"?"":(""+_).trim()}}catch(E){lt(y,y.return,E)}}}else if(t.tag===6){if(n===null){y=t;try{y.stateNode.nodeValue=r?"":y.memoizedProps}catch(E){lt(y,y.return,E)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=e.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,hu(e,n))));break;case 19:Cn(t,e),_n(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,hu(e,s)));break;case 30:break;case 21:break;default:Cn(t,e),_n(e)}}function _n(e){var t=e.flags;if(t&2){try{for(var n,s=e.return;s!==null;){if(vh(s)){n=s;break}s=s.return}if(n==null)throw Error(A(160));switch(n.tag){case 27:var r=n.stateNode,c=cu(e);Po(e,c,r);break;case 5:var d=n.stateNode;n.flags&32&&(ue(d,""),n.flags&=-33);var g=cu(e);Po(e,g,d);break;case 3:case 4:var y=n.stateNode.containerInfo,C=cu(e);uu(e,C,y);break;default:throw Error(A(161))}}catch(D){lt(e,e.return,D)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function _h(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;_h(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ea(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Oh(e,t.alternate,t),t=t.sibling}function ds(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:_a(4,t,t.return),ds(t);break;case 1:Si(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&mh(t,t.return,n),ds(t);break;case 27:pr(t.stateNode);case 26:case 5:Si(t,t.return),ds(t);break;case 22:t.memoizedState===null&&ds(t);break;case 30:ds(t);break;default:ds(t)}e=e.sibling}}function Ma(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,r=e,c=t,d=c.flags;switch(c.tag){case 0:case 11:case 15:Ma(r,c,n),sr(4,c);break;case 1:if(Ma(r,c,n),s=c,r=s.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(C){lt(s,s.return,C)}if(s=c,r=s.updateQueue,r!==null){var g=s.stateNode;try{var y=r.shared.hiddenCallbacks;if(y!==null)for(r.shared.hiddenCallbacks=null,r=0;r<y.length;r++)Oa(y[r],g)}catch(C){lt(s,s.return,C)}}n&&d&64&&ph(c),lr(c,c.return);break;case 27:bh(c);case 26:case 5:Ma(r,c,n),n&&s===null&&d&4&&yh(c),lr(c,c.return);break;case 12:Ma(r,c,n);break;case 13:Ma(r,c,n),n&&d&4&&Rh(r,c);break;case 22:c.memoizedState===null&&Ma(r,c,n),lr(c,c.return);break;case 30:break;default:Ma(r,c,n)}t=t.sibling}}function du(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&as(n))}function gu(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&as(e))}function Oi(e,t,n,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)Eh(e,t,n,s),t=t.sibling}function Eh(e,t,n,s){var r=t.flags;switch(t.tag){case 0:case 11:case 15:Oi(e,t,n,s),r&2048&&sr(9,t);break;case 1:Oi(e,t,n,s);break;case 3:Oi(e,t,n,s),r&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&as(e)));break;case 12:if(r&2048){Oi(e,t,n,s),e=t.stateNode;try{var c=t.memoizedProps,d=c.id,g=c.onPostCommit;typeof g=="function"&&g(d,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(y){lt(t,t.return,y)}}else Oi(e,t,n,s);break;case 13:Oi(e,t,n,s);break;case 23:break;case 22:c=t.stateNode,d=t.alternate,t.memoizedState!==null?c._visibility&2?Oi(e,t,n,s):rr(e,t):c._visibility&2?Oi(e,t,n,s):(c._visibility|=2,Ks(e,t,n,s,(t.subtreeFlags&10256)!==0)),r&2048&&du(d,t);break;case 24:Oi(e,t,n,s),r&2048&&gu(t.alternate,t);break;default:Oi(e,t,n,s)}}function Ks(e,t,n,s,r){for(r=r&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var c=e,d=t,g=n,y=s,C=d.flags;switch(d.tag){case 0:case 11:case 15:Ks(c,d,g,y,r),sr(8,d);break;case 23:break;case 22:var D=d.stateNode;d.memoizedState!==null?D._visibility&2?Ks(c,d,g,y,r):rr(c,d):(D._visibility|=2,Ks(c,d,g,y,r)),r&&C&2048&&du(d.alternate,d);break;case 24:Ks(c,d,g,y,r),r&&C&2048&&gu(d.alternate,d);break;default:Ks(c,d,g,y,r)}t=t.sibling}}function rr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,s=t,r=s.flags;switch(s.tag){case 22:rr(n,s),r&2048&&du(s.alternate,s);break;case 24:rr(n,s),r&2048&&gu(s.alternate,s);break;default:rr(n,s)}t=t.sibling}}var or=8192;function Js(e){if(e.subtreeFlags&or)for(e=e.child;e!==null;)Mh(e),e=e.sibling}function Mh(e){switch(e.tag){case 26:Js(e),e.flags&or&&e.memoizedState!==null&&Zg(ei,e.memoizedState,e.memoizedProps);break;case 5:Js(e);break;case 3:case 4:var t=ei;ei=ac(e.stateNode.containerInfo),Js(e),ei=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=or,or=16777216,Js(e),or=t):Js(e));break;default:Js(e)}}function wh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function cr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Pt=s,Nh(s,e)}wh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)xh(e),e=e.sibling}function xh(e){switch(e.tag){case 0:case 11:case 15:cr(e),e.flags&2048&&_a(9,e,e.return);break;case 3:cr(e);break;case 12:cr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Xo(e)):cr(e);break;default:cr(e)}}function Xo(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Pt=s,Nh(s,e)}wh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:_a(8,t,t.return),Xo(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Xo(t));break;default:Xo(t)}e=e.sibling}}function Nh(e,t){for(;Pt!==null;){var n=Pt;switch(n.tag){case 0:case 11:case 15:_a(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:as(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,Pt=s;else e:for(n=e;Pt!==null;){s=Pt;var r=s.sibling,c=s.return;if(Ah(s),s===n){Pt=null;break e}if(r!==null){r.return=c,Pt=r;break e}Pt=c}}}var ug={getCacheForType:function(e){var t=Bt(rt),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},fg=typeof WeakMap=="function"?WeakMap:Map,tt=0,ot=null,He=null,Qe=0,nt=0,En=null,wa=!1,Ws=!1,pu=!1,Ki=0,Ct=0,xa=0,gs=0,mu=0,Bn=0,Fs=0,ur=null,On=null,yu=!1,vu=0,Qo=1/0,Zo=null,Na=null,Wt=0,Ua=null,$s=null,el=0,bu=0,Su=null,Uh=null,fr=0,Ou=null;function Mn(){if((tt&2)!==0&&Qe!==0)return Qe&-Qe;if(N.T!==null){var e=va;return e!==0?e:Mu()}return dl()}function kh(){Bn===0&&(Bn=(Qe&536870912)===0||Me?ul():536870912);var e=Ln.current;return e!==null&&(e.flags|=32),Bn}function wn(e,t,n){(e===ot&&(nt===2||nt===9)||e.cancelPendingCommit!==null)&&(tl(e,0),ka(e,Qe,Bn,!1)),Fi(e,n),((tt&2)===0||e!==ot)&&(e===ot&&((tt&2)===0&&(gs|=n),Ct===4&&ka(e,Qe,Bn,!1)),Ai(e))}function Dh(e,t,n){if((tt&6)!==0)throw Error(A(327));var s=!n&&(t&124)===0&&(t&e.expiredLanes)===0||Wi(e,t),r=s?gg(e,t):Ru(e,t,!0),c=s;do{if(r===0){Ws&&!s&&ka(e,t,0,!1);break}else{if(n=e.current.alternate,c&&!hg(n)){r=Ru(e,t,!1),c=!1;continue}if(r===2){if(c=t,e.errorRecoveryDisabledLanes&c)var d=0;else d=e.pendingLanes&-536870913,d=d!==0?d:d&536870912?536870912:0;if(d!==0){t=d;e:{var g=e;r=ur;var y=g.current.memoizedState.isDehydrated;if(y&&(tl(g,d).flags|=256),d=Ru(g,d,!1),d!==2){if(pu&&!y){g.errorRecoveryDisabledLanes|=c,gs|=c,r=4;break e}c=On,On=r,c!==null&&(On===null?On=c:On.push.apply(On,c))}r=d}if(c=!1,r!==2)continue}}if(r===1){tl(e,0),ka(e,t,0,!0);break}e:{switch(s=e,c=r,c){case 0:case 1:throw Error(A(345));case 4:if((t&4194048)!==t)break;case 6:ka(s,t,Bn,!wa);break e;case 2:On=null;break;case 3:case 5:break;default:throw Error(A(329))}if((t&62914560)===t&&(r=vu+300-Ze(),10<r)){if(ka(s,t,Bn,!wa),Ga(s,0,!0)!==0)break e;s.timeoutHandle=cd(Lh.bind(null,s,n,On,Zo,yu,t,Bn,gs,Fs,wa,c,2,-0,0),r);break e}Lh(s,n,On,Zo,yu,t,Bn,gs,Fs,wa,c,0,-0,0)}}break}while(!0);Ai(e)}function Lh(e,t,n,s,r,c,d,g,y,C,D,G,_,E){if(e.timeoutHandle=-1,G=t.subtreeFlags,(G&8192||(G&16785408)===16785408)&&(vr={stylesheets:null,count:0,unsuspend:Qg},Mh(t),G=Kg(),G!==null)){e.cancelPendingCommit=G(Vh.bind(null,e,t,c,n,s,r,d,g,y,D,1,_,E)),ka(e,c,d,!C);return}Vh(e,t,c,n,s,r,d,g,y)}function hg(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var r=n[s],c=r.getSnapshot;r=r.value;try{if(!rn(c(),r))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ka(e,t,n,s){t&=~mu,t&=~gs,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var r=t;0<r;){var c=31-K(r),d=1<<c;s[c]=-1,r&=~d}n!==0&&xr(e,n,t)}function Ko(){return(tt&6)===0?(hr(0),!1):!0}function Au(){if(He!==null){if(nt===0)var e=He.return;else e=He,Fn=kn=null,l(e),Qs=null,nr=0,e=He;for(;e!==null;)gh(e.alternate,e),e=e.return;He=null}}function tl(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,xg(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Au(),ot=e,He=n=Yn(e.current,null),Qe=t,nt=0,En=null,wa=!1,Ws=Wi(e,t),pu=!1,Fs=Bn=mu=gs=xa=Ct=0,On=ur=null,yu=!1,(t&8)!==0&&(t|=t&32);var s=e.entangledLanes;if(s!==0)for(e=e.entanglements,s&=t;0<s;){var r=31-K(s),c=1<<r;t|=e[r],s&=~c}return Ki=t,Ls(),n}function Bh(e,t){ke=null,N.H=Bo,t===ss||t===Hs?(t=xo(),nt=3):t===Eo?(t=xo(),nt=4):nt=t===eh?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,En=t,He===null&&(Ct=1,Go(e,mn(t,e.current)))}function jh(){var e=N.H;return N.H=Bo,e===null?Bo:e}function zh(){var e=N.A;return N.A=ug,e}function Tu(){Ct=4,wa||(Qe&4194048)!==Qe&&Ln.current!==null||(Ws=!0),(xa&134217727)===0&&(gs&134217727)===0||ot===null||ka(ot,Qe,Bn,!1)}function Ru(e,t,n){var s=tt;tt|=2;var r=jh(),c=zh();(ot!==e||Qe!==t)&&(Zo=null,tl(e,t)),t=!1;var d=Ct;e:do try{if(nt!==0&&He!==null){var g=He,y=En;switch(nt){case 8:Au(),d=6;break e;case 3:case 2:case 9:case 6:Ln.current===null&&(t=!0);var C=nt;if(nt=0,En=null,nl(e,g,y,C),n&&Ws){d=0;break e}break;default:C=nt,nt=0,En=null,nl(e,g,y,C)}}dg(),d=Ct;break}catch(D){Bh(e,D)}while(!0);return t&&e.shellSuspendCounter++,Fn=kn=null,tt=s,N.H=r,N.A=c,He===null&&(ot=null,Qe=0,Ls()),d}function dg(){for(;He!==null;)qh(He)}function gg(e,t){var n=tt;tt|=2;var s=jh(),r=zh();ot!==e||Qe!==t?(Zo=null,Qo=Ze()+500,tl(e,t)):Ws=Wi(e,t);e:do try{if(nt!==0&&He!==null){t=He;var c=En;t:switch(nt){case 1:nt=0,En=null,nl(e,t,c,1);break;case 2:case 9:if(Mo(c)){nt=0,En=null,Hh(t);break}t=function(){nt!==2&&nt!==9||ot!==e||(nt=7),Ai(e)},c.then(t,t);break e;case 3:nt=7;break e;case 4:nt=5;break e;case 7:Mo(c)?(nt=0,En=null,Hh(t)):(nt=0,En=null,nl(e,t,c,7));break;case 5:var d=null;switch(He.tag){case 26:d=He.memoizedState;case 5:case 27:var g=He;if(!d||Od(d)){nt=0,En=null;var y=g.sibling;if(y!==null)He=y;else{var C=g.return;C!==null?(He=C,Jo(C)):He=null}break t}}nt=0,En=null,nl(e,t,c,5);break;case 6:nt=0,En=null,nl(e,t,c,6);break;case 8:Au(),Ct=6;break e;default:throw Error(A(462))}}pg();break}catch(D){Bh(e,D)}while(!0);return Fn=kn=null,N.H=s,N.A=r,tt=n,He!==null?0:(ot=null,Qe=0,Ls(),Ct)}function pg(){for(;He!==null&&!Be();)qh(He)}function qh(e){var t=hh(e.alternate,e,Ki);e.memoizedProps=e.pendingProps,t===null?Jo(e):He=t}function Hh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=lh(n,t,t.pendingProps,t.type,void 0,Qe);break;case 11:t=lh(n,t,t.pendingProps,t.type.render,t.ref,Qe);break;case 5:l(t);default:gh(n,t),t=He=So(t,Ki),t=hh(n,t,Ki)}e.memoizedProps=e.pendingProps,t===null?Jo(e):He=t}function nl(e,t,n,s){Fn=kn=null,l(t),Qs=null,nr=0;var r=t.return;try{if(ag(e,r,t,n,Qe)){Ct=1,Go(e,mn(n,e.current)),He=null;return}}catch(c){if(r!==null)throw He=r,c;Ct=1,Go(e,mn(n,e.current)),He=null;return}t.flags&32768?(Me||s===1?e=!0:Ws||(Qe&536870912)!==0?e=!1:(wa=e=!0,(s===2||s===9||s===3||s===6)&&(s=Ln.current,s!==null&&s.tag===13&&(s.flags|=16384))),Gh(t,e)):Jo(t)}function Jo(e){var t=e;do{if((t.flags&32768)!==0){Gh(t,wa);return}e=t.return;var n=lg(t.alternate,t,Ki);if(n!==null){He=n;return}if(t=t.sibling,t!==null){He=t;return}He=t=e}while(t!==null);Ct===0&&(Ct=5)}function Gh(e,t){do{var n=rg(e.alternate,e);if(n!==null){n.flags&=32767,He=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){He=e;return}He=e=n}while(e!==null);Ct=6,He=null}function Vh(e,t,n,s,r,c,d,g,y){e.cancelPendingCommit=null;do Wo();while(Wt!==0);if((tt&6)!==0)throw Error(A(327));if(t!==null){if(t===e.current)throw Error(A(177));if(c=t.lanes|t.childLanes,c|=Ll,wr(e,n,c,d,g,y),e===ot&&(He=ot=null,Qe=0),$s=t,Ua=e,el=n,bu=c,Su=r,Uh=s,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,bg(Ue,function(){return Qh(),null})):(e.callbackNode=null,e.callbackPriority=0),s=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||s){s=N.T,N.T=null,r=U.p,U.p=2,d=tt,tt|=4;try{og(e,t,n)}finally{tt=d,U.p=r,N.T=s}}Wt=1,Ih(),Yh(),Ph()}}function Ih(){if(Wt===1){Wt=0;var e=Ua,t=$s,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=N.T,N.T=null;var s=U.p;U.p=2;var r=tt;tt|=4;try{Ch(t,e);var c=Bu,d=tn(e.containerInfo),g=c.focusedElem,y=c.selectionRange;if(d!==g&&g&&g.ownerDocument&&Ul(g.ownerDocument.documentElement,g)){if(y!==null&&Wa(g)){var C=y.start,D=y.end;if(D===void 0&&(D=C),"selectionStart"in g)g.selectionStart=C,g.selectionEnd=Math.min(D,g.value.length);else{var G=g.ownerDocument||document,_=G&&G.defaultView||window;if(_.getSelection){var E=_.getSelection(),Ae=g.textContent.length,ye=Math.min(y.start,Ae),st=y.end===void 0?ye:Math.min(y.end,Ae);!E.extend&&ye>st&&(d=st,st=ye,ye=d);var O=Us(g,ye),b=Us(g,st);if(O&&b&&(E.rangeCount!==1||E.anchorNode!==O.node||E.anchorOffset!==O.offset||E.focusNode!==b.node||E.focusOffset!==b.offset)){var T=G.createRange();T.setStart(O.node,O.offset),E.removeAllRanges(),ye>st?(E.addRange(T),E.extend(b.node,b.offset)):(T.setEnd(b.node,b.offset),E.addRange(T))}}}}for(G=[],E=g;E=E.parentNode;)E.nodeType===1&&G.push({element:E,left:E.scrollLeft,top:E.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<G.length;g++){var H=G[g];H.element.scrollLeft=H.left,H.element.scrollTop=H.top}}cc=!!Lu,Bu=Lu=null}finally{tt=r,U.p=s,N.T=n}}e.current=t,Wt=2}}function Yh(){if(Wt===2){Wt=0;var e=Ua,t=$s,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=N.T,N.T=null;var s=U.p;U.p=2;var r=tt;tt|=4;try{Oh(e,t.alternate,t)}finally{tt=r,U.p=s,N.T=n}}Wt=3}}function Ph(){if(Wt===4||Wt===3){Wt=0,ut();var e=Ua,t=$s,n=el,s=Uh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Wt=5:(Wt=0,$s=Ua=null,Xh(e,e.pendingLanes));var r=e.pendingLanes;if(r===0&&(Na=null),hl(n),t=t.stateNode,Z&&typeof Z.onCommitFiberRoot=="function")try{Z.onCommitFiberRoot(Tn,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=N.T,r=U.p,U.p=2,N.T=null;try{for(var c=e.onRecoverableError,d=0;d<s.length;d++){var g=s[d];c(g.value,{componentStack:g.stack})}}finally{N.T=t,U.p=r}}(el&3)!==0&&Wo(),Ai(e),r=e.pendingLanes,(n&4194090)!==0&&(r&42)!==0?e===Ou?fr++:(fr=0,Ou=e):fr=0,hr(0)}}function Xh(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,as(t)))}function Wo(e){return Ih(),Yh(),Ph(),Qh()}function Qh(){if(Wt!==5)return!1;var e=Ua,t=bu;bu=0;var n=hl(el),s=N.T,r=U.p;try{U.p=32>n?32:n,N.T=null,n=Su,Su=null;var c=Ua,d=el;if(Wt=0,$s=Ua=null,el=0,(tt&6)!==0)throw Error(A(331));var g=tt;if(tt|=4,xh(c.current),Eh(c,c.current,d,n),tt=g,hr(0,!1),Z&&typeof Z.onPostCommitFiberRoot=="function")try{Z.onPostCommitFiberRoot(Tn,c)}catch{}return!0}finally{U.p=r,N.T=s,Xh(e,t)}}function Zh(e,t,n){t=mn(n,t),t=$c(e.stateNode,t,2),e=pi(e,t,2),e!==null&&(Fi(e,2),Ai(e))}function lt(e,t,n){if(e.tag===3)Zh(e,e,n);else for(;t!==null;){if(t.tag===3){Zh(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Na===null||!Na.has(s))){e=mn(n,e),n=Ff(2),s=pi(t,n,2),s!==null&&($f(n,s,t,e),Fi(s,2),Ai(s));break}}t=t.return}}function Cu(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new fg;var r=new Set;s.set(t,r)}else r=s.get(t),r===void 0&&(r=new Set,s.set(t,r));r.has(n)||(pu=!0,r.add(n),e=mg.bind(null,e,t,n),t.then(e,e))}function mg(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ot===e&&(Qe&n)===n&&(Ct===4||Ct===3&&(Qe&62914560)===Qe&&300>Ze()-vu?(tt&2)===0&&tl(e,0):mu|=n,Fs===Qe&&(Fs=0)),Ai(e)}function Kh(e,t){t===0&&(t=Va()),e=fa(e,t),e!==null&&(Fi(e,t),Ai(e))}function yg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Kh(e,n)}function vg(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(A(314))}s!==null&&s.delete(t),Kh(e,n)}function bg(e,t){return V(e,t)}var Fo=null,il=null,_u=!1,$o=!1,Eu=!1,ps=0;function Ai(e){e!==il&&e.next===null&&(il===null?Fo=il=e:il=il.next=e),$o=!0,_u||(_u=!0,Og())}function hr(e,t){if(!Eu&&$o){Eu=!0;do for(var n=!1,s=Fo;s!==null;){if(e!==0){var r=s.pendingLanes;if(r===0)var c=0;else{var d=s.suspendedLanes,g=s.pingedLanes;c=(1<<31-K(42|e)+1)-1,c&=r&~(d&~g),c=c&201326741?c&201326741|1:c?c|2:0}c!==0&&(n=!0,$h(s,c))}else c=Qe,c=Ga(s,s===ot?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),(c&3)===0||Wi(s,c)||(n=!0,$h(s,c));s=s.next}while(n);Eu=!1}}function Sg(){Jh()}function Jh(){$o=_u=!1;var e=0;ps!==0&&(wg()&&(e=ps),ps=0);for(var t=Ze(),n=null,s=Fo;s!==null;){var r=s.next,c=Wh(s,t);c===0?(s.next=null,n===null?Fo=r:n.next=r,r===null&&(il=n)):(n=s,(e!==0||(c&3)!==0)&&($o=!0)),s=r}hr(e)}function Wh(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,c=e.pendingLanes&-62914561;0<c;){var d=31-K(c),g=1<<d,y=r[d];y===-1?((g&n)===0||(g&s)!==0)&&(r[d]=ms(g,t)):y<=t&&(e.expiredLanes|=g),c&=~g}if(t=ot,n=Qe,n=Ga(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s=e.callbackNode,n===0||e===t&&(nt===2||nt===9)||e.cancelPendingCommit!==null)return s!==null&&s!==null&&P(s),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||Wi(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(s!==null&&P(s),hl(n)){case 2:case 8:n=$t;break;case 32:n=Ue;break;case 268435456:n=un;break;default:n=Ue}return s=Fh.bind(null,e),n=V(n,s),e.callbackPriority=t,e.callbackNode=n,t}return s!==null&&s!==null&&P(s),e.callbackPriority=2,e.callbackNode=null,2}function Fh(e,t){if(Wt!==0&&Wt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Wo()&&e.callbackNode!==n)return null;var s=Qe;return s=Ga(e,e===ot?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s===0?null:(Dh(e,s,t),Wh(e,Ze()),e.callbackNode!=null&&e.callbackNode===n?Fh.bind(null,e):null)}function $h(e,t){if(Wo())return null;Dh(e,t,!0)}function Og(){Ng(function(){(tt&6)!==0?V(Ht,Sg):Jh()})}function Mu(){return ps===0&&(ps=ul()),ps}function ed(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ts(""+e)}function td(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Ag(e,t,n,s,r){if(t==="submit"&&n&&n.stateNode===r){var c=ed((r[Zt]||null).action),d=s.submitter;d&&(t=(t=d[Zt]||null)?ed(t.formAction):d.getAttribute("formAction"),t!==null&&(c=t,d=null));var g=new Ms("action","action",null,s,r);e.push({event:g,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(ps!==0){var y=d?td(r,d):new FormData(r);Zc(n,{pending:!0,data:y,method:r.method,action:c},null,y)}}else typeof c=="function"&&(g.preventDefault(),y=d?td(r,d):new FormData(r),Zc(n,{pending:!0,data:y,method:r.method,action:c},c,y))},currentTarget:r}]})}}for(var wu=0;wu<ca.length;wu++){var xu=ca[wu],Tg=xu.toLowerCase(),Rg=xu[0].toUpperCase()+xu.slice(1);Ut(Tg,"on"+Rg)}Ut(ui,"onAnimationEnd"),Ut(Ds,"onAnimationIteration"),Ut(go,"onAnimationStart"),Ut("dblclick","onDoubleClick"),Ut("focusin","onFocus"),Ut("focusout","onBlur"),Ut(po,"onTransitionRun"),Ut(mo,"onTransitionStart"),Ut(Gc,"onTransitionCancel"),Ut(yo,"onTransitionEnd"),ii("onMouseEnter",["mouseout","mouseover"]),ii("onMouseLeave",["mouseout","mouseover"]),ii("onPointerEnter",["pointerout","pointerover"]),ii("onPointerLeave",["pointerout","pointerover"]),Ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ci("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dr));function nd(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;e:{var c=void 0;if(t)for(var d=s.length-1;0<=d;d--){var g=s[d],y=g.instance,C=g.currentTarget;if(g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=C;try{c(r)}catch(D){Ho(D)}r.currentTarget=null,c=y}else for(d=0;d<s.length;d++){if(g=s[d],y=g.instance,C=g.currentTarget,g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=C;try{c(r)}catch(D){Ho(D)}r.currentTarget=null,c=y}}}}function Ge(e,t){var n=t[ys];n===void 0&&(n=t[ys]=new Set);var s=e+"__bubble";n.has(s)||(id(t,e,2,!1),n.add(s))}function Nu(e,t,n){var s=0;t&&(s|=4),id(n,e,s,t)}var ec="_reactListening"+Math.random().toString(36).slice(2);function Uu(e){if(!e[ec]){e[ec]=!0,be.forEach(function(n){n!=="selectionchange"&&(Cg.has(n)||Nu(n,!1,e),Nu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ec]||(t[ec]=!0,Nu("selectionchange",!1,t))}}function id(e,t,n,s){switch(Ed(t)){case 2:var r=Fg;break;case 8:r=$g;break;default:r=Xu}n=r.bind(null,t,n,e),r=void 0,!ri||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),s?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function ku(e,t,n,s,r){var c=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var g=s.stateNode.containerInfo;if(g===r)break;if(d===4)for(d=s.return;d!==null;){var y=d.tag;if((y===3||y===4)&&d.stateNode.containerInfo===r)return;d=d.return}for(;g!==null;){if(d=Hn(g),d===null)return;if(y=d.tag,y===5||y===6||y===26||y===27){s=c=d;continue e}g=g.parentNode}}s=s.return}Tl(function(){var C=c,D=Ya(n),G=[];e:{var _=vo.get(e);if(_!==void 0){var E=Ms,Ae=e;switch(e){case"keypress":if(Xa(n)===0)break e;case"keydown":case"keyup":E=Nc;break;case"focusin":Ae="focus",E=_l;break;case"focusout":Ae="blur",E=_l;break;case"beforeblur":case"afterblur":E=_l;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":E=Cl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":E=xs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":E=Zr;break;case ui:case Ds:case go:E=Ec;break;case yo:E=Dc;break;case"scroll":case"scrollend":E=Tc;break;case"wheel":E=Kr;break;case"copy":case"cut":case"paste":E=Gr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":E=Qr;break;case"toggle":case"beforetoggle":E=El}var ye=(t&4)!==0,st=!ye&&(e==="scroll"||e==="scrollend"),O=ye?_!==null?_+"Capture":null:_;ye=[];for(var b=C,T;b!==null;){var H=b;if(T=H.stateNode,H=H.tag,H!==5&&H!==26&&H!==27||T===null||O===null||(H=li(b,O),H!=null&&ye.push(gr(b,H,T))),st)break;b=b.return}0<ye.length&&(_=new E(_,Ae,null,n,D),G.push({event:_,listeners:ye}))}}if((t&7)===0){e:{if(_=e==="mouseover"||e==="pointerover",E=e==="mouseout"||e==="pointerout",_&&n!==Rs&&(Ae=n.relatedTarget||n.fromElement)&&(Hn(Ae)||Ae[$i]))break e;if((E||_)&&(_=D.window===D?D:(_=D.ownerDocument)?_.defaultView||_.parentWindow:window,E?(Ae=n.relatedTarget||n.toElement,E=C,Ae=Ae?Hn(Ae):null,Ae!==null&&(st=W(Ae),ye=Ae.tag,Ae!==st||ye!==5&&ye!==27&&ye!==6)&&(Ae=null)):(E=null,Ae=C),E!==Ae)){if(ye=Cl,H="onMouseLeave",O="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(ye=Qr,H="onPointerLeave",O="onPointerEnter",b="pointer"),st=E==null?_:ni(E),T=Ae==null?_:ni(Ae),_=new ye(H,b+"leave",E,n,D),_.target=st,_.relatedTarget=T,H=null,Hn(D)===C&&(ye=new ye(O,b+"enter",Ae,n,D),ye.target=T,ye.relatedTarget=st,H=ye),st=H,E&&Ae)t:{for(ye=E,O=Ae,b=0,T=ye;T;T=al(T))b++;for(T=0,H=O;H;H=al(H))T++;for(;0<b-T;)ye=al(ye),b--;for(;0<T-b;)O=al(O),T--;for(;b--;){if(ye===O||O!==null&&ye===O.alternate)break t;ye=al(ye),O=al(O)}ye=null}else ye=null;E!==null&&ad(G,_,E,ye,!1),Ae!==null&&st!==null&&ad(G,st,Ae,ye,!0)}}e:{if(_=C?ni(C):window,E=_.nodeName&&_.nodeName.toLowerCase(),E==="select"||E==="input"&&_.type==="file")var re=so;else if(io(_))if(lo)re=Hc;else{re=oo;var qe=ro}else E=_.nodeName,!E||E.toLowerCase()!=="input"||_.type!=="checkbox"&&_.type!=="radio"?C&&As(C.elementType)&&(re=so):re=co;if(re&&(re=re(e,C))){Ml(G,re,n,D);break e}qe&&qe(e,_,C),e==="focusout"&&C&&_.type==="number"&&C.memoizedProps.value!=null&&Ol(_,"number",_.value)}switch(qe=C?ni(C):window,e){case"focusin":(io(qe)||qe.contentEditable==="true")&&(oa=qe,Dl=C,Ui=null);break;case"focusout":Ui=Dl=oa=null;break;case"mousedown":ks=!0;break;case"contextmenu":case"mouseup":case"dragend":ks=!1,fo(G,n,D);break;case"selectionchange":if(kl)break;case"keydown":case"keyup":fo(G,n,D)}var fe;if(wi)e:{switch(e){case"compositionstart":var ve="onCompositionStart";break e;case"compositionend":ve="onCompositionEnd";break e;case"compositionupdate":ve="onCompositionUpdate";break e}ve=void 0}else xi?eo(e,n)&&(ve="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ve="onCompositionStart");ve&&(Wr&&n.locale!=="ko"&&(xi||ve!=="onCompositionStart"?ve==="onCompositionEnd"&&xi&&(fe=Mi()):(Vn=D,Cs="value"in Vn?Vn.value:Vn.textContent,xi=!0)),qe=tc(C,ve),0<qe.length&&(ve=new Ir(ve,e,null,n,D),G.push({event:ve,listeners:qe}),fe?ve.data=fe:(fe=to(n),fe!==null&&(ve.data=fe)))),(fe=jc?zc(e,n):no(e,n))&&(ve=tc(C,"onBeforeInput"),0<ve.length&&(qe=new Ir("onBeforeInput","beforeinput",null,n,D),G.push({event:qe,listeners:ve}),qe.data=fe)),Ag(G,e,C,n,D)}nd(G,t)})}function gr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function tc(e,t){for(var n=t+"Capture",s=[];e!==null;){var r=e,c=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||c===null||(r=li(e,n),r!=null&&s.unshift(gr(e,r,c)),r=li(e,t),r!=null&&s.push(gr(e,r,c))),e.tag===3)return s;e=e.return}return[]}function al(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function ad(e,t,n,s,r){for(var c=t._reactName,d=[];n!==null&&n!==s;){var g=n,y=g.alternate,C=g.stateNode;if(g=g.tag,y!==null&&y===s)break;g!==5&&g!==26&&g!==27||C===null||(y=C,r?(C=li(n,c),C!=null&&d.unshift(gr(n,C,y))):r||(C=li(n,c),C!=null&&d.push(gr(n,C,y)))),n=n.return}d.length!==0&&e.push({event:t,listeners:d})}var _g=/\r\n?/g,Eg=/\u0000|\uFFFD/g;function sd(e){return(typeof e=="string"?e:""+e).replace(_g,`
`).replace(Eg,"")}function ld(e,t){return t=sd(t),sd(e)===t}function nc(){}function at(e,t,n,s,r,c){switch(n){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||ue(e,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&ue(e,""+s);break;case"className":ta(e,"class",s);break;case"tabIndex":ta(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":ta(e,n,s);break;case"style":zr(e,s,c);break;case"data":if(t!=="object"){ta(e,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Ts(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof c=="function"&&(n==="formAction"?(t!=="input"&&at(e,t,"name",r.name,r,null),at(e,t,"formEncType",r.formEncType,r,null),at(e,t,"formMethod",r.formMethod,r,null),at(e,t,"formTarget",r.formTarget,r,null)):(at(e,t,"encType",r.encType,r,null),at(e,t,"method",r.method,r,null),at(e,t,"target",r.target,r,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Ts(""+s),e.setAttribute(n,s);break;case"onClick":s!=null&&(e.onclick=nc);break;case"onScroll":s!=null&&Ge("scroll",e);break;case"onScrollEnd":s!=null&&Ge("scrollend",e);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(A(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(A(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":e.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){e.removeAttribute("xlink:href");break}n=Ts(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":s===!0?e.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":Ge("beforetoggle",e),Ge("toggle",e),_i(e,"popover",s);break;case"xlinkActuate":Gn(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":Gn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":Gn(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":Gn(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":Gn(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":Gn(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":Gn(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":Gn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":Gn(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":_i(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Ac.get(n)||n,_i(e,n,s))}}function Du(e,t,n,s,r,c){switch(n){case"style":zr(e,s,c);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(A(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(A(60));e.innerHTML=n}}break;case"children":typeof s=="string"?ue(e,s):(typeof s=="number"||typeof s=="bigint")&&ue(e,""+s);break;case"onScroll":s!=null&&Ge("scroll",e);break;case"onScrollEnd":s!=null&&Ge("scrollend",e);break;case"onClick":s!=null&&(e.onclick=nc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kr.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),c=e[Zt]||null,c=c!=null?c[n]:null,typeof c=="function"&&e.removeEventListener(t,c,r),typeof s=="function")){typeof c!="function"&&c!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,r);break e}n in e?e[n]=s:s===!0?e.setAttribute(n,""):_i(e,n,s)}}}function Ft(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ge("error",e),Ge("load",e);var s=!1,r=!1,c;for(c in n)if(n.hasOwnProperty(c)){var d=n[c];if(d!=null)switch(c){case"src":s=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(A(137,t));default:at(e,t,c,d,n,null)}}r&&at(e,t,"srcSet",n.srcSet,n,null),s&&at(e,t,"src",n.src,n,null);return;case"input":Ge("invalid",e);var g=c=d=r=null,y=null,C=null;for(s in n)if(n.hasOwnProperty(s)){var D=n[s];if(D!=null)switch(s){case"name":r=D;break;case"type":d=D;break;case"checked":y=D;break;case"defaultChecked":C=D;break;case"value":c=D;break;case"defaultValue":g=D;break;case"children":case"dangerouslySetInnerHTML":if(D!=null)throw Error(A(137,t));break;default:at(e,t,s,D,n,null)}}Os(e,c,g,y,C,d,r,!1),Ss(e);return;case"select":Ge("invalid",e),s=d=c=null;for(r in n)if(n.hasOwnProperty(r)&&(g=n[r],g!=null))switch(r){case"value":c=g;break;case"defaultValue":d=g;break;case"multiple":s=g;default:at(e,t,r,g,n,null)}t=c,n=d,e.multiple=!!s,t!=null?ai(e,!!s,t,!1):n!=null&&ai(e,!!s,n,!0);return;case"textarea":Ge("invalid",e),c=r=s=null;for(d in n)if(n.hasOwnProperty(d)&&(g=n[d],g!=null))switch(d){case"value":s=g;break;case"defaultValue":r=g;break;case"children":c=g;break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(A(91));break;default:at(e,t,d,g,n,null)}Et(e,s,r,c),Ss(e);return;case"option":for(y in n)if(n.hasOwnProperty(y)&&(s=n[y],s!=null))switch(y){case"selected":e.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:at(e,t,y,s,n,null)}return;case"dialog":Ge("beforetoggle",e),Ge("toggle",e),Ge("cancel",e),Ge("close",e);break;case"iframe":case"object":Ge("load",e);break;case"video":case"audio":for(s=0;s<dr.length;s++)Ge(dr[s],e);break;case"image":Ge("error",e),Ge("load",e);break;case"details":Ge("toggle",e);break;case"embed":case"source":case"link":Ge("error",e),Ge("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(C in n)if(n.hasOwnProperty(C)&&(s=n[C],s!=null))switch(C){case"children":case"dangerouslySetInnerHTML":throw Error(A(137,t));default:at(e,t,C,s,n,null)}return;default:if(As(t)){for(D in n)n.hasOwnProperty(D)&&(s=n[D],s!==void 0&&Du(e,t,D,s,n,void 0));return}}for(g in n)n.hasOwnProperty(g)&&(s=n[g],s!=null&&at(e,t,g,s,n,null))}function Mg(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,c=null,d=null,g=null,y=null,C=null,D=null;for(E in n){var G=n[E];if(n.hasOwnProperty(E)&&G!=null)switch(E){case"checked":break;case"value":break;case"defaultValue":y=G;default:s.hasOwnProperty(E)||at(e,t,E,null,s,G)}}for(var _ in s){var E=s[_];if(G=n[_],s.hasOwnProperty(_)&&(E!=null||G!=null))switch(_){case"type":c=E;break;case"name":r=E;break;case"checked":C=E;break;case"defaultChecked":D=E;break;case"value":d=E;break;case"defaultValue":g=E;break;case"children":case"dangerouslySetInnerHTML":if(E!=null)throw Error(A(137,t));break;default:E!==G&&at(e,t,_,E,s,G)}}Sl(e,d,g,y,C,D,c,r);return;case"select":E=d=g=_=null;for(c in n)if(y=n[c],n.hasOwnProperty(c)&&y!=null)switch(c){case"value":break;case"multiple":E=y;default:s.hasOwnProperty(c)||at(e,t,c,null,s,y)}for(r in s)if(c=s[r],y=n[r],s.hasOwnProperty(r)&&(c!=null||y!=null))switch(r){case"value":_=c;break;case"defaultValue":g=c;break;case"multiple":d=c;default:c!==y&&at(e,t,r,c,s,y)}t=g,n=d,s=E,_!=null?ai(e,!!n,_,!1):!!s!=!!n&&(t!=null?ai(e,!!n,t,!0):ai(e,!!n,n?[]:"",!1));return;case"textarea":E=_=null;for(g in n)if(r=n[g],n.hasOwnProperty(g)&&r!=null&&!s.hasOwnProperty(g))switch(g){case"value":break;case"children":break;default:at(e,t,g,null,s,r)}for(d in s)if(r=s[d],c=n[d],s.hasOwnProperty(d)&&(r!=null||c!=null))switch(d){case"value":_=r;break;case"defaultValue":E=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(A(91));break;default:r!==c&&at(e,t,d,r,s,c)}Br(e,_,E);return;case"option":for(var Ae in n)if(_=n[Ae],n.hasOwnProperty(Ae)&&_!=null&&!s.hasOwnProperty(Ae))switch(Ae){case"selected":e.selected=!1;break;default:at(e,t,Ae,null,s,_)}for(y in s)if(_=s[y],E=n[y],s.hasOwnProperty(y)&&_!==E&&(_!=null||E!=null))switch(y){case"selected":e.selected=_&&typeof _!="function"&&typeof _!="symbol";break;default:at(e,t,y,_,s,E)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var ye in n)_=n[ye],n.hasOwnProperty(ye)&&_!=null&&!s.hasOwnProperty(ye)&&at(e,t,ye,null,s,_);for(C in s)if(_=s[C],E=n[C],s.hasOwnProperty(C)&&_!==E&&(_!=null||E!=null))switch(C){case"children":case"dangerouslySetInnerHTML":if(_!=null)throw Error(A(137,t));break;default:at(e,t,C,_,s,E)}return;default:if(As(t)){for(var st in n)_=n[st],n.hasOwnProperty(st)&&_!==void 0&&!s.hasOwnProperty(st)&&Du(e,t,st,void 0,s,_);for(D in s)_=s[D],E=n[D],!s.hasOwnProperty(D)||_===E||_===void 0&&E===void 0||Du(e,t,D,_,s,E);return}}for(var O in n)_=n[O],n.hasOwnProperty(O)&&_!=null&&!s.hasOwnProperty(O)&&at(e,t,O,null,s,_);for(G in s)_=s[G],E=n[G],!s.hasOwnProperty(G)||_===E||_==null&&E==null||at(e,t,G,_,s,E)}var Lu=null,Bu=null;function ic(e){return e.nodeType===9?e:e.ownerDocument}function rd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function od(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function ju(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var zu=null;function wg(){var e=window.event;return e&&e.type==="popstate"?e===zu?!1:(zu=e,!0):(zu=null,!1)}var cd=typeof setTimeout=="function"?setTimeout:void 0,xg=typeof clearTimeout=="function"?clearTimeout:void 0,ud=typeof Promise=="function"?Promise:void 0,Ng=typeof queueMicrotask=="function"?queueMicrotask:typeof ud<"u"?function(e){return ud.resolve(null).then(e).catch(Ug)}:cd;function Ug(e){setTimeout(function(){throw e})}function Da(e){return e==="head"}function fd(e,t){var n=t,s=0,r=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"){if(0<s&&8>s){n=s;var d=e.ownerDocument;if(n&1&&pr(d.documentElement),n&2&&pr(d.body),n&4)for(n=d.head,pr(n),d=n.firstChild;d;){var g=d.nextSibling,y=d.nodeName;d[Ia]||y==="SCRIPT"||y==="STYLE"||y==="LINK"&&d.rel.toLowerCase()==="stylesheet"||n.removeChild(d),d=g}}if(r===0){e.removeChild(c),Tr(t);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:s=n.charCodeAt(0)-48;else s=0;n=c}while(n);Tr(t)}function qu(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":qu(n),pl(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function kg(e,t,n,s){for(;e.nodeType===1;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(s){if(!e[Ia])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(c=e.getAttribute("rel"),c==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(c!==r.rel||e.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||e.getAttribute("title")!==(r.title==null?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(c=e.getAttribute("src"),(c!==(r.src==null?null:r.src)||e.getAttribute("type")!==(r.type==null?null:r.type)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&c&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var c=r.name==null?null:""+r.name;if(r.type==="hidden"&&e.getAttribute("name")===c)return e}else return e;if(e=ti(e.nextSibling),e===null)break}return null}function Dg(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=ti(e.nextSibling),e===null))return null;return e}function Hu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Lg(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var s=function(){t(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}function ti(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var Gu=null;function hd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function dd(e,t,n){switch(t=ic(n),e){case"html":if(e=t.documentElement,!e)throw Error(A(452));return e;case"head":if(e=t.head,!e)throw Error(A(453));return e;case"body":if(e=t.body,!e)throw Error(A(454));return e;default:throw Error(A(451))}}function pr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);pl(e)}var jn=new Map,gd=new Set;function ac(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Ji=U.d;U.d={f:Bg,r:jg,D:zg,C:qg,L:Hg,m:Gg,X:Ig,S:Vg,M:Yg};function Bg(){var e=Ji.f(),t=Ko();return e||t}function jg(e){var t=Ri(e);t!==null&&t.tag===5&&t.type==="form"?Df(t):Ji.r(e)}var sl=typeof document>"u"?null:document;function pd(e,t,n){var s=sl;if(s&&typeof t=="string"&&t){var r=dn(t);r='link[rel="'+e+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),gd.has(r)||(gd.add(r),e={rel:e,crossOrigin:n,href:t},s.querySelector(r)===null&&(t=s.createElement("link"),Ft(t,"link",e),Nt(t),s.head.appendChild(t)))}}function zg(e){Ji.D(e),pd("dns-prefetch",e,null)}function qg(e,t){Ji.C(e,t),pd("preconnect",e,t)}function Hg(e,t,n){Ji.L(e,t,n);var s=sl;if(s&&e&&t){var r='link[rel="preload"][as="'+dn(t)+'"]';t==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+dn(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+dn(n.imageSizes)+'"]')):r+='[href="'+dn(e)+'"]';var c=r;switch(t){case"style":c=ll(e);break;case"script":c=rl(e)}jn.has(c)||(e=F({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),jn.set(c,e),s.querySelector(r)!==null||t==="style"&&s.querySelector(mr(c))||t==="script"&&s.querySelector(yr(c))||(t=s.createElement("link"),Ft(t,"link",e),Nt(t),s.head.appendChild(t)))}}function Gg(e,t){Ji.m(e,t);var n=sl;if(n&&e){var s=t&&typeof t.as=="string"?t.as:"script",r='link[rel="modulepreload"][as="'+dn(s)+'"][href="'+dn(e)+'"]',c=r;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":c=rl(e)}if(!jn.has(c)&&(e=F({rel:"modulepreload",href:e},t),jn.set(c,e),n.querySelector(r)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(yr(c)))return}s=n.createElement("link"),Ft(s,"link",e),Nt(s),n.head.appendChild(s)}}}function Vg(e,t,n){Ji.S(e,t,n);var s=sl;if(s&&e){var r=ea(s).hoistableStyles,c=ll(e);t=t||"default";var d=r.get(c);if(!d){var g={loading:0,preload:null};if(d=s.querySelector(mr(c)))g.loading=5;else{e=F({rel:"stylesheet",href:e,"data-precedence":t},n),(n=jn.get(c))&&Vu(e,n);var y=d=s.createElement("link");Nt(y),Ft(y,"link",e),y._p=new Promise(function(C,D){y.onload=C,y.onerror=D}),y.addEventListener("load",function(){g.loading|=1}),y.addEventListener("error",function(){g.loading|=2}),g.loading|=4,sc(d,t,s)}d={type:"stylesheet",instance:d,count:1,state:g},r.set(c,d)}}}function Ig(e,t){Ji.X(e,t);var n=sl;if(n&&e){var s=ea(n).hoistableScripts,r=rl(e),c=s.get(r);c||(c=n.querySelector(yr(r)),c||(e=F({src:e,async:!0},t),(t=jn.get(r))&&Iu(e,t),c=n.createElement("script"),Nt(c),Ft(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function Yg(e,t){Ji.M(e,t);var n=sl;if(n&&e){var s=ea(n).hoistableScripts,r=rl(e),c=s.get(r);c||(c=n.querySelector(yr(r)),c||(e=F({src:e,async:!0,type:"module"},t),(t=jn.get(r))&&Iu(e,t),c=n.createElement("script"),Nt(c),Ft(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function md(e,t,n,s){var r=(r=ge.current)?ac(r):null;if(!r)throw Error(A(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=ll(n.href),n=ea(r).hoistableStyles,s=n.get(t),s||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=ll(n.href);var c=ea(r).hoistableStyles,d=c.get(e);if(d||(r=r.ownerDocument||r,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,d),(c=r.querySelector(mr(e)))&&!c._p&&(d.instance=c,d.state.loading=5),jn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},jn.set(e,n),c||Pg(r,e,n,d.state))),t&&s===null)throw Error(A(528,""));return d}if(t&&s!==null)throw Error(A(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=rl(n),n=ea(r).hoistableScripts,s=n.get(t),s||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(A(444,e))}}function ll(e){return'href="'+dn(e)+'"'}function mr(e){return'link[rel="stylesheet"]['+e+"]"}function yd(e){return F({},e,{"data-precedence":e.precedence,precedence:null})}function Pg(e,t,n,s){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=e.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),Ft(t,"link",n),Nt(t),e.head.appendChild(t))}function rl(e){return'[src="'+dn(e)+'"]'}function yr(e){return"script[async]"+e}function vd(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+dn(n.href)+'"]');if(s)return t.instance=s,Nt(s),s;var r=F({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(e.ownerDocument||e).createElement("style"),Nt(s),Ft(s,"style",r),sc(s,n.precedence,e),t.instance=s;case"stylesheet":r=ll(n.href);var c=e.querySelector(mr(r));if(c)return t.state.loading|=4,t.instance=c,Nt(c),c;s=yd(n),(r=jn.get(r))&&Vu(s,r),c=(e.ownerDocument||e).createElement("link"),Nt(c);var d=c;return d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),Ft(c,"link",s),t.state.loading|=4,sc(c,n.precedence,e),t.instance=c;case"script":return c=rl(n.src),(r=e.querySelector(yr(c)))?(t.instance=r,Nt(r),r):(s=n,(r=jn.get(c))&&(s=F({},n),Iu(s,r)),e=e.ownerDocument||e,r=e.createElement("script"),Nt(r),Ft(r,"link",s),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(A(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(s=t.instance,t.state.loading|=4,sc(s,n.precedence,e));return t.instance}function sc(e,t,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=s.length?s[s.length-1]:null,c=r,d=0;d<s.length;d++){var g=s[d];if(g.dataset.precedence===t)c=g;else if(c!==r)break}c?c.parentNode.insertBefore(e,c.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Vu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Iu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var lc=null;function bd(e,t,n){if(lc===null){var s=new Map,r=lc=new Map;r.set(n,s)}else r=lc,s=r.get(n),s||(s=new Map,r.set(n,s));if(s.has(e))return s;for(s.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var c=n[r];if(!(c[Ia]||c[Lt]||e==="link"&&c.getAttribute("rel")==="stylesheet")&&c.namespaceURI!=="http://www.w3.org/2000/svg"){var d=c.getAttribute(t)||"";d=e+d;var g=s.get(d);g?g.push(c):s.set(d,[c])}}return s}function Sd(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Xg(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Od(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var vr=null;function Qg(){}function Zg(e,t,n){if(vr===null)throw Error(A(475));var s=vr;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var r=ll(n.href),c=e.querySelector(mr(r));if(c){e=c._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(s.count++,s=rc.bind(s),e.then(s,s)),t.state.loading|=4,t.instance=c,Nt(c);return}c=e.ownerDocument||e,n=yd(n),(r=jn.get(r))&&Vu(n,r),c=c.createElement("link"),Nt(c);var d=c;d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),Ft(c,"link",n),t.instance=c}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(s.count++,t=rc.bind(s),e.addEventListener("load",t),e.addEventListener("error",t))}}function Kg(){if(vr===null)throw Error(A(475));var e=vr;return e.stylesheets&&e.count===0&&Yu(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Yu(e,e.stylesheets),e.unsuspend){var s=e.unsuspend;e.unsuspend=null,s()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function rc(){if(this.count--,this.count===0){if(this.stylesheets)Yu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var oc=null;function Yu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,oc=new Map,t.forEach(Jg,e),oc=null,rc.call(e))}function Jg(e,t){if(!(t.state.loading&4)){var n=oc.get(e);if(n)var s=n.get(null);else{n=new Map,oc.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),c=0;c<r.length;c++){var d=r[c];(d.nodeName==="LINK"||d.getAttribute("media")!=="not all")&&(n.set(d.dataset.precedence,d),s=d)}s&&n.set(null,s)}r=t.instance,d=r.getAttribute("data-precedence"),c=n.get(d)||s,c===s&&n.set(null,r),n.set(d,r),this.count++,s=rc.bind(this),r.addEventListener("load",s),r.addEventListener("error",s),c?c.parentNode.insertBefore(r,c.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(r,e.firstChild)),t.state.loading|=4}}var br={$$typeof:Pe,Provider:null,Consumer:null,_currentValue:ae,_currentValue2:ae,_threadCount:0};function Wg(e,t,n,s,r,c,d,g){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=xt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xt(0),this.hiddenUpdates=xt(null),this.identifierPrefix=s,this.onUncaughtError=r,this.onCaughtError=c,this.onRecoverableError=d,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=g,this.incompleteTransitions=new Map}function Ad(e,t,n,s,r,c,d,g,y,C,D,G){return e=new Wg(e,t,n,d,g,y,C,G),t=1,c===!0&&(t|=24),c=on(3,null,null,t),e.current=c,c.stateNode=e,t=hi(),t.refCount++,e.pooledCache=t,t.refCount++,c.memoizedState={element:s,isDehydrated:n,cache:t},Gs(c),e}function Td(e){return e?(e=Bi,e):Bi}function Rd(e,t,n,s,r,c){r=Td(r),s.context===null?s.context=r:s.pendingContext=r,s=gi(t),s.payload={element:n},c=c===void 0?null:c,c!==null&&(s.callback=c),n=pi(e,s,t),n!==null&&(wn(n,e,t),os(n,e,t))}function Cd(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Pu(e,t){Cd(e,t),(e=e.alternate)&&Cd(e,t)}function _d(e){if(e.tag===13){var t=fa(e,67108864);t!==null&&wn(t,e,67108864),Pu(e,67108864)}}var cc=!0;function Fg(e,t,n,s){var r=N.T;N.T=null;var c=U.p;try{U.p=2,Xu(e,t,n,s)}finally{U.p=c,N.T=r}}function $g(e,t,n,s){var r=N.T;N.T=null;var c=U.p;try{U.p=8,Xu(e,t,n,s)}finally{U.p=c,N.T=r}}function Xu(e,t,n,s){if(cc){var r=Qu(s);if(r===null)ku(e,t,s,uc,n),Md(e,s);else if(tp(r,e,t,n,s))s.stopPropagation();else if(Md(e,s),t&4&&-1<ep.indexOf(e)){for(;r!==null;){var c=Ri(r);if(c!==null)switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var d=Qt(c.pendingLanes);if(d!==0){var g=c;for(g.pendingLanes|=2,g.entangledLanes|=2;d;){var y=1<<31-K(d);g.entanglements[1]|=y,d&=~y}Ai(c),(tt&6)===0&&(Qo=Ze()+500,hr(0))}}break;case 13:g=fa(c,2),g!==null&&wn(g,c,2),Ko(),Pu(c,2)}if(c=Qu(s),c===null&&ku(e,t,s,uc,n),c===r)break;r=c}r!==null&&s.stopPropagation()}else ku(e,t,s,null,n)}}function Qu(e){return e=Ya(e),Zu(e)}var uc=null;function Zu(e){if(uc=null,e=Hn(e),e!==null){var t=W(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=Ne(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return uc=e,null}function Ed(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xe()){case Ht:return 2;case $t:return 8;case Ue:case An:return 32;case un:return 268435456;default:return 32}default:return 32}}var Ku=!1,La=null,Ba=null,ja=null,Sr=new Map,Or=new Map,za=[],ep="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Md(e,t){switch(e){case"focusin":case"focusout":La=null;break;case"dragenter":case"dragleave":Ba=null;break;case"mouseover":case"mouseout":ja=null;break;case"pointerover":case"pointerout":Sr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Or.delete(t.pointerId)}}function Ar(e,t,n,s,r,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:c,targetContainers:[r]},t!==null&&(t=Ri(t),t!==null&&_d(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function tp(e,t,n,s,r){switch(t){case"focusin":return La=Ar(La,e,t,n,s,r),!0;case"dragenter":return Ba=Ar(Ba,e,t,n,s,r),!0;case"mouseover":return ja=Ar(ja,e,t,n,s,r),!0;case"pointerover":var c=r.pointerId;return Sr.set(c,Ar(Sr.get(c)||null,e,t,n,s,r)),!0;case"gotpointercapture":return c=r.pointerId,Or.set(c,Ar(Or.get(c)||null,e,t,n,s,r)),!0}return!1}function wd(e){var t=Hn(e.target);if(t!==null){var n=W(t);if(n!==null){if(t=n.tag,t===13){if(t=Ne(n),t!==null){e.blockedOn=t,Nr(e.priority,function(){if(n.tag===13){var s=Mn();s=fl(s);var r=fa(n,s);r!==null&&wn(r,n,s),Pu(n,s)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function fc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qu(e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Rs=s,n.target.dispatchEvent(s),Rs=null}else return t=Ri(n),t!==null&&_d(t),e.blockedOn=n,!1;t.shift()}return!0}function xd(e,t,n){fc(e)&&n.delete(t)}function np(){Ku=!1,La!==null&&fc(La)&&(La=null),Ba!==null&&fc(Ba)&&(Ba=null),ja!==null&&fc(ja)&&(ja=null),Sr.forEach(xd),Or.forEach(xd)}function hc(e,t){e.blockedOn===t&&(e.blockedOn=null,Ku||(Ku=!0,k.unstable_scheduleCallback(k.unstable_NormalPriority,np)))}var dc=null;function Nd(e){dc!==e&&(dc=e,k.unstable_scheduleCallback(k.unstable_NormalPriority,function(){dc===e&&(dc=null);for(var t=0;t<e.length;t+=3){var n=e[t],s=e[t+1],r=e[t+2];if(typeof s!="function"){if(Zu(s||n)===null)continue;break}var c=Ri(n);c!==null&&(e.splice(t,3),t-=3,Zc(c,{pending:!0,data:r,method:n.method,action:s},s,r))}}))}function Tr(e){function t(y){return hc(y,e)}La!==null&&hc(La,e),Ba!==null&&hc(Ba,e),ja!==null&&hc(ja,e),Sr.forEach(t),Or.forEach(t);for(var n=0;n<za.length;n++){var s=za[n];s.blockedOn===e&&(s.blockedOn=null)}for(;0<za.length&&(n=za[0],n.blockedOn===null);)wd(n),n.blockedOn===null&&za.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var r=n[s],c=n[s+1],d=r[Zt]||null;if(typeof c=="function")d||Nd(n);else if(d){var g=null;if(c&&c.hasAttribute("formAction")){if(r=c,d=c[Zt]||null)g=d.formAction;else if(Zu(r)!==null)continue}else g=d.action;typeof g=="function"?n[s+1]=g:(n.splice(s,3),s-=3),Nd(n)}}}function Ju(e){this._internalRoot=e}gc.prototype.render=Ju.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(A(409));var n=t.current,s=Mn();Rd(n,s,e,t,null,null)},gc.prototype.unmount=Ju.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Rd(e.current,2,null,e,null,null),Ko(),t[$i]=null}};function gc(e){this._internalRoot=e}gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=dl();e={blockedOn:null,target:e,priority:t};for(var n=0;n<za.length&&t!==0&&t<za[n].priority;n++);za.splice(n,0,e),n===0&&wd(e)}};var Ud=oe.version;if(Ud!=="19.1.0")throw Error(A(527,Ud,"19.1.0"));U.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(A(188)):(e=Object.keys(e).join(","),Error(A(268,e)));return e=ne(t),e=e!==null?L(e):null,e=e===null?null:e.stateNode,e};var ip={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:N,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pc.isDisabled&&pc.supportsFiber)try{Tn=pc.inject(ip),Z=pc}catch{}}return Cr.createRoot=function(e,t){if(!te(e))throw Error(A(299));var n=!1,s="",r=Zf,c=Kf,d=Jf,g=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(c=t.onCaughtError),t.onRecoverableError!==void 0&&(d=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(g=t.unstable_transitionCallbacks)),t=Ad(e,1,!1,null,null,n,s,r,c,d,g,null),e[$i]=t.current,Uu(e),new Ju(t)},Cr.hydrateRoot=function(e,t,n){if(!te(e))throw Error(A(299));var s=!1,r="",c=Zf,d=Kf,g=Jf,y=null,C=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(c=n.onUncaughtError),n.onCaughtError!==void 0&&(d=n.onCaughtError),n.onRecoverableError!==void 0&&(g=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(y=n.unstable_transitionCallbacks),n.formState!==void 0&&(C=n.formState)),t=Ad(e,1,!0,t,n??null,s,r,c,d,g,y,C),t.context=Td(null),n=t.current,s=Mn(),s=fl(s),r=gi(s),r.callback=null,pi(n,r,s),n=s,t.current.lanes=n,Fi(t,n),Ai(t),e[$i]=t.current,Uu(e),new gc(t)},Cr.version="19.1.0",Cr}var Vd;function gp(){if(Vd)return $u.exports;Vd=1;function k(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(k)}catch(oe){console.error(oe)}}return k(),$u.exports=dp(),$u.exports}var pp=gp();const mp=gf(pp);var mc={exports:{}};/*@license Copyright 2015-2022 Ably Real-time Ltd (ably.com)

Ably JavaScript Library v2.10.1
https://github.com/ably/ably-js

Released under the Apache Licence v2.0*/var yp=mc.exports,Id;function vp(){return Id||(Id=1,function(k,oe){(function(ce,A){k.exports=A()})(yp,()=>{var ce={},A={exports:ce},te=Object.defineProperty,W=Object.defineProperties,Ne=Object.getOwnPropertyDescriptor,ze=Object.getOwnPropertyDescriptors,ne=Object.getOwnPropertyNames,L=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable,we=(i,a,l)=>a in i?te(i,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[a]=l,he=(i,a)=>{for(var l in a||(a={}))F.call(a,l)&&we(i,l,a[l]);if(L)for(var l of L(a))Le.call(a,l)&&we(i,l,a[l]);return i},Te=(i,a)=>W(i,ze(a)),Fe=(i,a)=>{var l={};for(var o in i)F.call(i,o)&&a.indexOf(o)<0&&(l[o]=i[o]);if(i!=null&&L)for(var o of L(i))a.indexOf(o)<0&&Le.call(i,o)&&(l[o]=i[o]);return l},le=(i,a)=>{for(var l in a)te(i,l,{get:a[l],enumerable:!0})},dt=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of ne(a))!F.call(i,u)&&u!==l&&te(i,u,{get:()=>a[u],enumerable:!(o=Ne(a,u))||o.enumerable});return i},At=i=>dt(te({},"__esModule",{value:!0}),i),Pe={};le(Pe,{ErrorInfo:()=>w,Realtime:()=>Zn,Rest:()=>Ds,default:()=>Uo,makeProtocolMessageFromDeserialized:()=>Ul,msgpack:()=>Vi}),A.exports=At(Pe);var x=class{},de=typeof Ha<"u"?Ha:typeof window<"u"?window:self;function Se(i,a){return`${i}`.padStart(a?3:2,"0")}function ie(i){return x.Config.logTimestamps?function(a){const l=new Date;i(Se(l.getHours())+":"+Se(l.getMinutes())+":"+Se(l.getSeconds())+"."+Se(l.getMilliseconds(),1)+" "+a)}:function(a){i(a)}}var xe=()=>{var i;let a,l;return typeof((i=de?.console)==null?void 0:i.log)=="function"?(a=function(...o){console.log.apply(console,o)},l=console.warn?function(...o){console.warn.apply(console,o)}:a):a=l=function(){},[a,l].map(ie)},je=class _r{constructor(){this.deprecated=(a,l)=>{this.deprecationWarning(`${a} is deprecated and will be removed in a future version. ${l}`)},this.shouldLog=a=>a<=this.logLevel,this.setLog=(a,l)=>{a!==void 0&&(this.logLevel=a),l!==void 0&&(this.logHandler=this.logErrorHandler=l)},this.logLevel=_r.defaultLogLevel,this.logHandler=_r.defaultLogHandler,this.logErrorHandler=_r.defaultLogErrorHandler}static initLogHandlers(){const[a,l]=xe();this.defaultLogHandler=a,this.defaultLogErrorHandler=l,this.defaultLogger=new _r}static logActionNoStrip(a,l,o,u){a.logAction(l,o,u)}logAction(a,l,o){this.shouldLog(a)&&(a===1?this.logErrorHandler:this.logHandler)("Ably: "+l+": "+o,a)}renamedClientOption(a,l){this.deprecationWarning(`The \`${a}\` client option has been renamed to \`${l}\`. Please update your code to use \`${l}\` instead. \`${a}\` will be removed in a future version.`)}renamedMethod(a,l,o){this.deprecationWarning(`\`${a}\`s \`${l}\` method has been renamed to \`${o}\`. Please update your code to use \`${o}\` instead. \`${l}\` will be removed in a future version.`)}deprecationWarning(a){this.shouldLog(1)&&this.logErrorHandler(`Ably: Deprecation warning - ${a}`,1)}};je.defaultLogLevel=1,je.LOG_NONE=0,je.LOG_ERROR=1,je.LOG_MAJOR=2,je.LOG_MINOR=3,je.LOG_MICRO=4,je.logAction=(i,a,l,o)=>{je.logActionNoStrip(i,a,l,o)};var bt=je,h=bt,Ve={};le(Ve,{Format:()=>ut,allSame:()=>Be,allToLowerCase:()=>pt,allToUpperCase:()=>Ie,arrChooseN:()=>Tn,arrDeleteValue:()=>_t,arrEquals:()=>ul,arrIntersect:()=>_e,arrIntersectOb:()=>gt,arrPopRandomElement:()=>Ze,arrWithoutValue:()=>sn,cheapRandStr:()=>zn,containsValue:()=>ge,copy:()=>ae,createMissingPluginError:()=>Va,dataSizeBytes:()=>un,decodeBody:()=>J,encodeBody:()=>K,ensureArray:()=>pe,forInOwnNonNullProperties:()=>P,getBackoffCoefficient:()=>Ee,getGlobalObject:()=>Qt,getJitterCoefficient:()=>wt,getRetryTime:()=>Gt,inherits:()=>Re,inspectBody:()=>An,inspectError:()=>Ue,intersect:()=>ct,isEmpty:()=>B,isErrorInfoOrPartialErrorInfo:()=>$t,isNil:()=>Y,isObject:()=>v,keysArray:()=>qt,matchDerivedChannel:()=>Wi,mixin:()=>U,parseQueryString:()=>Ht,prototypicalClone:()=>se,randomString:()=>Ti,shallowClone:()=>Q,shallowEquals:()=>Ga,throwMissingPluginError:()=>xt,toBase64:()=>ms,toQueryString:()=>Xe,valuesArray:()=>V,whenPromiseSettles:()=>Z,withTimeoutAsync:()=>Fi});function Tt(i){let a="["+i.constructor.name;return i.message&&(a+=": "+i.message),i.statusCode&&(a+="; statusCode="+i.statusCode),i.code&&(a+="; code="+i.code),i.cause&&(a+="; cause="+Ue(i.cause)),i.href&&!(i.message&&i.message.indexOf("help.ably.io")>-1)&&(a+="; see "+i.href+" "),a+="]",a}var w=class sf extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,sf.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return Tt(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||typeof o!="number"||typeof u!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+x.Config.inspect(a));const f=Object.assign(new sf(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}},Ce=class lf extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,lf.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return Tt(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||!Y(o)&&typeof o!="number"||!Y(u)&&typeof u!="number")throw new Error("PartialErrorInfo.fromValues(): invalid values: "+x.Config.inspect(a));const f=Object.assign(new lf(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}};function N(i){return Math.floor(Math.random()*i.length)}function U(i,...a){for(let l=0;l<a.length;l++){const o=a[l];if(!o)break;for(const u in o)Object.prototype.hasOwnProperty.call(o,u)&&(i[u]=o[u])}return i}function ae(i){return U({},i)}function pe(i){return Y(i)?[]:Array.isArray(i)?i:[i]}function v(i){return Object.prototype.toString.call(i)=="[object Object]"}function B(i){for(const a in i)return!1;return!0}function Y(i){return i==null}function Q(i){const a=new Object;for(const l in i)a[l]=i[l];return a}function se(i,a){class l{}l.prototype=i;const o=new l;return a&&U(o,a),o}var Re=function(i,a){if(x.Config.inherits){x.Config.inherits(i,a);return}i.super_=a,i.prototype=se(a.prototype,{constructor:i})};function ge(i,a){for(const l in i)if(i[l]==a)return!0;return!1}function ct(i,a){return Array.isArray(a)?_e(i,a):gt(i,a)}function _e(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];a.indexOf(u)!=-1&&l.push(u)}return l}function gt(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];u in a&&l.push(u)}return l}function _t(i,a){const l=i.indexOf(a),o=l!=-1;return o&&i.splice(l,1),o}function sn(i,a){const l=i.slice();return _t(l,a),l}function qt(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(o);return l}function V(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(i[o]);return l}function P(i,a){for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&a(l)}function Be(i,a){if(i.length===0)return!0;const l=i[0][a];return i.every(function(o){return o[a]===l})}var ut=(i=>(i.msgpack="msgpack",i.json="json",i))(ut||{});function Ze(i){return i.splice(N(i),1)[0]}function Xe(i){const a=[];if(i)for(const l in i)a.push(encodeURIComponent(l)+"="+encodeURIComponent(i[l]));return a.length?"?"+a.join("&"):""}function Ht(i){let a;const l=/([^?&=]+)=?([^&]*)/g,o={};for(;a=l.exec(i);)o[decodeURIComponent(a[1])]=decodeURIComponent(a[2]);return o}function $t(i){return typeof i=="object"&&i!==null&&(i instanceof w||i instanceof Ce)}function Ue(i){var a,l;return i instanceof Error||((a=i?.constructor)==null?void 0:a.name)==="ErrorInfo"||((l=i?.constructor)==null?void 0:l.name)==="PartialErrorInfo"?i.toString():x.Config.inspect(i)}function An(i){return x.BufferUtils.isBuffer(i)?i.toString():typeof i=="string"?i:x.Config.inspect(i)}function un(i){if(x.BufferUtils.isBuffer(i))return x.BufferUtils.byteLength(i);if(typeof i=="string")return x.Config.stringByteSize(i);if(typeof i=="number")return 8;if(typeof i=="boolean")return 1;throw new Error(`Expected input of Utils.dataSizeBytes to be a string, a number, a boolean or a buffer, but was: ${typeof i}`)}function zn(){return String(Math.random()).substr(2)}var Ti=async i=>{const a=await x.Config.getRandomArrayBuffer(i);return x.BufferUtils.base64Encode(a)};function Tn(i,a){const l=Math.min(a,i.length),o=i.slice(),u=[];for(let f=0;f<l;f++)u.push(Ze(o));return u}function Z(i,a){i.then(l=>{a?.(null,l)}).catch(l=>{a?.(l)})}function J(i,a,l){return l=="msgpack"?(a||xt("MsgPack"),a.decode(i)):JSON.parse(String(i))}function K(i,a,l){return l=="msgpack"?(a||xt("MsgPack"),a.encode(i,!0)):JSON.stringify(i)}function pt(i){return i.map(function(a){return a&&a.toLowerCase()})}function Ie(i){return i.map(function(a){return a&&a.toUpperCase()})}function Ee(i){return Math.min((i+2)/3,2)}function wt(){return 1-Math.random()*.2}function Gt(i,a){return i*Ee(a)*wt()}function Qt(){return typeof Ha<"u"?Ha:typeof window<"u"?window:self}function Ga(i,a){return Object.keys(i).every(l=>i[l]===a[l])&&Object.keys(a).every(l=>a[l]===i[l])}function Wi(i){const a=/^(\[([^?]*)(?:(.*))\])?(.+)$/,l=i.match(a);if(!l||!l.length||l.length<5)throw new w("regex match failed",400,40010);if(l[2])throw new w(`cannot use a derived option with a ${l[2]} channel`,400,40010);return{qualifierParam:l[3]||"",channelName:l[4]}}function ms(i){const a=x.BufferUtils,l=a.utf8Encode(i);return a.base64Encode(l)}function ul(i,a){return i.length===a.length&&i.every(function(l,o){return l===a[o]})}function Va(i){return new w(`${i} plugin not provided`,40019,400)}function xt(i){throw Va(i)}async function Fi(i,a=5e3,l="Timeout expired"){const o=new w(l,5e4,500);return Promise.race([i,new Promise((u,f)=>setTimeout(()=>f(o),a))])}var wr="2.10.1",xr="ably-js/"+wr,fn={ENDPOINT:"main",ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["main.a.fallback.ably-realtime.com","main.b.fallback.ably-realtime.com","main.c.fallback.ably-realtime.com","main.d.fallback.ably-realtime.com","main.e.fallback.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:1e4,httpMaxRetryDuration:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,webSocketConnectTimeout:1e4,webSocketSlowTimeout:4e3},httpMaxRetryCount:3,maxMessageSize:65536,version:wr,protocolVersion:3,agent:xr,getPort:fl,getHttpScheme:hl,getPrimaryDomainFromEndpoint:Nr,getEndpointFallbackHosts:qn,getFallbackHosts:Zt,getHosts:$i,checkHost:ys,objectifyOptions:Ur,normaliseOptions:pl,defaultGetHeaders:ea,defaultPostHeaders:Nt};function fl(i,a){return a||i.tls?i.tlsPort:i.port}function hl(i){return i.tls?"https://":"http://"}function dl(i){return i.includes(".")||i.includes("::")||i==="localhost"}function Nr(i){return dl(i)?i:i.startsWith("nonprod:")?`${i.replace("nonprod:","")}.realtime.ably-nonprod.net`:`${i}.realtime.ably.net`}function qn(i){if(dl(i))return[];if(i.startsWith("nonprod:")){const a=i.replace("nonprod:","");return Lt(a,"ably-realtime-nonprod.com")}return Lt(i,"ably-realtime.com")}function Lt(i,a){return["a","b","c","d","e"].map(l=>`${i}.${l}.fallback.${a}`)}function Zt(i){const a=i.fallbackHosts,l=typeof i.httpMaxRetryCount<"u"?i.httpMaxRetryCount:fn.httpMaxRetryCount;return a?Tn(a,l):[]}function $i(i){return[i.primaryDomain].concat(Zt(i))}function ys(i){if(typeof i!="string")throw new w("host must be a string; was a "+typeof i,4e4,400);if(!i.length)throw new w("host must not be zero-length",4e4,400)}function vc(i){const a={};for(const l in fn.TIMEOUTS)a[l]=i[l]||fn.TIMEOUTS[l];return a}function gl(i){let a=fn.agent;if(i.agents)for(var l in i.agents)a+=" "+l+"/"+i.agents[l];return a}function Ur(i,a,l,o,u){if(i===void 0){const p=a?`${l} must be initialized with either a client options object, an Ably API key, or an Ably Token`:`${l} must be initialized with a client options object`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,p),new Error(p)}let f;if(typeof i=="string")if(i.indexOf(":")==-1){if(!a){const p=`${l} cannot be initialized with just an Ably Token; you must provide a client options object with a \`plugins\` property. (Set this Ably Token as the objects \`token\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,p),new Error(p)}f={token:i}}else{if(!a){const p=`${l} cannot be initialized with just an Ably API key; you must provide a client options object with a \`plugins\` property. (Set this Ably API key as the objects \`key\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,p),new Error(p)}f={key:i}}else f=i;return u&&(f=Te(he({},f),{plugins:he(he({},u),f.plugins)})),f}function Ia(i){if(i.endpoint&&(i.environment||i.restHost||i.realtimeHost))throw new w("The `endpoint` option cannot be used in conjunction with the `environment`, `restHost`, or `realtimeHost` options.",40106,400);if(i.environment&&(i.restHost||i.realtimeHost))throw new w("The `environment` option cannot be used in conjunction with the `restHost`, or `realtimeHost` options.",40106,400)}function pl(i,a,l){const o=l??h.defaultLogger;i.environment&&o.deprecated("The `environment` client option","Use the `endpoint` client option instead."),i.restHost&&o.deprecated("The `restHost` client option","Use the `endpoint` client option instead."),i.realtimeHost&&o.deprecated("The `realtimeHost` client option","Use the `endpoint` client option instead."),Ia(i),typeof i.recover=="function"&&i.closeOnUnload===!0&&(h.logAction(o,h.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),i.recover=void 0),"closeOnUnload"in i||(i.closeOnUnload=!i.recover),"queueMessages"in i||(i.queueMessages=!0);const u=i.endpoint||fn.ENDPOINT;!i.fallbackHosts&&!i.restHost&&!i.realtimeHost&&!i.port&&!i.tlsPort&&(i.fallbackHosts=qn(i.environment||u));const f=i.environment&&`${i.environment}.realtime.ably.net`,m=i.restHost||i.realtimeHost||f||Nr(u);(i.fallbackHosts||[]).concat(m).forEach(ys),i.port=i.port||fn.PORT,i.tlsPort=i.tlsPort||fn.TLS_PORT,"tls"in i||(i.tls=!0);const R=vc(i);a?"useBinaryProtocol"in i?i.useBinaryProtocol=x.Config.supportsBinary&&i.useBinaryProtocol:i.useBinaryProtocol=x.Config.preferBinary:i.useBinaryProtocol=!1;const S={};i.clientId&&(S["X-Ably-ClientId"]=x.BufferUtils.base64Encode(x.BufferUtils.utf8Encode(i.clientId))),"idempotentRestPublishing"in i||(i.idempotentRestPublishing=!0);let j=null,z=i.connectivityCheckUrl;if(i.connectivityCheckUrl){let[q,$]=i.connectivityCheckUrl.split("?");j=$?Ht($):{},q.indexOf("://")===-1&&(q="https://"+q),z=q}let X=i.wsConnectivityCheckUrl;return X&&X.indexOf("://")===-1&&(X="wss://"+X),Te(he({},i),{primaryDomain:m,maxMessageSize:i.maxMessageSize||fn.maxMessageSize,timeouts:R,connectivityCheckParams:j,connectivityCheckUrl:z,wsConnectivityCheckUrl:X,headers:S})}function Hn(i,a,l){const o=l||{};if(o.cipher){i||xt("Crypto");const u=i.getCipher(o.cipher,a);o.cipher=u.cipherParams,o.channelCipher=u.cipher}else"cipher"in o&&(o.cipher=void 0,o.channelCipher=null);return o}var Ri={json:"application/json",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack",text:"text/plain"},ni={format:"json",protocolVersion:fn.protocolVersion};function ea(i,{format:a=ni.format,protocolVersion:l=ni.protocolVersion}={}){return{accept:Ri[a],"X-Ably-Version":l.toString(),"Ably-Agent":gl(i)}}function Nt(i,{format:a=ni.format,protocolVersion:l=ni.protocolVersion}={}){let o;return{accept:o=Ri[a],"content-type":o,"X-Ably-Version":l.toString(),"Ably-Agent":gl(i)}}var be=fn;function kr(i){return Object.assign(fn,i)}var Ci=class Xd{constructor(a,l){this.logger=a,this.members=l||[]}call(a,l){for(const o of this.members)if(o)try{o(a,l)}catch(u){h.logAction(this.logger,h.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+u+"; stack = "+u.stack)}}push(...a){this.members.push(...a)}createPromise(){return new Promise((a,l)=>{this.push((o,u)=>{o?l(o):a(u)})})}resolveAll(a){this.call(null,a)}rejectAll(a){this.call(a)}static create(a,l){const o=new Xd(a,l);return Object.assign((u,f)=>o.call(u,f),{push:u=>o.push(u),createPromise:()=>o.createPromise(),resolveAll:u=>o.resolveAll(u),rejectAll:u=>o.rejectAll(u)})}},ii=Ci,Dr=(i=>(i.Get="get",i.Delete="delete",i.Post="post",i.Put="put",i.Patch="patch",i))(Dr||{}),mt=Dr,ml=(i=>(i[i.Success=200]="Success",i[i.NoContent=204]="NoContent",i[i.BadRequest=400]="BadRequest",i[i.Unauthorized=401]="Unauthorized",i[i.Forbidden=403]="Forbidden",i[i.RequestTimeout=408]="RequestTimeout",i[i.InternalServerError=500]="InternalServerError",i))(ml||{});function bc(i){return i>=200&&i<400}var _i=ml,ta=Math.pow(2,17);function Gn(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function yl(i){return!!i.connection}function vl(i){return $t(i)?(i.code||(i.statusCode===403?i.code=40300:(i.code=40170,i.statusCode=401)),i):new w(Ue(i),i.code||40170,i.statusCode||401)}var na=(i,a)=>{const l=x.BufferUtils,o=l.utf8Encode(i),u=l.utf8Encode(a),f=l.hmacSha256(o,u);return l.base64Encode(f)};function vs(i){if(!i)return"";typeof i=="string"&&(i=JSON.parse(i));const a=Object.create(null),l=qt(i,!0);if(!l)return"";l.sort();for(let o=0;o<l.length;o++)a[l[o]]=i[l[o]].sort();return JSON.stringify(a)}function bs(i,a){if(i.authCallback)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authCallback");else if(i.authUrl)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authUrl");else if(i.key)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(i.tokenDetails)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with supplied token only");else{const l="authOptions must include valid authentication parameters";throw h.logAction(a,h.LOG_ERROR,"Auth()",l),new Error(l)}}function Sc(i){return"useTokenAuth"in i&&!i.useTokenAuth}function bl(i){return i.useTokenAuth||!Sc(i)&&(i.authCallback||i.authUrl||i.token||i.tokenDetails)}function hn(i){return!i.key&&!i.authCallback&&!i.authUrl}var Lr=0;function Oc(){return Lr++}var Ss=class{constructor(i,a){if(this.authOptions={},this.client=i,this.tokenParams=a.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,bl(a))hn(a)&&h.logAction(this.logger,h.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(a.defaultTokenParams,a),bs(this.authOptions,this.logger);else{if(!a.key){const l="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()",l),new w(l,40160,401)}h.logAction(this.logger,h.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(a)}}get logger(){return this.client.logger}async authorize(i,a){if(a&&a.key&&this.authOptions.key!==a.key)throw new w("Unable to update auth options with incompatible key",40102,401);try{let l=await this._forceNewToken(i??null,a??null);return yl(this.client)?new Promise((o,u)=>{this.client.connection.connectionManager.onAuthUpdated(l,(f,p)=>f?u(f):o(p))}):l}catch(l){throw this.client.connection&&l.statusCode===_i.Forbidden&&this.client.connection.connectionManager.actOnErrorFromAuthorize(l),l}}async _forceNewToken(i,a){this.tokenDetails=null,this._saveTokenOptions(i,a),bs(this.authOptions,this.logger);try{return this._ensureValidAuthCredentials(!0)}finally{delete this.tokenParams.timestamp,delete this.authOptions.queryTime}}async requestToken(i,a){const l=a||this.authOptions,o=i||ae(this.tokenParams);let u,f=this.client;if(l.authCallback)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),u=l.authCallback;else if(l.authUrl)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),u=(m,R)=>{const S=U({accept:"application/json, text/plain"},l.authHeaders),j=l.authMethod&&l.authMethod.toLowerCase()==="post";let z;const X=l.authUrl.indexOf("?");X>-1&&(z=Ht(l.authUrl.slice(X)),l.authUrl=l.authUrl.slice(0,X),j||(l.authParams=U(z,l.authParams)));const q=U({},l.authParams||{},m),$=ee=>{var me,Ye;let We=(me=ee.body)!=null?me:null,et=null;if(ee.error)h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+Ue(ee.error));else{const jt=(Ye=ee.headers["content-type"])!=null?Ye:null;Array.isArray(jt)?et=jt.join(", "):et=jt,h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+et+"; body: "+An(We))}if(ee.error){R(ee.error,null);return}if(ee.unpacked){R(null,We);return}if(x.BufferUtils.isBuffer(We)&&(We=We.toString()),!et){R(new w("authUrl response is missing a content-type header",40170,401),null);return}const Oe=et.indexOf("application/json")>-1,cn=et.indexOf("text/plain")>-1||et.indexOf("application/jwt")>-1;if(!Oe&&!cn){R(new w("authUrl responded with unacceptable content-type "+et+", should be either text/plain, application/jwt or application/json",40170,401),null);return}if(Oe){if(We.length>ta){R(new w("authUrl response exceeded max permitted length",40170,401),null);return}try{We=JSON.parse(We)}catch(jt){R(new w("Unexpected error processing authURL response; err = "+jt.message,40170,401),null);return}}R(null,We,et)};if(h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+l.authUrl+"; Params: "+JSON.stringify(q)+"; method: "+(j?"POST":"GET")),j){const ee=S||{};ee["content-type"]="application/x-www-form-urlencoded";const me=Xe(q).slice(1);Z(this.client.http.doUri(mt.Post,l.authUrl,ee,me,z),(Ye,We)=>$(Ye||We))}else Z(this.client.http.doUri(mt.Get,l.authUrl,S||{},null,q),(ee,me)=>$(ee||me))};else if(l.key)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),u=(m,R)=>{Z(this.createTokenRequest(m,l),(S,j)=>R(S,j??null))};else{const m="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),new w(m,40171,403)}"capability"in o&&(o.capability=vs(o.capability));const p=(m,R)=>{const S=m.keyName,j="/keys/"+S+"/requestToken",z=function(q){return f.baseUri(q)+j},X=be.defaultPostHeaders(this.client.options);l.requestHeaders&&U(X,l.requestHeaders),h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+j+"; Token params: "+JSON.stringify(m)),Z(this.client.http.do(mt.Post,z,X,JSON.stringify(m),null),(q,$)=>q?R(q):R($.error,$.body,$.unpacked))};return new Promise((m,R)=>{let S=!1,j=this.client.options.timeouts.realtimeRequestTimeout,z=setTimeout(()=>{S=!0;const X="Token request callback timed out after "+j/1e3+" seconds";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",X),R(new w(X,40170,401))},j);u(o,(X,q,$)=>{if(S)return;if(clearTimeout(z),X){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+Ue(X)),R(vl(X));return}if(typeof q=="string"){q.length===0?R(new w("Token string is empty",40170,401)):q.length>ta?R(new w("Token string exceeded max permitted length (was "+q.length+" bytes)",40170,401)):q==="undefined"||q==="null"?R(new w("Token string was literal null/undefined",40170,401)):q[0]==="{"&&!($&&$.indexOf("application/jwt")>-1)?R(new w("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):m({token:q});return}if(typeof q!="object"||q===null){const me="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof q;h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",me),R(new w(me,40170,401));return}const ee=JSON.stringify(q).length;if(ee>ta&&!l.suppressMaxLengthCheck){R(new w("Token request/details object exceeded max permitted stringified size (was "+ee+" bytes)",40170,401));return}if("issued"in q){m(q);return}if(!("keyName"in q)){const me="Expected token request callback to call back with a token string, token request object, or token details object";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",me),R(new w(me,40170,401));return}p(q,(me,Ye,We)=>{if(me){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+Ue(me)),R(vl(me));return}We||(Ye=JSON.parse(Ye)),h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","token received"),m(Ye)})})})}async createTokenRequest(i,a){a=a||this.authOptions,i=i||ae(this.tokenParams);const l=a.key;if(!l)throw new w("No key specified",40101,403);const o=l.split(":"),u=o[0],f=o[1];if(!f)throw new w("Invalid key specified",40101,403);if(i.clientId==="")throw new w("clientId cant be an empty string",40012,400);"capability"in i&&(i.capability=vs(i.capability));const p=U({keyName:u},i),m=i.clientId||"",R=i.ttl||"",S=i.capability||"";p.timestamp||(p.timestamp=await this._getTimestamp(a&&a.queryTime));const j=p.nonce||(p.nonce=Gn()),z=p.timestamp,X=p.keyName+`
`+R+`
`+S+`
`+m+`
`+z+`
`+j+`
`;return p.mac=p.mac||na(X,f),h.logAction(this.logger,h.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),p}async getAuthParams(){if(this.method=="basic")return{key:this.key};{let i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{access_token:i.token}}}async getAuthHeaders(){if(this.method=="basic")return{authorization:"Basic "+this.basicKey};{const i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{authorization:"Bearer "+ms(i.token)}}}_saveBasicOptions(i){this.method="basic",this.key=i.key,this.basicKey=ms(i.key),this.authOptions=i||{},"clientId"in i&&this._userSetClientId(i.clientId)}_saveTokenOptions(i,a){this.method="token",i&&(this.tokenParams=i),a&&(a.token&&(a.tokenDetails=typeof a.token=="string"?{token:a.token}:a.token),a.tokenDetails&&(this.tokenDetails=a.tokenDetails),"clientId"in a&&this._userSetClientId(a.clientId),this.authOptions=a)}async _ensureValidAuthCredentials(i){const a=this.tokenDetails;if(a){if(this._tokenClientIdMismatch(a.clientId))throw new w("Mismatch between clientId in token ("+a.clientId+") and current clientId ("+this.clientId+")",40102,403);if(!this.client.isTimeOffsetSet()||!a.expires||a.expires>=this.client.getTimestampUsingOffset())return h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+a.expires),a;h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}const l=(this.waitingForTokenRequest||(this.waitingForTokenRequest=ii.create(this.logger))).createPromise();if(this.currentTokenRequestId!==null&&!i)return l;const o=this.currentTokenRequestId=Oc();let u,f=null;try{u=await this.requestToken(this.tokenParams,this.authOptions)}catch(m){f=m}if(this.currentTokenRequestId>o)return h.logAction(this.logger,h.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one"),l;this.currentTokenRequestId=null;const p=this.waitingForTokenRequest;return this.waitingForTokenRequest=null,f?(p?.rejectAll(f),l):(p?.resolveAll(this.tokenDetails=u),l)}_userSetClientId(i){if(typeof i=="string"||i===null){if(i==="*")throw new w('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);{const a=this._uncheckedSetClientId(i);if(a)throw a}}else throw new w("clientId must be either a string or null",40012,400)}_uncheckedSetClientId(i){if(this._tokenClientIdMismatch(i)){const a="Unexpected clientId mismatch: client has "+this.clientId+", requested "+i,l=new w(a,40102,401);return h.logAction(this.logger,h.LOG_ERROR,"Auth._uncheckedSetClientId()",a),l}else return this.clientId=this.tokenParams.clientId=i,null}_tokenClientIdMismatch(i){return!!(this.clientId&&this.clientId!=="*"&&i&&i!=="*"&&this.clientId!==i)}static isTokenErr(i){return i.code&&i.code>=40140&&i.code<40150}revokeTokens(i,a){return this.client.rest.revokeTokens(i,a)}async _getTimestamp(i){return this.client.getTimestamp(i||!!this.authOptions.queryTime)}},xn=Ss;function ia(i){const a=[];if(i)for(const l in i)a.push(l+"="+i[l]);return a.join("&")}function aa(i,a){return i+(a?"?":"")+ia(a)}function dn(i,a,l,o,u){i.error?h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received Error; "+aa(l,o)+"; Error: "+Ue(i.error)):h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received; "+aa(l,o)+"; Headers: "+ia(i.headers)+"; StatusCode: "+i.statusCode+"; Body"+(x.BufferUtils.isBuffer(i.body)?" (Base64): "+x.BufferUtils.base64Encode(i.body):": "+i.body))}function Sl(i,a,l,o,u){u.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(u,h.LOG_MICRO,"Http."+i+"()","Sending; "+aa(a,o)+"; Body"+(x.BufferUtils.isBuffer(l)?" (Base64): "+x.BufferUtils.base64Encode(l):": "+l))}var Os=class{constructor(i){this.client=i,this.platformHttp=new x.Http(i),this.checkConnectivity=this.platformHttp.checkConnectivity?()=>this.platformHttp.checkConnectivity():void 0}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}get supportsAuthHeaders(){return this.platformHttp.supportsAuthHeaders}get supportsLinkHeaders(){return this.platformHttp.supportsLinkHeaders}_getHosts(i){const a=i.connection,l=a&&a.connectionManager.host;return l?[l].concat(be.getFallbackHosts(i.options)):be.getHosts(i.options)}async do(i,a,l,o,u){try{const f=this.client;if(!f)return{error:new w("http.do called without client",5e4,500)};const p=typeof a=="function"?a:function(z){return f.baseUri(z)+a},m=f._currentFallback;if(m)if(m.validUntil>Date.now()){const z=await this.doUri(i,p(m.host),l,o,u);return z.error&&this.platformHttp.shouldFallback(z.error)?(f._currentFallback=null,this.do(i,a,l,o,u)):z}else f._currentFallback=null;const R=this._getHosts(f);if(R.length===1)return this.doUri(i,p(R[0]),l,o,u);let S=null;const j=async(z,X)=>{const q=z.shift();S=S??new Date;const $=await this.doUri(i,p(q),l,o,u);return $.error&&this.platformHttp.shouldFallback($.error)&&z.length?Date.now()-S.getTime()>f.options.timeouts.httpMaxRetryDuration?{error:new w(`Timeout for trying fallback hosts retries. Total elapsed time exceeded the ${f.options.timeouts.httpMaxRetryDuration}ms limit`,50003,500)}:j(z,!0):(X&&(f._currentFallback={host:q,validUntil:Date.now()+f.options.timeouts.fallbackRetryTimeout}),$)};return j(R)}catch(f){return{error:new w(`Unexpected error in Http.do: ${Ue(f)}`,500,5e4)}}}async doUri(i,a,l,o,u){try{Sl(i,a,o,u,this.logger);const f=await this.platformHttp.doUri(i,a,l,o,u);return this.logger.shouldLog(h.LOG_MICRO)&&dn(f,i,a,u,this.logger),f}catch(f){return{error:new w(`Unexpected error in Http.doUri: ${Ue(f)}`,500,5e4)}}}};function Ol(i,a,l,o){try{l.apply(a,o)}catch(u){h.logAction(i,h.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+u+"; stack = "+(u&&u.stack))}}function ai(i,a,l){let o,u,f;for(let p=0;p<i.length;p++)if(o=i[p],l&&(o=o[l]),Array.isArray(o)){for(;(u=o.indexOf(a))!==-1;)o.splice(u,1);l&&o.length===0&&delete i[p][l]}else if(v(o))for(f in o)Object.prototype.hasOwnProperty.call(o,f)&&Array.isArray(o[f])&&ai([o],a,f)}var Br=class{constructor(i){this.logger=i,this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}on(...i){if(i.length===1){const a=i[0];if(typeof a=="function")this.any.push(a);else throw new Error("EventListener.on(): Invalid arguments: "+x.Config.inspect(i))}if(i.length===2){const[a,l]=i;if(typeof l!="function")throw new Error("EventListener.on(): Invalid arguments: "+x.Config.inspect(i));if(Y(a))this.any.push(l);else if(Array.isArray(a))a.forEach(o=>{this.on(o,l)});else{if(typeof a!="string")throw new Error("EventListener.on(): Invalid arguments: "+x.Config.inspect(i));(this.events[a]||(this.events[a]=[])).push(l)}}}off(...i){if(i.length==0||Y(i[0])&&Y(i[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}const[a,l]=i;let o=null,u=null;if(i.length===1||!l)typeof a=="function"?o=a:u=a;else{if(typeof l!="function")throw new Error("EventEmitter.off(): invalid arguments:"+x.Config.inspect(i));[u,o]=[a,l]}if(o&&Y(u)){ai([this.any,this.events,this.anyOnce,this.eventsOnce],o);return}if(Array.isArray(u)){u.forEach(f=>{this.off(f,o)});return}if(typeof u!="string")throw new Error("EventEmitter.off(): invalid arguments:"+x.Config.inspect(i));o?ai([this.events,this.eventsOnce],o,u):(delete this.events[u],delete this.eventsOnce[u])}listeners(i){if(i){const a=this.events[i]||[];return this.eventsOnce[i]&&Array.prototype.push.apply(a,this.eventsOnce[i]),a.length?a:null}return this.any.length?this.any:null}emit(i,...a){const l={event:i},o=[];this.anyOnce.length&&(Array.prototype.push.apply(o,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(o,this.any);const u=this.eventsOnce[i];u&&(Array.prototype.push.apply(o,u),delete this.eventsOnce[i]);const f=this.events[i];f&&Array.prototype.push.apply(o,f),o.forEach(p=>{Ol(this.logger,l,p,a)})}once(...i){const a=i.length;if(a===0||a===1&&typeof i[0]!="function"){const u=i[0];return new Promise(f=>{this.once(u,f)})}const[l,o]=i;if(i.length===1&&typeof l=="function")this.anyOnce.push(l);else if(Y(l)){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));this.anyOnce.push(o)}else if(Array.isArray(l)){const u=this,f=function(){const p=Array.prototype.slice.call(arguments);if(l.forEach(function(m){u.off(m,f)}),typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));o.apply(this,p)};l.forEach(function(p){u.on(p,f)})}else{if(typeof l!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));const u=this.eventsOnce[l]||(this.eventsOnce[l]=[]);if(o){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));u.push(o)}}}async whenState(i,a){if(typeof i!="string"||typeof a!="string")throw new Error("whenState requires a valid state String argument");return i===a?null:this.once(i)}},Et=Br,ue={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18,OBJECT:19,OBJECT_SYNC:20,ANNOTATION:21},jr=[];Object.keys(ue).forEach(function(i){jr[ue[i]]=i});var Kt={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,HAS_OBJECTS:128,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19,ANNOTATION_PUBLISH:1<<21,ANNOTATION_SUBSCRIBE:1<<22,OBJECT_SUBSCRIBE:1<<24,OBJECT_PUBLISH:1<<25},zr=Object.keys(Kt);Kt.MODE_ALL=Kt.PRESENCE|Kt.PUBLISH|Kt.SUBSCRIBE|Kt.PRESENCE_SUBSCRIBE|Kt.ANNOTATION_PUBLISH|Kt.ANNOTATION_SUBSCRIBE|Kt.OBJECT_SUBSCRIBE|Kt.OBJECT_PUBLISH;var As=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE","ANNOTATION_PUBLISH","ANNOTATION_SUBSCRIBE","OBJECT_SUBSCRIBE","OBJECT_PUBLISH"];function Ac(i){return!i||!i.channelOptions?{channelOptions:i,plugins:{},baseEncodedPreviousPayload:void 0}:i}function qr(i,a,l){if(l&&l.cipher){i||xt("Crypto");const o=i.getCipher(l.cipher,a);return{cipher:o.cipherParams,channelCipher:o.cipher}}return l??{}}async function Ts(i,a){const{data:l,encoding:o}=await Rs(i.data,i.encoding,a);return i.data=l,i.encoding=o,i}async function Rs(i,a,l){let o=l.channelCipher,u=i,f=a?a+"/":"";x.BufferUtils.isBuffer(u)||(u=x.BufferUtils.utf8Encode(String(u)),f=f+"utf-8/");const p=await o.encrypt(u);return f=f+"cipher+"+o.algorithm,{data:p,encoding:f}}async function Ya(i,a){const l=typeof i.data=="string"||x.BufferUtils.isBuffer(i.data)||i.data===null||i.data===void 0,{data:o,encoding:u}=Ei(i.data,i.encoding,l);return i.data=o,i.encoding=u,a!=null&&a.cipher?Ts(i,a):i}function Ei(i,a,l){if(l)return{data:i,encoding:a};if(v(i)||Array.isArray(i))return{data:JSON.stringify(i),encoding:a?a+"/json":"json"};throw new w("Data type is unsupported",40013,400)}async function si(i,a){const{data:l,encoding:o,error:u}=await Al(i.data,i.encoding,a);if(i.data=l,i.encoding=o,u)throw u}async function Al(i,a,l){const o=Ac(l);let u=i,f=i,p=a,m;if(a){const R=a.split("/");let S,j=R.length,z="";try{for(;(S=j)>0;){const X=R[--j].match(/([-\w]+)(\+([\w-]+))?/);if(!X)break;switch(z=X[1],z){case"base64":f=x.BufferUtils.base64Decode(String(f)),S==R.length&&(u=f);continue;case"utf-8":f=x.BufferUtils.utf8Decode(f);continue;case"json":f=JSON.parse(f);continue;case"cipher":if(o.channelOptions!=null&&o.channelOptions.cipher&&o.channelOptions.channelCipher){const q=X[3],$=o.channelOptions.channelCipher;if(q!=$.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");f=await $.decrypt(f);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!o.plugins||!o.plugins.vcdiff)throw new w("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new w("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{let q=o.baseEncodedPreviousPayload;typeof q=="string"&&(q=x.BufferUtils.utf8Encode(q));const $=x.BufferUtils.toBuffer(q);f=x.BufferUtils.toBuffer(f),f=x.BufferUtils.arrayBufferViewToBuffer(o.plugins.vcdiff.decode(f,$)),u=f}catch(q){throw new w("Vcdiff delta decode failed with "+q,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(X){const q=X;m=new w(`Error processing the ${z} encoding, decoder returned ${q.message}`,q.code||40013,400)}finally{p=S<=0?null:R.slice(0,S).join("/")}}return m?{error:m,data:f,encoding:p}:(o.baseEncodedPreviousPayload=u,{data:f,encoding:p})}function Pa(...i){const a=i.length>0?"json":"msgpack",{data:l,encoding:o}=Tl(this.data,this.encoding,a);return Object.assign({},this,{encoding:o,data:l})}function Tl(i,a,l){return!i||!x.BufferUtils.isBuffer(i)?{data:i,encoding:a}:l==="msgpack"?{data:x.BufferUtils.toBuffer(i),encoding:a}:{data:x.BufferUtils.base64Encode(i),encoding:a?a+"/base64":"base64"}}var li={encryptData:Rs,encodeData:Ei,encodeDataForWire:Tl,decodeData:Al};function gn(i){const{id:a,connectionId:l,timestamp:o}=i;let u;switch(i.action){case ue.MESSAGE:{u=i.messages;break}case ue.PRESENCE:case ue.SYNC:u=i.presence;break;case ue.ANNOTATION:u=i.annotations;break;case ue.OBJECT:case ue.OBJECT_SYNC:u=i.state;break;default:throw new w("Unexpected action "+i.action,4e4,400)}for(let f=0;f<u.length;f++){const p=u[f];p.connectionId||(p.connectionId=l),p.timestamp||(p.timestamp=o),a&&!p.id&&(p.id=a+":"+f)}}function ri(i,a){let l="["+a;for(const o in i)o==="data"?typeof i.data=="string"?l+="; data="+i.data:x.BufferUtils.isBuffer(i.data)?l+="; data (buffer)="+x.BufferUtils.base64Encode(i.data):typeof i.data<"u"&&(l+="; data (json)="+JSON.stringify(i.data)):o&&(o==="extras"||o==="operation")?l+="; "+o+"="+JSON.stringify(i[o]):i[o]!==void 0&&(l+="; "+o+"="+i[o]);return l+="]",l}var Nn=class{},Vn=class{constructor(i){this.Platform=x,this.ErrorInfo=w,this.Logger=h,this.Defaults=be,this.Utils=Ve,this.EventEmitter=Et,this.MessageEncoding=li;var a,l,o,u,f,p,m,R,S,j;this._additionalHTTPRequestImplementations=(a=i.plugins)!=null?a:null,this.logger=new h,this.logger.setLog(i.logLevel,i.logHandler),h.logAction(this.logger,h.LOG_MICRO,"BaseClient()","initialized with clientOptions "+x.Config.inspect(i)),this._MsgPack=(o=(l=i.plugins)==null?void 0:l.MsgPack)!=null?o:null;const z=this.options=be.normaliseOptions(i,this._MsgPack,this.logger);if(z.key){const X=z.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!X){const q="invalid key parameter";throw h.logAction(this.logger,h.LOG_ERROR,"BaseClient()",q),new w(q,40400,404)}z.keyName=X[1],z.keySecret=X[2]}if("clientId"in z)if(typeof z.clientId=="string"||z.clientId===null){if(z.clientId==="*")throw new w('Cant use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new w("clientId must be either a string or null",40012,400);h.logAction(this.logger,h.LOG_MINOR,"BaseClient()","started; version = "+be.version),this._currentFallback=null,this.serverTimeOffset=null,this.http=new Os(this),this.auth=new xn(this,z),this._rest=(u=i.plugins)!=null&&u.Rest?new i.plugins.Rest(this):null,this._Crypto=(p=(f=i.plugins)==null?void 0:f.Crypto)!=null?p:null,this.__FilteredSubscriptions=(R=(m=i.plugins)==null?void 0:m.MessageInteractions)!=null?R:null,this._Annotations=(j=(S=i.plugins)==null?void 0:S.Annotations)!=null?j:null}get rest(){return this._rest||xt("Rest"),this._rest}get _FilteredSubscriptions(){return this.__FilteredSubscriptions||xt("MessageInteractions"),this.__FilteredSubscriptions}get channels(){return this.rest.channels}get push(){return this.rest.push}device(){var i;return(!((i=this.options.plugins)!=null&&i.Push)||!this.push.LocalDevice)&&xt("Push"),this._device||(this._device=this.push.LocalDevice.load(this)),this._device}baseUri(i){return be.getHttpScheme(this.options)+i+":"+be.getPort(this.options,!1)}async stats(i){return this.rest.stats(i)}async time(i){return this.rest.time(i)}async request(i,a,l,o,u,f){return this.rest.request(i,a,l,o,u,f)}batchPublish(i){return this.rest.batchPublish(i)}batchPresence(i){return this.rest.batchPresence(i)}setLog(i){this.logger.setLog(i.level,i.handler)}async getTimestamp(i){return!this.isTimeOffsetSet()&&i?this.time():this.getTimestampUsingOffset()}getTimestampUsingOffset(){return Date.now()+(this.serverTimeOffset||0)}isTimeOffsetSet(){return this.serverTimeOffset!==null}};Vn.Platform=x;var Cs=Vn,_s=class ol{toJSON(){var a,l,o;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(a=this.push)==null?void 0:a.recipient,state:(l=this.push)==null?void 0:l.state,error:(o=this.push)==null?void 0:o.error}}}toString(){var a,l,o,u;let f="[DeviceDetails";return this.id&&(f+="; id="+this.id),this.platform&&(f+="; platform="+this.platform),this.formFactor&&(f+="; formFactor="+this.formFactor),this.clientId&&(f+="; clientId="+this.clientId),this.metadata&&(f+="; metadata="+this.metadata),this.deviceIdentityToken&&(f+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),(a=this.push)!=null&&a.recipient&&(f+="; push.recipient="+JSON.stringify(this.push.recipient)),(l=this.push)!=null&&l.state&&(f+="; push.state="+this.push.state),(o=this.push)!=null&&o.error&&(f+="; push.error="+JSON.stringify(this.push.error)),(u=this.push)!=null&&u.metadata&&(f+="; push.metadata="+this.push.metadata),f+="]",f}static toRequestBody(a,l,o){return K(a,l,o)}static fromResponseBody(a,l,o){return o&&(a=J(a,l,o)),Array.isArray(a)?ol.fromValuesArray(a):ol.fromValues(a)}static fromValues(a){return a.error=a.error&&w.fromValues(a.error),Object.assign(new ol,a)}static fromLocalDevice(a){return Object.assign(new ol,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=ol.fromValues(a[u]);return o}},Mi=_s;async function Xa(i,a,l,o){if(i.http.supportsAuthHeaders){const u=await i.auth.getAuthHeaders();return o(U(u,a),l)}else{const u=await i.auth.getAuthParams();return o(a,U(u,l))}}function Es(i,a,l){if(i.err&&!i.body)return{err:i.err};if(i.statusCode===_i.NoContent)return Te(he({},i),{body:[],unpacked:!0});let o=i.body;if(!i.unpacked)try{o=J(o,a,l)}catch(m){return $t(m)?{err:m}:{err:new Ce(Ue(m),null)}}if(!o)return{err:new Ce("unenvelope(): Response body is missing",null)};const{statusCode:u,response:f,headers:p}=o;if(u===void 0)return Te(he({},i),{body:o,unpacked:!0});if(u<200||u>=300){let m=f&&f.error||i.err;return m||(m=new Error("Error in unenveloping "+o),m.statusCode=u),{err:m,body:f,headers:p,unpacked:!0,statusCode:u}}return{err:i.err,body:f,headers:p,unpacked:!0,statusCode:u}}function Hr(i,a,l,o,u){i.err?h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received Error; "+aa(l,o)+"; Error: "+Ue(i.err)):h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received; "+aa(l,o)+"; Headers: "+ia(i.headers)+"; StatusCode: "+i.statusCode+"; Body: "+(x.BufferUtils.isBuffer(i.body)?" (Base64): "+x.BufferUtils.base64Encode(i.body):": "+x.Config.inspect(i.body)))}var en=class cl{static async get(a,l,o,u,f,p){return cl.do(mt.Get,a,l,null,o,u,f,p??!1)}static async delete(a,l,o,u,f,p){return cl.do(mt.Delete,a,l,null,o,u,f,p)}static async post(a,l,o,u,f,p,m){return cl.do(mt.Post,a,l,o,u,f,p,m)}static async patch(a,l,o,u,f,p,m){return cl.do(mt.Patch,a,l,o,u,f,p,m)}static async put(a,l,o,u,f,p,m){return cl.do(mt.Put,a,l,o,u,f,p,m)}static async do(a,l,o,u,f,p,m,R){m&&((p=p||{}).envelope=m);const S=l.logger;async function j(X,q){var $;if(S.shouldLog(h.LOG_MICRO)){let me=u;if((($=X["content-type"])==null?void 0:$.indexOf("msgpack"))>0)try{l._MsgPack||xt("MsgPack"),me=l._MsgPack.decode(u)}catch(Ye){h.logAction(S,h.LOG_MICRO,"Resource."+a+"()","Sending MsgPack Decoding Error: "+Ue(Ye))}h.logAction(S,h.LOG_MICRO,"Resource."+a+"()","Sending; "+aa(o,q)+"; Body: "+me)}const ee=await l.http.do(a,o,X,u,q);return ee.error&&xn.isTokenErr(ee.error)?(await l.auth.authorize(null,null),Xa(l,X,q,j)):{err:ee.error,body:ee.body,headers:ee.headers,unpacked:ee.unpacked,statusCode:ee.statusCode}}let z=await Xa(l,f,p,j);if(m&&(z=Es(z,l._MsgPack,m)),S.shouldLog(h.LOG_MICRO)&&Hr(z,a,o,p,S),R){if(z.err)throw z.err;{const X=he({},z);return delete X.err,X}}return z}},it=en;function Ms(i){const a=i.match(/^\.\/(\w+)\?(.*)$/);return a&&a[2]&&Ht(a[2])}function Qa(i){typeof i=="string"&&(i=i.split(","));const a={};for(let l=0;l<i.length;l++){const o=i[l].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(o){const u=Ms(o[1]);u&&(a[o[2]]=u)}}return a}function Tc(i,a,l){return!(l&&(a||typeof i.code=="number"))}var Rl=class{constructor(i,a,l,o,u,f){this.client=i,this.path=a,this.headers=l,this.envelope=o??null,this.bodyHandler=u,this.useHttpPaginatedResponse=f||!1}get logger(){return this.client.logger}async get(i){const a=await it.get(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async delete(i){const a=await it.delete(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async post(i,a){const l=await it.post(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async put(i,a){const l=await it.put(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async patch(i,a){const l=await it.patch(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async handlePage(i){if(i.err&&Tc(i.err,i.body,this.useHttpPaginatedResponse))throw h.logAction(this.logger,h.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+Ue(i.err)),i.err;let a,l,o;try{a=i.statusCode==_i.NoContent?[]:await this.bodyHandler(i.body,i.headers||{},i.unpacked)}catch(u){throw i.err||u}return i.headers&&(l=i.headers.Link||i.headers.link)&&(o=Qa(l)),this.useHttpPaginatedResponse?new Za(this,a,i.headers||{},i.statusCode,o,i.err):new ws(this,a,o)}},ws=class{constructor(i,a,l){this.resource=i,this.items=a,this._relParams=l}async first(){if(this.hasFirst())return this.get(this._relParams.first);throw new w("No link to the first page of results",40400,404)}async current(){if(this.hasCurrent())return this.get(this._relParams.current);throw new w("No link to the current page of results",40400,404)}async next(){return this.hasNext()?this.get(this._relParams.next):null}hasFirst(){return this._relParams!=null&&"first"in this._relParams}hasCurrent(){return this._relParams!=null&&"current"in this._relParams}hasNext(){return this._relParams!=null&&"next"in this._relParams}isLast(){return!this.hasNext()}async get(i){const a=this.resource,l=await it.get(a.client,a.path,a.headers,i,a.envelope,!1);return a.handlePage(l)}},Za=class extends ws{constructor(i,a,l,o,u,f){super(i,a,u),this.statusCode=o,this.success=o<300&&o>=200,this.headers=l,this.errorCode=f&&f.code,this.errorMessage=f&&f.message}toJSON(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}}},ln=Rl,Cl=class Er{toJSON(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}}toString(){let a="[PushChannelSubscription";return this.channel&&(a+="; channel="+this.channel),this.deviceId&&(a+="; deviceId="+this.deviceId),this.clientId&&(a+="; clientId="+this.clientId),a+="]",a}static fromResponseBody(a,l,o){return o&&(a=J(a,l,o)),Array.isArray(a)?Er.fromValuesArray(a):Er.fromValues(a)}static fromValues(a){return Object.assign(new Er,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=Er.fromValues(a[u]);return o}};Cl.toRequestBody=K;var Rc=Cl,xs=Rc,Cc=class{constructor(i){var a;this.client=i,this.admin=new _l(i),x.Config.push&&((a=i.options.plugins)!=null&&a.Push)&&(this.stateMachine=new i.options.plugins.Push.ActivationStateMachine(i),this.LocalDevice=i.options.plugins.Push.localDeviceFactory(Mi))}async activate(i,a){await new Promise((l,o)=>{var u;if(!((u=this.client.options.plugins)!=null&&u.Push)){o(Va("Push"));return}if(!this.stateMachine){o(new w("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.activatedCallback){o(new w("Activation already in progress",4e4,400));return}this.stateMachine.activatedCallback=f=>{if(f){o(f);return}l()},this.stateMachine.updateFailedCallback=a,this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledActivate(this.stateMachine,i))})}async deactivate(i){await new Promise((a,l)=>{var o;if(!((o=this.client.options.plugins)!=null&&o.Push)){l(Va("Push"));return}if(!this.stateMachine){l(new w("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.deactivatedCallback){l(new w("Deactivation already in progress",4e4,400));return}this.stateMachine.deactivatedCallback=u=>{if(u){l(u);return}a()},this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledDeactivate(this.stateMachine,i))})}},_l=class{constructor(i){this.client=i,this.deviceRegistrations=new _c(i),this.channelSubscriptions=new Ec(i)}async publish(i,a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=be.defaultPostHeaders(l.options,{format:o}),f={},p=U({recipient:i},a);U(u,l.options.headers),l.options.pushFullWait&&U(f,{fullWait:"true"});const m=K(p,l._MsgPack,o);await it.post(l,"/push/publish",m,u,f,null,!0)}},_c=class{constructor(i){this.client=i}async save(i){const a=this.client,l=Mi.fromValues(i),o=a.options.useBinaryProtocol?"msgpack":"json",u=be.defaultPostHeaders(a.options,{format:o}),f={};U(u,a.options.headers),a.options.pushFullWait&&U(f,{fullWait:"true"});const p=K(l,a._MsgPack,o),m=await it.put(a,"/push/deviceRegistrations/"+encodeURIComponent(i.id),p,u,f,null,!0);return Mi.fromResponseBody(m.body,a._MsgPack,m.unpacked?void 0:o)}async get(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=be.defaultGetHeaders(a.options,{format:l}),u=i.id||i;if(typeof u!="string"||!u.length)throw new w("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400);U(o,a.options.headers);const f=await it.get(a,"/push/deviceRegistrations/"+encodeURIComponent(u),o,{},null,!0);return Mi.fromResponseBody(f.body,a._MsgPack,f.unpacked?void 0:l)}async list(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l,u=be.defaultGetHeaders(a.options,{format:l});return U(u,a.options.headers),new ln(a,"/push/deviceRegistrations",u,o,async function(f,p,m){return Mi.fromResponseBody(f,a._MsgPack,m?void 0:l)}).get(i)}async remove(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=be.defaultGetHeaders(a.options,{format:l}),u={},f=i.id||i;if(typeof f!="string"||!f.length)throw new w("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400);U(o,a.options.headers),a.options.pushFullWait&&U(u,{fullWait:"true"}),await it.delete(a,"/push/deviceRegistrations/"+encodeURIComponent(f),o,u,null,!0)}async removeWhere(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=be.defaultGetHeaders(a.options,{format:l});U(o,a.options.headers),a.options.pushFullWait&&U(i,{fullWait:"true"}),await it.delete(a,"/push/deviceRegistrations",o,i,null,!0)}},Ec=class Qd{constructor(a){this.remove=Qd.prototype.removeWhere,this.client=a}async save(a){const l=this.client,o=xs.fromValues(a),u=l.options.useBinaryProtocol?"msgpack":"json",f=be.defaultPostHeaders(l.options,{format:u}),p={};U(f,l.options.headers),l.options.pushFullWait&&U(p,{fullWait:"true"});const m=K(o,l._MsgPack,u),R=await it.post(l,"/push/channelSubscriptions",m,f,p,null,!0);return xs.fromResponseBody(R.body,l._MsgPack,R.unpacked?void 0:u)}async list(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=be.defaultGetHeaders(l.options,{format:o});return U(f,l.options.headers),new ln(l,"/push/channelSubscriptions",f,u,async function(p,m,R){return xs.fromResponseBody(p,l._MsgPack,R?void 0:o)}).get(a)}async removeWhere(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=be.defaultGetHeaders(l.options,{format:o});U(u,l.options.headers),l.options.pushFullWait&&U(a,{fullWait:"true"}),await it.delete(l,"/push/channelSubscriptions",u,a,null,!0)}async listChannels(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=be.defaultGetHeaders(l.options,{format:o});return U(f,l.options.headers),l.options.pushFullWait&&U(a,{fullWait:"true"}),new ln(l,"/push/channels",f,u,async function(p,m,R){const S=!R&&o?J(p,l._MsgPack,o):p;for(let j=0;j<S.length;j++)S[j]=String(S[j]);return S}).get(a)}},Mc=Cc,Gr=["absent","present","enter","leave","update"];async function Vr(i,a,l,o){const u=qr(a,i,o??null);return Ka.fromValues(l).decode(u,i)}async function Ir(i,a,l,o){return Promise.all(l.map(function(u){return Vr(i,a,u,o)}))}async function wc(i,a){return Ka.fromValues(i).decode(a.channelOptions,a.logger)}async function Yr(i,a){return Promise.all(i.map(function(l){return wc(l,a)}))}var Pr=class Mr extends Nn{isSynthesized(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId}parseId(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");const a=this.id.split(":");return{connectionId:a[0],msgSerial:parseInt(a[1],10),index:parseInt(a[2],10)}}async encode(a){const l=Object.assign(new Ka,this,{action:Gr.indexOf(this.action||"present")});return Ya(l,a)}static fromValues(a){return Object.assign(new Mr,a)}static fromValuesArray(a){return a.map(l=>Mr.fromValues(l))}static fromData(a){return a instanceof Mr?a:Mr.fromValues({data:a})}toString(){return ri(this,"PresenceMessage")}},Ka=class rf extends Nn{toJSON(...a){return Pa.call(this,...a)}static fromValues(a){return Object.assign(new rf,a)}static fromValuesArray(a){return a.map(l=>rf.fromValues(l))}async decode(a,l){const o=Object.assign(new Pr,Te(he({},this),{action:Gr[this.action]}));try{await si(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WirePresenceMessage.decode()",Ue(u))}return o}toString(){return ri(this,"WirePresenceMessage")}},Un=Pr,xc=class{constructor(i){this.channel=i}get logger(){return this.channel.logger}async get(i){h.logAction(this.logger,h.LOG_MICRO,"RestPresence.get()","channel = "+this.channel.name);const a=this.channel.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.channel.client.http.supportsLinkHeaders?void 0:l,u=be.defaultGetHeaders(a.options,{format:l});return U(u,a.options.headers),new ln(a,this.channel.client.rest.presenceMixin.basePath(this),u,o,async(f,p,m)=>{const R=m?f:J(f,a._MsgPack,l);return Yr(R,this.channel)}).get(i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestPresence.history()","channel = "+this.channel.name),this.channel.client.rest.presenceMixin.history(this,i)}},Nc=xc,Xr=["message.create","message.update","message.delete","meta","message.summary"];function Qr(i){return Xr[i||0]||"unknown"}function Uc(i){let a=0;return i.name&&(a+=i.name.length),i.clientId&&(a+=i.clientId.length),i.extras&&(a+=JSON.stringify(i.extras).length),i.data&&(a+=un(i.data)),a}async function Zr(i,a,l,o){const u=qr(a,i,o??null);return wi.fromValues(l).decode(u,i)}async function kc(i,a,l,o){return Promise.all(l.map(function(u){return Zr(i,a,u,o)}))}async function Dc(i,a){return wi.fromValues(i).decode(a.channelOptions,a.logger)}async function Lc(i,a){return Promise.all(i.map(function(l){return Dc(l,a)}))}async function Kr(i,a){return Promise.all(i.map(l=>l.encode(a)))}var Bc=K;function El(i){let a,l=0;for(let o=0;o<i.length;o++)a=i[o],l+=a.size||(a.size=Uc(a));return l}var Jr=class of extends Nn{expandFields(){this.action==="message.create"&&(this.version&&!this.serial&&(this.serial=this.version),this.timestamp&&!this.createdAt&&(this.createdAt=this.timestamp))}async encode(a){const l=Object.assign(new wi,this,{action:Xr.indexOf(this.action||"message.create")});return Ya(l,a)}static fromValues(a){return Object.assign(new of,a)}static fromValuesArray(a){return a.map(l=>of.fromValues(l))}toString(){return ri(this,"Message")}},wi=class cf extends Nn{toJSON(...a){return Pa.call(this,...a)}static fromValues(a){return Object.assign(new cf,a)}static fromValuesArray(a){return a.map(l=>cf.fromValues(l))}async decodeWithErr(a,l){const o=Object.assign(new Jr,Te(he({},this),{action:Qr(this.action)}));let u;try{await si(o,a)}catch(f){h.logAction(l,h.LOG_ERROR,"WireMessage.decode()",Ue(f)),u=f}return o.expandFields(),{decoded:o,err:u}}async decode(a,l){const{decoded:o}=await this.decodeWithErr(a,l);return o}toString(){return ri(this,"WireMessage")}},pn=Jr,jc=9;function Wr(i){return i.every(function(a){return!a.id})}var Fr=class{constructor(i,a,l){this._annotations=null;var o,u;h.logAction(i.logger,h.LOG_MINOR,"RestChannel()","started; name = "+a),this.name=a,this.client=i,this.presence=new Nc(this),this.channelOptions=Hn((o=i._Crypto)!=null?o:null,this.logger,l),(u=i.options.plugins)!=null&&u.Push&&(this._push=new i.options.plugins.Push.PushChannel(this)),i._Annotations&&(this._annotations=new i._Annotations.RestAnnotations(this))}get annotations(){return this._annotations||xt("Annotations"),this._annotations}get push(){return this._push||xt("Push"),this._push}get logger(){return this.client.logger}setOptions(i){var a;this.channelOptions=Hn((a=this.client._Crypto)!=null?a:null,this.logger,i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestChannel.history()","channel = "+this.name),this.client.rest.channelMixin.history(this,i)}async publish(...i){const a=i[0],l=i[1];let o,u;if(typeof a=="string"||a===null)o=[pn.fromValues({name:a,data:l})],u=i[2];else if(v(a))o=[pn.fromValues(a)],u=i[1];else if(Array.isArray(a))o=pn.fromValuesArray(a),u=i[1];else throw new w("The single-argument form of publish() expects a message object or an array of message objects",40013,400);u||(u={});const f=this.client,p=f.options,m=p.useBinaryProtocol?"msgpack":"json",R=f.options.idempotentRestPublishing,S=be.defaultPostHeaders(f.options,{format:m});if(U(S,p.headers),R&&Wr(o)){const q=await Ti(jc);o.forEach(function($,ee){$.id=q+":"+ee.toString()})}const j=await Kr(o,this.channelOptions),z=El(j),X=p.maxMessageSize;if(z>X)throw new w(`Maximum size of messages that can be published at once exceeded (was ${z} bytes; limit is ${X} bytes)`,40009,400);await this._publish(Bc(j,f._MsgPack,m),S,u)}async _publish(i,a,l){await it.post(this.client,this.client.rest.channelMixin.basePath(this)+"/messages",i,a,l,null,!0)}async status(){return this.client.rest.channelMixin.status(this)}},$r=Fr,eo=class Zd{constructor(a){this.entries=a&&a.entries||void 0,this.schema=a&&a.schema||void 0,this.appId=a&&a.appId||void 0,this.inProgress=a&&a.inProgress||void 0,this.unit=a&&a.unit||void 0,this.intervalId=a&&a.intervalId||void 0}static fromValues(a){return new Zd(a)}},to=eo,xi=class{static basePath(i){return"/channels/"+encodeURIComponent(i.name)}static history(i,a){const l=i.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.client.http.supportsLinkHeaders?void 0:o,f=be.defaultGetHeaders(l.options,{format:o});return U(f,l.options.headers),new ln(l,this.basePath(i)+"/messages",f,u,async function(p,m,R){const S=R?p:J(p,l._MsgPack,o);return Lc(S,i)}).get(a)}static async status(i){const a=i.client.options.useBinaryProtocol?"msgpack":"json",l=be.defaultPostHeaders(i.client.options,{format:a});return(await it.get(i.client,this.basePath(i),l,{},a,!0)).body}},zc=class{static basePath(i){return xi.basePath(i.channel)+"/presence"}static async history(i,a){const l=i.channel.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.channel.client.http.supportsLinkHeaders?void 0:o,f=be.defaultGetHeaders(l.options,{format:o});return U(f,l.options.headers),new ln(l,this.basePath(i)+"/history",f,u,async(p,m,R)=>{const S=R?p:J(p,l._MsgPack,o);return Yr(S,i.channel)}).get(a)}},no=class{constructor(i){this.channelMixin=xi,this.presenceMixin=zc,this.Resource=it,this.PaginatedResource=ln,this.DeviceDetails=Mi,this.PushChannelSubscription=xs,this.client=i,this.channels=new qc(this.client),this.push=new Mc(this.client)}async stats(i){const a=be.defaultGetHeaders(this.client.options),l=this.client.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l;return U(a,this.client.options.headers),new ln(this.client,"/stats",a,o,function(u,f,p){const m=p?u:JSON.parse(u);for(let R=0;R<m.length;R++)m[R]=to.fromValues(m[R]);return m}).get(i)}async time(i){const a=be.defaultGetHeaders(this.client.options);this.client.options.headers&&U(a,this.client.options.headers);const l=m=>this.client.baseUri(m)+"/time";let{error:o,body:u,unpacked:f}=await this.client.http.do(mt.Get,l,a,null,i);if(o)throw o;f||(u=JSON.parse(u));const p=u[0];if(!p)throw new w("Internal error (unexpected result type from GET /time)",5e4,500);return this.client.serverTimeOffset=p-Date.now(),p}async request(i,a,l,o,u,f){var p;const[m,R,S]=this.client.options.useBinaryProtocol?(this.client._MsgPack||xt("MsgPack"),[this.client._MsgPack.encode,this.client._MsgPack.decode,"msgpack"]):[JSON.stringify,JSON.parse,"json"],j=this.client.http.supportsLinkHeaders?void 0:S;o=o||{};const z=i.toLowerCase(),X=z=="get"?be.defaultGetHeaders(this.client.options,{format:S,protocolVersion:l}):be.defaultPostHeaders(this.client.options,{format:S,protocolVersion:l});typeof u!="string"&&(u=(p=m(u))!=null?p:null),U(X,this.client.options.headers),f&&U(X,f);const q=new ln(this.client,a,X,j,async function($,ee,me){return pe(me?$:R($))},!0);if(!x.Http.methods.includes(z))throw new w("Unsupported method "+z,40500,405);return x.Http.methodsWithBody.includes(z)?q[z](o,u):q[z](o)}async batchPublish(i){let a,l;Array.isArray(i)?(a=i,l=!1):(a=[i],l=!0);const o=this.client.options.useBinaryProtocol?"msgpack":"json",u=be.defaultPostHeaders(this.client.options,{format:o});this.client.options.headers&&U(u,this.client.options.headers);const f=K(a,this.client._MsgPack,o),p=await it.post(this.client,"/messages",f,u,{},null,!0),m=p.unpacked?p.body:J(p.body,this.client._MsgPack,o);return l?m[0]:m}async batchPresence(i){const a=this.client.options.useBinaryProtocol?"msgpack":"json",l=be.defaultPostHeaders(this.client.options,{format:a});this.client.options.headers&&U(l,this.client.options.headers);const o=i.join(","),u=await it.get(this.client,"/presence",l,{channels:o},null,!0);return u.unpacked?u.body:J(u.body,this.client._MsgPack,a)}async revokeTokens(i,a){if(bl(this.client.options))throw new w("Cannot revoke tokens when using token auth",40162,401);const l=this.client.options.keyName;let o=a??{};const u=he({targets:i.map(S=>`${S.type}:${S.value}`)},o),f=this.client.options.useBinaryProtocol?"msgpack":"json",p=be.defaultPostHeaders(this.client.options,{format:f});this.client.options.headers&&U(p,this.client.options.headers);const m=K(u,this.client._MsgPack,f),R=await it.post(this.client,`/keys/${l}/revokeTokens`,m,p,{},null,!0);return R.unpacked?R.body:J(R.body,this.client._MsgPack,f)}},qc=class{constructor(i){this.client=i,this.all=Object.create(null)}get(i,a){i=String(i);let l=this.all[i];return l?a&&l.setOptions(a):this.all[i]=l=new $r(this.client,i,a),l}release(i){delete this.all[String(i)]}},io=class extends Cs{constructor(i){super(be.objectifyOptions(i,!1,"BaseRest",h.defaultLogger,{Rest:no}))}},Ml={Rest:no},sa=class extends pn{static async fromEncoded(i,a){return Zr(h.defaultLogger,x.Crypto,i,a)}static async fromEncodedArray(i,a){return kc(h.defaultLogger,x.Crypto,i,a)}static fromValues(i){return pn.fromValues(i)}},la=class extends Un{static async fromEncoded(i,a){return Vr(h.defaultLogger,x.Crypto,i,a)}static async fromEncodedArray(i,a){return Ir(h.defaultLogger,x.Crypto,i,a)}static fromValues(i){return Un.fromValues(i)}},ao=["annotation.create","annotation.delete"];async function Ja(i,a,l){return Ni.fromValues(a).decode(l||{},i)}async function so(i,a,l){return Promise.all(a.map(function(o){return Ja(i,o,l)}))}async function lo(i,a){return Ni.fromValues(i).decode(a.channelOptions,a.logger)}async function wl(i,a){return Promise.all(i.map(function(l){return lo(l,a)}))}var Ns=class uf extends Nn{async encode(){const a=Object.assign(new Ni,this,{action:ao.indexOf(this.action||"annotation.create")});return Ya(a,{})}static fromValues(a){return Object.assign(new uf,a)}static fromValuesArray(a){return a.map(l=>uf.fromValues(l))}toString(){return ri(this,"Annotation")}},Ni=class ff extends Nn{toJSON(...a){return Pa.call(this,...a)}static fromValues(a){return Object.assign(new ff,a)}static fromValuesArray(a){return a.map(l=>ff.fromValues(l))}async decode(a,l){const o=Object.assign(new Ns,Te(he({},this),{action:ao[this.action]}));try{await si(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WireAnnotation.decode()",Ue(u))}return o}toString(){return ri(this,"WireAnnotation")}},ra=Ns,xl=class extends ra{static async fromEncoded(i,a){return Ja(h.defaultLogger,i,a)}static async fromEncodedArray(i,a){return so(h.defaultLogger,i,a)}static fromValues(i){return ra.fromValues(i)}};function ro(i){let a;switch(typeof i){case"string":a=i;break;case"object":a=i.serial;break}if(!a||typeof a!="string")throw new w("First argument of annotations.publish() must be either a Message (or at least an object with a string `serial` property) or a message serial (string)",40003,400);return a}function oo(i,a){const l=ro(i);if(!a||typeof a!="object")throw new w("Second argument of annotations.publish() must be an object (the intended annotation to publish)",40003,400);const o=ra.fromValues(a);return o.messageSerial=l,o.action||(o.action="annotation.create"),o}function co(i,a){return i.client.rest.channelMixin.basePath(i)+"/messages/"+encodeURIComponent(a)+"/annotations"}var Hc=class{constructor(i){this.channel=i}async publish(i,a){const l=oo(i,a),o=await l.encode(),u=this.channel.client,f=u.options,p=f.useBinaryProtocol?"msgpack":"json",m=be.defaultPostHeaders(u.options,{format:p}),R={};U(m,u.options.headers);const S=K([o],u._MsgPack,p);await it.post(u,co(this.channel,l.messageSerial),S,m,R,null,!0)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async get(i,a){const l=this.channel.client,o=ro(i),u=l.options.useBinaryProtocol?"msgpack":"json",f=l.http.supportsLinkHeaders?void 0:u,p=be.defaultGetHeaders(l.options,{format:u});return U(p,l.options.headers),new ln(l,co(this.channel,o),p,f,async(m,R,S)=>{const j=S?m:J(m,l._MsgPack,u);return wl(j,this.channel)}).get(a)}},Nl=Hc,rn=K;function oi(i){const a=[];if(i)for(let l=0;l<i.length;l++)a.push(i[l].toString());return"[ "+a.join(", ")+" ]"}function uo(i,a,l,o,u,f){const p=J(i,a,f);return Us(p,l,o,u)}function Us(i,a,l,o){let u;i.error&&(u=w.fromValues(i.error));let f;i.messages&&(f=wi.fromValuesArray(i.messages));let p;a&&i.presence&&(p=a.WirePresenceMessage.fromValuesArray(i.presence));let m;l&&i.annotations&&(m=l.WireAnnotation.fromValuesArray(i.annotations));let R;return o&&i.state&&(R=o.ObjectMessage.fromValuesArray(i.state,Ve,li)),Object.assign(new kl,Te(he({},i),{presence:p,messages:f,annotations:m,state:R,error:u}))}function Ul(i){return a=>{var l;return Us(a,{WirePresenceMessage:Ka},{WireAnnotation:Ni},(l=i?.ObjectsPlugin)!=null?l:null)}}function tn(i){return Object.assign(new kl,i)}function Wa(i,a,l,o){let u="[ProtocolMessage";i.action!==void 0&&(u+="; action="+jr[i.action]||i.action);const f=["id","channel","channelSerial","connectionId","count","msgSerial","timestamp"];let p;for(let m=0;m<f.length;m++)p=f[m],i[p]!==void 0&&(u+="; "+p+"="+i[p]);if(i.messages&&(u+="; messages="+oi(wi.fromValuesArray(i.messages))),i.presence&&a&&(u+="; presence="+oi(a.WirePresenceMessage.fromValuesArray(i.presence))),i.annotations&&l&&(u+="; annotations="+oi(l.WireAnnotation.fromValuesArray(i.annotations))),i.state&&o&&(u+="; state="+oi(o.ObjectMessage.fromValuesArray(i.state,Ve,li))),i.error&&(u+="; error="+w.fromValues(i.error).toString()),i.auth&&i.auth.accessToken&&(u+="; token="+i.auth.accessToken),i.flags&&(u+="; flags="+zr.filter(i.hasFlag).join(",")),i.params){let m="";P(i.params,function(R){m.length>0&&(m+="; "),m+=R+"="+i.params[R]}),m.length>0&&(u+="; params=["+m+"]")}return u+="]",u}var kl=class{constructor(){this.hasFlag=i=>(this.flags&Kt[i])>0}setFlag(i){return this.flags=this.flags|Kt[i]}getMode(){return(this.flags||0)&Kt.MODE_ALL}encodeModesToFlags(i){i.forEach(a=>this.setFlag(a))}decodeModesFromFlags(){const i=[];return As.forEach(a=>{this.hasFlag(a)&&i.push(a)}),i.length>0?i:void 0}},oa=kl,Dl=class{constructor(i,a,l,o,u){this.previous=i,this.current=a,a==="attached"&&(this.resumed=l,this.hasBacklog=o),u&&(this.reason=u)}},Ui=Dl,ks=function(){};function fo(i){if(i&&"params"in i&&!v(i.params))return new w("options.params must be an object",4e4,400);if(i&&"modes"in i){if(!Array.isArray(i.modes))return new w("options.modes must be an array",4e4,400);for(let a=0;a<i.modes.length;a++){const l=i.modes[a];if(!l||typeof l!="string"||!As.includes(String.prototype.toUpperCase.call(l)))return new w("Invalid channel mode: "+l,4e4,400)}}}var ki=class hf extends Et{constructor(a,l,o){var u,f,p;super(a.logger),this._annotations=null,this._mode=0,this.retryCount=0,this.history=async function(m){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name);const R=this.client.rest.channelMixin;if(m&&m.untilAttach){if(this.state!=="attached")throw new w("option untilAttach requires the channel to be attached",4e4,400);if(!this.properties.attachSerial)throw new w("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400);delete m.untilAttach,m.from_serial=this.properties.attachSerial}return R.history(this,m)},this.whenState=m=>Et.prototype.whenState.call(this,m,this.state),h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel()","started; name = "+l),this.name=l,this.channelOptions=Hn((u=a._Crypto)!=null?u:null,this.logger,o),this.client=a,this._presence=a._RealtimePresence?new a._RealtimePresence.RealtimePresence(this):null,a._Annotations&&(this._annotations=new a._Annotations.RealtimeAnnotations(this)),this.connectionManager=a.connection.connectionManager,this.state="initialized",this.subscriptions=new Et(this.logger),this.syncChannelSerial=void 0,this.properties={attachSerial:void 0,channelSerial:void 0},this.setOptions(o),this.errorReason=null,this._attachResume=!1,this._decodingContext={channelOptions:this.channelOptions,plugins:a.options.plugins||{},baseEncodedPreviousPayload:void 0},this._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},this._allChannelChanges=new Et(this.logger),(f=a.options.plugins)!=null&&f.Push&&(this._push=new a.options.plugins.Push.PushChannel(this)),(p=a.options.plugins)!=null&&p.Objects&&(this._objects=new a.options.plugins.Objects.Objects(this))}get presence(){return this._presence||xt("RealtimePresence"),this._presence}get annotations(){return this._annotations||xt("Annotations"),this._annotations}get push(){return this._push||xt("Push"),this._push}get objects(){return this._objects||xt("Objects"),this._objects}invalidStateError(){return new w("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)}static processListenerArgs(a){return a=Array.prototype.slice.call(a),typeof a[0]=="function"&&a.unshift(null),a}async setOptions(a){var l;const o=this.channelOptions,u=fo(a);if(u)throw u;if(this.channelOptions=Hn((l=this.client._Crypto)!=null?l:null,this.logger,a),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(a,o))return this.attachImpl(),new Promise((f,p)=>{this._allChannelChanges.once(["attached","update","detached","failed"],function(m){switch(this.event){case"update":case"attached":f();break;default:p(m.reason)}})})}_shouldReattachToSetOptions(a,l){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(a?.params){const o=Di(a.params),u=Di(l.params);if(Object.keys(o).length!==Object.keys(u).length||!Ga(u,o))return!0}return!!(a?.modes&&(!l.modes||!ul(a.modes,l.modes)))}async publish(...a){let l;if(a.length==1)if(v(a[0]))l=[pn.fromValues(a[0])];else if(Array.isArray(a[0]))l=pn.fromValuesArray(a[0]);else throw new w("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else l=[pn.fromValues({name:a[0],data:a[1]})];const u=this.client.options.maxMessageSize,f=await Kr(l,this.channelOptions),p=El(f);if(p>u)throw new w(`Maximum size of messages that can be published at once exceeded (was ${p} bytes; limit is ${u} bytes)`,40009,400);this.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+this.state+", message count = "+f.length);const m=tn({action:ue.MESSAGE,channel:this.name,messages:f});return this.sendMessage(m)}throwIfUnpublishableState(){if(!this.connectionManager.activeState())throw this.connectionManager.getError();if(this.state==="failed"||this.state==="suspended")throw this.invalidStateError()}onEvent(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.onEvent()","received message");const l=this.subscriptions;for(let o=0;o<a.length;o++){const u=a[o];l.emit(u.name,u)}}async attach(){return this.state==="attached"?null:new Promise((a,l)=>{this._attach(!1,null,(o,u)=>o?l(o):a(u))})}_attach(a,l,o){o||(o=f=>{f&&h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+f.toString())});const u=this.connectionManager;if(!u.activeState()){o(u.getError());return}(this.state!=="attaching"||a)&&this.requestState("attaching",l),this.once(function(f){switch(this.event){case"attached":o?.(null,f);break;case"detached":case"suspended":case"failed":o?.(f.reason||u.getError()||new w("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":o?.(new w("Attach request superseded by a subsequent detach request",9e4,409));break}})}attachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");const a=tn({action:ue.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this.channelOptions.modes&&a.encodeModesToFlags(Ie(this.channelOptions.modes)),this._attachResume&&a.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(a.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(a).catch(ks)}async detach(){const a=this.connectionManager;if(!a.activeState())throw a.getError();switch(this.state){case"suspended":this.notifyState("detached");return;case"detached":return;case"failed":throw new w("Unable to detach; channel state = failed",90001,400);default:this.requestState("detaching");case"detaching":return new Promise((l,o)=>{this.once(function(u){switch(this.event){case"detached":l();break;case"attached":case"suspended":case"failed":o(u.reason||a.getError()||new w("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":o(new w("Detach request superseded by a subsequent attach request",9e4,409));break}})})}}detachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");const a=tn({action:ue.DETACH,channel:this.name});this.sendMessage(a).catch(ks)}async subscribe(...a){const[l,o]=hf.processListenerArgs(a);if(this.state==="failed")throw w.fromValues(this.invalidStateError());return l&&typeof l=="object"&&!Array.isArray(l)?this.client._FilteredSubscriptions.subscribeFilter(this,l,o):this.subscriptions.on(l,o),this.channelOptions.attachOnSubscribe!==!1?this.attach():null}unsubscribe(...a){var l;const[o,u]=hf.processListenerArgs(a);if(typeof o=="object"&&!u||(l=this.filteredSubscriptions)!=null&&l.has(u)){this.client._FilteredSubscriptions.getAndDeleteFilteredSubscriptions(this,o,u).forEach(f=>this.subscriptions.off(f));return}this.subscriptions.off(o,u)}sync(){switch(this.state){case"initialized":case"detaching":case"detached":throw new Ce("Unable to sync to channel; not attached",4e4)}const a=this.connectionManager;if(!a.activeState())throw a.getError();const l=tn({action:ue.SYNC,channel:this.name});this.syncChannelSerial&&(l.channelSerial=this.syncChannelSerial),a.send(l)}async sendMessage(a){return new Promise((l,o)=>{this.connectionManager.send(a,this.client.options.queueMessages,u=>{u?o(u):l()})})}async sendPresence(a){const l=tn({action:ue.PRESENCE,channel:this.name,presence:a});return this.sendMessage(l)}sendState(a){const l=tn({action:ue.OBJECT,channel:this.name,state:a});return this.sendMessage(l)}async processMessage(a){(a.action===ue.ATTACHED||a.action===ue.MESSAGE||a.action===ue.PRESENCE||a.action===ue.OBJECT||a.action===ue.ANNOTATION)&&this.setChannelSerial(a.channelSerial);let l,o=!1;switch(a.action){case ue.ATTACHED:{this.properties.attachSerial=a.channelSerial,this._mode=a.getMode(),this.params=a.params||{};const u=a.decodeModesFromFlags();this.modes=u&&pt(u)||void 0;const f=a.hasFlag("RESUMED"),p=a.hasFlag("HAS_PRESENCE"),m=a.hasFlag("HAS_BACKLOG"),R=a.hasFlag("HAS_OBJECTS");if(this.state==="attached"){f||(this._presence&&this._presence.onAttached(p),this._objects&&this._objects.onAttached(R));const S=new Ui(this.state,this.state,f,m,a.error);this._allChannelChanges.emit("update",S),(!f||this.channelOptions.updateOnAttached)&&this.emit("update",S)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",a.error,f,p,m,R);break}case ue.DETACHED:{const u=a.error?w.fromValues(a.error):new w("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",u):this.state==="attaching"?this.notifyState("suspended",u):(this.state==="attached"||this.state==="suspended")&&this.requestState("attaching",u);break}case ue.SYNC:if(o=!0,l=this.syncChannelSerial=a.channelSerial,!a.presence)break;case ue.PRESENCE:{if(!a.presence)break;gn(a);const u=this.channelOptions;if(this._presence){const f=await Promise.all(a.presence.map(p=>p.decode(u,this.logger)));this._presence.setPresence(f,o,l)}break}case ue.OBJECT:case ue.OBJECT_SYNC:{if(!this._objects||!a.state)return;gn(a);const u=a.state,f=this.client.connection.connectionManager.getActiveTransportFormat();await Promise.all(u.map(p=>this.client._objectsPlugin.ObjectMessage.decode(p,this.client,this.logger,h,Ve,f))),a.action===ue.OBJECT?this._objects.handleObjectMessages(u):this._objects.handleObjectSyncMessages(u,a.channelSerial);break}case ue.MESSAGE:{if(this.state!=="attached"){h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()",'Message "'+a.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}gn(a);const u=a.messages,f=u[0],p=u[u.length-1];if(f.extras&&f.extras.delta&&f.extras.delta.from!==this._lastPayload.messageId){const R='Delta message decode failure - previous message not available for message "'+a.id+'" on this channel "'+this.name+'".';h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel.processMessage()",R),this._startDecodeFailureRecovery(new w(R,40018,400));break}let m=[];for(let R=0;R<u.length;R++){const{decoded:S,err:j}=await u[R].decodeWithErr(this._decodingContext,this.logger);if(m[R]=S,j)switch(j.code){case 40018:this._startDecodeFailureRecovery(j);return;case 40019:case 40021:this.notifyState("failed",j);return}}this._lastPayload.messageId=p.id,this._lastPayload.protocolMessageChannelSerial=a.channelSerial,this.onEvent(m);break}case ue.ANNOTATION:{gn(a);const u=this.channelOptions;if(this._annotations){const f=await Promise.all((a.annotations||[]).map(p=>p.decode(u,this.logger)));this._annotations._processIncoming(f)}break}case ue.ERROR:{const u=a.error;u&&u.code==80016?this.checkPendingState():this.notifyState("failed",w.fromValues(u));break}default:h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Protocol error: unrecognised message action ("+a.action+")")}}_startDecodeFailureRecovery(a){this._lastPayload.decodeFailureRecoveryInProgress||(h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,a,()=>{this._lastPayload.decodeFailureRecoveryInProgress=!1}))}onAttached(){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)}notifyState(a,l,o,u,f,p){if(h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+a),this.clearStateTimer(),["detached","suspended","failed"].includes(a)&&(this.properties.channelSerial=null),a===this.state)return;this._presence&&this._presence.actOnChannelState(a,u,l),this._objects&&this._objects.actOnChannelState(a,p),a==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),l&&(this.errorReason=l);const m=new Ui(this.state,a,o,f,l),R='Channel state for channel "'+this.name+'"',S=a+(l?"; reason: "+l:"");a==="failed"?h.logAction(this.logger,h.LOG_ERROR,R,S):h.logAction(this.logger,h.LOG_MAJOR,R,S),a!=="attaching"&&a!=="suspended"&&(this.retryCount=0),a==="attached"&&this.onAttached(),a==="attached"?this._attachResume=!0:(a==="detaching"||a==="failed")&&(this._attachResume=!1),this.state=a,this._allChannelChanges.emit(a,m),this.emit(a,m)}requestState(a,l){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+a),this.notifyState(a,l),this.checkPendingState()}checkPendingState(){if(!this.connectionManager.state.sendEvents){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}}timeoutPendingState(){switch(this.state){case"attaching":{const a=new w("Channel attach timed out",90007,408);this.notifyState("suspended",a);break}case"detaching":{const a=new w("Channel detach timed out",90007,408);this.notifyState("attached",a);break}default:this.checkPendingState();break}}startStateTimerIfNotRunning(){this.stateTimer||(this.stateTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),this.stateTimer=null,this.timeoutPendingState()},this.client.options.timeouts.realtimeRequestTimeout))}clearStateTimer(){const a=this.stateTimer;a&&(clearTimeout(a),this.stateTimer=null)}startRetryTimer(){if(this.retryTimer)return;this.retryCount++;const a=Gt(this.client.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(()=>{this.state==="suspended"&&this.connectionManager.state.sendEvents&&(this.retryTimer=null,h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),this.requestState("attaching"))},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}getReleaseErr(){const a=this.state;return a==="initialized"||a==="detached"||a==="failed"?null:new w("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+a,90001,400)}setChannelSerial(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+a+"; previous = "+this.properties.channelSerial),a&&(this.properties.channelSerial=a)}async status(){return this.client.rest.channelMixin.status(this)}};function Di(i){const a=i||{},{agent:l}=a;return Fe(a,["agent"])}var Li=ki,ho=class{constructor(i){this.channel=i,this.logger=i.logger,this.subscriptions=new Et(this.logger)}async publish(i,a){const l=this.channel.name,o=oo(i,a),u=await o.encode();this.channel.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeAnnotations.publish()","channelName = "+l+", sending annotation with messageSerial = "+o.messageSerial+", type = "+o.type);const f=tn({action:ue.ANNOTATION,channel:l,annotations:[u]});return this.channel.sendMessage(f)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async subscribe(...i){const a=Li.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw w.fromValues(u.invalidStateError());if(this.subscriptions.on(l,o),this.channel.channelOptions.attachOnSubscribe!==!1&&await u.attach(),(this.channel.state==="attached"&&this.channel._mode&Kt.ANNOTATION_SUBSCRIBE)===0)throw new w("You are trying to add an annotation listener, but you haven't requested the annotation_subscribe channel mode in ChannelOptions, so this won't do anything (we only deliver annotations to clients who have explicitly requested them)",93001,400)}unsubscribe(...i){const a=Li.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}_processIncoming(i){for(const a of i)this.subscriptions.emit(a.type||"",a)}async get(i,a){return Nl.prototype.get.call(this,i,a)}},ci=ho,ui=class yc extends io{constructor(a){var l,o;if(!yc._MsgPack)throw new Error("Expected DefaultRest._MsgPack to have been set");super(be.objectifyOptions(a,!0,"Rest",h.defaultLogger,Te(he({},Ml),{Crypto:(l=yc.Crypto)!=null?l:void 0,MsgPack:(o=yc._MsgPack)!=null?o:void 0,Annotations:{Annotation:ra,WireAnnotation:Ni,RealtimeAnnotations:ci,RestAnnotations:Nl}})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};ui._Crypto=null,ui.Message=sa,ui.PresenceMessage=la,ui.Annotation=xl,ui._MsgPack=null,ui._Http=Os;var Ds=ui,go=class extends Et{constructor(i){super(i),this.messages=[]}count(){return this.messages.length}push(i){this.messages.push(i)}shift(){return this.messages.shift()}last(){return this.messages[this.messages.length-1]}copyAll(){return this.messages.slice()}append(i){this.messages.push.apply(this.messages,i)}prepend(i){this.messages.unshift.apply(this.messages,i)}completeMessages(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+i+"; count = "+a),l=l||null;const o=this.messages;if(o.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");const u=o[0];if(u){const f=u.message.msgSerial,p=i+a;if(p>f){const m=o.splice(0,p-f);for(const R of m)R.callback(l)}o.length==0&&this.emit("idle")}}completeAllMessages(i){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,i)}resetSendAttempted(){for(let i of this.messages)i.sendAttempted=!1}clear(){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")}},po=go,mo=class{constructor(i,a){this.message=i,this.callback=a,this.merged=!1;const l=i.action;this.sendAttempted=!1,this.ackRequired=typeof l=="number"&&[ue.MESSAGE,ue.PRESENCE,ue.ANNOTATION,ue.OBJECT].includes(l)}},Gc=class extends Et{constructor(i){super(i.logger),this.transport=i,this.messageQueue=new po(this.logger),i.on("ack",(a,l)=>{this.onAck(a,l)}),i.on("nack",(a,l,o)=>{this.onNack(a,l,o)})}onAck(i,a){h.logAction(this.logger,h.LOG_MICRO,"Protocol.onAck()","serial = "+i+"; count = "+a),this.messageQueue.completeMessages(i,a)}onNack(i,a,l){h.logAction(this.logger,h.LOG_ERROR,"Protocol.onNack()","serial = "+i+"; count = "+a+"; err = "+Ue(l)),l||(l=new w("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(i,a,l)}onceIdle(i){const a=this.messageQueue;if(a.count()===0){i();return}a.once("idle",i)}send(i){i.ackRequired&&this.messageQueue.push(i),this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Protocol.send()","sending msg; "+Wa(i.message,this.transport.connectionManager.realtime._RealtimePresence,this.transport.connectionManager.realtime._Annotations,this.transport.connectionManager.realtime._objectsPlugin)),i.sendAttempted=!0,this.transport.send(i.message)}getTransport(){return this.transport}getPendingMessages(){return this.messageQueue.copyAll()}clearPendingMessages(){return this.messageQueue.clear()}finish(){const i=this.transport;this.onceIdle(function(){i.disconnect()})}},yo=Gc,vo=class{constructor(i,a,l,o){this.previous=i,this.current=a,l&&(this.retryIn=l),o&&(this.reason=o)}},ca=vo,Ut={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},bo={disconnected:()=>w.fromValues({statusCode:400,code:Ut.DISCONNECTED,message:"Connection to server temporarily unavailable"}),suspended:()=>w.fromValues({statusCode:400,code:Ut.SUSPENDED,message:"Connection to server unavailable"}),failed:()=>w.fromValues({statusCode:400,code:Ut.FAILED,message:"Connection failed or disconnected by server"}),closing:()=>w.fromValues({statusCode:400,code:Ut.CLOSING,message:"Connection closing"}),closed:()=>w.fromValues({statusCode:400,code:Ut.CLOSED,message:"Connection closed"}),unknownConnectionErr:()=>w.fromValues({statusCode:500,code:Ut.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"}),unknownChannelErr:()=>w.fromValues({statusCode:500,code:Ut.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})};function mn(i){return!i.statusCode||!i.code||i.statusCode>=500?!0:Object.values(Ut).includes(i.code)}var kt=bo,ua=tn({action:ue.CLOSE}),Ll=tn({action:ue.DISCONNECT}),Ls=class extends Et{constructor(i,a,l,o){super(i.logger),o&&(l.format=void 0,l.heartbeats=!0),this.connectionManager=i,this.auth=a,this.params=l,this.timeouts=l.options.timeouts,this.format=l.format,this.isConnected=!1,this.isFinished=!1,this.isDisposed=!1,this.maxIdleInterval=null,this.idleTimer=null,this.lastActivity=null}connect(){}close(){this.isConnected&&this.requestClose(),this.finish("closed",kt.closed())}disconnect(i){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",i||kt.disconnected())}fail(i){this.isConnected&&this.requestDisconnect(),this.finish("failed",i||kt.failed())}finish(i,a){var l;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((l=this.idleTimer)!=null?l:void 0),this.idleTimer=null,this.emit(i,a),this.dispose())}onProtocolMessage(i){switch(this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+Wa(i,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),i.action){case ue.HEARTBEAT:h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",i.id);break;case ue.CONNECTED:this.onConnect(i),this.emit("connected",i.error,i.connectionId,i.connectionDetails,i);break;case ue.CLOSED:this.onClose(i);break;case ue.DISCONNECTED:this.onDisconnect(i);break;case ue.ACK:this.emit("ack",i.msgSerial,i.count);break;case ue.NACK:this.emit("nack",i.msgSerial,i.count,i.error);break;case ue.SYNC:this.connectionManager.onChannelMessage(i,this);break;case ue.ACTIVATE:break;case ue.AUTH:Z(this.auth.authorize(),a=>{a&&h.logAction(this.logger,h.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+Ue(a))});break;case ue.ERROR:if(h.logAction(this.logger,h.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+x.Config.inspect(i.error)+(i.channel?", channel: "+i.channel:"")),i.channel===void 0){this.onFatalError(i);break}this.connectionManager.onChannelMessage(i,this);break;default:this.connectionManager.onChannelMessage(i,this)}}onConnect(i){if(this.isConnected=!0,!i.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");const a=i.connectionDetails.maxIdleInterval;a&&(this.maxIdleInterval=a+this.timeouts.realtimeRequestTimeout,this.onActivity())}onDisconnect(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onDisconnect()","err = "+Ue(a)),this.finish("disconnected",a)}onFatalError(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onFatalError()","err = "+Ue(a)),this.finish("failed",a)}onClose(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onClose()","err = "+Ue(a)),this.finish("closed",a)}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestClose()",""),this.send(ua)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(Ll)}ping(i){const a={action:ue.HEARTBEAT};i&&(a.id=i),this.send(tn(a))}dispose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()}onActivity(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=Date.now(),this.setIdleTimer(this.maxIdleInterval+100))}setIdleTimer(i){this.idleTimer||(this.idleTimer=setTimeout(()=>{this.onIdleTimerExpire()},i))}onIdleTimerExpire(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;const i=Date.now()-this.lastActivity,a=this.maxIdleInterval-i;if(a<=0){const l="No activity seen from realtime in "+i+"ms; assuming connection has dropped";h.logAction(this.logger,h.LOG_ERROR,"Transport.onIdleTimerExpire()",l),this.disconnect(new w(l,80003,408))}else this.setIdleTimer(a+100)}static tryConnect(i,a,l,o,u){const f=new i(a,l,o);let p;const m=function(S){clearTimeout(p),u({event:this.event,error:S})},R=a.options.timeouts.realtimeRequestTimeout;return p=setTimeout(()=>{f.off(["preconnect","disconnected","failed"]),f.dispose(),m.call({event:"disconnected"},new w("Timeout waiting for transport to indicate itself viable",5e4,500))},R),f.on(["failed","disconnected"],m),f.on("preconnect",function(){h.logAction(a.logger,h.LOG_MINOR,"Transport.tryConnect()","viable transport "+f),clearTimeout(p),f.off(["failed","disconnected"],m),u(null,f)}),f.connect(),f}static isAvailable(){throw new w("isAvailable not implemented for transport",5e4,500)}},In=Ls,Vt;(i=>{i.WebSocket="web_socket",i.Comet="comet",i.XhrPolling="xhr_polling"})(Vt||(Vt={}));var fa=typeof Ha<"u"?Ha:typeof window<"u"?window:self,Bs=()=>{var i;return typeof x.WebStorage<"u"&&((i=x.WebStorage)==null?void 0:i.localSupported)},fi=()=>{var i;return typeof x.WebStorage<"u"&&((i=x.WebStorage)==null?void 0:i.sessionSupported)},Bi=function(){},Bl="ably-transport-preference";function on(i,a,l){let o;if(i.channel!==a.channel||(o=i.action)!==ue.PRESENCE&&o!==ue.MESSAGE||o!==a.action)return!1;const u=o===ue.PRESENCE?"presence":"messages",f=i[u].concat(a[u]);return El(f)>l||!Be(f,"clientId")||!f.every(function(m){return!m.id})?!1:(i[u]=f,!0)}function Fa(i){try{return JSON.parse(i)}catch{return null}}var Yn=class{constructor(i,a,l,o){this.options=i,this.host=a,this.mode=l,this.connectionKey=o,this.format=i.useBinaryProtocol?"msgpack":"json"}getConnectParams(i){const a=i?ae(i):{},l=this.options;switch(this.mode){case"resume":a.resume=this.connectionKey;break;case"recover":{const o=Fa(l.recover);o&&(a.recover=o.connectionKey);break}}return l.clientId!==void 0&&(a.clientId=l.clientId),l.echoMessages===!1&&(a.echo="false"),this.format!==void 0&&(a.format=this.format),this.stream!==void 0&&(a.stream=this.stream),this.heartbeats!==void 0&&(a.heartbeats=this.heartbeats),a.v=be.protocolVersion,a.agent=gl(this.options),l.transportParams!==void 0&&U(a,l.transportParams),a}toString(){let i="[mode="+this.mode;return this.host&&(i+=",host="+this.host),this.connectionKey&&(i+=",connectionKey="+this.connectionKey),this.format&&(i+=",format="+this.format),i+="]",i}},So=class Kd extends Et{constructor(a,l){super(a.logger),this.supportedTransports={},this.disconnectedRetryCount=0,this.pendingChannelMessagesState={isProcessing:!1,queue:[]},this.realtime=a,this.initTransports(),this.options=l;const o=l.timeouts,u=o.webSocketConnectTimeout+o.realtimeRequestTimeout;if(this.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:u,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:o.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},this.state=this.states.initialized,this.errorReason=null,this.queuedMessages=new po(this.logger),this.msgSerial=0,this.connectionDetails=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.connectionStateTtl=o.connectionStateTtl,this.maxIdleInterval=null,this.transports=ct(l.transports||be.defaultTransports,this.supportedTransports),this.transportPreference=null,this.transports.includes(Vt.WebSocket)&&(this.webSocketTransportAvailable=!0),this.transports.includes(Vt.XhrPolling)?this.baseTransport=Vt.XhrPolling:this.transports.includes(Vt.Comet)&&(this.baseTransport=Vt.Comet),this.domains=be.getHosts(l),this.activeProtocol=null,this.host=null,this.lastAutoReconnectAttempt=null,this.lastActivity=null,this.forceFallbackHost=!1,this.connectCounter=0,this.wsCheckResult=null,this.webSocketSlowTimer=null,this.webSocketGiveUpTimer=null,this.abandonedWebSocket=!1,h.logAction(this.logger,h.LOG_MINOR,"Realtime.ConnectionManager()","started"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(l.transports||be.defaultTransports)+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+this.transports+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","http domains = ["+this.domains+"]"),!this.transports.length){const p="no requested transports available";throw h.logAction(this.logger,h.LOG_ERROR,"realtime.ConnectionManager()",p),new Error(p)}const f=x.Config.addEventListener;f&&(fi()&&typeof l.recover=="function"&&f("beforeunload",this.persistConnection.bind(this)),l.closeOnUnload===!0&&f("beforeunload",()=>{h.logAction(this.logger,h.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),this.requestState({state:"closing"})}),f("online",()=>{var p;this.state==this.states.disconnected||this.state==this.states.suspended?(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser online event","reattempting connection"),this.requestState({state:"connecting"})):this.state==this.states.connecting&&((p=this.pendingTransport)==null||p.off(),this.disconnectAllTransports(),this.startConnect())}),f("offline",()=>{this.state==this.states.connected&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser offline event","disconnecting active transport"),this.disconnectAllTransports())}))}static supportedTransports(a){const l={supportedTransports:{}};return this.initTransports(a,l),l.supportedTransports}static initTransports(a,l){const o=he(he({},x.Transports.bundledImplementations),a);[Vt.WebSocket,...x.Transports.order].forEach(u=>{const f=o[u];f&&f.isAvailable()&&(l.supportedTransports[u]=f)})}initTransports(){Kd.initTransports(this.realtime._additionalTransportImplementations,this)}createTransportParams(a,l){return new Yn(this.options,a,l,this.connectionKey)}getTransportParams(a){(o=>{if(this.connectionKey){o("resume");return}if(typeof this.options.recover=="string"){o("recover");return}const u=this.options.recover,f=this.getSessionRecoverData(),p=this.sessionRecoveryName();if(f&&typeof u=="function"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data (recovery scope: "+p+")"),u(f,m=>{m?(this.options.recover=f.recoveryKey,o("recover")):o("clean")});return}o("clean")})(o=>{const u=this.createTransportParams(null,o);if(o==="recover"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+this.options.recover);const f=Fa(this.options.recover);f&&(this.msgSerial=f.msgSerial)}else h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+u.toString());a(u)})}tryATransport(a,l,o){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+l),this.proposedTransport=In.tryConnect(this.supportedTransports[l],this,this.realtime.auth,a,(u,f)=>{const p=this.state;if(p==this.states.closing||p==this.states.closed||p==this.states.failed){f&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+p.state+" while we were attempting the transport; closing "+f),f.close()),o(!0);return}if(u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+l+" "+u.event+", err: "+u.error.toString()),xn.isTokenErr(u.error)&&!(this.errorReason&&xn.isTokenErr(this.errorReason))?(this.errorReason=u.error,Z(this.realtime.auth._forceNewToken(null,null),m=>{if(m){this.actOnErrorFromAuthorize(m);return}this.tryATransport(a,l,o)})):u.event==="failed"?(this.notifyState({state:"failed",error:u.error}),o(!0)):u.event==="disconnected"&&(mn(u.error)?o(!1):(this.notifyState({state:this.states.connecting.failState,error:u.error}),o(!0)));return}h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+l+"; setting pending"),this.setTransportPending(f,a),o(null,f)})}setTransportPending(a,l){const o=l.mode;h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+a+"; mode = "+o),this.pendingTransport=a,this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),a.once("connected",(f,p,m)=>{this.activateTransport(f,a,p,m),o==="recover"&&this.options.recover&&(delete this.options.recover,this.unpersistConnection())});const u=this;a.on(["disconnected","closed","failed"],function(f){u.deactivateTransport(a,this.event,f)}),this.emit("transport.pending",a)}activateTransport(a,l,o,u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+l),a&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+a),o&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+o),u&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(u)),this.persistTransportPreference(l);const f=this.state,p=this.states.connected.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+f.state),f.state==this.states.closing.state||f.state==this.states.closed.state||f.state==this.states.failed.state)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),l.disconnect(),!1;if(delete this.pendingTransport,!l.isConnected)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+l+" since it appears to no longer be connected"),!1;const m=this.activeProtocol;this.activeProtocol=new yo(l),this.host=l.params.host;const R=u.connectionKey;if(R&&this.connectionKey!=R&&this.setConnection(o,u,!!a),this.onConnectionDetailsUpdate(u,l),x.Config.nextTick(()=>{l.on("connected",(S,j,z)=>{this.onConnectionDetailsUpdate(z,l),this.emit("update",new ca(p,p,null,S))})}),f.state===this.states.connected.state?a&&(this.errorReason=this.realtime.connection.errorReason=a,this.emit("update",new ca(p,p,null,a))):(this.notifyState({state:"connected",error:a}),this.errorReason=this.realtime.connection.errorReason=a||null),this.emit("transport.active",l),m)if(m.messageQueue.count()>0&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+m.transport.shortName+", new one is "+l.shortName+") finishing with "+m.messageQueue.count()+" messages still pending"),m.transport===l){const S="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+l.shortName+"; stack = "+new Error().stack;h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()",S)}else m.finish();return!0}deactivateTransport(a,l,o){const u=this.activeProtocol,f=u&&u.getTransport()===a,p=a===this.pendingTransport,m=this.noTransportsScheduledForActivation();if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+a),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+l+(f?"; was active":p?"; was pending":"")+(m?"":"; another transport is scheduled for activation")),o&&o.message&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+o.message),f&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(u.getPendingMessages()),u.clearPendingMessages(),this.activeProtocol=this.host=null),this.emit("transport.inactive",a),f&&m||f&&l==="failed"||l==="closed"||u===null&&p){if(l==="disconnected"&&o&&o.statusCode>500&&this.domains.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:l,error:o,retryImmediately:!0});return}const R=l==="failed"&&xn.isTokenErr(o)?"disconnected":l;this.notifyState({state:R,error:o});return}}noTransportsScheduledForActivation(){return!this.pendingTransport||!this.pendingTransport.isConnected}setConnection(a,l,o){const u=this.connectionId;(u&&u!==a||!u&&o)&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==a&&h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=a,this.realtime.connection.key=this.connectionKey=l.connectionKey}clearConnection(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()}createRecoveryKey(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null}checkConnectionStateFreshness(){if(!this.lastActivity||!this.connectionId)return;const a=Date.now()-this.lastActivity;a>this.connectionStateTtl+this.maxIdleInterval&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+a+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}persistConnection(){if(fi()){const a=this.createRecoveryKey();a&&this.setSessionRecoverData({recoveryKey:a,disconnectedAt:Date.now(),location:fa.location,clientId:this.realtime.auth.clientId})}}unpersistConnection(){this.clearSessionRecoverData()}getActiveTransportFormat(){var a;return(a=this.activeProtocol)==null?void 0:a.getTransport().format}getError(){if(this.errorReason){const a=Ce.fromValues(this.errorReason);return a.cause=this.errorReason,a}return this.getStateError()}getStateError(){var a,l;return(l=(a=kt)[this.state.state])==null?void 0:l.call(a)}activeState(){return this.state.queueEvents||this.state.sendEvents}enactStateChange(a){const l="Connection state",o=a.current+(a.reason?"; reason: "+a.reason:"");a.current==="failed"?h.logAction(this.logger,h.LOG_ERROR,l,o):h.logAction(this.logger,h.LOG_MAJOR,l,o),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+a.current+"; reason = "+(a.reason&&a.reason.message));const u=this.state=this.states[a.current];a.reason&&(this.errorReason=a.reason,this.realtime.connection.errorReason=a.reason),(u.terminal||u.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",a)}startTransitionTimer(a){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+a.state),this.transitionTimer&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(()=>{this.transitionTimer&&(this.transitionTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager "+a.state+" timer expired","requesting new state: "+a.failState),this.notifyState({state:a.failState}))},a.retryDelay)}cancelTransitionTimer(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)}startSuspendTimer(){this.suspendTimer||(this.suspendTimer=setTimeout(()=>{this.suspendTimer&&(this.suspendTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),this.states.connecting.failState="suspended",this.notifyState({state:"suspended"}))},this.connectionStateTtl))}checkSuspendTimer(a){a!=="disconnected"&&a!=="suspended"&&a!=="connecting"&&this.cancelSuspendTimer()}cancelSuspendTimer(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)}startRetryTimer(a){this.retryTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),this.retryTimer=null,this.requestState({state:"connecting"})},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}startWebSocketSlowTimer(){this.webSocketSlowTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","checking connectivity"),this.checkWsConnectivity().then(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","ws connectivity check succeeded"),this.wsCheckResult=!0}).catch(()=>{h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","ws connectivity check failed"),this.wsCheckResult=!1}),this.realtime.http.checkConnectivity&&Z(this.realtime.http.checkConnectivity(),(a,l)=>{a||!l?(h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","http connectivity check failed"),this.cancelWebSocketGiveUpTimer(),this.notifyState({state:"disconnected",error:new w("Unable to connect (network unreachable)",80003,404)})):h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","http connectivity check succeeded")})},this.options.timeouts.webSocketSlowTimeout)}cancelWebSocketSlowTimer(){this.webSocketSlowTimer&&(clearTimeout(this.webSocketSlowTimer),this.webSocketSlowTimer=null)}startWebSocketGiveUpTimer(a){this.webSocketGiveUpTimer=setTimeout(()=>{var l,o;this.wsCheckResult||(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket give up timer","websocket connection took more than 10s; "+(this.baseTransport?"trying base transport":"")),this.baseTransport?(this.abandonedWebSocket=!0,(l=this.proposedTransport)==null||l.dispose(),(o=this.pendingTransport)==null||o.dispose(),this.connectBase(a,++this.connectCounter)):h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket give up timer","websocket connectivity appears to be unavailable but no other transports to try"))},this.options.timeouts.webSocketConnectTimeout)}cancelWebSocketGiveUpTimer(){this.webSocketGiveUpTimer&&(clearTimeout(this.webSocketGiveUpTimer),this.webSocketGiveUpTimer=null)}notifyState(a){var l,o;const u=a.state,f=u==="disconnected"&&(this.state===this.states.connected||a.retryImmediately||this.state===this.states.connecting&&a.error&&xn.isTokenErr(a.error)&&!(this.errorReason&&xn.isTokenErr(this.errorReason)));if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+u+(f?"; will retry connection immediately":"")),u==this.state.state||(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.checkSuspendTimer(a.state),(u==="suspended"||u==="connected")&&(this.disconnectedRetryCount=0),this.state.terminal))return;const p=this.states[a.state];let m=p.retryDelay;p.state==="disconnected"&&(this.disconnectedRetryCount++,m=Gt(p.retryDelay,this.disconnectedRetryCount));const R=new ca(this.state.state,p.state,m,a.error||((o=(l=kt)[p.state])==null?void 0:o.call(l)));if(f){const S=()=>{this.state===this.states.disconnected&&(this.lastAutoReconnectAttempt=Date.now(),this.requestState({state:"connecting"}))},j=this.lastAutoReconnectAttempt&&Date.now()-this.lastAutoReconnectAttempt+1;j&&j<1e3?(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+j+"ms ago, waiting another "+(1e3-j)+"ms before trying again"),setTimeout(S,1e3-j)):x.Config.nextTick(S)}else(u==="disconnected"||u==="suspended")&&this.startRetryTimer(m);(u==="disconnected"&&!f||u==="suspended"||p.terminal)&&x.Config.nextTick(()=>{this.disconnectAllTransports()}),u=="connected"&&!this.activeProtocol&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(R),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(u,R.reason),this.failQueuedMessages(R.reason))}requestState(a){var l,o;const u=a.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+u+"; current state: "+this.state.state),u==this.state.state||(this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(u),u=="connecting"&&this.state.state=="connected")||u=="closing"&&this.state.state=="closed")return;const f=this.states[u],p=new ca(this.state.state,f.state,null,a.error||((o=(l=kt)[f.state])==null?void 0:o.call(l)));this.enactStateChange(p),u=="connecting"&&x.Config.nextTick(()=>{this.startConnect()}),u=="closing"&&this.closeImpl()}startConnect(){if(this.state!==this.states.connecting){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}const a=this.realtime.auth,l=++this.connectCounter,o=()=>{this.checkConnectionStateFreshness(),this.getTransportParams(u=>{if(u.mode==="recover"&&u.options.recover){const f=Fa(u.options.recover);f&&this.realtime.channels.recoverChannels(f.channelSerials)}l===this.connectCounter&&this.connectImpl(u,l)})};if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),a.method==="basic")o();else{const u=f=>{l===this.connectCounter&&(f?this.actOnErrorFromAuthorize(f):o())};this.errorReason&&xn.isTokenErr(this.errorReason)?Z(a._forceNewToken(null,null),u):Z(a._ensureValidAuthCredentials(!1),u)}}connectImpl(a,l){const o=this.state.state;if(o!==this.states.connecting.state){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect, but was "+o);return}const u=this.getTransportPreference();u&&u===this.baseTransport&&this.webSocketTransportAvailable&&this.checkWsConnectivity().then(()=>{this.unpersistTransportPreference(),this.state===this.states.connecting&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl():","web socket connectivity available, cancelling connection attempt with "+this.baseTransport),this.disconnectAllTransports(),this.connectWs(a,++this.connectCounter))}).catch(Bi),u&&u===this.baseTransport||this.baseTransport&&!this.webSocketTransportAvailable?this.connectBase(a,l):this.connectWs(a,l)}connectWs(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectWs()"),this.wsCheckResult=null,this.abandonedWebSocket=!1,this.startWebSocketSlowTimer(),this.startWebSocketGiveUpTimer(a),this.tryTransportWithFallbacks("web_socket",a,!0,l,()=>this.wsCheckResult!==!1&&!this.abandonedWebSocket)}connectBase(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectBase()"),this.baseTransport?this.tryTransportWithFallbacks(this.baseTransport,a,!1,l,()=>!0):this.notifyState({state:"disconnected",error:new w("No transports left to try",8e4,404)})}tryTransportWithFallbacks(a,l,o,u,f){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryTransportWithFallbacks()",a);const p=z=>{this.notifyState({state:this.states.connecting.failState,error:z})},m=this.domains.slice(),R=(z,X)=>{if(u===this.connectCounter){if(!f()){X&&X.dispose();return}!X&&!z&&j()}},S=m.shift();if(!S){p(new w("Unable to connect (no available host)",80003,404));return}l.host=S;const j=()=>{if(!m.length){p(new w("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!this.realtime.http.checkConnectivity){p(new Ce("Internal error: Http.checkConnectivity not set",null,500));return}Z(this.realtime.http.checkConnectivity(),(z,X)=>{if(u===this.connectCounter&&f()){if(z){p(z);return}if(!X){p(new w("Unable to connect (network unreachable)",80003,404));return}l.host=Ze(m),this.tryATransport(l,a,R)}})};if(this.forceFallbackHost&&m.length){this.forceFallbackHost=!1,j();return}this.tryATransport(l,a,R)}closeImpl(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+this.pendingTransport),this.pendingTransport.close()),this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})}onAuthUpdated(a,l){var o;switch(this.state.state){case"connected":{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport");const u=(o=this.activeProtocol)==null?void 0:o.getTransport();u&&u.onAuthUpdated&&u.onAuthUpdated(a);const f=tn({action:ue.AUTH,auth:{accessToken:a.token}});this.send(f);const p=()=>{this.off(m),l(null,a)},m=R=>{R.current==="failed"&&(this.off(p),this.off(m),l(R.reason||this.getStateError()))};this.once("connectiondetails",p),this.on("connectionstate",m);break}case"connecting":h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");const u=f=>{switch(f.current){case"connected":this.off(u),l(null,a);break;case"failed":case"closed":case"suspended":this.off(u),l(f.reason||this.getStateError());break}};this.on("connectionstate",u),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}}disconnectAllTransports(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"),this.connectCounter++,this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+this.pendingTransport),this.pendingTransport.disconnect()),delete this.pendingTransport,this.proposedTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting proposed transport: "+this.pendingTransport),this.proposedTransport.disconnect()),delete this.pendingTransport,this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())}send(a,l,o){o=o||Bi;const u=this.state;if(u.sendEvents){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new mo(a,o));return}if(!(l&&u.queueEvents)){const p="rejecting event, queueEvent was "+l+", state was "+u.state;h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()",p),o(this.errorReason||new w(p,9e4,400));return}this.logger.shouldLog(h.LOG_MICRO)&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+Wa(a,this.realtime._RealtimePresence,this.realtime._Annotations,this.realtime._objectsPlugin)),this.queue(a,o)}sendImpl(a){const l=a.message;a.ackRequired&&!a.sendAttempted&&(l.msgSerial=this.msgSerial++);try{this.activeProtocol.send(a)}catch(o){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+o.stack)}}queue(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queue()","queueing event");const o=this.queuedMessages.last(),u=this.options.maxMessageSize;o&&!o.sendAttempted&&on(o.message,a,u)?(o.merged||(o.callback=ii.create(this.logger,[o.callback]),o.merged=!0),o.callback.push(l)):this.queuedMessages.push(new mo(a,l))}sendQueuedMessages(){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");let a;for(;a=this.queuedMessages.shift();)this.sendImpl(a)}queuePendingMessages(a){a&&a.length&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+a.length+" pending messages"),this.queuedMessages.prepend(a))}failQueuedMessages(a){const l=this.queuedMessages.count();l>0&&(h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+l+" queued messages, err = "+Ue(a)),this.queuedMessages.completeAllMessages(a))}onChannelMessage(a,l){this.pendingChannelMessagesState.queue.push({message:a,transport:l}),this.pendingChannelMessagesState.isProcessing||this.processNextPendingChannelMessage()}processNextPendingChannelMessage(){if(this.pendingChannelMessagesState.queue.length>0){this.pendingChannelMessagesState.isProcessing=!0;const a=this.pendingChannelMessagesState.queue.shift();this.processChannelMessage(a.message).catch(l=>{h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.processNextPendingChannelMessage() received error ",l)}).finally(()=>{this.pendingChannelMessagesState.isProcessing=!1,this.processNextPendingChannelMessage()})}}async processChannelMessage(a){await this.realtime.channels.processChannelMessage(a)}async ping(){var a;if(this.state.state!=="connected")throw new w("Unable to ping service; not connected",4e4,400);const l=(a=this.activeProtocol)==null?void 0:a.getTransport();if(!l)throw this.getStateError();h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.ping()","transport = "+l);const o=Date.now(),u=zn();return Fi(new Promise(f=>{const p=m=>{m===u&&(l.off("heartbeat",p),f(Date.now()-o))};l.on("heartbeat",p),l.ping(u)}),this.options.timeouts.realtimeRequestTimeout,"Timeout waiting for heartbeat response")}abort(a){this.activeProtocol.getTransport().fail(a)}getTransportPreference(){var a,l;return this.transportPreference||Bs()&&((l=(a=x.WebStorage)==null?void 0:a.get)==null?void 0:l.call(a,Bl))}persistTransportPreference(a){var l,o;this.transportPreference=a.shortName,Bs()&&((o=(l=x.WebStorage)==null?void 0:l.set)==null||o.call(l,Bl,a.shortName))}unpersistTransportPreference(){var a,l;this.transportPreference=null,Bs()&&((l=(a=x.WebStorage)==null?void 0:a.remove)==null||l.call(a,Bl))}actOnErrorFromAuthorize(a){if(a.code===40171)this.notifyState({state:"failed",error:a});else if(a.code===40102)this.notifyState({state:"failed",error:a});else if(a.statusCode===_i.Forbidden){const l="Client configured authentication provider returned 403; failing the connection";h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",l),this.notifyState({state:"failed",error:new w(l,80019,403,a)})}else{const l="Client configured authentication provider request failed";h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",l),this.notifyState({state:this.state.failState,error:new w(l,80019,401,a)})}}onConnectionDetailsUpdate(a,l){if(!a)return;this.connectionDetails=a,a.maxMessageSize&&(this.options.maxMessageSize=a.maxMessageSize);const o=a.clientId;if(o){const f=this.realtime.auth._uncheckedSetClientId(o);if(f){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",f.message),l.fail(f);return}}const u=a.connectionStateTtl;u&&(this.connectionStateTtl=u),this.maxIdleInterval=a.maxIdleInterval,this.emit("connectiondetails",a)}checkWsConnectivity(){const a=this.options.wsConnectivityCheckUrl||be.wsConnectivityCheckUrl,l=new x.Config.WebSocket(a);return new Promise((o,u)=>{let f=!1;l.onopen=()=>{f||(f=!0,o(),l.close())},l.onclose=l.onerror=()=>{f||(f=!0,u())}})}sessionRecoveryName(){return this.options.recoveryKeyStorageName||"ably-connection-recovery"}getSessionRecoverData(){var a,l;return fi()&&((l=(a=x.WebStorage)==null?void 0:a.getSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}setSessionRecoverData(a){var l,o;return fi()&&((o=(l=x.WebStorage)==null?void 0:l.setSession)==null?void 0:o.call(l,this.sessionRecoveryName(),a))}clearSessionRecoverData(){var a,l;return fi()&&((l=(a=x.WebStorage)==null?void 0:a.removeSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}},$a=So,ji=class extends Et{constructor(i,a){super(i.logger),this.whenState=l=>Et.prototype.whenState.call(this,l,this.state),this.ably=i,this.connectionManager=new $a(i,a),this.state=this.connectionManager.state.state,this.key=void 0,this.id=void 0,this.errorReason=null,this.connectionManager.on("connectionstate",l=>{const o=this.state=l.current;x.Config.nextTick(()=>{this.emit(o,l)})}),this.connectionManager.on("update",l=>{x.Config.nextTick(()=>{this.emit("update",l)})})}connect(){h.logAction(this.logger,h.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})}async ping(){return h.logAction(this.logger,h.LOG_MINOR,"Connection.ping()",""),this.connectionManager.ping()}close(){h.logAction(this.logger,h.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})}get recoveryKey(){return this.logger.deprecationWarning("The `Connection.recoveryKey` attribute has been replaced by the `Connection.createRecoveryKey()` method. Replace your usage of `recoveryKey` with the return value of `createRecoveryKey()`. `recoveryKey` will be removed in a future version."),this.createRecoveryKey()}createRecoveryKey(){return this.connectionManager.createRecoveryKey()}},jl=ji,js=class Jd extends Cs{constructor(a){var l,o,u,f;if(super(be.objectifyOptions(a,!1,"BaseRealtime",h.defaultLogger)),h.logAction(this.logger,h.LOG_MINOR,"Realtime()",""),typeof EdgeRuntime=="string")throw new w(`Ably.Realtime instance cannot be used in Vercel Edge runtime. If you are running Vercel Edge functions, please replace your "new Ably.Realtime()" with "new Ably.Rest()" and use Ably Rest API instead of the Realtime API. If you are server-rendering your application in the Vercel Edge runtime, please use the condition "if (typeof EdgeRuntime === 'string')" to prevent instantiating Ably.Realtime instance during SSR in the Vercel Edge runtime.`,4e4,400);this._additionalTransportImplementations=Jd.transportImplementationsFromPlugins(this.options.plugins),this._RealtimePresence=(o=(l=this.options.plugins)==null?void 0:l.RealtimePresence)!=null?o:null,this._objectsPlugin=(f=(u=this.options.plugins)==null?void 0:u.Objects)!=null?f:null,this.connection=new jl(this,this.options),this._channels=new da(this),this.options.autoConnect!==!1&&this.connect()}static transportImplementationsFromPlugins(a){const l={};return a?.WebSocketTransport&&(l[Vt.WebSocket]=a.WebSocketTransport),a?.XHRPolling&&(l[Vt.XhrPolling]=a.XHRPolling),l}get channels(){return this._channels}connect(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()}close(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.close()",""),this.connection.close()}};js.EventEmitter=Et;var ha=js,da=class extends Et{constructor(i){super(i.logger),this.realtime=i,this.all=Object.create(null),i.connection.connectionManager.on("transport.active",()=>{this.onTransportActive()})}channelSerials(){let i={};for(const a of qt(this.all,!0)){const l=this.all[a];l.properties.channelSerial&&(i[a]=l.properties.channelSerial)}return i}recoverChannels(i){for(const a of qt(i,!0)){const l=this.get(a);l.properties.channelSerial=i[a]}}async processChannelMessage(i){const a=i.channel;if(a===void 0){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event unspecified channel, action = "+i.action);return}const l=this.all[a];if(!l){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event for non-existent channel: "+a);return}await l.processMessage(i)}onTransportActive(){for(const i in this.all){const a=this.all[i];a.state==="attaching"||a.state==="detaching"?a.checkPendingState():a.state==="suspended"?a._attach(!1,null):a.state==="attached"&&a.requestState("attaching")}}propogateConnectionInterruption(i,a){const l={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},o=["attaching","attached","detaching","suspended"],u=l[i];for(const f in this.all){const p=this.all[f];o.includes(p.state)&&p.notifyState(u,a)}}get(i,a){i=String(i);let l=this.all[i];if(!l)l=this.all[i]=new Li(this.realtime,i,a);else if(a){if(l._shouldReattachToSetOptions(a,l.channelOptions))throw new w("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);l.setOptions(a)}return l}getDerived(i,a,l){if(a.filter){const o=ms(a.filter),u=Wi(i);i=`[filter=${o}${u.qualifierParam}]${u.channelName}`}return this.get(i,l)}release(i){i=String(i);const a=this.all[i];if(!a)return;const l=a.getReleaseErr();if(l)throw l;delete this.all[i]}},zs=ha;function qs(i,a){if(i.isSynthesized()||a.isSynthesized())return i.timestamp>=a.timestamp;const l=i.parseId(),o=a.parseId();return l.msgSerial===o.msgSerial?l.index>o.index:l.msgSerial>o.msgSerial}var nn=class extends Et{constructor(i,a,l=qs){super(i.logger),this.presence=i,this.map=Object.create(null),this.syncInProgress=!1,this.residualMembers=null,this.memberKey=a,this.newerThan=l}get(i){return this.map[i]}getClient(i){const a=this.map,l=[];for(const o in a){const u=a[o];u.clientId==i&&u.action!="absent"&&l.push(u)}return l}list(i){const a=this.map,l=i&&i.clientId,o=i&&i.connectionId,u=[];for(const f in a){const p=a[f];p.action!=="absent"&&(l&&l!=p.clientId||o&&o!=p.connectionId||u.push(p))}return u}put(i){(i.action==="enter"||i.action==="update")&&(i=Un.fromValues(i),i.action="present");const a=this.map,l=this.memberKey(i);this.residualMembers&&delete this.residualMembers[l];const o=a[l];return o&&!this.newerThan(i,o)?!1:(a[l]=i,!0)}values(){const i=this.map,a=[];for(const l in i){const o=i[l];o.action!="absent"&&a.push(o)}return a}remove(i){const a=this.map,l=this.memberKey(i),o=a[l];return o&&!this.newerThan(i,o)?!1:(this.syncInProgress?(i=Un.fromValues(i),i.action="absent",a[l]=i):delete a[l],!!o)}startSync(){const i=this.map,a=this.syncInProgress;h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),this.syncInProgress||(this.residualMembers=ae(i),this.setInProgress(!0))}endSync(){const i=this.map,a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),a){for(const l in i)i[l].action==="absent"&&delete i[l];this.presence._synthesizeLeaves(V(this.residualMembers));for(const l in this.residualMembers)delete i[l];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")}waitSync(i){const a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),!a){i();return}this.once("sync",i)}clear(){this.map={},this.setInProgress(!1),this.residualMembers=null}setInProgress(i){h.logAction(this.logger,h.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+i),this.syncInProgress=i,this.presence.syncComplete=!i}};function yn(i){return i.channel.client.auth.clientId}function Pn(i){const a=i.channel.client,l=a.auth.clientId;return(!l||l==="*")&&a.connection.state==="connected"}function Xn(i,a,l){switch(i.state){case"attached":case"suspended":l();break;case"initialized":case"detached":case"detaching":case"attaching":Z(i.attach(),function(o){o?a(o):l()});break;default:a(w.fromValues(i.invalidStateError()))}}var Qn=class extends Et{constructor(i){super(i.logger),this.channel=i,this.syncComplete=!1,this.members=new nn(this,a=>a.clientId+":"+a.connectionId),this._myMembers=new nn(this,a=>a.clientId),this.subscriptions=new Et(this.logger),this.pendingPresence=[]}async enter(i){if(Pn(this))throw new w("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"enter")}async update(i){if(Pn(this))throw new w("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"update")}async enterClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"enter")}async updateClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"update")}async _enterOrUpdateClient(i,a,l,o){const u=this.channel;if(!u.connectionManager.activeState())throw u.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence."+o+"Client()","channel = "+u.name+", id = "+i+", client = "+(a||"(implicit) "+yn(this)));const f=Un.fromData(l);f.action=o,i&&(f.id=i),a&&(f.clientId=a);const p=await f.encode(u.channelOptions);switch(u.state){case"attached":return u.sendPresence([p]);case"initialized":case"detached":u.attach();case"attaching":return new Promise((m,R)=>{this.pendingPresence.push({presence:p,callback:S=>S?R(S):m()})});default:{const m=new Ce("Unable to "+o+" presence channel while in "+u.state+" state",90001);throw m.code=90001,m}}}async leave(i){if(Pn(this))throw new w("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,i)}async leaveClient(i,a){const l=this.channel;if(!l.connectionManager.activeState())throw l.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+i);const o=Un.fromData(a);o.action="leave",i&&(o.clientId=i);const u=await o.encode(l.channelOptions);switch(l.state){case"attached":return l.sendPresence([u]);case"attaching":return new Promise((f,p)=>{this.pendingPresence.push({presence:u,callback:m=>m?p(m):f()})});case"initialized":case"failed":throw new Ce("Unable to leave presence channel (incompatible state)",90001);default:throw l.invalidStateError()}}async get(i){const a=!i||("waitForSync"in i?i.waitForSync:!0);return new Promise((l,o)=>{function u(f){l(i?f.list(i):f.values())}if(this.channel.state==="suspended"){a?o(w.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):u(this.members);return}Xn(this.channel,f=>o(f),()=>{const f=this.members;a?f.waitSync(function(){u(f)}):u(f)})})}async history(i){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name);const a=this.channel.client.rest.presenceMixin;if(i&&i.untilAttach)if(this.channel.state==="attached")delete i.untilAttach,i.from_serial=this.channel.properties.attachSerial;else throw new w("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400);return a.history(this,i)}setPresence(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+i.length+" participants; syncChannelSerial = "+l);let o,u;const f=this.members,p=this._myMembers,m=[],R=this.channel.connectionManager.connectionId;a&&(this.members.startSync(),l&&(u=l.match(/^[\w-]+:(.*)$/))&&(o=u[1]));for(let S of i)switch(S.action){case"leave":f.remove(S)&&m.push(S),S.connectionId===R&&!S.isSynthesized()&&p.remove(S);break;case"enter":case"present":case"update":f.put(S)&&m.push(S),S.connectionId===R&&p.put(S);break}a&&!o&&(f.endSync(),this.channel.syncChannelSerial=null);for(let S=0;S<m.length;S++){const j=m[S];this.subscriptions.emit(j.action,j)}}onAttached(i){h.logAction(this.logger,h.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+i),i?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();const a=this.pendingPresence,l=a.length;if(l){this.pendingPresence=[];const o=[],u=ii.create(this.logger);h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.onAttached","sending "+l+" queued presence messages");for(let f=0;f<l;f++){const p=a[f];o.push(p.presence),u.push(p.callback)}this.channel.sendPresence(o).then(()=>u()).catch(f=>u(f))}}actOnChannelState(i,a,l){switch(i){case"attached":this.onAttached(a);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(l);break}}failPendingPresence(i){if(this.pendingPresence.length){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+Ue(i));for(let a=0;a<this.pendingPresence.length;a++)try{this.pendingPresence[a].callback(i)}catch{}this.pendingPresence=[]}}_clearMyMembers(){this._myMembers.clear()}_ensureMyMembersPresent(){const i=this._myMembers,a=this.channel.connectionManager.connectionId;for(const l in i.map){const o=i.map[l];h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+o.clientId+'" into the presence set');const u=o.connectionId===a?o.id:void 0;this._enterOrUpdateClient(u,o.clientId,o.data,"enter").catch(f=>{const p=new w("Presence auto re-enter failed",91004,400,f);h.logAction(this.logger,h.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()","Presence auto re-enter failed; reason = "+Ue(f));const m=new Ui(this.channel.state,this.channel.state,!0,!1,p);this.channel.emit("update",m)})}}_synthesizeLeaves(i){const a=this.subscriptions;i.forEach(function(l){const o=Un.fromValues({action:"leave",connectionId:l.connectionId,clientId:l.clientId,data:l.data,encoding:l.encoding,timestamp:Date.now()});a.emit("leave",o)})}async subscribe(...i){const a=Li.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw w.fromValues(u.invalidStateError());this.subscriptions.on(l,o),u.channelOptions.attachOnSubscribe!==!1&&await u.attach()}unsubscribe(...i){const a=Li.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}},zi=Qn,Oo=Vt.WebSocket;function zl(i){return!!i.on}var ql=class extends In{constructor(i,a,l){super(i,a,l),this.shortName=Oo,l.heartbeats=x.Config.useProtocolHeartbeats,this.wsHost=l.host}static isAvailable(){return!!x.Config.WebSocket}createWebSocket(i,a){return this.uri=i+Xe(a),new x.Config.WebSocket(this.uri)}toString(){return"WebSocketTransport; uri="+this.uri}connect(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","starting"),In.prototype.connect.call(this);const i=this,a=this.params,l=a.options,u=(l.tls?"wss://":"ws://")+this.wsHost+":"+be.getPort(l)+"/";h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","uri: "+u),Z(this.auth.getAuthParams(),function(f,p){if(i.isDisposed)return;let m="";for(const S in p)m+=" "+S+": "+p[S]+";";if(h.logAction(i.logger,h.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+m+" err: "+f),f){i.disconnect(f);return}const R=a.getConnectParams(p);try{const S=i.wsConnection=i.createWebSocket(u,R);S.binaryType=x.Config.binaryType,S.onopen=function(){i.onWsOpen()},S.onclose=function(j){i.onWsClose(j)},S.onmessage=function(j){i.onWsData(j.data)},S.onerror=function(j){i.onWsError(j)},zl(S)&&S.on("ping",function(){i.onActivity()})}catch(S){h.logAction(i.logger,h.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(S.stack||S.message)),i.disconnect(S)}})}send(i){const a=this.wsConnection;if(!a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{a.send(rn(i,this.connectionManager.realtime._MsgPack,this.params.format))}catch(l){const o="Exception from ws connection when trying to send: "+Ue(l);h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()",o),this.finish("disconnected",new w(o,5e4,500))}}onWsData(i){h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+i.length+"; type = "+typeof i);try{this.onProtocolMessage(uo(i,this.connectionManager.realtime._MsgPack,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin,this.format))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+a.stack)}}onWsOpen(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")}onWsClose(i){let a,l;if(typeof i=="object"?(l=i.code,a=i.wasClean||l===1e3):(l=i,a=l==1e3),delete this.wsConnection,a){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");const o=new w("Websocket closed",80003,400);this.finish("disconnected",o)}else{const o="Unclean disconnection of WebSocket ; code = "+l,u=new w(o,80003,400);h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()",o),this.finish("disconnected",u)}this.emit("disposed")}onWsError(i){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+i.message),x.Config.nextTick(()=>{this.disconnect(Error(i.message))})}dispose(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;const i=this.wsConnection;i&&(i.onmessage=function(){},delete this.wsConnection,x.Config.nextTick(()=>{if(h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!i)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");i.close()}))}},It=ql,yt=class{static subscribeFilter(i,a,l){const o=u=>{var f,p,m,R,S,j;const z={name:u.name,refTimeserial:(p=(f=u.extras)==null?void 0:f.ref)==null?void 0:p.timeserial,refType:(R=(m=u.extras)==null?void 0:m.ref)==null?void 0:R.type,isRef:!!((j=(S=u.extras)==null?void 0:S.ref)!=null&&j.timeserial),clientId:u.clientId};Object.entries(a).find(([X,q])=>q!==void 0?z[X]!==q:!1)||l(u)};this.addFilteredSubscription(i,a,l,o),i.subscriptions.on(o)}static addFilteredSubscription(i,a,l,o){var u;if(i.filteredSubscriptions||(i.filteredSubscriptions=new Map),i.filteredSubscriptions.has(l)){const f=i.filteredSubscriptions.get(l);f.set(a,((u=f?.get(a))==null?void 0:u.concat(o))||[o])}else i.filteredSubscriptions.set(l,new Map([[a,[o]]]))}static getAndDeleteFilteredSubscriptions(i,a,l){if(!i.filteredSubscriptions)return[];if(!l&&a)return Array.from(i.filteredSubscriptions.entries()).map(([f,p])=>{var m;let R=p.get(a);return p.delete(a),p.size===0&&((m=i.filteredSubscriptions)==null||m.delete(f)),R}).reduce((f,p)=>p?f.concat(...p):f,[]);if(!l||!i.filteredSubscriptions.has(l))return[];const o=i.filteredSubscriptions.get(l);if(!a){const f=Array.from(o.values()).reduce((p,m)=>p.concat(...m),[]);return i.filteredSubscriptions.delete(l),f}let u=o.get(a);return o.delete(a),u||[]}},Me=class df extends zs{constructor(a){var l;const o=df._MsgPack;if(!o)throw new Error("Expected DefaultRealtime._MsgPack to have been set");super(be.objectifyOptions(a,!0,"Realtime",h.defaultLogger,Te(he({},Ml),{Crypto:(l=df.Crypto)!=null?l:void 0,MsgPack:o,RealtimePresence:{RealtimePresence:zi,PresenceMessage:Un,WirePresenceMessage:Ka},Annotations:{Annotation:ra,WireAnnotation:Ni,RealtimeAnnotations:ci,RestAnnotations:Nl},WebSocketTransport:It,MessageInteractions:yt})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};Me.Utils=Ve,Me.ConnectionManager=$a,Me.ProtocolMessage=oa,Me._Crypto=null,Me.Message=sa,Me.PresenceMessage=la,Me.Annotation=xl,Me._MsgPack=null,Me._Http=Os,Me._PresenceMap=nn,Me._MessageEncoding=li;var Zn=Me,vn=Uint8Array,qi=Uint32Array,Kn=Math.pow,Hl=new qi(8),Gl=[],Jn=new qi(64);function ga(i){return(i-(i|0))*Kn(2,32)|0}for(var pa=2,Wn=0;Wn<64;){for(es=!0,kn=2;kn<=pa/2;kn++)pa%kn===0&&(es=!1);es&&(Wn<8&&(Hl[Wn]=ga(Kn(pa,1/2))),Gl[Wn]=ga(Kn(pa,1/3)),Wn++),pa++}var es,kn,Fn=!!new vn(new qi([1]).buffer)[0];function Dn(i){return Fn?i>>>24|(i>>>16&255)<<8|(i&65280)<<8|i<<24:i}function Dt(i,a){return i>>>a|i<<32-a}function ma(i){var a=Hl.slice(),l=i.length,o=l*8,u=512-(o+64)%512-1+o+65,f=new vn(u/8),p=new qi(f.buffer);f.set(i,0),f[l]=128,p[p.length-1]=Dn(o);for(var m,R=0;R<u/32;R+=16){var S=a.slice();for(m=0;m<64;m++){var j;if(m<16)j=Dn(p[R+m]);else{var z=Jn[m-15],X=Jn[m-2];j=Jn[m-7]+Jn[m-16]+(Dt(z,7)^Dt(z,18)^z>>>3)+(Dt(X,17)^Dt(X,19)^X>>>10)}Jn[m]=j|=0;for(var q=(Dt(S[4],6)^Dt(S[4],11)^Dt(S[4],25))+(S[4]&S[5]^~S[4]&S[6])+S[7]+j+Gl[m],$=(Dt(S[0],2)^Dt(S[0],13)^Dt(S[0],22))+(S[0]&S[1]^S[2]&(S[0]^S[1])),ee=7;ee>0;ee--)S[ee]=S[ee-1];S[0]=q+$|0,S[4]=S[4]+q|0}for(m=0;m<8;m++)a[m]=a[m]+S[m]|0}return new vn(new qi(a.map(function(me){return Dn(me)})).buffer)}function Vl(i,a){if(i.length>64&&(i=ma(i)),i.length<64){const m=new Uint8Array(64);m.set(i,0),i=m}for(var l=new Uint8Array(64),o=new Uint8Array(64),u=0;u<64;u++)l[u]=54^i[u],o[u]=92^i[u];var f=new Uint8Array(a.length+64);f.set(l,0),f.set(a,64);var p=new Uint8Array(96);return p.set(o,0),p.set(ma(f),64),ma(p)}var ts=class{constructor(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}uint8ViewToBase64(i){let a="";const l=this.base64CharSet,o=i.byteLength,u=o%3,f=o-u;let p,m,R,S,j;for(let z=0;z<f;z=z+3)j=i[z]<<16|i[z+1]<<8|i[z+2],p=(j&16515072)>>18,m=(j&258048)>>12,R=(j&4032)>>6,S=j&63,a+=l[p]+l[m]+l[R]+l[S];return u==1?(j=i[f],p=(j&252)>>2,m=(j&3)<<4,a+=l[p]+l[m]+"=="):u==2&&(j=i[f]<<8|i[f+1],p=(j&64512)>>10,m=(j&1008)>>4,R=(j&15)<<2,a+=l[p]+l[m]+l[R]+"="),a}base64ToArrayBuffer(i){const a=atob?.(i),l=a.length,o=new Uint8Array(l);for(let u=0;u<l;u++){const f=a.charCodeAt(u);o[u]=f}return this.toArrayBuffer(o)}isBuffer(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)}toBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(this.toArrayBuffer(i));throw new Error("BufferUtils.toBuffer expected an ArrayBuffer or a view onto one")}toArrayBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to ArrayBuffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return i;if(ArrayBuffer.isView(i))return i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength);throw new Error("BufferUtils.toArrayBuffer expected an ArrayBuffer or a view onto one")}base64Encode(i){return this.uint8ViewToBase64(this.toBuffer(i))}base64UrlEncode(i){return this.base64Encode(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}base64Decode(i){if(ArrayBuffer&&x.Config.atob)return this.base64ToArrayBuffer(i);throw new Error("Expected ArrayBuffer to exist and Platform.Config.atob to be configured")}hexEncode(i){return this.toBuffer(i).reduce((l,o)=>l+o.toString(16).padStart(2,"0"),"")}hexDecode(i){if(i.length%2!==0)throw new Error("Can't create a byte array from a hex string of odd length");const a=new Uint8Array(i.length/2);for(let l=0;l<a.length;l++)a[l]=parseInt(i.slice(2*l,2*(l+1)),16);return this.toArrayBuffer(a)}utf8Encode(i){if(x.Config.TextEncoder){const a=new x.Config.TextEncoder().encode(i);return this.toArrayBuffer(a)}else throw new Error("Expected TextEncoder to be configured")}utf8Decode(i){if(!this.isBuffer(i))throw new Error("Expected input of utf8decode to be an arraybuffer or typed array");if(TextDecoder)return new TextDecoder().decode(i);throw new Error("Expected TextDecoder to be configured")}areBuffersEqual(i,a){if(!i||!a)return!1;const l=this.toArrayBuffer(i),o=this.toArrayBuffer(a);if(l.byteLength!=o.byteLength)return!1;const u=new Uint8Array(l),f=new Uint8Array(o);for(var p=0;p<u.length;p++)if(u[p]!=f[p])return!1;return!0}byteLength(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)?i.byteLength:-1}arrayBufferViewToBuffer(i){return this.toArrayBuffer(i)}concat(i){const a=i.reduce((u,f)=>u+f.byteLength,0),l=new Uint8Array(a);let o=0;for(const u of i){const f=this.toBuffer(u);l.set(f,o),o+=f.byteLength}return l.buffer}sha256(i){const a=ma(this.toBuffer(i));return this.toArrayBuffer(a)}hmacSha256(i,a){const l=Vl(this.toBuffer(a),this.toBuffer(i));return this.toArrayBuffer(l)}},ns=new ts,Hi=function(i,a){var l="aes",o=256,u="cbc",f=16;function p(X){if(X.algorithm==="aes"&&X.mode==="cbc"){if(X.keyLength===128||X.keyLength===256)return;throw new Error("Unsupported key length "+X.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function m(X){return X.replace("_","/").replace("-","+")}function R(X){return X instanceof S}class S{constructor(q,$,ee,me){this.algorithm=q,this.keyLength=$,this.mode=ee,this.key=me}}class j{static getDefaultParams(q){var $;if(!q.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof q.key=="string"?$=a.toArrayBuffer(a.base64Decode(m(q.key))):q.key instanceof ArrayBuffer?$=q.key:$=a.toArrayBuffer(q.key);var ee=q.algorithm||l,me=$.byteLength*8,Ye=q.mode||u,We=new S(ee,me,Ye,$);if(q.keyLength&&q.keyLength!==We.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+q.keyLength+" was specified, but the key actually has length "+We.keyLength);return p(We),We}static async generateRandomKey(q){try{return i.getRandomArrayBuffer((q||o)/8)}catch($){throw new w("Failed to generate random key: "+$.message,400,5e4,$)}}static getCipher(q,$){var ee,me=R(q)?q:this.getDefaultParams(q);return{cipherParams:me,cipher:new z(me,(ee=q.iv)!=null?ee:null,$)}}}j.CipherParams=S;class z{constructor(q,$,ee){if(this.logger=ee,!crypto.subtle)throw isSecureContext?new Error("Crypto operations are not possible since the browsers SubtleCrypto class is unavailable (reason unknown)."):new Error("Crypto operations are is not possible since the current environment is a non-secure context and hence the browsers SubtleCrypto class is not available.");this.algorithm=q.algorithm+"-"+String(q.keyLength)+"-"+q.mode,this.webCryptoAlgorithm=q.algorithm+"-"+q.mode,this.key=a.toArrayBuffer(q.key),this.iv=$?a.toArrayBuffer($):null}concat(q,$){const ee=new ArrayBuffer(q.byteLength+$.byteLength),me=new DataView(ee),Ye=new DataView(a.toArrayBuffer(q));for(let et=0;et<Ye.byteLength;et++)me.setInt8(et,Ye.getInt8(et));const We=new DataView(a.toArrayBuffer($));for(let et=0;et<We.byteLength;et++)me.setInt8(Ye.byteLength+et,We.getInt8(et));return ee}async encrypt(q){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.encrypt()","");const $=await this.getIv(),ee=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["encrypt"]),me=await crypto.subtle.encrypt({name:this.webCryptoAlgorithm,iv:$},ee,q);return this.concat($,me)}async decrypt(q){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.decrypt()","");const $=a.toArrayBuffer(q),ee=$.slice(0,f),me=$.slice(f),Ye=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["decrypt"]);return crypto.subtle.decrypt({name:this.webCryptoAlgorithm,iv:ee},Ye,me)}async getIv(){if(this.iv){var q=this.iv;return this.iv=null,q}const $=await i.getRandomArrayBuffer(f);return a.toArrayBuffer($)}}return j},Bt=(i=>(i[i.REQ_SEND=0]="REQ_SEND",i[i.REQ_RECV=1]="REQ_RECV",i[i.REQ_RECV_POLL=2]="REQ_RECV_POLL",i[i.REQ_RECV_STREAM=3]="REQ_RECV_STREAM",i))(Bt||{}),bn=Bt;function Il(){return new w("No HTTP request plugin provided. Provide at least one of the FetchRequest or XHRRequest plugins.",400,4e4)}var is,Ao=(is=class{constructor(i){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1;var a;this.client=i??null;const l=i?.options.connectivityCheckUrl||be.connectivityCheckUrl,o=(a=i?.options.connectivityCheckParams)!=null?a:null,u=!i?.options.connectivityCheckUrl,f=he(he({},Ao.bundledRequestImplementations),i?._additionalHTTPRequestImplementations),p=f.XHRRequest,m=f.FetchRequest,R=!!(p||m);if(!R)throw Il();x.Config.xhrSupported&&p?(this.supportsAuthHeaders=!0,this.Request=async function(S,j,z,X,q){return new Promise($=>{var ee;const me=p.createRequest(j,z,X,q,bn.REQ_SEND,(ee=i&&i.options.timeouts)!=null?ee:null,this.logger,S);me.once("complete",(Ye,We,et,Oe,cn)=>$({error:Ye,body:We,headers:et,unpacked:Oe,statusCode:cn})),me.exec()})},i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var S;h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+l);const j=await this.doUri(mt.Get,l,null,null,o);let z=!1;return u?z=!j.error&&((S=j.body)==null?void 0:S.replace(/\n/,""))=="yes":z=!j.error&&bc(j.statusCode),h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+z),z}):x.Config.fetchSupported&&m?(this.supportsAuthHeaders=!0,this.Request=async(S,j,z,X,q)=>m(S,i??null,j,z,X,q),i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var S;h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+l);const j=await this.doUri(mt.Get,l,null,null,null),z=!j.error&&((S=j.body)==null?void 0:S.replace(/\n/,""))=="yes";return h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+z),z}):this.Request=async()=>({error:R?new Ce("no supported HTTP transports available",null,400):Il()})}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}async doUri(i,a,l,o,u){return this.Request?this.Request(i,a,l,u,o):{error:new Ce("Request invoked before assigned to",null,500)}}shouldFallback(i){const a=i.statusCode;return a===408&&!i.code||a===400&&!i.code||a>=500&&a<=504}},is.methods=[mt.Get,mt.Delete,mt.Post,mt.Put,mt.Patch],is.methodsWithoutBody=[mt.Get,mt.Delete],is.methodsWithBody=[mt.Post,mt.Put,mt.Patch],is),To=Ao,rt="ablyjs-storage-test",hi=typeof Ha<"u"?Ha:typeof window<"u"?window:self,as=class{constructor(){try{hi.sessionStorage.setItem(rt,rt),hi.sessionStorage.removeItem(rt),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{hi.localStorage.setItem(rt,rt),hi.localStorage.removeItem(rt),this.localSupported=!0}catch{this.localSupported=!1}}get(i){return this._get(i,!1)}getSession(i){return this._get(i,!0)}remove(i){return this._remove(i,!1)}removeSession(i){return this._remove(i,!0)}set(i,a,l){return this._set(i,a,l,!1)}setSession(i,a,l){return this._set(i,a,l,!0)}_set(i,a,l,o){const u={value:a};return l&&(u.expires=Date.now()+l),this.storageInterface(o).setItem(i,JSON.stringify(u))}_get(i,a){if(a&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!a&&!this.localSupported)throw new Error("Local Storage not supported");const l=this.storageInterface(a).getItem(i);if(!l)return null;const o=JSON.parse(l);return o.expires&&o.expires<Date.now()?(this.storageInterface(a).removeItem(i),null):o.value}_remove(i,a){return this.storageInterface(a).removeItem(i)}storageInterface(i){return i?hi.sessionStorage:hi.localStorage}},ya=new as,ft=Qt(),va=typeof EdgeRuntime=="string";typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&!va&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function ba(){const i=ft.location;return!ft.WebSocket||!i||!i.origin||i.origin.indexOf("http")>-1}function Vc(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}var Ro=ft.navigator&&ft.navigator.userAgent.toString(),Ic=ft.location&&ft.location.href,Co={agent:"browser",logTimestamps:!0,userAgent:Ro,currentUrl:Ic,binaryType:"arraybuffer",WebSocket:ft.WebSocket,fetchSupported:!!ft.fetch,xhrSupported:ft.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,allowComet:ba(),useProtocolHeartbeats:!0,supportsBinary:!!ft.TextDecoder,preferBinary:!1,ArrayBuffer:ft.ArrayBuffer,atob:ft.atob,nextTick:typeof ft.setImmediate<"u"?ft.setImmediate.bind(ft):function(i){setTimeout(i,0)},addEventListener:ft.addEventListener,inspect:JSON.stringify,stringByteSize:function(i){return ft.TextDecoder&&new ft.TextEncoder().encode(i).length||i.length},TextEncoder:ft.TextEncoder,TextDecoder:ft.TextDecoder,getRandomArrayBuffer:async function(i){const a=new Uint8Array(i);return ft.crypto.getRandomValues(a),a.buffer},isWebworker:Vc(),push:{platform:"browser",formFactor:"desktop",storage:ya}},di=Co;function Yl(i){const a=[80015,80017,80030];return i.code?xn.isTokenErr(i)?!1:a.includes(i.code)?!0:i.code>=4e4&&i.code<5e4:!1}function Sa(i){return Yl(i)?[tn({action:ue.ERROR,error:i})]:[tn({action:ue.DISCONNECTED,error:i})]}var _o=class extends In{constructor(i,a,l){super(i,a,l,!0),this.onAuthUpdated=o=>{this.authParams={access_token:o.token}},this.stream="stream"in l?l.stream:!0,this.sendRequest=null,this.recvRequest=null,this.pendingCallback=null,this.pendingItems=null}connect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","starting"),In.prototype.connect.call(this);const i=this.params,a=i.options,l=i.host||a.primaryDomain,o=be.getPort(a),u=a.tls?"https://":"http://";this.baseUri=u+l+":"+o+"/comet/";const f=this.baseUri+"connect";h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","uri: "+f),Z(this.auth.getAuthParams(),(p,m)=>{if(p){this.disconnect(p);return}if(this.isDisposed)return;this.authParams=m;const R=this.params.getConnectParams(m);"stream"in R&&(this.stream=R.stream),h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","connectParams:"+Xe(R));let S=!1;const j=this.recvRequest=this.createRequest(f,null,R,null,this.stream?bn.REQ_RECV_STREAM:bn.REQ_RECV);j.on("data",z=>{this.recvRequest&&(S||(S=!0,this.emit("preconnect")),this.onData(z))}),j.on("complete",z=>{if(this.recvRequest||(z=z||new w("Request cancelled",80003,400)),this.recvRequest=null,!S&&!z&&(S=!0,this.emit("preconnect")),this.onActivity(),z){z.code?this.onData(Sa(z)):this.disconnect(z);return}x.Config.nextTick(()=>{this.recv()})}),j.exec()})}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)}_requestCloseOrDisconnect(i){const a=i?this.closeUri:this.disconnectUri;if(a){const l=this.createRequest(a,null,this.authParams,null,bn.REQ_SEND);l.on("complete",o=>{o&&(h.logAction(this.logger,h.LOG_ERROR,"CometTransport.request"+(i?"Close()":"Disconnect()"),"request returned err = "+Ue(o)),this.finish("disconnected",o))}),l.exec()}}dispose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",kt.disconnected()),x.Config.nextTick(()=>{this.emit("disposed")}))}onConnect(i){var a;if(this.isDisposed)return;const l=(a=i.connectionDetails)==null?void 0:a.connectionKey;In.prototype.onConnect.call(this,i);const o=this.baseUri+l;h.logAction(this.logger,h.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+o),this.sendUri=o+"/send",this.recvUri=o+"/recv",this.closeUri=o+"/close",this.disconnectUri=o+"/disconnect"}send(i){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(i);return}const a=this.pendingItems||[];a.push(i),this.pendingItems=null,this.sendItems(a)}sendAnyPending(){const i=this.pendingItems;i&&(this.pendingItems=null,this.sendItems(i))}sendItems(i){const a=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(i),bn.REQ_SEND);a.on("complete",(l,o)=>{if(l&&h.logAction(this.logger,h.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+Ue(l)),this.sendRequest=null,l){l.code?this.onData(Sa(l)):this.disconnect(l);return}o&&this.onData(o),this.pendingItems&&x.Config.nextTick(()=>{this.sendRequest||this.sendAnyPending()})}),a.exec()}recv(){if(this.recvRequest||!this.isConnected)return;const i=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?bn.REQ_RECV_STREAM:bn.REQ_RECV_POLL);i.on("data",a=>{this.onData(a)}),i.on("complete",a=>{if(this.recvRequest=null,this.onActivity(),a){a.code?this.onData(Sa(a)):this.disconnect(a);return}x.Config.nextTick(()=>{this.recv()})}),i.exec()}onData(i){try{const a=this.decodeResponse(i);if(a&&a.length)for(let l=0;l<a.length;l++)this.onProtocolMessage(Us(a[l],this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+a.stack)}}encodeRequest(i){return JSON.stringify(i)}decodeResponse(i){return typeof i=="string"?JSON.parse(i):i}},ss=_o;function Eo(i,a){return pt(qt(a)).includes("x-ably-errorcode")}function Hs(i,a){if(Eo(i,a))return i.error&&w.fromValues(i.error)}var Pl=function(){},Mo=0,ls={};function wo(i,a){return i.getResponseHeader&&i.getResponseHeader(a)}function rs(i){return i.getResponseHeader&&(i.getResponseHeader("transfer-encoding")||!i.getResponseHeader("content-length"))}function xo(i){const a=i.getAllResponseHeaders().trim().split(`\r
`),l={};for(let o=0;o<a.length;o++){const u=a[o].split(":").map(f=>f.trim());l[u[0].toLowerCase()]=u[1]}return l}var No=class Wd extends Et{constructor(a,l,o,u,f,p,m,R){super(m),o=o||{},o.rnd=zn(),this.uri=a+Xe(o),this.headers=l||{},this.body=u,this.method=R?R.toUpperCase():Y(u)?"GET":"POST",this.requestMode=f,this.timeouts=p,this.timedOut=!1,this.requestComplete=!1,this.id=String(++Mo),ls[this.id]=this}static createRequest(a,l,o,u,f,p,m,R){const S=p||be.TIMEOUTS;return new Wd(a,l,ae(o),u,f,S,m,R)}complete(a,l,o,u,f){this.requestComplete||(this.requestComplete=!0,!a&&l&&this.emit("data",l),this.emit("complete",a,l,o,u,f),this.dispose())}abort(){this.dispose()}exec(){let a=this.headers;const l=this.requestMode==bn.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,o=this.timer=setTimeout(()=>{this.timedOut=!0,f.abort()},l),u=this.method,f=this.xhr=new XMLHttpRequest,p=a.accept;let m=this.body,R="text";p?p.indexOf("application/x-msgpack")===0&&(R="arraybuffer"):a.accept="application/json",m&&(a["content-type"]||(a["content-type"]="application/json")).indexOf("application/json")>-1&&typeof m!="string"&&(m=JSON.stringify(m)),f.open(u,this.uri,!0),f.responseType=R,"authorization"in a&&(f.withCredentials=!0);for(const Oe in a)f.setRequestHeader(Oe,a[Oe]);const S=(Oe,cn,jt,Ta)=>{var Ii;let fs=cn+" (event type: "+Oe.type+")";(Ii=this==null?void 0:this.xhr)!=null&&Ii.statusText&&(fs+=", current statusText is "+this.xhr.statusText),h.logAction(this.logger,h.LOG_ERROR,"Request.on"+Oe.type+"()",fs),this.complete(new Ce(fs,jt,Ta))};f.onerror=Oe=>{S(Oe,"XHR error occurred",null,400)},f.onabort=Oe=>{this.timedOut?S(Oe,"Request aborted due to request timeout expiring",null,408):S(Oe,"Request cancelled",null,400)},f.ontimeout=Oe=>{S(Oe,"Request timed out",null,408)};let j,z,X,q=0,$=!1;const ee=()=>{if(clearTimeout(o),X=z<400,z==204){this.complete(null,null,null,null,z);return}j=this.requestMode==bn.REQ_RECV_STREAM&&X&&rs(f)},me=()=>{let Oe;try{const jt=wo(f,"content-type");if(jt?jt.indexOf("application/json")>=0:f.responseType=="text"){const Ii=f.responseType==="arraybuffer"?x.BufferUtils.utf8Decode(f.response):String(f.responseText);Ii.length?Oe=JSON.parse(Ii):Oe=Ii,$=!0}else Oe=f.response;Oe.response!==void 0?(z=Oe.statusCode,X=z<400,a=Oe.headers,Oe=Oe.response):a=xo(f)}catch(jt){this.complete(new Ce("Malformed response body from server: "+jt.message,null,400));return}if(X||Array.isArray(Oe)){this.complete(null,Oe,a,$,z);return}let cn=Hs(Oe,a);cn||(cn=new Ce("Error response received from server: "+z+" body was: "+x.Config.inspect(Oe),null,z)),this.complete(cn,Oe,a,$,z)};function Ye(){const Oe=f.responseText,cn=Oe.length-1;let jt,Ta;for(;q<cn&&(jt=Oe.indexOf(`
`,q))>-1;)Ta=Oe.slice(q,jt),q=jt+1,We(Ta)}const We=Oe=>{try{Oe=JSON.parse(Oe)}catch(cn){this.complete(new Ce("Malformed response body from server: "+cn.message,null,400));return}this.emit("data",Oe)},et=()=>{Ye(),this.streamComplete=!0,x.Config.nextTick(()=>{this.complete()})};f.onreadystatechange=()=>{const Oe=f.readyState;Oe<3||f.status!==0&&(z===void 0&&(z=f.status,ee()),Oe==3&&j?Ye():Oe==4&&(j?et():me()))},f.send(m)}dispose(){const a=this.xhr;if(a){a.onreadystatechange=a.onerror=a.onabort=a.ontimeout=Pl,this.xhr=null;const l=this.timer;l&&(clearTimeout(l),this.timer=null),this.requestComplete||a.abort()}delete ls[this.id]}},$n=No,Gs=Vt.XhrPolling,Xl=class extends ss{constructor(i,a,l){super(i,a,l),this.shortName=Gs,l.stream=!1,this.shortName=Gs}static isAvailable(){return!!(x.Config.xhrSupported&&x.Config.allowComet)}toString(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected}createRequest(i,a,l,o,u){return $n.createRequest(i,a,l,o,u,this.timeouts,this.logger)}},gi=Xl,pi=["xhr_polling"],os={order:pi,bundledImplementations:{web_socket:It,xhr_polling:gi}},Ql=os,Zl={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",wsConnectivityCheckUrl:"wss://ws-up.ably-realtime.com",defaultTransports:[Vt.XhrPolling,Vt.WebSocket]},cs=Zl;function us(i){if(i===void 0)return"undefined";let a,l;if(i instanceof ArrayBuffer?(l="ArrayBuffer",a=new DataView(i)):i instanceof DataView&&(l="DataView",a=i),!a)return JSON.stringify(i);const o=[];for(let u=0;u<i.byteLength;u++){if(u>20){o.push("...");break}let f=a.getUint8(u).toString(16);f.length===1&&(f="0"+f),o.push(f)}return"<"+l+" "+o.join(" ")+">"}function Oa(i,a,l){for(let o=0,u=l.length;o<u;o++){const f=l.charCodeAt(o);if(f<128){i.setUint8(a++,f>>>0&127|0);continue}if(f<2048){i.setUint8(a++,f>>>6&31|192),i.setUint8(a++,f>>>0&63|128);continue}if(f<65536){i.setUint8(a++,f>>>12&15|224),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}if(f<1114112){i.setUint8(a++,f>>>18&7|240),i.setUint8(a++,f>>>12&63|128),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}throw new Error("bad codepoint "+f)}}function Kl(i,a,l){let o="";for(let u=a,f=a+l;u<f;u++){const p=i.getUint8(u);if((p&128)===0){o+=String.fromCharCode(p);continue}if((p&224)===192){o+=String.fromCharCode((p&15)<<6|i.getUint8(++u)&63);continue}if((p&240)===224){o+=String.fromCharCode((p&15)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}if((p&248)===240){o+=String.fromCharCode((p&7)<<18|(i.getUint8(++u)&63)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}throw new Error("Invalid byte "+p.toString(16))}return o}function mi(i){let a=0;for(let l=0,o=i.length;l<o;l++){const u=i.charCodeAt(l);if(u<128){a+=1;continue}if(u<2048){a+=2;continue}if(u<65536){a+=3;continue}if(u<1114112){a+=4;continue}throw new Error("bad codepoint "+u)}return a}function Vs(i,a){const l=vi(i,a);if(l===0)return;const o=new ArrayBuffer(l),u=new DataView(o);return Rn(i,u,0,a),o}var Is=65536*65536,Ys=1/Is;function Jl(i,a){return a=a||0,i.getInt32(a)*Is+i.getUint32(a+4)}function yi(i,a){return a=a||0,i.getUint32(a)*Is+i.getUint32(a+4)}function ke(i,a,l){l<9223372036854776e3?(i.setInt32(a,Math.floor(l*Ys)),i.setInt32(a+4,l&-1)):(i.setUint32(a,2147483647),i.setUint32(a+4,2147483647))}function $e(i,a,l){l<18446744073709552e3?(i.setUint32(a,Math.floor(l*Ys)),i.setInt32(a+4,l&-1)):(i.setUint32(a,4294967295),i.setUint32(a+4,4294967295))}var Rt=class{constructor(i,a){this.map=l=>{const o={};for(let u=0;u<l;u++){const f=this.parse();o[f]=this.parse()}return o},this.bin=l=>{const o=new ArrayBuffer(l);return new Uint8Array(o).set(new Uint8Array(this.view.buffer,this.offset,l),0),this.offset+=l,o},this.buf=this.bin,this.str=l=>{const o=Kl(this.view,this.offset,l);return this.offset+=l,o},this.array=l=>{const o=new Array(l);for(let u=0;u<l;u++)o[u]=this.parse();return o},this.ext=l=>(this.offset+=l,{type:this.view.getInt8(this.offset),data:this.buf(l)}),this.parse=()=>{const l=this.view.getUint8(this.offset);let o,u;if((l&128)===0)return this.offset++,l;if((l&240)===128)return u=l&15,this.offset++,this.map(u);if((l&240)===144)return u=l&15,this.offset++,this.array(u);if((l&224)===160)return u=l&31,this.offset++,this.str(u);if((l&224)===224)return o=this.view.getInt8(this.offset),this.offset++,o;switch(l){case 192:return this.offset++,null;case 193:this.offset++;return;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(u);case 197:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(u);case 198:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(u);case 199:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.ext(u);case 200:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.ext(u);case 201:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.ext(u);case 202:return o=this.view.getFloat32(this.offset+1),this.offset+=5,o;case 203:return o=this.view.getFloat64(this.offset+1),this.offset+=9,o;case 204:return o=this.view.getUint8(this.offset+1),this.offset+=2,o;case 205:return o=this.view.getUint16(this.offset+1),this.offset+=3,o;case 206:return o=this.view.getUint32(this.offset+1),this.offset+=5,o;case 207:return o=yi(this.view,this.offset+1),this.offset+=9,o;case 208:return o=this.view.getInt8(this.offset+1),this.offset+=2,o;case 209:return o=this.view.getInt16(this.offset+1),this.offset+=3,o;case 210:return o=this.view.getInt32(this.offset+1),this.offset+=5,o;case 211:return o=Jl(this.view,this.offset+1),this.offset+=9,o;case 212:return u=1,this.offset++,this.ext(u);case 213:return u=2,this.offset++,this.ext(u);case 214:return u=4,this.offset++,this.ext(u);case 215:return u=8,this.offset++,this.ext(u);case 216:return u=16,this.offset++,this.ext(u);case 217:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.str(u);case 218:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.str(u);case 219:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.str(u);case 220:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.array(u);case 221:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.array(u);case 222:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.map(u);case 223:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.map(u)}throw new Error("Unknown type 0x"+l.toString(16))},this.offset=a||0,this.view=i}};function Ps(i){const a=new DataView(i),l=new Rt(a),o=l.parse();if(l.offset!==i.byteLength)throw new Error(i.byteLength-l.offset+" trailing bytes");return o}function Gi(i,a){return Object.keys(i).filter(function(l){const o=i[l],u=typeof o;return(!a||o!=null)&&(u!=="function"||!!o.toJSON)})}function Rn(i,a,l,o){const u=typeof i;if(typeof i=="string"){const f=mi(i);if(f<32)return a.setUint8(l,f|160),Oa(a,l+1,i),1+f;if(f<256)return a.setUint8(l,217),a.setUint8(l+1,f),Oa(a,l+2,i),2+f;if(f<65536)return a.setUint8(l,218),a.setUint16(l+1,f),Oa(a,l+3,i),3+f;if(f<4294967296)return a.setUint8(l,219),a.setUint32(l+1,f),Oa(a,l+5,i),5+f}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const f=i.byteLength;if(f<256)return a.setUint8(l,196),a.setUint8(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+2),2+f;if(f<65536)return a.setUint8(l,197),a.setUint16(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+3),3+f;if(f<4294967296)return a.setUint8(l,198),a.setUint32(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+5),5+f}if(typeof i=="number"){if(Math.floor(i)!==i)return a.setUint8(l,203),a.setFloat64(l+1,i),9;if(i>=0){if(i<128)return a.setUint8(l,i),1;if(i<256)return a.setUint8(l,204),a.setUint8(l+1,i),2;if(i<65536)return a.setUint8(l,205),a.setUint16(l+1,i),3;if(i<4294967296)return a.setUint8(l,206),a.setUint32(l+1,i),5;if(i<18446744073709552e3)return a.setUint8(l,207),$e(a,l+1,i),9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return a.setInt8(l,i),1;if(i>=-128)return a.setUint8(l,208),a.setInt8(l+1,i),2;if(i>=-32768)return a.setUint8(l,209),a.setInt16(l+1,i),3;if(i>=-2147483648)return a.setUint8(l,210),a.setInt32(l+1,i),5;if(i>=-9223372036854776e3)return a.setUint8(l,211),ke(a,l+1,i),9;throw new Error("Number too small -0x"+(-i).toString(16).substr(1))}if(u==="undefined")return o?0:(a.setUint8(l,212),a.setUint8(l+1,0),a.setUint8(l+2,0),3);if(i===null)return o?0:(a.setUint8(l,192),1);if(u==="boolean")return a.setUint8(l,i?195:194),1;if(typeof i.toJSON=="function")return Rn(i.toJSON(),a,l,o);if(u==="object"){let f,p=0,m;const R=Array.isArray(i);if(R?f=i.length:(m=Gi(i,o),f=m.length),f<16?(a.setUint8(l,f|(R?144:128)),p=1):f<65536?(a.setUint8(l,R?220:222),a.setUint16(l+1,f),p=3):f<4294967296&&(a.setUint8(l,R?221:223),a.setUint32(l+1,f),p=5),R)for(let S=0;S<f;S++)p+=Rn(i[S],a,l+p,o);else if(m)for(let S=0;S<f;S++){const j=m[S];p+=Rn(j,a,l+p),p+=Rn(i[j],a,l+p,o)}return p}if(u==="function")return 0;throw new Error("Unknown type "+u)}function vi(i,a){const l=typeof i;if(l==="string"){const o=mi(i);if(o<32)return 1+o;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const o=i.byteLength;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(typeof i=="number"){if(Math.floor(i)!==i)return 9;if(i>=0){if(i<128)return 1;if(i<256)return 2;if(i<65536)return 3;if(i<4294967296)return 5;if(i<18446744073709552e3)return 9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return 1;if(i>=-128)return 2;if(i>=-32768)return 3;if(i>=-2147483648)return 5;if(i>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+i.toString(16).substr(1))}if(l==="boolean")return 1;if(i===null)return a?0:1;if(i===void 0)return a?0:3;if(typeof i.toJSON=="function")return vi(i.toJSON(),a);if(l==="object"){let o,u=0;if(Array.isArray(i)){o=i.length;for(let f=0;f<o;f++)u+=vi(i[f],a)}else{const f=Gi(i,a);o=f.length;for(let p=0;p<o;p++){const m=f[p];u+=vi(m)+vi(i[m],a)}}if(o<16)return 1+u;if(o<65536)return 3+u;if(o<4294967296)return 5+u;throw new Error("Array or object too long 0x"+o.toString(16))}if(l==="function")return 0;throw new Error("Unknown type "+l)}var Vi={encode:Vs,decode:Ps,inspect:us,utf8Write:Oa,utf8Read:Kl,utf8ByteCount:mi};function Aa(i,a){return!!a.get("x-ably-errorcode")}function Yc(i,a){if(Aa(i,a))return i.error&&w.fromValues(i.error)}function St(i){const a={};return i.forEach((l,o)=>{a[o]=l}),a}async function Wl(i,a,l,o,u,f){const p=new Headers(o||{}),m=i?i.toUpperCase():Y(f)?"GET":"POST",R=new AbortController;let S;const j=new Promise(q=>{S=setTimeout(()=>{R.abort(),q({error:new Ce("Request timed out",null,408)})},a?a.options.timeouts.httpRequestTimeout:be.TIMEOUTS.httpRequestTimeout)}),z={method:m,headers:p,body:f,signal:R.signal};x.Config.isWebworker||(z.credentials=p.has("authorization")?"include":"same-origin");const X=(async()=>{try{const q=new URLSearchParams(u||{});q.set("rnd",zn());const $=l+"?"+q,ee=await Qt().fetch($,z);if(clearTimeout(S),ee.status==204)return{error:null,statusCode:ee.status};const me=ee.headers.get("Content-Type");let Ye;me&&me.indexOf("application/x-msgpack")>-1?Ye=await ee.arrayBuffer():me&&me.indexOf("application/json")>-1?Ye=await ee.json():Ye=await ee.text();const We=!!me&&me.indexOf("application/x-msgpack")===-1,et=St(ee.headers);return ee.ok?{error:null,body:Ye,headers:et,unpacked:We,statusCode:ee.status}:{error:Yc(Ye,ee.headers)||new Ce("Error response received from server: "+ee.status+" body was: "+x.Config.inspect(Ye),null,ee.status),body:Ye,headers:et,unpacked:We,statusCode:ee.status}}catch(q){return clearTimeout(S),{error:q}}})();return Promise.race([j,X])}var Fl={XHRRequest:$n,FetchRequest:Wl},$l=Hi(di,ns);x.Crypto=$l,x.BufferUtils=ns,x.Http=To,x.Config=di,x.Transports=Ql,x.WebStorage=ya;for(const i of[Ds,Zn])i.Crypto=$l,i._MsgPack=Vi;To.bundledRequestImplementations=Fl,h.initLogHandlers(),x.Defaults=kr(cs),x.Config.agent&&(x.Defaults.agent+=" "+x.Config.agent);var Uo={ErrorInfo:w,Rest:Ds,Realtime:Zn,msgpack:Vi,makeProtocolMessageFromDeserialized:Ul};if(typeof A.exports=="object"&&typeof ce=="object"){var Pc=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of Object.getOwnPropertyNames(a))!Object.prototype.hasOwnProperty.call(i,u)&&u!==l&&Object.defineProperty(i,u,{get:()=>a[u],enumerable:!(o=Object.getOwnPropertyDescriptor(a,u))||o.enumerable});return i};A.exports=Pc(A.exports,ce)}return A.exports})}(mc)),mc.exports}var bp=vp();const Sp=gf(bp),Op={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"}]},af="https://hamper-studio.store",Ap=(k,oe,ce,A,te)=>{const[W,Ne]=I.useState(null),[ze,ne]=I.useState(null),[L,F]=I.useState([]),[Le,we]=I.useState(!1),[he,Te]=I.useState(!1),[Fe,le]=I.useState(!1),[dt,At]=I.useState(!1),[Pe,x]=I.useState(!0),[de,Se]=I.useState(null),[ie,xe]=I.useState(null),[je,bt]=I.useState("idle"),[h,Ve]=I.useState(null),[Tt,w]=I.useState(1),[Ce,N]=I.useState(!0),[U,ae]=I.useState(!1),pe=I.useRef(null),v=I.useRef(null),B=I.useRef(null),Y=I.useRef([]),Q=I.useRef(null),se=I.useRef(null),Re=I.useRef(je);I.useEffect(()=>{Re.current=je},[je]);const ge=I.useCallback(async()=>{if(!(!oe||U||!Ce)){ae(!0);try{const Z=await fetch(`${af}/api/data?limit=50&page=${Tt}&user=${oe}`);if(!Z.ok)throw new Error(`Failed to fetch message history: ${Z.status}`);const J=await Z.json();if(!J||!Array.isArray(J.items)||J.items.length===0){N(!1);return}const K=J.items,pt=[...L,...K],Ie=K.map(Ee=>{let wt;if(Ee.replyingTo){const Gt=pt.find(Qt=>String(Qt.id)===String(Ee.replyingTo));Gt&&(wt={id:String(Gt.id),text:Gt.message,username:Gt.username})}return{type:"chat",id:String(Ee.id||`history-${Math.random()}`),text:Ee.message||"",username:Ee.username,timestamp:Ee.timestamp?new Date(Ee.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",replyingTo:wt,reactions:Ee.reactions||{}}}).reverse();F(Ee=>{const wt=new Set(Ee.map(Qt=>Qt.id));return[...Ie.filter(Qt=>!wt.has(Qt.id)),...Ee]}),w(Ee=>Ee+1),N(J.hasMore)}catch(Z){console.error("Error fetching message history:",Z)}finally{ae(!1)}}},[oe,U,Ce,Tt,L]),ct=I.useCallback(()=>{pe.current&&(pe.current.onicecandidate=null,pe.current.ontrack=null,pe.current.ondatachannel=null,pe.current.onconnectionstatechange=null,pe.current.close(),pe.current=null),v.current&&(v.current.onopen=null,v.current.onmessage=null,v.current.onclose=null,v.current=null),ne(null),we(!1),Y.current=[]},[]),_e=I.useCallback(()=>{ct(),bt("idle"),Ve(null),Q.current=null,se.current=null,te()},[ct,te]),gt=I.useCallback(()=>{B.current?.presence.leave(),B.current?.unsubscribe(),B.current=null,_e(),W?.getTracks().forEach(Z=>Z.stop()),Ne(null),Te(!1),le(!1),F([]),Se(null),w(1),N(!0)},[W,_e]),_t=I.useCallback((Z,J,K)=>{F(pt=>pt.map(Ie=>{if(Ie.id!==Z)return Ie;const Ee={...Ie.reactions||{}},wt=Ee[J]||[];return wt.includes(K)?(Ee[J]=wt.filter(Gt=>Gt!==K),Ee[J].length===0&&delete Ee[J]):Ee[J]=[...wt,K],{...Ie,reactions:Ee}}))},[]),sn=I.useCallback(Z=>{Z.onopen=()=>console.log("Data channel is open"),Z.onmessage=J=>{const K=JSON.parse(J.data);K.type==="chat"?F(pt=>[...pt,{...K}]):K.type==="reaction"?_t(K.messageId,K.emoji,K.username):(K.type==="draw"||K.type==="clear"||K.type==="text")&&xe(K)},Z.onclose=()=>console.log("Data channel is closed"),v.current=Z},[_t]),qt=I.useCallback(Z=>{ct();const J=new RTCPeerConnection(Op);return J.onicecandidate=K=>{if(K.candidate&&B.current&&k){const pt={type:"ice-candidate",candidate:K.candidate.toJSON(),from:k.auth.clientId};B.current.publish("webrtc-signal",pt)}},J.ontrack=K=>ne(K.streams[0]),J.ondatachannel=K=>{sn(K.channel)},J.onconnectionstatechange=()=>{const K=J.connectionState;K==="connected"&&(we(!0),Re.current==="outgoing"&&se.current&&(A(se.current),se.current=null),bt("idle")),(K==="failed"||K==="closed"||K==="disconnected")&&_e()},Z&&Z.getTracks().forEach(K=>J.addTrack(K,Z)),pe.current=J,J},[ct,sn,k,A,_e]),V=I.useCallback(async(Z,J)=>{if(W)return W;try{const K=await navigator.mediaDevices.getUserMedia({video:Z,audio:J});return Ne(K),x(Z),Se(null),K}catch(K){return console.error("Error accessing media devices.",K),K.name==="NotFoundError"||K.name==="DevicesNotFoundError"?Se("No camera or microphone found. Voice and video calls are disabled."):K.name==="NotAllowedError"||K.name==="PermissionDeniedError"?Se("Permission for camera and microphone was denied. Voice and video calls are disabled."):Se("Could not access camera or microphone."),Ne(null),null}},[W]),P=I.useCallback(async Z=>{if(pe.current)if(pe.current.remoteDescription)try{await pe.current.addIceCandidate(new RTCIceCandidate(Z))}catch(J){console.error("Error adding received ICE candidate",J)}else Y.current.push(Z)},[]),Be=I.useCallback(async Z=>{const J=pe.current;if(!(!J||J.signalingState!=="have-local-offer")){await J.setRemoteDescription({type:"answer",sdp:Z});for(const K of Y.current)await P(K);Y.current=[]}},[P]),ut=I.useCallback(async Z=>{if(!k||Re.current!=="idle")return;bt("outgoing"),se.current=Z;const K=Z==="video"||Z==="voice"?await V(Z==="video",!0):null,pt=qt(K),Ie=pt.createDataChannel("chat");sn(Ie);const Ee=await pt.createOffer();await pt.setLocalDescription(Ee);const wt={type:"offer",sdp:Ee.sdp,from:k.auth.clientId,callType:Z};await B.current.publish("webrtc-signal",wt)},[k,V,qt,sn]),Ze=I.useCallback(async()=>{if(!k||Re.current!=="incoming"||!h||!Q.current)return;const Z=Q.current,J=h.callType,pt=J==="video"||J==="voice"?await V(J==="video",!0):null,Ie=qt(pt);await Ie.setRemoteDescription({type:"offer",sdp:Z});for(const Gt of Y.current)await P(Gt);Y.current=[];const Ee=await Ie.createAnswer();await Ie.setLocalDescription(Ee);const wt={type:"answer",sdp:Ee.sdp,from:k.auth.clientId};await B.current.publish("webrtc-signal",wt),A(J)},[k,h,V,qt,P,A]),Xe=I.useCallback(async()=>{if(!k||!h)return;const Z={type:"reject",from:k.auth.clientId};await B.current?.publish("webrtc-signal",Z),bt("idle"),Ve(null),Q.current=null},[k,h]),Ht=I.useCallback(async()=>{if(!k)return;const Z={type:"cancel",from:k.auth.clientId};await B.current?.publish("webrtc-signal",Z),_e()},[k,_e]);I.useEffect(()=>{k&&oe&&ce&&!he&&(Te(!0),ge())},[k,oe,ce,he,ge]),I.useEffect(()=>{if(!he||!k||!ce)return;const Z=k.auth.clientId,J=k.channels.get(`p2p-chat:${ce}`);B.current=J;const K=Ie=>{const Ee=Ie.data;if(!(!Ee||Ee.from===Z))switch(Ee.type){case"offer":if(Re.current!=="idle")return;Q.current=Ee.sdp,Ve({callType:Ee.callType,from:Ee.from}),bt("incoming");break;case"answer":Be(Ee.sdp);break;case"ice-candidate":P(Ee.candidate);break;case"reject":case"cancel":_e();break}};J.subscribe("webrtc-signal",K);const pt=Ie=>{if(Ie.clientId!==Z){if(Ie.action==="enter"||Ie.action==="present")le(!0);else if(Ie.action==="leave"){if(le(!1),Re.current==="incoming"&&h?.from===Ie.clientId){_e();return}pe.current&&pe.current.connectionState==="connected"&&_e()}}};return J.presence.subscribe(pt),J.presence.get().then(Ie=>{le(Ie.some(Ee=>Ee.clientId!==Z))}),J.presence.enter(),()=>{J.unsubscribe(),J.presence.unsubscribe(),J.presence.leave()}},[he,k,ce,Be,P,_e,h]);const $t=I.useCallback((Z,J)=>{if(!oe)return;let K;if(J){const Ie=L.find(Ee=>Ee.id===J);Ie&&(K={id:Ie.id,text:Ie.text,username:Ie.username})}const pt={type:"chat",id:Date.now().toString(),text:Z,username:oe,timestamp:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),replyingTo:K};F(Ie=>[...Ie,pt]),v.current?.readyState==="open"&&v.current.send(JSON.stringify({...pt})),fetch(`${af}/api/data`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:oe,imageUrl:null,replyingTo:J||null,message:Z})}).catch(Ie=>console.error("Failed to save message to server:",Ie))},[oe,L]),Ue=I.useCallback((Z,J)=>{if(oe){if(_t(Z,J,oe),v.current?.readyState==="open"){const K={type:"reaction",messageId:Z,emoji:J,username:oe};v.current.send(JSON.stringify(K))}fetch(`${af}/api/data/${Z}/reactions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:oe,emoji:J})}).catch(K=>console.error("Failed to save message to server:",K))}},[oe,_t]),An=I.useCallback(Z=>{v.current?.readyState==="open"&&v.current.send(JSON.stringify(Z))},[]),un=I.useCallback(Z=>{v.current?.readyState==="open"&&v.current.send(JSON.stringify(Z))},[]),zn=I.useCallback(()=>{v.current?.readyState==="open"&&v.current.send(JSON.stringify({type:"clear"}))},[]),Ti=I.useCallback(()=>{W&&(W.getAudioTracks()[0].enabled=!W.getAudioTracks()[0].enabled,At(!W.getAudioTracks()[0].enabled))},[W]),Tn=I.useCallback(()=>{W&&(W.getVideoTracks()[0].enabled=!W.getVideoTracks()[0].enabled,x(W.getVideoTracks()[0].enabled))},[W]);return I.useEffect(()=>{},[]),{localStream:W,remoteStream:ze,messages:L,hasJoinedRoom:he,isConnected:Le,isMuted:dt,isVideoEnabled:Pe,mediaError:de,lastCanvasEvent:ie,isPeerPresent:Fe,callState:je,incomingCallInfo:h,isFetchingHistory:U,hasMoreMessages:Ce,startCall:ut,sendMessage:$t,hangUp:gt,toggleMute:Ti,toggleVideo:Tn,sendDrawData:An,sendClearCanvas:zn,sendTextData:un,acceptCall:Ze,rejectCall:Xe,cancelCall:Ht,sendReaction:Ue,loadMoreMessages:ge}},Tp=({onJoin:k,isJoining:oe})=>{const[ce,A]=I.useState("Queenofmissuniverse"),[te,W]=I.useState("uuu"),Ne=ze=>{ze.preventDefault(),ce.trim()&&!oe&&k(ce.trim(),te)};return M.jsx("div",{className:"p-6 bg-dark-surface rounded-lg shadow-lg max-w-md mx-auto text-center",children:M.jsxs("form",{onSubmit:Ne,className:"flex flex-col gap-4",children:[M.jsx("button",{type:"submit",onClick:()=>W("uuu"),className:"w-50 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"uuu"}),M.jsx("button",{type:"submit",onClick:()=>W("g11h"),className:"w-50 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"g11h"})]})})},ht=({path:k,className:oe="w-6 h-6"})=>M.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:oe,"aria-hidden":"true",children:M.jsx("path",{fillRule:"evenodd",d:k,clipRule:"evenodd"})}),Ke={chat:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z",phone:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z",hangup:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.57c-2.83-1.35-5.21-3.73-6.56-6.56l1.57-1.57c.28-.28.36-.67.24-1.01-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.01c-.55 0-.99.45-.99.99 0 9.32 7.53 16.85 16.85 16.85.54 0 .99-.45-.99-.99v-3.54c0-.54-.45-.99-.99-.99z",video:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z",videoOff:"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.22 0 .42-.08.58-.2L20.73 21 22 19.73 3.27 2z",send:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",mic:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5-3c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z",micOff:"M10.8 4.9c0-.66.54-1.2 1.2-1.2.66 0 1.2.54 1.2 1.2l-.01 3.18 1.66 1.66 0-.02c0-1.55-1.11-2.82-2.6-3.15v-1.1c0-.41-.34-.75-.75-.75s-.75.34-.75.75v1.1C9.01 4.58 8 5.85 8 7.4v.02l1.66 1.66L10.8 4.9zM19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zM3.41 1.86L2 3.27 4.73 6H5c0 3.53 2.61 6.43 6 6.92V17h2v-4.08c.12 0 .23-.01.35-.02l2.54 2.54c-.69.44-1.46.77-2.28.98V17h2v-1.08c1.99-.43 3.61-1.78 4.29-3.48l1.45 1.45L20.73 15l-17.32-17.14z",reply:"M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z",pen:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",eraser:"M6.29 2.56c.39-.39 1.02-.39 1.41 0l2.59 2.59c.39.39.39 1.02 0 1.41L3.81 13.04c-.39.39-1.02.39-1.41 0L.11 10.75c-.39-.39-.39-1.02 0-1.41l6.18-6.78zm13.35 12.08l-3.95-3.95-6.18 6.78c-.39.39-.39 1.02 0 1.41l2.59 2.59c.39.39 1.02.39 1.41 0l6.13-6.83z",text:"M2.5 4v3h5v12h3V7h5V4h-13zM21.5 9h-9v3h3v7h3v-7h3V9z",undo:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.38 11.23 17.34 8 12.5 8z",redo:"M18 10h-9l3.62-3.62c-1.39-1.16-3.16-1.88-5.12-1.88C3.66 4.5 1.13 6.94.36 10.22l-2.37-.78C-1.18 5.77 2.66 2 7.5 2c2.65 0 5.05.99 6.9 2.6L18 1v9z",zoomIn:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM10 7H9v2H7v1h2v2h1v-2h2V9h-2V7z",zoomOut:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z",resetView:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"},Rp=["","","","",""],Cp=({messages:k,sendMessage:oe,sendReaction:ce,currentUsername:A,loadMoreMessages:te,hasMoreMessages:W,isFetchingHistory:Ne})=>{const[ze,ne]=I.useState(""),[L,F]=I.useState(null),[Le,we]=I.useState(null),he=I.useRef(null),Te=I.useRef(null),[Fe,le]=I.useState(!0),[dt,At]=I.useState(!0);I.useEffect(()=>{dt&&he.current&&(he.current.scrollTop=he.current.scrollHeight)},[k,dt]),I.useLayoutEffect(()=>{const ie=he.current;if(ie&&Ne){const{scrollHeight:xe,scrollTop:je}=ie,bt=xe-je,h=new MutationObserver(()=>{ie.scrollTop=ie.scrollHeight-bt,h.disconnect()});h.observe(ie,{childList:!0})}},[Ne]);const Pe=()=>{const ie=he.current;if(!ie)return;const xe=ie.scrollHeight-ie.scrollTop===ie.clientHeight;le(xe),At(xe),ie.scrollTop===0&&W&&!Ne&&te()};I.useEffect(()=>{const ie=xe=>{Te.current&&!Te.current.contains(xe.target)&&F(null)};return document.addEventListener("mousedown",ie),()=>document.removeEventListener("mousedown",ie)},[]);const x=ie=>{ie.preventDefault(),ze.trim()&&(oe(ze.trim(),Le?.id),ne(""),we(null),At(!0))},de=(ie,xe)=>{ce(ie,xe),F(null)},Se=ie=>{we(ie),F(null)};return M.jsxs("div",{className:"flex flex-col h-full bg-dark-surface rounded-b-lg",children:[M.jsxs("div",{ref:he,onScroll:Pe,className:"flex-1 p-4 overflow-y-auto space-y-2",children:[Ne&&M.jsx("div",{className:"flex justify-center my-4",children:M.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-400"})}),k.map(ie=>M.jsxs("div",{className:`group flex items-end gap-2 ${ie.username===A?"justify-end":"justify-start"}`,children:[M.jsxs("div",{onClick:xe=>{xe.stopPropagation(),F(ie.id===L?null:ie.id)},className:`relative max-w-xs lg:max-w-md px-4 py-2 rounded-2xl cursor-pointer ${ie.username===A?"bg-blue-600 text-white rounded-br-none":"bg-gray-600 text-dark-text-primary rounded-bl-none"}`,children:[ie.replyingTo&&M.jsxs("div",{className:"mb-2 p-2 border-l-2 border-blue-300 bg-black/20 rounded-lg",children:[M.jsx("p",{className:"font-bold text-xs opacity-80",children:ie.replyingTo.username}),M.jsx("p",{className:"text-sm opacity-80 truncate",children:ie.replyingTo.text})]}),M.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:ie.text}),M.jsx("p",{className:"text-xs text-right mt-1 opacity-40",children:ie.timestamp}),ie.reactions&&Object.keys(ie.reactions).length>0&&M.jsx("div",{className:"absolute -bottom-3 right-2 flex gap-1",children:Object.entries(ie.reactions).map(([xe,je])=>je.length>0&&M.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-full px-2 py-0.5 text-xs flex items-center shadow",children:[M.jsx("span",{children:xe}),M.jsx("span",{className:"ml-1 text-dark-text-secondary font-bold",children:je.length})]},xe))})]}),L===ie.id&&M.jsxs("div",{ref:Te,className:"absolute z-10 -mt-8 bg-dark-surface border border-dark-border p-1 rounded-full shadow-lg flex items-center gap-1",children:[Rp.map(xe=>M.jsx("button",{onClick:()=>de(ie.id,xe),className:`p-1.5 rounded-full hover:bg-gray-600 transition-colors text-xl leading-none ${ie.reactions?.[xe]?.includes(A)?"bg-blue-800":""}`,children:xe},xe)),M.jsx("div",{className:"w-px h-6 bg-dark-border mx-1"}),M.jsx("button",{onClick:()=>Se(ie),className:"p-1.5 rounded-full hover:bg-gray-600 transition-colors",children:M.jsx(ht,{path:Ke.reply,className:"w-5 h-5"})})]})]},ie.id))]}),M.jsxs("div",{className:"p-4 border-t border-dark-border",children:[Le&&M.jsxs("div",{className:"mb-2 p-2 bg-gray-800 rounded-lg text-sm relative",children:[M.jsxs("p",{className:"font-bold text-dark-text-secondary",children:["Replying to ",Le.username]}),M.jsx("p",{className:"text-dark-text-primary truncate",children:Le.text}),M.jsx("button",{onClick:()=>we(null),className:"absolute top-1 right-1 p-1 rounded-full hover:bg-gray-700",children:M.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),M.jsxs("form",{onSubmit:x,className:"flex items-center gap-4",children:[M.jsx("input",{type:"text",value:ze,onChange:ie=>ne(ie.target.value),placeholder:"Type a message...",className:"flex-1 bg-gray-700 border border-gray-600 rounded-full py-2 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500 text-dark-text-primary"}),M.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full p-3 transition-colors disabled:bg-gray-500 disabled:cursor-not-allowed","aria-label":"Send message",children:M.jsx(ht,{path:Ke.send,className:"w-6 h-6"})})]})]})]})},_p=({localStream:k,remoteStream:oe,isMuted:ce,isVideoEnabled:A,onToggleMute:te,onToggleVideo:W,onHangUp:Ne})=>{const ze=I.useRef(null),ne=I.useRef(null);return I.useEffect(()=>{ze.current&&k&&(ze.current.srcObject=k)},[k]),I.useEffect(()=>{ne.current&&oe&&(ne.current.srcObject=oe)},[oe]),M.jsxs("div",{className:"relative h-full w-full bg-black rounded-b-lg overflow-hidden",children:[M.jsx("video",{ref:ne,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),!oe&&M.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900",children:M.jsxs("div",{className:"text-center",children:[M.jsx(ht,{path:Ke.video,className:"w-16 h-16 mx-auto text-gray-500"}),M.jsx("p",{className:"mt-2 text-dark-text-secondary",children:"Waiting for peer to connect..."})]})}),M.jsx("video",{ref:ze,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute bottom-4 right-4 w-1/4 max-w-[200px] rounded-lg border-2 border-dark-border shadow-lg",style:{display:k?"block":"none"}}),!k&&M.jsx("div",{className:"absolute bottom-4 right-4 w-1/4 max-w-[200px] h-auto aspect-video rounded-lg border-2 border-dark-border bg-gray-800 flex items-center justify-center",children:M.jsx(ht,{path:Ke.videoOff,className:"w-8 h-8 text-gray-500"})}),M.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-black bg-opacity-50 flex justify-center items-center gap-4",children:[M.jsx("button",{onClick:te,className:`p-3 rounded-full transition-colors ${ce?"bg-red-600":"bg-gray-600 hover:bg-gray-500"}`,"aria-label":ce?"Unmute":"Mute",children:M.jsx(ht,{path:ce?Ke.micOff:Ke.mic})}),M.jsx("button",{onClick:W,className:`p-3 rounded-full transition-colors ${A?"bg-gray-600 hover:bg-gray-500":"bg-red-600"}`,"aria-label":A?"Disable Video":"Enable Video",children:M.jsx(ht,{path:A?Ke.video:Ke.videoOff})}),M.jsx("button",{onClick:Ne,className:"p-3 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Hang up",children:M.jsx(ht,{path:Ke.hangup})})]})]})},Ep=({remoteStream:k,isMuted:oe,onToggleMute:ce,onHangUp:A})=>{const te=I.useRef(null);return I.useEffect(()=>{te.current&&k&&(te.current.srcObject=k,te.current.play().catch(W=>console.error("Error playing remote audio:",W)))},[k]),M.jsxs("div",{className:"flex flex-col h-full w-full items-center justify-center bg-dark-surface rounded-b-lg p-8",children:[M.jsx("audio",{ref:te,autoPlay:!0,playsInline:!0}),M.jsxs("div",{className:"text-center",children:[M.jsxs("div",{className:"relative inline-block",children:[M.jsx("div",{className:"w-40 h-40 rounded-full bg-gray-700 flex items-center justify-center",children:M.jsx(ht,{path:Ke.phone,className:"w-20 h-20 text-blue-400"})}),k&&M.jsx("span",{className:"absolute bottom-0 right-0 block h-8 w-8 rounded-full bg-green-500 border-4 border-dark-surface animate-pulse"})]}),M.jsx("h2",{className:"text-2xl font-bold mt-6 text-dark-text-primary",children:"Voice Call in Progress"}),M.jsx("p",{className:"text-dark-text-secondary mt-2",children:k?"You are connected to your peer.":"Waiting for peer to connect..."})]}),M.jsxs("div",{className:"mt-12 flex justify-center items-center gap-6",children:[M.jsx("button",{onClick:ce,className:`p-4 rounded-full transition-colors ${oe?"bg-red-600":"bg-gray-600 hover:bg-gray-500"}`,"aria-label":oe?"Unmute":"Mute",children:M.jsx(ht,{path:oe?Ke.micOff:Ke.mic,className:"w-8 h-8"})}),M.jsx("button",{onClick:A,className:"p-4 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Hang up",children:M.jsx(ht,{path:Ke.hangup,className:"w-8 h-8"})})]})]})},Yd="#1F2937",Pd=20,Mp=({sendDrawData:k,sendTextData:oe,sendClearCanvas:ce,lastCanvasEvent:A})=>{const te=I.useRef(null),[W,Ne]=I.useState("pen"),[ze,ne]=I.useState("#FFFFFF"),[L,F]=I.useState(5),[Le,we]=I.useState(!1),he=I.useRef(null),[Te,Fe]=I.useState({active:!1,x:0,y:0,value:""}),[le,dt]=I.useState({scale:1,offset:{x:0,y:0}}),[At,Pe]=I.useState(!1),x=I.useRef({x:0,y:0}),de=I.useRef(null),Se=I.useRef(null),[ie,xe]=I.useState([]),[je,bt]=I.useState([]),[h,Ve]=I.useState(-1),Tt=I.useCallback(()=>{const V=te.current;if(!V)return;const P=V.parentElement;if(!P)return;const Be=window.devicePixelRatio||1;V.width=P.clientWidth*Be,V.height=P.clientHeight*Be;const ut=V.getContext("2d");ut&&ut.scale(Be,Be)},[]);I.useEffect(()=>(Tt(),window.addEventListener("resize",Tt),()=>window.removeEventListener("resize",Tt)),[Tt]),I.useEffect(()=>{A&&(A.type==="draw"||A.type==="text"?xe(V=>[...V,A]):A.type==="clear"&&(xe([]),bt([]),Ve(-1)))},[A]);const w=V=>{const P=je.slice(0,h+1);P.push(V),bt(P),Ve(P.length-1)};I.useEffect(()=>{const V=te.current,P=V?.getContext("2d");if(!V||!P)return;const Be=window.devicePixelRatio||1;P.save(),P.setTransform(Be,0,0,Be,0,0),P.fillStyle=Yd,P.fillRect(0,0,V.width,V.height),P.restore(),P.save(),P.translate(le.offset.x,le.offset.y),P.scale(le.scale,le.scale);const ut=je.slice(0,h+1),Ze=[...ie,...ut];for(const Xe of Ze)Xe.type==="draw"?(P.beginPath(),P.moveTo(Xe.x0,Xe.y0),P.lineTo(Xe.x1,Xe.y1),P.strokeStyle=Xe.tool==="eraser"?Yd:Xe.color,P.lineWidth=Xe.lineWidth,P.lineCap="round",P.lineJoin="round",P.stroke(),P.closePath()):Xe.type==="text"&&(P.font=Xe.font,P.fillStyle=Xe.color,P.textAlign="left",P.textBaseline="top",P.fillText(Xe.text,Xe.x,Xe.y));P.restore()},[ie,je,h,le]);const Ce=(V,P)=>{const Be=te.current;if(!Be)return null;const ut=Be.getBoundingClientRect(),Ze=(V-ut.left-le.offset.x)/le.scale,Xe=(P-ut.top-le.offset.y)/le.scale;return{x:Ze,y:Xe}},N=V=>{const P=Ce("touches"in V.nativeEvent?V.nativeEvent.touches[0].clientX:V.nativeEvent.clientX,"touches"in V.nativeEvent?V.nativeEvent.touches[0].clientY:V.nativeEvent.clientY);P&&(we(!0),he.current=P)},U=V=>{if(!Le)return;const P=Ce("touches"in V.nativeEvent?V.nativeEvent.touches[0].clientX:V.nativeEvent.clientX,"touches"in V.nativeEvent?V.nativeEvent.touches[0].clientY:V.nativeEvent.clientY),Be=he.current;if(!P||!Be)return;const ut={type:"draw",tool:W,x0:Be.x,y0:Be.y,x1:P.x,y1:P.y,color:ze,lineWidth:L};w(ut),k(ut),he.current=P},ae=()=>{we(!1),he.current=null},pe=()=>{if(!Te.active||!Te.value.trim()){Fe({active:!1,x:0,y:0,value:""});return}const V=`${Pd}px sans-serif`,P={type:"text",x:Te.x,y:Te.y,text:Te.value,color:ze,font:V};w(P),oe(P),Fe({active:!1,x:0,y:0,value:""})},v=V=>{if(V.button===0){if(W==="pen"||W==="eraser")N(V);else if(W==="text"){pe();const P=Ce(V.clientX,V.clientY);P&&Fe({active:!0,x:P.x,y:P.y,value:""})}}else V.button===2&&(Pe(!0),x.current={x:V.clientX-le.offset.x,y:V.clientY-le.offset.y})},B=V=>{At?dt(P=>({...P,offset:{x:V.clientX-x.current.x,y:V.clientY-x.current.y}})):Le&&U(V)},Y=V=>{V.button===0?ae():V.button===2&&Pe(!1)},Q=V=>{if(V.touches.length===1){if(W==="pen"||W==="eraser")N(V);else if(W==="text"){pe();const P=Ce(V.touches[0].clientX,V.touches[0].clientY);P&&Fe({active:!0,x:P.x,y:P.y,value:""})}}else if(V.touches.length>=2){we(!1);const P=V.touches[0],Be=V.touches[1];de.current=Math.hypot(P.clientX-Be.clientX,P.clientY-Be.clientY),Se.current={x:(P.clientX+Be.clientX)/2,y:(P.clientY+Be.clientY)/2},x.current={x:Se.current.x-le.offset.x,y:Se.current.y-le.offset.y}}},se=V=>{if(V.touches.length===1)U(V);else if(V.touches.length>=2){V.preventDefault();const P=V.touches[0],Be=V.touches[1],ut=Math.hypot(P.clientX-Be.clientX,P.clientY-Be.clientY),Ze={x:(P.clientX+Be.clientX)/2,y:(P.clientY+Be.clientY)/2},Xe=Ze.x-x.current.x,Ht=Ze.y-x.current.y,$t=de.current?ut/de.current:1,Ue=te.current;if(!Ue)return;const An=Ue.getBoundingClientRect(),un=Ze.x-An.left,zn=Ze.y-An.top,Ti=un-(un-Xe)*$t,Tn=zn-(zn-Ht)*$t;dt(Z=>({scale:Math.max(.1,Math.min(10,Z.scale*$t)),offset:{x:Ti,y:Tn}})),de.current=ut,x.current={x:Ze.x-Ti,y:Ze.y-Tn}}},Re=()=>{de.current=null,Se.current=null,ae()},ge=V=>{V.preventDefault();const P=-V.deltaY*.001,Be=Math.max(.1,Math.min(10,le.scale+P)),ut=te.current;if(!ut)return;const Ze=ut.getBoundingClientRect(),Xe=V.clientX-Ze.left,Ht=V.clientY-Ze.top,$t=(Xe-le.offset.x)/le.scale,Ue=(Ht-le.offset.y)/le.scale,An=Xe-$t*Be,un=Ht-Ue*Be;dt({scale:Be,offset:{x:An,y:un}})},ct=()=>Ve(V=>Math.max(-1,V-1)),_e=()=>Ve(V=>Math.min(je.length-1,V+1)),gt=()=>{xe([]),bt([]),Ve(-1),ce()},_t=V=>{const P=te.current;if(!P)return;const{width:Be,height:ut}=P.getBoundingClientRect(),Ze=Be/2,Xe=ut/2,Ht=Math.max(.1,Math.min(10,le.scale*V)),$t=(Ze-le.offset.x)/le.scale,Ue=(Xe-le.offset.y)/le.scale,An=Ze-$t*Ht,un=Xe-Ue*Ht;dt({scale:Ht,offset:{x:An,y:un}})},sn=()=>{dt({scale:1,offset:{x:0,y:0}})},qt=({myTool:V,label:P,icon:Be})=>M.jsx("button",{onClick:()=>Ne(V),className:`p-2 rounded-lg transition-colors ${W===V?"bg-blue-600 text-white":"bg-dark-surface hover:bg-gray-600"}`,"aria-label":P,children:M.jsx(ht,{path:Be,className:"w-5 h-5"})});return M.jsxs("div",{className:"relative h-full w-full bg-gray-800 rounded-b-lg touch-none",style:{cursor:W==="text"?"text":At?"grabbing":"crosshair"},children:[M.jsx("canvas",{ref:te,className:"w-full h-full",onMouseDown:v,onMouseUp:Y,onMouseLeave:Y,onMouseMove:B,onWheel:ge,onContextMenu:V=>V.preventDefault(),onTouchStart:Q,onTouchEnd:Re,onTouchCancel:Re,onTouchMove:se}),M.jsxs("div",{className:"absolute top-2 left-2 flex flex-wrap items-center gap-2 bg-dark-bg p-2 rounded-lg shadow-md",children:[M.jsxs("div",{className:"flex items-center gap-1 border-r border-dark-border pr-2",children:[M.jsx(qt,{myTool:"pen",label:"Pen",icon:Ke.pen}),M.jsx(qt,{myTool:"eraser",label:"Eraser",icon:Ke.eraser}),M.jsx(qt,{myTool:"text",label:"Text",icon:Ke.text})]}),M.jsxs("div",{className:"flex items-center gap-1 border-r border-dark-border pr-2",children:[M.jsx("button",{onClick:ct,disabled:h<0,className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Undo",children:M.jsx(ht,{path:Ke.undo,className:"w-5 h-5"})}),M.jsx("button",{onClick:_e,disabled:h>=je.length-1,className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Redo",children:M.jsx(ht,{path:Ke.redo,className:"w-5 h-5"})})]}),M.jsxs("div",{className:"flex items-center gap-1 border-r border-dark-border pr-2",children:[M.jsx("button",{onClick:()=>_t(1.2),className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600","aria-label":"Zoom In",children:M.jsx(ht,{path:Ke.zoomIn,className:"w-5 h-5"})}),M.jsx("button",{onClick:()=>_t(.8),className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600","aria-label":"Zoom Out",children:M.jsx(ht,{path:Ke.zoomOut,className:"w-5 h-5"})}),M.jsx("button",{onClick:sn,className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600","aria-label":"Reset View",children:M.jsx(ht,{path:Ke.resetView,className:"w-5 h-5"})})]}),M.jsxs("div",{className:"flex items-center gap-2",children:[M.jsx("input",{type:"color",id:"color-picker",value:ze,onChange:V=>ne(V.target.value),className:"w-8 h-8 p-0 border-none rounded bg-dark-surface cursor-pointer"}),M.jsx("input",{type:"range",id:"line-width",min:"1",max:"50",value:L,onChange:V=>F(Number(V.target.value)),className:"w-24 cursor-pointer"})]}),M.jsx("button",{onClick:gt,className:"bg-red-600 hover:bg-red-700 text-white text-sm font-bold py-2 px-3 rounded-lg transition-colors",children:"Clear All"})]}),Te.active&&M.jsx("textarea",{autoFocus:!0,value:Te.value,onChange:V=>Fe(P=>({...P,value:V.target.value})),onBlur:pe,onKeyDown:V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),pe())},style:{position:"absolute",left:`${le.offset.x+Te.x*le.scale}px`,top:`${le.offset.y+Te.y*le.scale}px`,transform:`scale(${le.scale})`,transformOrigin:"top left",fontSize:`${Pd}px`,lineHeight:1.2,color:ze,background:"transparent",border:`1px dashed ${ze}`,outline:"none",resize:"none",overflow:"hidden",minWidth:"100px"},className:"p-1 font-sans"})]})},wp=k=>{switch(k){case"video":return{icon:Ke.video,name:"Video Call"};case"voice":return{icon:Ke.phone,name:"Voice Call"};case"canvas":return{icon:Ke.pen,name:"Canvas Session"};default:return{icon:Ke.chat,name:"Call"}}},xp=({callInfo:k,onAccept:oe,onReject:ce})=>{const{icon:A,name:te}=wp(k.callType);return M.jsxs("div",{className:"flex flex-col h-full w-full items-center justify-center bg-dark-surface rounded-b-lg p-8",children:[M.jsxs("div",{className:"text-center",children:[M.jsx("div",{className:"relative inline-block animate-pulse",children:M.jsx("div",{className:"w-40 h-40 rounded-full bg-gray-700 flex items-center justify-center",children:M.jsx(ht,{path:A,className:"w-20 h-20 text-blue-400"})})}),M.jsxs("h2",{className:"text-2xl font-bold mt-6 text-dark-text-primary",children:["Incoming ",te]}),M.jsx("p",{className:"text-dark-text-secondary mt-2",children:"You have an incoming call from your peer."})]}),M.jsxs("div",{className:"mt-12 flex justify-center items-center gap-6",children:[M.jsx("button",{onClick:ce,className:"p-4 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Reject Call",children:M.jsx(ht,{path:Ke.hangup,className:"w-8 h-8"})}),M.jsx("button",{onClick:oe,className:"p-4 rounded-full bg-green-600 hover:bg-green-700 transition-colors","aria-label":"Accept Call",children:M.jsx(ht,{path:Ke.phone,className:"w-8 h-8"})})]})]})},Np=({onCancel:k})=>M.jsxs("div",{className:"flex flex-col h-full w-full items-center justify-center bg-dark-surface rounded-b-lg p-8",children:[M.jsxs("div",{className:"text-center",children:[M.jsx("div",{className:"relative inline-block",children:M.jsxs("div",{className:"w-40 h-40 rounded-full bg-gray-700 flex items-center justify-center",children:[M.jsx("div",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),M.jsx(ht,{path:Ke.phone,className:"w-20 h-20 text-blue-400"})]})}),M.jsx("h2",{className:"text-2xl font-bold mt-6 text-dark-text-primary",children:"Calling Peer..."}),M.jsx("p",{className:"text-dark-text-secondary mt-2",children:"Waiting for your peer to answer."})]}),M.jsx("div",{className:"mt-12 flex justify-center items-center gap-6",children:M.jsx("button",{onClick:k,className:"p-4 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Cancel Call",children:M.jsx(ht,{path:Ke.hangup,className:"w-8 h-8"})})})]}),Up=()=>{const[k,oe]=I.useState("chat"),[ce,A]=I.useState(null),[te,W]=I.useState(null),[Ne,ze]=I.useState(""),[ne,L]=I.useState(""),F=I.useCallback(gt=>{oe(gt)},[]),Le=I.useCallback(()=>{oe("chat")},[]);I.useEffect(()=>{const gt="I2tDaw.8aYbrA:AL3WVoe9M-LCuy9Fr4b14LuVnsoVUmQuj1t_6_2-a4k",_t=new Sp.Realtime({key:gt,clientId:`user-${Math.random().toString(36).substring(2,9)}`});return _t.connection.on("connected",()=>{A(_t),W(null)}),_t.connection.on("failed",sn=>{W(`Ably connection failed: ${sn.reason?.message??"Unknown error"}`)}),()=>{_t.close()}},[]);const{localStream:we,remoteStream:he,messages:Te,hasJoinedRoom:Fe,isConnected:le,isMuted:dt,isVideoEnabled:At,mediaError:Pe,lastCanvasEvent:x,isPeerPresent:de,callState:Se,incomingCallInfo:ie,isFetchingHistory:xe,hasMoreMessages:je,startCall:bt,sendMessage:h,hangUp:Ve,toggleMute:Tt,toggleVideo:w,sendDrawData:Ce,sendClearCanvas:N,sendTextData:U,acceptCall:ae,rejectCall:pe,cancelCall:v,sendReaction:B,loadMoreMessages:Y}=Ap(ce,Ne,ne,F,Le),Q=I.useCallback(()=>{Ve(),L(""),ze(""),oe("chat")},[Ve]),se=I.useCallback((gt,_t)=>{ce&&(ze(_t),L(gt))},[ce]),Re=I.useMemo(()=>{if(te)return M.jsx("div",{className:"p-8 text-center text-red-400",children:te});if(!ce||!Fe)return M.jsx("div",{className:"p-4 md:p-8 flex items-center justify-center h-full",children:M.jsx(Tp,{onJoin:se,isJoining:Se!=="idle"})});if(Se==="incoming"&&ie)return M.jsx(xp,{callInfo:ie,onAccept:ae,onReject:pe});if(Se==="outgoing")return M.jsx(Np,{onCancel:v});switch(k){case"video":return M.jsx(_p,{localStream:we,remoteStream:he,isMuted:dt,isVideoEnabled:At,onToggleMute:Tt,onToggleVideo:w,onHangUp:Q});case"voice":return M.jsx(Ep,{remoteStream:he,isMuted:dt,onToggleMute:Tt,onHangUp:Q});case"canvas":return M.jsx(Mp,{sendDrawData:Ce,sendTextData:U,sendClearCanvas:N,lastCanvasEvent:x});case"chat":default:return M.jsx(Cp,{messages:Te,sendMessage:h,sendReaction:B,currentUsername:Ne,loadMoreMessages:Y,hasMoreMessages:je,isFetchingHistory:xe})}},[ce,te,Fe,Se,k,we,he,dt,At,Tt,w,Q,Te,h,se,Pe,x,Ce,N,U,ie,ae,pe,v,B,Ne,Y,je,xe]),{statusText:ge,statusColor:ct}=I.useMemo(()=>Se==="outgoing"?{statusText:"Calling...",statusColor:"bg-yellow-500"}:Se==="incoming"?{statusText:"Incoming call...",statusColor:"bg-yellow-500"}:le?{statusText:"Connected",statusColor:"bg-green-500"}:Fe?de?{statusText:"Peer is present",statusColor:"bg-blue-500"}:{statusText:"Waiting for Peer",statusColor:"bg-orange-500"}:{statusText:"Disconnected",statusColor:"bg-red-500"},[Se,le,Fe,de]),_e=I.useCallback(gt=>{de&&!le&&Se==="idle"&&bt(gt),le&&oe(gt)},[de,le,Se,bt]);return M.jsx("div",{className:"antialiased min-h-screen flex flex-col items-center justify-center p-4 bg-dark-bg",children:M.jsxs("div",{className:"w-full max-w-4xl h-[90vh] flex flex-col bg-dark-surface rounded-lg shadow-2xl border border-dark-border",children:[M.jsx("header",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:Fe&&M.jsx("div",{className:"flex items-center gap-4",children:M.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium text-white ${ct}`,children:ge})})}),M.jsx("main",{className:"flex-1 overflow-y-auto relative",children:M.jsxs("div",{className:"h-full",children:[Pe&&Fe&&M.jsx("div",{className:"absolute top-0 left-0 right-0 p-2 bg-yellow-600 text-white text-center text-sm z-10 animate-pulse",children:M.jsx("p",{children:Pe})}),Re]})}),Fe&&M.jsx("footer",{className:"flex items-center justify-center p-2 border-t border-dark-border",children:M.jsxs("nav",{className:"flex items-center gap-2",children:[M.jsx("button",{onClick:()=>oe("chat"),disabled:Se!=="idle"&&!le,className:`p-2 rounded-full transition-colors ${k==="chat"&&le?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:M.jsx(ht,{path:Ke.chat})}),M.jsx("button",{onClick:()=>_e("voice"),disabled:!de||!!Pe||Se!=="idle",title:Pe??(de?Se==="idle"?"Start voice call":"Call in progress":"Waiting for a peer to join"),className:`p-2 rounded-full transition-colors ${k==="voice"&&le?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:M.jsx(ht,{path:Ke.phone})}),M.jsx("button",{onClick:()=>_e("video"),disabled:!de||!!Pe||Se!=="idle",title:Pe??(de?Se==="idle"?"Start video call":"Call in progress":"Waiting for a peer to join"),className:`p-2 rounded-full transition-colors ${k==="video"&&le?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:M.jsx(ht,{path:Ke.video})}),M.jsx("button",{onClick:()=>_e("canvas"),disabled:!de||Se!=="idle",title:de?Se==="idle"?"Start collaborative canvas":"Call in progress":"Waiting for a peer to join",className:`p-2 rounded-full transition-colors ${k==="canvas"&&le?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:M.jsx(ht,{path:Ke.pen})})]})})]})})},Fd=document.getElementById("root");if(!Fd)throw new Error("Could not find root element to mount to");const kp=mp.createRoot(Fd);kp.render(M.jsx(op.StrictMode,{children:M.jsx(Up,{})}));
