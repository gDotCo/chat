(function(){const oe=document.createElement("link").relList;if(oe&&oe.supports&&oe.supports("modulepreload"))return;for(const W of document.querySelectorAll('link[rel="modulepreload"]'))A(W);new MutationObserver(W=>{for(const J of W)if(J.type==="childList")for(const Ue of J.addedNodes)Ue.tagName==="LINK"&&Ue.rel==="modulepreload"&&A(Ue)}).observe(document,{childList:!0,subtree:!0});function ce(W){const J={};return W.integrity&&(J.integrity=W.integrity),W.referrerPolicy&&(J.referrerPolicy=W.referrerPolicy),W.crossOrigin==="use-credentials"?J.credentials="include":W.crossOrigin==="anonymous"?J.credentials="omit":J.credentials="same-origin",J}function A(W){if(W.ep)return;W.ep=!0;const J=ce(W);fetch(W.href,J)}})();var Ba=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function df(k){return k&&k.__esModule&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k}var Wu={exports:{}},Ar={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ud;function ap(){if(Ud)return Ar;Ud=1;var k=Symbol.for("react.transitional.element"),oe=Symbol.for("react.fragment");function ce(A,W,J){var Ue=null;if(J!==void 0&&(Ue=""+J),W.key!==void 0&&(Ue=""+W.key),"key"in W){J={};for(var Le in W)Le!=="key"&&(J[Le]=W[Le])}else J=W;return W=J.ref,{$$typeof:k,type:A,key:Ue,ref:W!==void 0?W:null,props:J}}return Ar.Fragment=oe,Ar.jsx=ce,Ar.jsxs=ce,Ar}var kd;function sp(){return kd||(kd=1,Wu.exports=ap()),Wu.exports}var w=sp(),Fu={exports:{}},Ne={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dd;function lp(){if(Dd)return Ne;Dd=1;var k=Symbol.for("react.transitional.element"),oe=Symbol.for("react.portal"),ce=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),W=Symbol.for("react.profiler"),J=Symbol.for("react.consumer"),Ue=Symbol.for("react.context"),Le=Symbol.for("react.forward_ref"),ee=Symbol.for("react.suspense"),L=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),ke=Symbol.iterator;function we(v){return v===null||typeof v!="object"?null:(v=ke&&v[ke]||v["@@iterator"],typeof v=="function"?v:null)}var pe={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ce=Object.assign,Fe={};function P(v,H,I){this.props=v,this.context=H,this.refs=Fe,this.updater=I||pe}P.prototype.isReactComponent={},P.prototype.setState=function(v,H){if(typeof v!="object"&&typeof v!="function"&&v!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,v,H,"setState")},P.prototype.forceUpdate=function(v){this.updater.enqueueForceUpdate(this,v,"forceUpdate")};function Ge(){}Ge.prototype=P.prototype;function mt(v,H,I){this.props=v,this.context=H,this.refs=Fe,this.updater=I||pe}var Ke=mt.prototype=new Ge;Ke.constructor=mt,Ce(Ke,P.prototype),Ke.isPureReactComponent=!0;var x=Array.isArray,he={H:null,A:null,T:null,S:null,V:null},Ae=Object.prototype.hasOwnProperty;function yt(v,H,I,K,se,Re){return I=Re.ref,{$$typeof:k,type:v,key:H,ref:I!==void 0?I:null,props:Re}}function vt(v,H){return yt(v.type,H,void 0,void 0,void 0,v.props)}function Ie(v){return typeof v=="object"&&v!==null&&v.$$typeof===k}function _t(v){var H={"=":"=0",":":"=2"};return"$"+v.replace(/[=:]/g,function(I){return H[I]})}var h=/\/+/g;function He(v,H){return typeof v=="object"&&v!==null&&v.key!=null?_t(""+v.key):H.toString(36)}function Xe(){}function _(v){switch(v.status){case"fulfilled":return v.value;case"rejected":throw v.reason;default:switch(typeof v.status=="string"?v.then(Xe,Xe):(v.status="pending",v.then(function(H){v.status==="pending"&&(v.status="fulfilled",v.value=H)},function(H){v.status==="pending"&&(v.status="rejected",v.reason=H)})),v.status){case"fulfilled":return v.value;case"rejected":throw v.reason}}throw v}function de(v,H,I,K,se){var Re=typeof v;(Re==="undefined"||Re==="boolean")&&(v=null);var re=!1;if(v===null)re=!0;else switch(Re){case"bigint":case"string":case"number":re=!0;break;case"object":switch(v.$$typeof){case k:case oe:re=!0;break;case te:return re=v._init,de(re(v._payload),H,I,K,se)}}if(re)return se=se(v),re=K===""?"."+He(v,0):K,x(se)?(I="",re!=null&&(I=re.replace(h,"$&/")+"/"),de(se,H,I,"",function(Kt){return Kt})):se!=null&&(Ie(se)&&(se=vt(se,I+(se.key==null||v&&v.key===se.key?"":(""+se.key).replace(h,"$&/")+"/")+re)),H.push(se)),1;re=0;var et=K===""?".":K+":";if(x(v))for(var Be=0;Be<v.length;Be++)K=v[Be],Re=et+He(K,Be),re+=de(K,H,I,Re,se);else if(Be=we(v),typeof Be=="function")for(v=Be.call(v),Be=0;!(K=v.next()).done;)K=K.value,Re=et+He(K,Be++),re+=de(K,H,I,Re,se);else if(Re==="object"){if(typeof v.then=="function")return de(_(v),H,I,K,se);throw H=String(v),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(v).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return re}function N(v,H,I){if(v==null)return v;var K=[],se=0;return de(v,K,"","",function(Re){return H.call(I,Re,se++)}),K}function U(v){if(v._status===-1){var H=v._result;H=H(),H.then(function(I){(v._status===0||v._status===-1)&&(v._status=1,v._result=I)},function(I){(v._status===0||v._status===-1)&&(v._status=2,v._result=I)}),v._status===-1&&(v._status=0,v._result=H)}if(v._status===1)return v._result.default;throw v._result}var ne=typeof reportError=="function"?reportError:function(v){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof v=="object"&&v!==null&&typeof v.message=="string"?String(v.message):String(v),error:v});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",v);return}console.error(v)};function Te(){}return Ne.Children={map:N,forEach:function(v,H,I){N(v,function(){H.apply(this,arguments)},I)},count:function(v){var H=0;return N(v,function(){H++}),H},toArray:function(v){return N(v,function(H){return H})||[]},only:function(v){if(!Ie(v))throw Error("React.Children.only expected to receive a single React element child.");return v}},Ne.Component=P,Ne.Fragment=ce,Ne.Profiler=W,Ne.PureComponent=mt,Ne.StrictMode=A,Ne.Suspense=ee,Ne.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=he,Ne.__COMPILER_RUNTIME={__proto__:null,c:function(v){return he.H.useMemoCache(v)}},Ne.cache=function(v){return function(){return v.apply(null,arguments)}},Ne.cloneElement=function(v,H,I){if(v==null)throw Error("The argument must be a React element, but you passed "+v+".");var K=Ce({},v.props),se=v.key,Re=void 0;if(H!=null)for(re in H.ref!==void 0&&(Re=void 0),H.key!==void 0&&(se=""+H.key),H)!Ae.call(H,re)||re==="key"||re==="__self"||re==="__source"||re==="ref"&&H.ref===void 0||(K[re]=H[re]);var re=arguments.length-2;if(re===1)K.children=I;else if(1<re){for(var et=Array(re),Be=0;Be<re;Be++)et[Be]=arguments[Be+2];K.children=et}return yt(v.type,se,void 0,void 0,Re,K)},Ne.createContext=function(v){return v={$$typeof:Ue,_currentValue:v,_currentValue2:v,_threadCount:0,Provider:null,Consumer:null},v.Provider=v,v.Consumer={$$typeof:J,_context:v},v},Ne.createElement=function(v,H,I){var K,se={},Re=null;if(H!=null)for(K in H.key!==void 0&&(Re=""+H.key),H)Ae.call(H,K)&&K!=="key"&&K!=="__self"&&K!=="__source"&&(se[K]=H[K]);var re=arguments.length-2;if(re===1)se.children=I;else if(1<re){for(var et=Array(re),Be=0;Be<re;Be++)et[Be]=arguments[Be+2];se.children=et}if(v&&v.defaultProps)for(K in re=v.defaultProps,re)se[K]===void 0&&(se[K]=re[K]);return yt(v,Re,void 0,void 0,null,se)},Ne.createRef=function(){return{current:null}},Ne.forwardRef=function(v){return{$$typeof:Le,render:v}},Ne.isValidElement=Ie,Ne.lazy=function(v){return{$$typeof:te,_payload:{_status:-1,_result:v},_init:U}},Ne.memo=function(v,H){return{$$typeof:L,type:v,compare:H===void 0?null:H}},Ne.startTransition=function(v){var H=he.T,I={};he.T=I;try{var K=v(),se=he.S;se!==null&&se(I,K),typeof K=="object"&&K!==null&&typeof K.then=="function"&&K.then(Te,ne)}catch(Re){ne(Re)}finally{he.T=H}},Ne.unstable_useCacheRefresh=function(){return he.H.useCacheRefresh()},Ne.use=function(v){return he.H.use(v)},Ne.useActionState=function(v,H,I){return he.H.useActionState(v,H,I)},Ne.useCallback=function(v,H){return he.H.useCallback(v,H)},Ne.useContext=function(v){return he.H.useContext(v)},Ne.useDebugValue=function(){},Ne.useDeferredValue=function(v,H){return he.H.useDeferredValue(v,H)},Ne.useEffect=function(v,H,I){var K=he.H;if(typeof I=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return K.useEffect(v,H)},Ne.useId=function(){return he.H.useId()},Ne.useImperativeHandle=function(v,H,I){return he.H.useImperativeHandle(v,H,I)},Ne.useInsertionEffect=function(v,H){return he.H.useInsertionEffect(v,H)},Ne.useLayoutEffect=function(v,H){return he.H.useLayoutEffect(v,H)},Ne.useMemo=function(v,H){return he.H.useMemo(v,H)},Ne.useOptimistic=function(v,H){return he.H.useOptimistic(v,H)},Ne.useReducer=function(v,H,I){return he.H.useReducer(v,H,I)},Ne.useRef=function(v){return he.H.useRef(v)},Ne.useState=function(v){return he.H.useState(v)},Ne.useSyncExternalStore=function(v,H,I){return he.H.useSyncExternalStore(v,H,I)},Ne.useTransition=function(){return he.H.useTransition()},Ne.version="19.1.0",Ne}var Ld;function gf(){return Ld||(Ld=1,Fu.exports=lp()),Fu.exports}var X=gf();const rp=df(X);var $u={exports:{}},Rr={},ef={exports:{}},tf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Bd;function op(){return Bd||(Bd=1,function(k){function oe(N,U){var ne=N.length;N.push(U);e:for(;0<ne;){var Te=ne-1>>>1,v=N[Te];if(0<W(v,U))N[Te]=U,N[ne]=v,ne=Te;else break e}}function ce(N){return N.length===0?null:N[0]}function A(N){if(N.length===0)return null;var U=N[0],ne=N.pop();if(ne!==U){N[0]=ne;e:for(var Te=0,v=N.length,H=v>>>1;Te<H;){var I=2*(Te+1)-1,K=N[I],se=I+1,Re=N[se];if(0>W(K,ne))se<v&&0>W(Re,K)?(N[Te]=Re,N[se]=ne,Te=se):(N[Te]=K,N[I]=ne,Te=I);else if(se<v&&0>W(Re,ne))N[Te]=Re,N[se]=ne,Te=se;else break e}}return U}function W(N,U){var ne=N.sortIndex-U.sortIndex;return ne!==0?ne:N.id-U.id}if(k.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var J=performance;k.unstable_now=function(){return J.now()}}else{var Ue=Date,Le=Ue.now();k.unstable_now=function(){return Ue.now()-Le}}var ee=[],L=[],te=1,ke=null,we=3,pe=!1,Ce=!1,Fe=!1,P=!1,Ge=typeof setTimeout=="function"?setTimeout:null,mt=typeof clearTimeout=="function"?clearTimeout:null,Ke=typeof setImmediate<"u"?setImmediate:null;function x(N){for(var U=ce(L);U!==null;){if(U.callback===null)A(L);else if(U.startTime<=N)A(L),U.sortIndex=U.expirationTime,oe(ee,U);else break;U=ce(L)}}function he(N){if(Fe=!1,x(N),!Ce)if(ce(ee)!==null)Ce=!0,Ae||(Ae=!0,He());else{var U=ce(L);U!==null&&de(he,U.startTime-N)}}var Ae=!1,yt=-1,vt=5,Ie=-1;function _t(){return P?!0:!(k.unstable_now()-Ie<vt)}function h(){if(P=!1,Ae){var N=k.unstable_now();Ie=N;var U=!0;try{e:{Ce=!1,Fe&&(Fe=!1,mt(yt),yt=-1),pe=!0;var ne=we;try{t:{for(x(N),ke=ce(ee);ke!==null&&!(ke.expirationTime>N&&_t());){var Te=ke.callback;if(typeof Te=="function"){ke.callback=null,we=ke.priorityLevel;var v=Te(ke.expirationTime<=N);if(N=k.unstable_now(),typeof v=="function"){ke.callback=v,x(N),U=!0;break t}ke===ce(ee)&&A(ee),x(N)}else A(ee);ke=ce(ee)}if(ke!==null)U=!0;else{var H=ce(L);H!==null&&de(he,H.startTime-N),U=!1}}break e}finally{ke=null,we=ne,pe=!1}U=void 0}}finally{U?He():Ae=!1}}}var He;if(typeof Ke=="function")He=function(){Ke(h)};else if(typeof MessageChannel<"u"){var Xe=new MessageChannel,_=Xe.port2;Xe.port1.onmessage=h,He=function(){_.postMessage(null)}}else He=function(){Ge(h,0)};function de(N,U){yt=Ge(function(){N(k.unstable_now())},U)}k.unstable_IdlePriority=5,k.unstable_ImmediatePriority=1,k.unstable_LowPriority=4,k.unstable_NormalPriority=3,k.unstable_Profiling=null,k.unstable_UserBlockingPriority=2,k.unstable_cancelCallback=function(N){N.callback=null},k.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):vt=0<N?Math.floor(1e3/N):5},k.unstable_getCurrentPriorityLevel=function(){return we},k.unstable_next=function(N){switch(we){case 1:case 2:case 3:var U=3;break;default:U=we}var ne=we;we=U;try{return N()}finally{we=ne}},k.unstable_requestPaint=function(){P=!0},k.unstable_runWithPriority=function(N,U){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var ne=we;we=N;try{return U()}finally{we=ne}},k.unstable_scheduleCallback=function(N,U,ne){var Te=k.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?Te+ne:Te):ne=Te,N){case 1:var v=-1;break;case 2:v=250;break;case 5:v=1073741823;break;case 4:v=1e4;break;default:v=5e3}return v=ne+v,N={id:te++,callback:U,priorityLevel:N,startTime:ne,expirationTime:v,sortIndex:-1},ne>Te?(N.sortIndex=ne,oe(L,N),ce(ee)===null&&N===ce(L)&&(Fe?(mt(yt),yt=-1):Fe=!0,de(he,ne-Te))):(N.sortIndex=v,oe(ee,N),Ce||pe||(Ce=!0,Ae||(Ae=!0,He()))),N},k.unstable_shouldYield=_t,k.unstable_wrapCallback=function(N){var U=we;return function(){var ne=we;we=U;try{return N.apply(this,arguments)}finally{we=ne}}}}(tf)),tf}var zd;function cp(){return zd||(zd=1,ef.exports=op()),ef.exports}var nf={exports:{}},en={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jd;function up(){if(jd)return en;jd=1;var k=gf();function oe(ee){var L="https://react.dev/errors/"+ee;if(1<arguments.length){L+="?args[]="+encodeURIComponent(arguments[1]);for(var te=2;te<arguments.length;te++)L+="&args[]="+encodeURIComponent(arguments[te])}return"Minified React error #"+ee+"; visit "+L+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function ce(){}var A={d:{f:ce,r:function(){throw Error(oe(522))},D:ce,C:ce,L:ce,m:ce,X:ce,S:ce,M:ce},p:0,findDOMNode:null},W=Symbol.for("react.portal");function J(ee,L,te){var ke=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:W,key:ke==null?null:""+ke,children:ee,containerInfo:L,implementation:te}}var Ue=k.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Le(ee,L){if(ee==="font")return"";if(typeof L=="string")return L==="use-credentials"?L:""}return en.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,en.createPortal=function(ee,L){var te=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!L||L.nodeType!==1&&L.nodeType!==9&&L.nodeType!==11)throw Error(oe(299));return J(ee,L,null,te)},en.flushSync=function(ee){var L=Ue.T,te=A.p;try{if(Ue.T=null,A.p=2,ee)return ee()}finally{Ue.T=L,A.p=te,A.d.f()}},en.preconnect=function(ee,L){typeof ee=="string"&&(L?(L=L.crossOrigin,L=typeof L=="string"?L==="use-credentials"?L:"":void 0):L=null,A.d.C(ee,L))},en.prefetchDNS=function(ee){typeof ee=="string"&&A.d.D(ee)},en.preinit=function(ee,L){if(typeof ee=="string"&&L&&typeof L.as=="string"){var te=L.as,ke=Le(te,L.crossOrigin),we=typeof L.integrity=="string"?L.integrity:void 0,pe=typeof L.fetchPriority=="string"?L.fetchPriority:void 0;te==="style"?A.d.S(ee,typeof L.precedence=="string"?L.precedence:void 0,{crossOrigin:ke,integrity:we,fetchPriority:pe}):te==="script"&&A.d.X(ee,{crossOrigin:ke,integrity:we,fetchPriority:pe,nonce:typeof L.nonce=="string"?L.nonce:void 0})}},en.preinitModule=function(ee,L){if(typeof ee=="string")if(typeof L=="object"&&L!==null){if(L.as==null||L.as==="script"){var te=Le(L.as,L.crossOrigin);A.d.M(ee,{crossOrigin:te,integrity:typeof L.integrity=="string"?L.integrity:void 0,nonce:typeof L.nonce=="string"?L.nonce:void 0})}}else L==null&&A.d.M(ee)},en.preload=function(ee,L){if(typeof ee=="string"&&typeof L=="object"&&L!==null&&typeof L.as=="string"){var te=L.as,ke=Le(te,L.crossOrigin);A.d.L(ee,te,{crossOrigin:ke,integrity:typeof L.integrity=="string"?L.integrity:void 0,nonce:typeof L.nonce=="string"?L.nonce:void 0,type:typeof L.type=="string"?L.type:void 0,fetchPriority:typeof L.fetchPriority=="string"?L.fetchPriority:void 0,referrerPolicy:typeof L.referrerPolicy=="string"?L.referrerPolicy:void 0,imageSrcSet:typeof L.imageSrcSet=="string"?L.imageSrcSet:void 0,imageSizes:typeof L.imageSizes=="string"?L.imageSizes:void 0,media:typeof L.media=="string"?L.media:void 0})}},en.preloadModule=function(ee,L){if(typeof ee=="string")if(L){var te=Le(L.as,L.crossOrigin);A.d.m(ee,{as:typeof L.as=="string"&&L.as!=="script"?L.as:void 0,crossOrigin:te,integrity:typeof L.integrity=="string"?L.integrity:void 0})}else A.d.m(ee)},en.requestFormReset=function(ee){A.d.r(ee)},en.unstable_batchedUpdates=function(ee,L){return ee(L)},en.useFormState=function(ee,L,te){return Ue.H.useFormState(ee,L,te)},en.useFormStatus=function(){return Ue.H.useHostTransitionStatus()},en.version="19.1.0",en}var qd;function fp(){if(qd)return nf.exports;qd=1;function k(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(k)}catch(oe){console.error(oe)}}return k(),nf.exports=up(),nf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hd;function hp(){if(Hd)return Rr;Hd=1;var k=cp(),oe=gf(),ce=fp();function A(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function W(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function J(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,(t.flags&4098)!==0&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function Ue(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Le(e){if(J(e)!==e)throw Error(A(188))}function ee(e){var t=e.alternate;if(!t){if(t=J(e),t===null)throw Error(A(188));return t!==e?null:e}for(var n=e,s=t;;){var r=n.return;if(r===null)break;var c=r.alternate;if(c===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===c.child){for(c=r.child;c;){if(c===n)return Le(r),e;if(c===s)return Le(r),t;c=c.sibling}throw Error(A(188))}if(n.return!==s.return)n=r,s=c;else{for(var d=!1,g=r.child;g;){if(g===n){d=!0,n=r,s=c;break}if(g===s){d=!0,s=r,n=c;break}g=g.sibling}if(!d){for(g=c.child;g;){if(g===n){d=!0,n=c,s=r;break}if(g===s){d=!0,s=c,n=r;break}g=g.sibling}if(!d)throw Error(A(189))}}if(n.alternate!==s)throw Error(A(190))}if(n.tag!==3)throw Error(A(188));return n.stateNode.current===n?e:t}function L(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e;for(e=e.child;e!==null;){if(t=L(e),t!==null)return t;e=e.sibling}return null}var te=Object.assign,ke=Symbol.for("react.element"),we=Symbol.for("react.transitional.element"),pe=Symbol.for("react.portal"),Ce=Symbol.for("react.fragment"),Fe=Symbol.for("react.strict_mode"),P=Symbol.for("react.profiler"),Ge=Symbol.for("react.provider"),mt=Symbol.for("react.consumer"),Ke=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),Ae=Symbol.for("react.suspense_list"),yt=Symbol.for("react.memo"),vt=Symbol.for("react.lazy"),Ie=Symbol.for("react.activity"),_t=Symbol.for("react.memo_cache_sentinel"),h=Symbol.iterator;function He(e){return e===null||typeof e!="object"?null:(e=h&&e[h]||e["@@iterator"],typeof e=="function"?e:null)}var Xe=Symbol.for("react.client.reference");function _(e){if(e==null)return null;if(typeof e=="function")return e.$$typeof===Xe?null:e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ce:return"Fragment";case P:return"Profiler";case Fe:return"StrictMode";case he:return"Suspense";case Ae:return"SuspenseList";case Ie:return"Activity"}if(typeof e=="object")switch(e.$$typeof){case pe:return"Portal";case Ke:return(e.displayName||"Context")+".Provider";case mt:return(e._context.displayName||"Context")+".Consumer";case x:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case yt:return t=e.displayName||null,t!==null?t:_(e.type)||"Memo";case vt:t=e._payload,e=e._init;try{return _(e(t))}catch{}}return null}var de=Array.isArray,N=oe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,U=ce.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne={pending:!1,data:null,method:null,action:null},Te=[],v=-1;function H(e){return{current:e}}function I(e){0>v||(e.current=Te[v],Te[v]=null,v--)}function K(e,t){v++,Te[v]=e.current,e.current=t}var se=H(null),Re=H(null),re=H(null),et=H(null);function Be(e,t){switch(K(re,t),K(Re,e),K(se,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?ld(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)t=ld(t),e=rd(t,e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}I(se),K(se,e)}function Kt(){I(se),I(Re),I(re)}function Un(e){e.memoizedState!==null&&K(et,e);var t=se.current,n=rd(t,e.type);t!==n&&(K(Re,e),K(se,n))}function Wn(e){Re.current===e&&(I(se),I(Re)),et.current===e&&(I(et),yr._currentValue=ne)}var tn=Object.prototype.hasOwnProperty,V=k.unstable_scheduleCallback,Z=k.unstable_cancelCallback,De=k.unstable_shouldYield,ht=k.unstable_requestPaint,Qe=k.unstable_now,Ye=k.unstable_getCurrentPriorityLevel,jt=k.unstable_ImmediatePriority,Jt=k.unstable_UserBlockingPriority,Y=k.unstable_NormalPriority,le=k.unstable_LowPriority,ie=k.unstable_IdlePriority,st=k.log,be=k.unstable_setDisableYieldValue,Me=null,_e=null;function Je(e){if(typeof st=="function"&&be(e),_e&&typeof _e.setStrictMode=="function")try{_e.setStrictMode(Me,e)}catch{}}var dt=Math.clz32?Math.clz32:Mr,rl=Math.log,Er=Math.LN2;function Mr(e){return e>>>=0,e===0?32:31-(rl(e)/Er|0)|0}var za=256,Xi=4194304;function kn(e){var t=e&42;if(t!==0)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return e&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function ja(e,t,n){var s=e.pendingLanes;if(s===0)return 0;var r=0,c=e.suspendedLanes,d=e.pingedLanes;e=e.warmLanes;var g=s&134217727;return g!==0?(s=g&~c,s!==0?r=kn(s):(d&=g,d!==0?r=kn(d):n||(n=g&~e,n!==0&&(r=kn(n))))):(g=s&~c,g!==0?r=kn(g):d!==0?r=kn(d):n||(n=s&~e,n!==0&&(r=kn(n)))),r===0?0:t!==0&&t!==r&&(t&c)===0&&(c=r&-r,n=t&-t,c>=n||c===32&&(n&4194048)!==0)?t:r}function Qi(e,t){return(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)===0}function ds(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ol(){var e=za;return za<<=1,(za&4194048)===0&&(za=256),e}function qa(){var e=Xi;return Xi<<=1,(Xi&62914560)===0&&(Xi=4194304),e}function wt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Zi(e,t){e.pendingLanes|=t,t!==268435456&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function wr(e,t,n,s,r,c){var d=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var g=e.entanglements,y=e.expirationTimes,C=e.hiddenUpdates;for(n=d&~n;0<n;){var D=31-dt(n),G=1<<D;g[D]=0,y[D]=-1;var E=C[D];if(E!==null)for(C[D]=null,D=0;D<E.length;D++){var M=E[D];M!==null&&(M.lane&=-536870913)}n&=~G}s!==0&&xr(e,s,0),c!==0&&r===0&&e.tag!==0&&(e.suspendedLanes|=c&~(d&~t))}function xr(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var s=31-dt(t);e.entangledLanes|=t,e.entanglements[s]=e.entanglements[s]|1073741824|n&4194090}function rn(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var s=31-dt(n),r=1<<s;r&t|e[s]&t&&(e[s]|=t),n&=~r}}function cl(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function ul(e){return e&=-e,2<e?8<e?(e&134217727)!==0?32:268435456:8:2}function fl(){var e=U.p;return e!==0?e:(e=window.event,e===void 0?32:_d(e.type))}function Nr(e,t){var n=U.p;try{return U.p=e,t()}finally{U.p=n}}var Dn=Math.random().toString(36).slice(2),Dt="__reactFiber$"+Dn,Yt="__reactProps$"+Dn,Ki="__reactContainer$"+Dn,gs="__reactEvents$"+Dn,vc="__reactListeners$"+Dn,hl="__reactHandles$"+Dn,Ur="__reactResources$"+Dn,Ha="__reactMarker$"+Dn;function dl(e){delete e[Dt],delete e[Yt],delete e[gs],delete e[vc],delete e[hl]}function Ln(e){var t=e[Dt];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ki]||n[Dt]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=fd(e);e!==null;){if(n=e[Dt])return n;e=fd(e)}return t}e=n,n=e.parentNode}return null}function bi(e){if(e=e[Dt]||e[Ki]){var t=e.tag;if(t===5||t===6||t===13||t===26||t===27||t===3)return e}return null}function Fn(e){var t=e.tag;if(t===5||t===26||t===27||t===6)return e.stateNode;throw Error(A(33))}function Ji(e){var t=e[Ur];return t||(t=e[Ur]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function xt(e){e[Ha]=!0}var ve=new Set,kr={};function Si(e,t){$n(e,t),$n(e+"Capture",t)}function $n(e,t){for(kr[e]=t,e=0;e<t.length;e++)ve.add(t[e])}var Dr=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),bt={},gl={};function bc(e){return tn.call(gl,e)?!0:tn.call(bt,e)?!1:Dr.test(e)?gl[e]=!0:(bt[e]=!0,!1)}function Oi(e,t,n){if(bc(t))if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":e.removeAttribute(t);return;case"boolean":var s=t.toLowerCase().slice(0,5);if(s!=="data-"&&s!=="aria-"){e.removeAttribute(t);return}}e.setAttribute(t,""+n)}}function Wi(e,t,n){if(n===null)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(t);return}e.setAttribute(t,""+n)}}function Bn(e,t,n,s){if(s===null)e.removeAttribute(n);else{switch(typeof s){case"undefined":case"function":case"symbol":case"boolean":e.removeAttribute(n);return}e.setAttributeNS(t,n,""+s)}}var pl,ml;function Fi(e){if(pl===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);pl=t&&t[1]||"",ml=-1<n.stack.indexOf(`
    at`)?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return`
`+pl+e+ml}var ps=!1;function ms(e,t){if(!e||ps)return"";ps=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var s={DetermineComponentFrameRoot:function(){try{if(t){var G=function(){throw Error()};if(Object.defineProperty(G.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(G,[])}catch(M){var E=M}Reflect.construct(e,[],G)}else{try{G.call()}catch(M){E=M}e.call(G.prototype)}}else{try{throw Error()}catch(M){E=M}(G=e())&&typeof G.catch=="function"&&G.catch(function(){})}}catch(M){if(M&&E&&typeof M.stack=="string")return[M.stack,E.stack]}return[null,null]}};s.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(s.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(s.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var c=s.DetermineComponentFrameRoot(),d=c[0],g=c[1];if(d&&g){var y=d.split(`
`),C=g.split(`
`);for(r=s=0;s<y.length&&!y[s].includes("DetermineComponentFrameRoot");)s++;for(;r<C.length&&!C[r].includes("DetermineComponentFrameRoot");)r++;if(s===y.length||r===C.length)for(s=y.length-1,r=C.length-1;1<=s&&0<=r&&y[s]!==C[r];)r--;for(;1<=s&&0<=r;s--,r--)if(y[s]!==C[r]){if(s!==1||r!==1)do if(s--,r--,0>r||y[s]!==C[r]){var D=`
`+y[s].replace(" at new "," at ");return e.displayName&&D.includes("<anonymous>")&&(D=D.replace("<anonymous>",e.displayName)),D}while(1<=s&&0<=r);break}}}finally{ps=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?Fi(n):""}function Sc(e){switch(e.tag){case 26:case 27:case 5:return Fi(e.type);case 16:return Fi("Lazy");case 13:return Fi("Suspense");case 19:return Fi("SuspenseList");case 0:case 15:return ms(e.type,!1);case 11:return ms(e.type.render,!1);case 1:return ms(e.type,!0);case 31:return Fi("Activity");default:return""}}function yl(e){try{var t="";do t+=Sc(e),e=e.return;while(e);return t}catch(n){return`
Error generating stack: `+n.message+`
`+n.stack}}function on(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function Lr(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Oc(e){var t=Lr(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),s=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,c=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(d){s=""+d,c.call(this,d)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(d){s=""+d},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ys(e){e._valueTracker||(e._valueTracker=Oc(e))}function Tn(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),s="";return e&&(s=Lr(e)?e.checked?"true":"false":e.value),e=s,e!==n?(t.setValue(e),!0):!1}function $i(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}var ea=/[\n"\\]/g;function cn(e){return e.replace(ea,function(t){return"\\"+t.charCodeAt(0).toString(16)+" "})}function vl(e,t,n,s,r,c,d,g){e.name="",d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"?e.type=d:e.removeAttribute("type"),t!=null?d==="number"?(t===0&&e.value===""||e.value!=t)&&(e.value=""+on(t)):e.value!==""+on(t)&&(e.value=""+on(t)):d!=="submit"&&d!=="reset"||e.removeAttribute("value"),t!=null?bl(e,d,on(t)):n!=null?bl(e,d,on(n)):s!=null&&e.removeAttribute("value"),r==null&&c!=null&&(e.defaultChecked=!!c),r!=null&&(e.checked=r&&typeof r!="function"&&typeof r!="symbol"),g!=null&&typeof g!="function"&&typeof g!="symbol"&&typeof g!="boolean"?e.name=""+on(g):e.removeAttribute("name")}function vs(e,t,n,s,r,c,d,g){if(c!=null&&typeof c!="function"&&typeof c!="symbol"&&typeof c!="boolean"&&(e.type=c),t!=null||n!=null){if(!(c!=="submit"&&c!=="reset"||t!=null))return;n=n!=null?""+on(n):"",t=t!=null?""+on(t):n,g||t===e.value||(e.value=t),e.defaultValue=t}s=s??r,s=typeof s!="function"&&typeof s!="symbol"&&!!s,e.checked=g?e.checked:!!s,e.defaultChecked=!!s,d!=null&&typeof d!="function"&&typeof d!="symbol"&&typeof d!="boolean"&&(e.name=d)}function bl(e,t,n){t==="number"&&$i(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function ei(e,t,n,s){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&s&&(e[n].defaultSelected=!0)}else{for(n=""+on(n),t=null,r=0;r<e.length;r++){if(e[r].value===n){e[r].selected=!0,s&&(e[r].defaultSelected=!0);return}t!==null||e[r].disabled||(t=e[r])}t!==null&&(t.selected=!0)}}function Br(e,t,n){if(t!=null&&(t=""+on(t),t!==e.value&&(e.value=t),n==null)){e.defaultValue!==t&&(e.defaultValue=t);return}e.defaultValue=n!=null?""+on(n):""}function Et(e,t,n,s){if(t==null){if(s!=null){if(n!=null)throw Error(A(92));if(de(s)){if(1<s.length)throw Error(A(93));s=s[0]}n=s}n==null&&(n=""),t=n}n=on(t),e.defaultValue=n,s=e.textContent,s===n&&s!==""&&s!==null&&(e.value=s)}function ue(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var zr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pt(e,t,n){var s=t.indexOf("--")===0;n==null||typeof n=="boolean"||n===""?s?e.setProperty(t,""):t==="float"?e.cssFloat="":e[t]="":s?e.setProperty(t,n):typeof n!="number"||n===0||zr.has(t)?t==="float"?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function jr(e,t,n){if(t!=null&&typeof t!="object")throw Error(A(62));if(e=e.style,n!=null){for(var s in n)!n.hasOwnProperty(s)||t!=null&&t.hasOwnProperty(s)||(s.indexOf("--")===0?e.setProperty(s,""):s==="float"?e.cssFloat="":e[s]="");for(var r in t)s=t[r],t.hasOwnProperty(r)&&n[r]!==s&&Pt(e,r,s)}else for(var c in t)t.hasOwnProperty(c)&&Pt(e,c,t[c])}function bs(e){if(e.indexOf("-")===-1)return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ac=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),qr=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ss(e){return qr.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}var Os=null;function Ga(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Ai=null,ti=null;function Sl(e){var t=bi(e);if(t&&(e=t.stateNode)){var n=e[Yt]||null;e:switch(e=t.stateNode,t.type){case"input":if(vl(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+cn(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var s=n[t];if(s!==e&&s.form===e.form){var r=s[Yt]||null;if(!r)throw Error(A(90));vl(s,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)s=n[t],s.form===e.form&&Tn(s)}break e;case"textarea":Br(e,n.value,n.defaultValue);break e;case"select":t=n.value,t!=null&&ei(e,!!n.multiple,t,!1)}}}var Va=!1;function Ol(e,t,n){if(Va)return e(t,n);Va=!0;try{var s=e(t);return s}finally{if(Va=!1,(Ai!==null||ti!==null)&&(Ko(),Ai&&(t=Ai,e=ti,ti=Ai=null,Sl(t),e)))for(t=0;t<e.length;t++)Sl(e[t])}}function ni(e,t){var n=e.stateNode;if(n===null)return null;var s=n[Yt]||null;if(s===null)return null;n=s[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(e=e.type,s=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!s;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(A(231,t,typeof n));return n}var un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ii=!1;if(un)try{var Cn={};Object.defineProperty(Cn,"passive",{get:function(){ii=!0}}),window.addEventListener("test",Cn,Cn),window.removeEventListener("test",Cn,Cn)}catch{ii=!1}var zn=null,As=null,Rs=null;function Ri(){if(Rs)return Rs;var e,t=As,n=t.length,s,r="value"in zn?zn.value:zn.textContent,c=r.length;for(e=0;e<n&&t[e]===r[e];e++);var d=n-e;for(s=1;s<=d&&t[n-s]===r[c-s];s++);return Rs=r.slice(e,1<s?1-s:void 0)}function Ia(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Ts(){return!0}function Hr(){return!1}function Wt(e){function t(n,s,r,c,d){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=c,this.target=d,this.currentTarget=null;for(var g in e)e.hasOwnProperty(g)&&(n=e[g],this[g]=n?n(c):c[g]);return this.isDefaultPrevented=(c.defaultPrevented!=null?c.defaultPrevented:c.returnValue===!1)?Ts:Hr,this.isPropagationStopped=Hr,this}return te(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ts)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ts)},persist:function(){},isPersistent:Ts}),t}var lt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Cs=Wt(lt),Ya=te({},lt,{view:0,detail:0}),Rc=Wt(Ya),Al,_s,Pa,nn=te({},Ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_n,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Pa&&(Pa&&e.type==="mousemove"?(Al=e.screenX-Pa.screenX,_s=e.screenY-Pa.screenY):_s=Al=0,Pa=e),Al)},movementY:function(e){return"movementY"in e?e.movementY:_s}}),Rl=Wt(nn),Tc=te({},nn,{dataTransfer:0}),Es=Wt(Tc),Cc=te({},Ya,{relatedTarget:0}),Tl=Wt(Cc),_c=te({},lt,{animationName:0,elapsedTime:0,pseudoElement:0}),Ec=Wt(_c),Mc=te({},lt,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Gr=Wt(Mc),Vr=te({},lt,{data:0}),Ir=Wt(Vr),wc={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Yr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Pr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Xa(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Pr[e])?!!t[e]:!1}function _n(){return Xa}var xc=te({},Ya,{key:function(e){if(e.key){var t=wc[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ia(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Yr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_n,charCode:function(e){return e.type==="keypress"?Ia(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ia(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Nc=Wt(xc),Xr=te({},nn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Qr=Wt(Xr),Uc=te({},Ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_n}),Zr=Wt(Uc),kc=te({},lt,{propertyName:0,elapsedTime:0,pseudoElement:0}),Dc=Wt(kc),Lc=te({},nn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Kr=Wt(Lc),Bc=te({},lt,{newState:0,oldState:0}),Cl=Wt(Bc),Jr=[9,13,27,32],Ti=un&&"CompositionEvent"in window,fn=null;un&&"documentMode"in document&&(fn=document.documentMode);var zc=un&&"TextEvent"in window&&!fn,Wr=un&&(!Ti||fn&&8<fn&&11>=fn),Fr=" ",$r=!1;function eo(e,t){switch(e){case"keyup":return Jr.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function to(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Ci=!1;function jc(e,t){switch(e){case"compositionend":return to(t);case"keypress":return t.which!==32?null:($r=!0,Fr);case"textInput":return e=t.data,e===Fr&&$r?null:e;default:return null}}function no(e,t){if(Ci)return e==="compositionend"||!Ti&&eo(e,t)?(e=Ri(),Rs=As=zn=null,Ci=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Wr&&t.locale!=="ko"?null:t.data;default:return null}}var qc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function io(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!qc[e.type]:t==="textarea"}function _l(e,t,n,s){Ai?ti?ti.push(s):ti=[s]:Ai=s,t=tc(t,"onChange"),0<t.length&&(n=new Cs("onChange","change",null,n,s),e.push({event:n,listeners:t}))}var ta=null,na=null;function ao(e){td(e,0)}function Qa(e){var t=Fn(e);if(Tn(t))return e}function so(e,t){if(e==="change")return t}var lo=!1;if(un){var El;if(un){var Ms="oninput"in document;if(!Ms){var _i=document.createElement("div");_i.setAttribute("oninput","return;"),Ms=typeof _i.oninput=="function"}El=Ms}else El=!1;lo=El&&(!document.documentMode||9<document.documentMode)}function ia(){ta&&(ta.detachEvent("onpropertychange",Ml),na=ta=null)}function Ml(e){if(e.propertyName==="value"&&Qa(na)){var t=[];_l(t,na,e,Ga(e)),Ol(ao,t)}}function ro(e,t,n){e==="focusin"?(ia(),ta=t,na=n,ta.attachEvent("onpropertychange",Ml)):e==="focusout"&&ia()}function oo(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Qa(na)}function co(e,t){if(e==="click")return Qa(t)}function Hc(e,t){if(e==="input"||e==="change")return Qa(t)}function wl(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var an=typeof Object.is=="function"?Object.is:wl;function ai(e,t){if(an(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),s=Object.keys(t);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!tn.call(t,r)||!an(e[r],t[r]))return!1}return!0}function uo(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ws(e,t){var n=uo(e);e=0;for(var s;n;){if(n.nodeType===3){if(s=e+n.textContent.length,e<=t&&s>=t)return{node:n,offset:t-e};e=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=uo(n)}}function xl(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?xl(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ft(e){e=e!=null&&e.ownerDocument!=null&&e.ownerDocument.defaultView!=null?e.ownerDocument.defaultView:window;for(var t=$i(e.document);t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=$i(e.document)}return t}function Za(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}var Nl=un&&"documentMode"in document&&11>=document.documentMode,aa=null,Ul=null,Ei=null,xs=!1;function fo(e,t,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;xs||aa==null||aa!==$i(s)||(s=aa,"selectionStart"in s&&Za(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Ei&&ai(Ei,s)||(Ei=s,s=tc(Ul,"onSelect"),0<s.length&&(t=new Cs("onSelect","select",null,t,n),e.push({event:t,listeners:s}),t.target=aa)))}function Mi(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var wi={animationend:Mi("Animation","AnimationEnd"),animationiteration:Mi("Animation","AnimationIteration"),animationstart:Mi("Animation","AnimationStart"),transitionrun:Mi("Transition","TransitionRun"),transitionstart:Mi("Transition","TransitionStart"),transitioncancel:Mi("Transition","TransitionCancel"),transitionend:Mi("Transition","TransitionEnd")},xi={},ho={};un&&(ho=document.createElement("div").style,"AnimationEvent"in window||(delete wi.animationend.animation,delete wi.animationiteration.animation,delete wi.animationstart.animation),"TransitionEvent"in window||delete wi.transitionend.transition);function si(e){if(xi[e])return xi[e];if(!wi[e])return e;var t=wi[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ho)return xi[e]=t[n];return e}var li=si("animationend"),Ns=si("animationiteration"),go=si("animationstart"),po=si("transitionrun"),mo=si("transitionstart"),Gc=si("transitioncancel"),yo=si("transitionend"),vo=new Map,sa="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");sa.push("scrollEnd");function Nt(e,t){vo.set(e,t),Si(t,[e])}var bo=new WeakMap;function hn(e,t){if(typeof e=="object"&&e!==null){var n=bo.get(e);return n!==void 0?n:(t={value:e,source:t,stack:yl(t)},bo.set(e,t),t)}return{value:e,source:t,stack:yl(t)}}var Ut=[],la=0,kl=0;function Us(){for(var e=la,t=kl=la=0;t<e;){var n=Ut[t];Ut[t++]=null;var s=Ut[t];Ut[t++]=null;var r=Ut[t];Ut[t++]=null;var c=Ut[t];if(Ut[t++]=null,s!==null&&r!==null){var d=s.pending;d===null?r.next=r:(r.next=d.next,d.next=r),s.pending=r}c!==0&&ks(n,r,c)}}function jn(e,t,n,s){Ut[la++]=e,Ut[la++]=t,Ut[la++]=n,Ut[la++]=s,kl|=s,e.lanes|=s,e=e.alternate,e!==null&&(e.lanes|=s)}function qt(e,t,n,s){return jn(e,t,n,s),ri(e)}function ra(e,t){return jn(e,null,null,t),ri(e)}function ks(e,t,n){e.lanes|=n;var s=e.alternate;s!==null&&(s.lanes|=n);for(var r=!1,c=e.return;c!==null;)c.childLanes|=n,s=c.alternate,s!==null&&(s.childLanes|=n),c.tag===22&&(e=c.stateNode,e===null||e._visibility&1||(r=!0)),e=c,c=c.return;return e.tag===3?(c=e.stateNode,r&&t!==null&&(r=31-dt(n),e=c.hiddenUpdates,s=e[r],s===null?e[r]=[t]:s.push(t),t.lane=n|536870912),c):null}function ri(e){if(50<cr)throw cr=0,Ou=null,Error(A(185));for(var t=e.return;t!==null;)e=t,t=e.return;return e.tag===3?e.stateNode:null}var Ni={};function Dl(e,t,n,s){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(e,t,n,s){return new Dl(e,t,n,s)}function Ka(e){return e=e.prototype,!(!e||!e.isReactComponent)}function qn(e,t){var n=e.alternate;return n===null?(n=sn(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&65011712,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function So(e,t){e.flags&=65011714;var n=e.alternate;return n===null?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function Ja(e,t,n,s,r,c){var d=0;if(s=e,typeof e=="function")Ka(e)&&(d=1);else if(typeof e=="string")d=Pg(e,n,se.current)?26:e==="html"||e==="head"||e==="body"?27:5;else e:switch(e){case Ie:return e=sn(31,n,t,r),e.elementType=Ie,e.lanes=c,e;case Ce:return Ui(n.children,r,c,t);case Fe:d=8,r|=24;break;case P:return e=sn(12,n,t,r|2),e.elementType=P,e.lanes=c,e;case he:return e=sn(13,n,t,r),e.elementType=he,e.lanes=c,e;case Ae:return e=sn(19,n,t,r),e.elementType=Ae,e.lanes=c,e;default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case Ge:case Ke:d=10;break e;case mt:d=9;break e;case x:d=11;break e;case yt:d=14;break e;case vt:d=16,s=null;break e}d=29,n=Error(A(130,e===null?"null":typeof e,"")),s=null}return t=sn(d,n,t,r),t.elementType=e,t.type=s,t.lanes=c,t}function Ui(e,t,n,s){return e=sn(7,e,s,t),e.lanes=n,e}function Ll(e,t,n){return e=sn(6,e,null,t),e.lanes=n,e}function Ds(e,t,n){return t=sn(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var oa=[],ca=0,Ls=null,Bs=0,$t=[],dn=0,Hn=null,Gn=1,Vn="";function ki(e,t){oa[ca++]=Bs,oa[ca++]=Ls,Ls=e,Bs=t}function Oo(e,t,n){$t[dn++]=Gn,$t[dn++]=Vn,$t[dn++]=Hn,Hn=e;var s=Gn;e=Vn;var r=32-dt(s)-1;s&=~(1<<r),n+=1;var c=32-dt(t)+r;if(30<c){var d=r-r%5;c=(s&(1<<d)-1).toString(32),s>>=d,r-=d,Gn=1<<32-dt(t)+r|n<<r|s,Vn=c+e}else Gn=1<<c|n<<r|s,Vn=e}function Bl(e){e.return!==null&&(ki(e,1),Oo(e,1,0))}function zl(e){for(;e===Ls;)Ls=oa[--ca],oa[ca]=null,Bs=oa[--ca],oa[ca]=null;for(;e===Hn;)Hn=$t[--dn],$t[dn]=null,Vn=$t[--dn],$t[dn]=null,Gn=$t[--dn],$t[dn]=null}var Ht=null,St=null,Ee=!1,In=null,gn=!1,Di=Error(A(519));function Yn(e){var t=Error(A(418,""));throw Xn(hn(t,e)),Di}function jl(e){var t=e.stateNode,n=e.type,s=e.memoizedProps;switch(t[Dt]=e,t[Yt]=s,n){case"dialog":qe("cancel",t),qe("close",t);break;case"iframe":case"object":case"embed":qe("load",t);break;case"video":case"audio":for(n=0;n<fr.length;n++)qe(fr[n],t);break;case"source":qe("error",t);break;case"img":case"image":case"link":qe("error",t),qe("load",t);break;case"details":qe("toggle",t);break;case"input":qe("invalid",t),vs(t,s.value,s.defaultValue,s.checked,s.defaultChecked,s.type,s.name,!0),ys(t);break;case"select":qe("invalid",t);break;case"textarea":qe("invalid",t),Et(t,s.value,s.defaultValue,s.children),ys(t)}n=s.children,typeof n!="string"&&typeof n!="number"&&typeof n!="bigint"||t.textContent===""+n||s.suppressHydrationWarning===!0||sd(t.textContent,n)?(s.popover!=null&&(qe("beforetoggle",t),qe("toggle",t)),s.onScroll!=null&&qe("scroll",t),s.onScrollEnd!=null&&qe("scrollend",t),s.onClick!=null&&(t.onclick=nc),t=!0):t=!1,t||Yn(e)}function ql(e){for(Ht=e.return;Ht;)switch(Ht.tag){case 5:case 13:gn=!1;return;case 27:case 3:gn=!0;return;default:Ht=Ht.return}}function Pn(e){if(e!==Ht)return!1;if(!Ee)return ql(e),Ee=!0,!1;var t=e.tag,n;if((n=t!==3&&t!==27)&&((n=t===5)&&(n=e.type,n=!(n!=="form"&&n!=="button")||zu(e.type,e.memoizedProps)),n=!n),n&&St&&Yn(e),ql(e),t===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(A(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8)if(n=e.data,n==="/$"){if(t===0){St=Jn(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++;e=e.nextSibling}St=null}}else t===27?(t=St,xa(e.type)?(e=Gu,Gu=null,St=e):St=t):St=Ht?Jn(e.stateNode.nextSibling):null;return!0}function ua(){St=Ht=null,Ee=!1}function fa(){var e=In;return e!==null&&(yn===null?yn=e:yn.push.apply(yn,e),In=null),e}function Xn(e){In===null?In=[e]:In.push(e)}var Wa=H(null),En=null,Qn=null;function Mn(e,t,n){K(Wa,t._currentValue),t._currentValue=n}function kt(e){e._currentValue=Wa.current,I(Wa)}function ha(e,t,n){for(;e!==null;){var s=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,s!==null&&(s.childLanes|=t)):s!==null&&(s.childLanes&t)!==t&&(s.childLanes|=t),e===n)break;e=e.return}}function Hl(e,t,n,s){var r=e.child;for(r!==null&&(r.return=e);r!==null;){var c=r.dependencies;if(c!==null){var d=r.child;c=c.firstContext;e:for(;c!==null;){var g=c;c=r;for(var y=0;y<t.length;y++)if(g.context===t[y]){c.lanes|=n,g=c.alternate,g!==null&&(g.lanes|=n),ha(c.return,n,e),s||(d=null);break e}c=g.next}}else if(r.tag===18){if(d=r.return,d===null)throw Error(A(341));d.lanes|=n,c=d.alternate,c!==null&&(c.lanes|=n),ha(d,n,e),d=null}else d=r.child;if(d!==null)d.return=r;else for(d=r;d!==null;){if(d===e){d=null;break}if(r=d.sibling,r!==null){r.return=d.return,d=r;break}d=d.return}r=d}}function Fa(e,t,n,s){e=null;for(var r=t,c=!1;r!==null;){if(!c){if((r.flags&524288)!==0)c=!0;else if((r.flags&262144)!==0)break}if(r.tag===10){var d=r.alternate;if(d===null)throw Error(A(387));if(d=d.memoizedProps,d!==null){var g=r.type;an(r.pendingProps.value,d.value)||(e!==null?e.push(g):e=[g])}}else if(r===et.current){if(d=r.alternate,d===null)throw Error(A(387));d.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(e!==null?e.push(yr):e=[yr])}r=r.return}e!==null&&Hl(t,e,n,s),t.flags|=262144}function $a(e){for(e=e.firstContext;e!==null;){if(!an(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Li(e){En=e,Qn=null,e=e.dependencies,e!==null&&(e.firstContext=null)}function Lt(e){return Gl(En,e)}function pn(e,t){return En===null&&Li(e),Gl(e,t)}function Gl(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},Qn===null){if(e===null)throw Error(A(308));Qn=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Qn=Qn.next=t;return n}var es=typeof AbortController<"u"?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(n,s){e.push(s)}};this.abort=function(){t.aborted=!0,e.forEach(function(n){return n()})}},Ao=k.unstable_scheduleCallback,Ro=k.unstable_NormalPriority,ut={$$typeof:Ke,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function oi(){return{controller:new es,data:new Map,refCount:0}}function ts(e){e.refCount--,e.refCount===0&&Ao(Ro,function(){e.controller.abort()})}var da=null,gt=0,ga=0,pa=null;function Vc(e,t){if(da===null){var n=da=[];gt=0,ga=Mu(),pa={status:"pending",value:void 0,then:function(s){n.push(s)}}}return gt++,t.then(To,To),t}function To(){if(--gt===0&&da!==null){pa!==null&&(pa.status="fulfilled");var e=da;da=null,ga=0,pa=null;for(var t=0;t<e.length;t++)(0,e[t])()}}function Ic(e,t){var n=[],s={status:"pending",value:null,reason:null,then:function(r){n.push(r)}};return e.then(function(){s.status="fulfilled",s.value=t;for(var r=0;r<n.length;r++)(0,n[r])(t)},function(r){for(s.status="rejected",s.reason=r,r=0;r<n.length;r++)(0,n[r])(void 0)}),s}var Co=N.S;N.S=function(e,t){typeof t=="object"&&t!==null&&typeof t.then=="function"&&Vc(e,t),Co!==null&&Co(e,t)};var ci=H(null);function Vl(){var e=ci.current;return e!==null?e:ft.pooledCache}function ma(e,t){t===null?K(ci,ci.current):K(ci,t.pool)}function _o(){var e=Vl();return e===null?null:{parent:ut._currentValue,pool:e}}var ns=Error(A(460)),Eo=Error(A(474)),zs=Error(A(542)),Il={then:function(){}};function Mo(e){return e=e.status,e==="fulfilled"||e==="rejected"}function is(){}function wo(e,t,n){switch(n=e[n],n===void 0?e.push(t):n!==t&&(t.then(is,is),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,No(e),e;default:if(typeof t.status=="string")t.then(is,is);else{if(e=ft,e!==null&&100<e.shellSuspendCounter)throw Error(A(482));e=t,e.status="pending",e.then(function(s){if(t.status==="pending"){var r=t;r.status="fulfilled",r.value=s}},function(s){if(t.status==="pending"){var r=t;r.status="rejected",r.reason=s}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw e=t.reason,No(e),e}throw as=t,ns}}var as=null;function xo(){if(as===null)throw Error(A(459));var e=as;return as=null,e}function No(e){if(e===ns||e===zs)throw Error(A(483))}var Zn=!1;function js(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Yl(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function ui(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function fi(e,t,n){var s=e.updateQueue;if(s===null)return null;if(s=s.shared,(it&2)!==0){var r=s.pending;return r===null?t.next=t:(t.next=r.next,r.next=t),s.pending=t,t=ri(e),ks(e,null,n),t}return jn(e,s,t,n),ri(e)}function ss(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194048)!==0)){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,rn(e,n)}}function Pl(e,t){var n=e.updateQueue,s=e.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,c=null;if(n=n.firstBaseUpdate,n!==null){do{var d={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};c===null?r=c=d:c=c.next=d,n=n.next}while(n!==null);c===null?r=c=t:c=c.next=t}else r=c=t;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:c,shared:s.shared,callbacks:s.callbacks},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Xl=!1;function ls(){if(Xl){var e=pa;if(e!==null)throw e}}function rs(e,t,n,s){Xl=!1;var r=e.updateQueue;Zn=!1;var c=r.firstBaseUpdate,d=r.lastBaseUpdate,g=r.shared.pending;if(g!==null){r.shared.pending=null;var y=g,C=y.next;y.next=null,d===null?c=C:d.next=C,d=y;var D=e.alternate;D!==null&&(D=D.updateQueue,g=D.lastBaseUpdate,g!==d&&(g===null?D.firstBaseUpdate=C:g.next=C,D.lastBaseUpdate=y))}if(c!==null){var G=r.baseState;d=0,D=C=y=null,g=c;do{var E=g.lane&-536870913,M=E!==g.lane;if(M?(Pe&E)===E:(s&E)===E){E!==0&&E===ga&&(Xl=!0),D!==null&&(D=D.next={lane:0,tag:g.tag,payload:g.payload,callback:null,next:null});e:{var Oe=e,me=g;E=t;var ot=n;switch(me.tag){case 1:if(Oe=me.payload,typeof Oe=="function"){G=Oe.call(ot,G,E);break e}G=Oe;break e;case 3:Oe.flags=Oe.flags&-65537|128;case 0:if(Oe=me.payload,E=typeof Oe=="function"?Oe.call(ot,G,E):Oe,E==null)break e;G=te({},G,E);break e;case 2:Zn=!0}}E=g.callback,E!==null&&(e.flags|=64,M&&(e.flags|=8192),M=r.callbacks,M===null?r.callbacks=[E]:M.push(E))}else M={lane:E,tag:g.tag,payload:g.payload,callback:g.callback,next:null},D===null?(C=D=M,y=G):D=D.next=M,d|=E;if(g=g.next,g===null){if(g=r.shared.pending,g===null)break;M=g,g=M.next,M.next=null,r.lastBaseUpdate=M,r.shared.pending=null}}while(!0);D===null&&(y=G),r.baseState=y,r.firstBaseUpdate=C,r.lastBaseUpdate=D,c===null&&(r.shared.lanes=0),_a|=d,e.lanes=d,e.memoizedState=G}}function ya(e,t){if(typeof e!="function")throw Error(A(191,e));e.call(t)}function Ql(e,t){var n=e.callbacks;if(n!==null)for(e.callbacks=null,e=0;e<n.length;e++)ya(n[e],t)}var hi=H(null),qs=H(0);function Hs(e,t){e=Yi,K(qs,e),K(hi,t),Yi=e|t.baseLanes}function Gs(){K(qs,Yi),K(hi,hi.current)}function Zl(){Yi=qs.current,I(hi),I(qs)}var di=0,xe=null,tt=null,Tt=null,Vs=!1,Bi=!1,vn=!1,gi=0,zi=0,va=null,Yc=0;function At(){throw Error(A(321))}function Kl(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!an(e[n],t[n]))return!1;return!0}function Jl(e,t,n,s,r,c){return di=c,xe=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,N.H=e===null||e.memoizedState===null?qf:Hf,vn=!1,c=n(s,r),vn=!1,Bi&&(c=Uo(t,n,s,r)),Wl(e),c}function Wl(e){N.H=Bo;var t=tt!==null&&tt.next!==null;if(di=0,Tt=tt=xe=null,Vs=!1,zi=0,va=null,t)throw Error(A(300));e===null||Gt||(e=e.dependencies,e!==null&&$a(e)&&(Gt=!0))}function Uo(e,t,n,s){xe=e;var r=0;do{if(Bi&&(va=null),zi=0,Bi=!1,25<=r)throw Error(A(301));if(r+=1,Tt=tt=null,e.updateQueue!=null){var c=e.updateQueue;c.lastEffect=null,c.events=null,c.stores=null,c.memoCache!=null&&(c.memoCache.index=0)}N.H=ng,c=t(n,s)}while(Bi);return c}function Pc(){var e=N.H,t=e.useState()[0];return t=typeof t.then=="function"?p(t):t,e=e.useState()[0],(tt!==null?tt.memoizedState:null)!==e&&(xe.flags|=1024),t}function i(){var e=gi!==0;return gi=0,e}function a(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function l(e){if(Vs){for(e=e.memoizedState;e!==null;){var t=e.queue;t!==null&&(t.pending=null),e=e.next}Vs=!1}di=0,Tt=tt=xe=null,Bi=!1,zi=gi=0,va=null}function o(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tt===null?xe.memoizedState=Tt=e:Tt=Tt.next=e,Tt}function u(){if(tt===null){var e=xe.alternate;e=e!==null?e.memoizedState:null}else e=tt.next;var t=Tt===null?xe.memoizedState:Tt.next;if(t!==null)Tt=t,tt=e;else{if(e===null)throw xe.alternate===null?Error(A(467)):Error(A(310));tt=e,e={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},Tt===null?xe.memoizedState=Tt=e:Tt=Tt.next=e}return Tt}function f(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function p(e){var t=zi;return zi+=1,va===null&&(va=[]),e=wo(va,e,t),t=xe,(Tt===null?t.memoizedState:Tt.next)===null&&(t=t.alternate,N.H=t===null||t.memoizedState===null?qf:Hf),e}function m(e){if(e!==null&&typeof e=="object"){if(typeof e.then=="function")return p(e);if(e.$$typeof===Ke)return Lt(e)}throw Error(A(438,String(e)))}function T(e){var t=null,n=xe.updateQueue;if(n!==null&&(t=n.memoCache),t==null){var s=xe.alternate;s!==null&&(s=s.updateQueue,s!==null&&(s=s.memoCache,s!=null&&(t={data:s.data.map(function(r){return r.slice()}),index:0})))}if(t==null&&(t={data:[],index:0}),n===null&&(n=f(),xe.updateQueue=n),n.memoCache=t,n=t.data[t.index],n===void 0)for(n=t.data[t.index]=Array(e),s=0;s<e;s++)n[s]=_t;return t.index++,n}function S(e,t){return typeof t=="function"?t(e):t}function B(e){var t=u();return z(t,tt,e)}function z(e,t,n){var s=e.queue;if(s===null)throw Error(A(311));s.lastRenderedReducer=n;var r=e.baseQueue,c=s.pending;if(c!==null){if(r!==null){var d=r.next;r.next=c.next,c.next=d}t.baseQueue=r=c,s.pending=null}if(c=e.baseState,r===null)e.memoizedState=c;else{t=r.next;var g=d=null,y=null,C=t,D=!1;do{var G=C.lane&-536870913;if(G!==C.lane?(Pe&G)===G:(di&G)===G){var E=C.revertLane;if(E===0)y!==null&&(y=y.next={lane:0,revertLane:0,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null}),G===ga&&(D=!0);else if((di&E)===E){C=C.next,E===ga&&(D=!0);continue}else G={lane:0,revertLane:C.revertLane,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null},y===null?(g=y=G,d=c):y=y.next=G,xe.lanes|=E,_a|=E;G=C.action,vn&&n(c,G),c=C.hasEagerState?C.eagerState:n(c,G)}else E={lane:G,revertLane:C.revertLane,action:C.action,hasEagerState:C.hasEagerState,eagerState:C.eagerState,next:null},y===null?(g=y=E,d=c):y=y.next=E,xe.lanes|=G,_a|=G;C=C.next}while(C!==null&&C!==t);if(y===null?d=c:y.next=g,!an(c,e.memoizedState)&&(Gt=!0,D&&(n=pa,n!==null)))throw n;e.memoizedState=c,e.baseState=d,e.baseQueue=y,s.lastRenderedState=c}return r===null&&(s.lanes=0),[e.memoizedState,s.dispatch]}function Q(e){var t=u(),n=t.queue;if(n===null)throw Error(A(311));n.lastRenderedReducer=e;var s=n.dispatch,r=n.pending,c=t.memoizedState;if(r!==null){n.pending=null;var d=r=r.next;do c=e(c,d.action),d=d.next;while(d!==r);an(c,t.memoizedState)||(Gt=!0),t.memoizedState=c,t.baseQueue===null&&(t.baseState=c),n.lastRenderedState=c}return[c,s]}function j(e,t,n){var s=xe,r=u(),c=Ee;if(c){if(n===void 0)throw Error(A(407));n=n()}else n=t();var d=!an((tt||r).memoizedState,n);d&&(r.memoizedState=n,Gt=!0),r=r.queue;var g=ge.bind(null,s,r,e);if(Fl(2048,8,g,[e]),r.getSnapshot!==t||d||Tt!==null&&Tt.memoizedState.tag&1){if(s.flags|=2048,Is(9,ko(),$.bind(null,s,r,n,t),null),ft===null)throw Error(A(349));c||(di&124)!==0||F(s,t,n)}return n}function F(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=xe.updateQueue,t===null?(t=f(),xe.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function $(e,t,n,s){t.value=n,t.getSnapshot=s,Ve(t)&&$e(e)}function ge(e,t,n){return n(function(){Ve(t)&&$e(e)})}function Ve(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!an(e,n)}catch{return!0}}function $e(e){var t=ra(e,2);t!==null&&Rn(t,e,2)}function nt(e){var t=o();if(typeof e=="function"){var n=e;if(e=n(),vn){Je(!0);try{n()}finally{Je(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:e},t}function Se(e,t,n,s){return e.baseState=n,z(e,tt,typeof s=="function"?s:S)}function ln(e,t,n,s,r){if(Lo(e))throw Error(A(485));if(e=t.action,e!==null){var c={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(d){c.listeners.push(d)}};N.T!==null?n(!0):c.isTransition=!1,s(c),n=t.pending,n===null?(c.next=t.pending=c,Bt(t,c)):(c.next=n.next,t.pending=n.next=c)}}function Bt(e,t){var n=t.action,s=t.payload,r=e.state;if(t.isTransition){var c=N.T,d={};N.T=d;try{var g=n(r,s),y=N.S;y!==null&&y(d,g),ba(e,t,g)}catch(C){os(e,t,C)}finally{N.T=c}}else try{c=n(r,s),ba(e,t,c)}catch(C){os(e,t,C)}}function ba(e,t,n){n!==null&&typeof n=="object"&&typeof n.then=="function"?n.then(function(s){ji(e,t,s)},function(s){return os(e,t,s)}):ji(e,t,n)}function ji(e,t,n){t.status="fulfilled",t.value=n,pf(t),e.state=n,t=e.pending,t!==null&&(n=t.next,n===t?e.pending=null:(n=n.next,t.next=n,Bt(e,n)))}function os(e,t,n){var s=e.pending;if(e.pending=null,s!==null){s=s.next;do t.status="rejected",t.reason=n,pf(t),t=t.next;while(t!==s)}e.action=null}function pf(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function mf(e,t){return t}function yf(e,t){if(Ee){var n=ft.formState;if(n!==null){e:{var s=xe;if(Ee){if(St){t:{for(var r=St,c=gn;r.nodeType!==8;){if(!c){r=null;break t}if(r=Jn(r.nextSibling),r===null){r=null;break t}}c=r.data,r=c==="F!"||c==="F"?r:null}if(r){St=Jn(r.nextSibling),s=r.data==="F!";break e}}Yn(s)}s=!1}s&&(t=n[0])}}return n=o(),n.memoizedState=n.baseState=t,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:mf,lastRenderedState:t},n.queue=s,n=Bf.bind(null,xe,s),s.dispatch=n,s=nt(!1),c=Jc.bind(null,xe,!1,s.queue),s=o(),r={state:t,dispatch:null,action:e,pending:null},s.queue=r,n=ln.bind(null,xe,r,c,n),r.dispatch=n,s.memoizedState=e,[t,n,!1]}function vf(e){var t=u();return bf(t,tt,e)}function bf(e,t,n){if(t=z(e,t,mf)[0],e=B(S)[0],typeof t=="object"&&t!==null&&typeof t.then=="function")try{var s=p(t)}catch(d){throw d===ns?zs:d}else s=t;t=u();var r=t.queue,c=r.dispatch;return n!==t.memoizedState&&(xe.flags|=2048,Is(9,ko(),Fd.bind(null,r,n),null)),[s,c,e]}function Fd(e,t){e.action=t}function Sf(e){var t=u(),n=tt;if(n!==null)return bf(t,n,e);u(),t=t.memoizedState,n=u();var s=n.queue.dispatch;return n.memoizedState=e,[t,s,!1]}function Is(e,t,n,s){return e={tag:e,create:n,deps:s,inst:t,next:null},t=xe.updateQueue,t===null&&(t=f(),xe.updateQueue=t),n=t.lastEffect,n===null?t.lastEffect=e.next=e:(s=n.next,n.next=e,e.next=s,t.lastEffect=e),e}function ko(){return{destroy:void 0,resource:void 0}}function Of(){return u().memoizedState}function Do(e,t,n,s){var r=o();s=s===void 0?null:s,xe.flags|=e,r.memoizedState=Is(1|t,ko(),n,s)}function Fl(e,t,n,s){var r=u();s=s===void 0?null:s;var c=r.memoizedState.inst;tt!==null&&s!==null&&Kl(s,tt.memoizedState.deps)?r.memoizedState=Is(t,c,n,s):(xe.flags|=e,r.memoizedState=Is(1|t,c,n,s))}function Af(e,t){Do(8390656,8,e,t)}function Rf(e,t){Fl(2048,8,e,t)}function Tf(e,t){return Fl(4,2,e,t)}function Cf(e,t){return Fl(4,4,e,t)}function _f(e,t){if(typeof t=="function"){e=e();var n=t(e);return function(){typeof n=="function"?n():t(null)}}if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Ef(e,t,n){n=n!=null?n.concat([e]):null,Fl(4,4,_f.bind(null,t,e),n)}function Xc(){}function Mf(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;return t!==null&&Kl(t,s[1])?s[0]:(n.memoizedState=[e,t],e)}function wf(e,t){var n=u();t=t===void 0?null:t;var s=n.memoizedState;if(t!==null&&Kl(t,s[1]))return s[0];if(s=e(),vn){Je(!0);try{e()}finally{Je(!1)}}return n.memoizedState=[s,t],s}function Qc(e,t,n){return n===void 0||(di&1073741824)!==0?e.memoizedState=t:(e.memoizedState=n,e=Uh(),xe.lanes|=e,_a|=e,n)}function xf(e,t,n,s){return an(n,t)?n:hi.current!==null?(e=Qc(e,n,s),an(e,t)||(Gt=!0),e):(di&42)===0?(Gt=!0,e.memoizedState=n):(e=Uh(),xe.lanes|=e,_a|=e,t)}function Nf(e,t,n,s,r){var c=U.p;U.p=c!==0&&8>c?c:8;var d=N.T,g={};N.T=g,Jc(e,!1,t,n);try{var y=r(),C=N.S;if(C!==null&&C(g,y),y!==null&&typeof y=="object"&&typeof y.then=="function"){var D=Ic(y,s);$l(e,t,D,An(e))}else $l(e,t,s,An(e))}catch(G){$l(e,t,{then:function(){},status:"rejected",reason:G},An())}finally{U.p=c,N.T=d}}function $d(){}function Zc(e,t,n,s){if(e.tag!==5)throw Error(A(476));var r=Uf(e).queue;Nf(e,r,t,ne,n===null?$d:function(){return kf(e),n(s)})}function Uf(e){var t=e.memoizedState;if(t!==null)return t;t={memoizedState:ne,baseState:ne,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:ne},next:null};var n={};return t.next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:S,lastRenderedState:n},next:null},e.memoizedState=t,e=e.alternate,e!==null&&(e.memoizedState=t),t}function kf(e){var t=Uf(e).next.queue;$l(e,t,{},An())}function Kc(){return Lt(yr)}function Df(){return u().memoizedState}function Lf(){return u().memoizedState}function eg(e){for(var t=e.return;t!==null;){switch(t.tag){case 24:case 3:var n=An();e=ui(n);var s=fi(t,e,n);s!==null&&(Rn(s,t,n),ss(s,t,n)),t={cache:oi()},e.payload=t;return}t=t.return}}function tg(e,t,n){var s=An();n={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null},Lo(e)?zf(t,n):(n=qt(e,t,n,s),n!==null&&(Rn(n,e,s),jf(n,t,s)))}function Bf(e,t,n){var s=An();$l(e,t,n,s)}function $l(e,t,n,s){var r={lane:s,revertLane:0,action:n,hasEagerState:!1,eagerState:null,next:null};if(Lo(e))zf(t,r);else{var c=e.alternate;if(e.lanes===0&&(c===null||c.lanes===0)&&(c=t.lastRenderedReducer,c!==null))try{var d=t.lastRenderedState,g=c(d,n);if(r.hasEagerState=!0,r.eagerState=g,an(g,d))return jn(e,t,r,0),ft===null&&Us(),!1}catch{}finally{}if(n=qt(e,t,r,s),n!==null)return Rn(n,e,s),jf(n,t,s),!0}return!1}function Jc(e,t,n,s){if(s={lane:2,revertLane:Mu(),action:s,hasEagerState:!1,eagerState:null,next:null},Lo(e)){if(t)throw Error(A(479))}else t=qt(e,n,s,2),t!==null&&Rn(t,e,2)}function Lo(e){var t=e.alternate;return e===xe||t!==null&&t===xe}function zf(e,t){Bi=Vs=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function jf(e,t,n){if((n&4194048)!==0){var s=t.lanes;s&=e.pendingLanes,n|=s,t.lanes=n,rn(e,n)}}var Bo={readContext:Lt,use:m,useCallback:At,useContext:At,useEffect:At,useImperativeHandle:At,useLayoutEffect:At,useInsertionEffect:At,useMemo:At,useReducer:At,useRef:At,useState:At,useDebugValue:At,useDeferredValue:At,useTransition:At,useSyncExternalStore:At,useId:At,useHostTransitionStatus:At,useFormState:At,useActionState:At,useOptimistic:At,useMemoCache:At,useCacheRefresh:At},qf={readContext:Lt,use:m,useCallback:function(e,t){return o().memoizedState=[e,t===void 0?null:t],e},useContext:Lt,useEffect:Af,useImperativeHandle:function(e,t,n){n=n!=null?n.concat([e]):null,Do(4194308,4,_f.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Do(4194308,4,e,t)},useInsertionEffect:function(e,t){Do(4,2,e,t)},useMemo:function(e,t){var n=o();t=t===void 0?null:t;var s=e();if(vn){Je(!0);try{e()}finally{Je(!1)}}return n.memoizedState=[s,t],s},useReducer:function(e,t,n){var s=o();if(n!==void 0){var r=n(t);if(vn){Je(!0);try{n(t)}finally{Je(!1)}}}else r=t;return s.memoizedState=s.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},s.queue=e,e=e.dispatch=tg.bind(null,xe,e),[s.memoizedState,e]},useRef:function(e){var t=o();return e={current:e},t.memoizedState=e},useState:function(e){e=nt(e);var t=e.queue,n=Bf.bind(null,xe,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Xc,useDeferredValue:function(e,t){var n=o();return Qc(n,e,t)},useTransition:function(){var e=nt(!1);return e=Nf.bind(null,xe,e.queue,!0,!1),o().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var s=xe,r=o();if(Ee){if(n===void 0)throw Error(A(407));n=n()}else{if(n=t(),ft===null)throw Error(A(349));(Pe&124)!==0||F(s,t,n)}r.memoizedState=n;var c={value:n,getSnapshot:t};return r.queue=c,Af(ge.bind(null,s,c,e),[e]),s.flags|=2048,Is(9,ko(),$.bind(null,s,c,n,t),null),n},useId:function(){var e=o(),t=ft.identifierPrefix;if(Ee){var n=Vn,s=Gn;n=(s&~(1<<32-dt(s)-1)).toString(32)+n,t="«"+t+"R"+n,n=gi++,0<n&&(t+="H"+n.toString(32)),t+="»"}else n=Yc++,t="«"+t+"r"+n.toString(32)+"»";return e.memoizedState=t},useHostTransitionStatus:Kc,useFormState:yf,useActionState:yf,useOptimistic:function(e){var t=o();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=Jc.bind(null,xe,!0,n),n.dispatch=t,[e,t]},useMemoCache:T,useCacheRefresh:function(){return o().memoizedState=eg.bind(null,xe)}},Hf={readContext:Lt,use:m,useCallback:Mf,useContext:Lt,useEffect:Rf,useImperativeHandle:Ef,useInsertionEffect:Tf,useLayoutEffect:Cf,useMemo:wf,useReducer:B,useRef:Of,useState:function(){return B(S)},useDebugValue:Xc,useDeferredValue:function(e,t){var n=u();return xf(n,tt.memoizedState,e,t)},useTransition:function(){var e=B(S)[0],t=u().memoizedState;return[typeof e=="boolean"?e:p(e),t]},useSyncExternalStore:j,useId:Df,useHostTransitionStatus:Kc,useFormState:vf,useActionState:vf,useOptimistic:function(e,t){var n=u();return Se(n,tt,e,t)},useMemoCache:T,useCacheRefresh:Lf},ng={readContext:Lt,use:m,useCallback:Mf,useContext:Lt,useEffect:Rf,useImperativeHandle:Ef,useInsertionEffect:Tf,useLayoutEffect:Cf,useMemo:wf,useReducer:Q,useRef:Of,useState:function(){return Q(S)},useDebugValue:Xc,useDeferredValue:function(e,t){var n=u();return tt===null?Qc(n,e,t):xf(n,tt.memoizedState,e,t)},useTransition:function(){var e=Q(S)[0],t=u().memoizedState;return[typeof e=="boolean"?e:p(e),t]},useSyncExternalStore:j,useId:Df,useHostTransitionStatus:Kc,useFormState:Sf,useActionState:Sf,useOptimistic:function(e,t){var n=u();return tt!==null?Se(n,tt,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:T,useCacheRefresh:Lf},Ys=null,er=0;function zo(e){var t=er;return er+=1,Ys===null&&(Ys=[]),wo(Ys,e,t)}function tr(e,t){t=t.props.ref,e.ref=t!==void 0?t:null}function jo(e,t){throw t.$$typeof===ke?Error(A(525)):(e=Object.prototype.toString.call(t),Error(A(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)))}function Gf(e){var t=e._init;return t(e._payload)}function Vf(e){function t(O,b){if(e){var R=O.deletions;R===null?(O.deletions=[b],O.flags|=16):R.push(b)}}function n(O,b){if(!e)return null;for(;b!==null;)t(O,b),b=b.sibling;return null}function s(O){for(var b=new Map;O!==null;)O.key!==null?b.set(O.key,O):b.set(O.index,O),O=O.sibling;return b}function r(O,b){return O=qn(O,b),O.index=0,O.sibling=null,O}function c(O,b,R){return O.index=R,e?(R=O.alternate,R!==null?(R=R.index,R<b?(O.flags|=67108866,b):R):(O.flags|=67108866,b)):(O.flags|=1048576,b)}function d(O){return e&&O.alternate===null&&(O.flags|=67108866),O}function g(O,b,R,q){return b===null||b.tag!==6?(b=Ll(R,O.mode,q),b.return=O,b):(b=r(b,R),b.return=O,b)}function y(O,b,R,q){var ae=R.type;return ae===Ce?D(O,b,R.props.children,q,R.key):b!==null&&(b.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===vt&&Gf(ae)===b.type)?(b=r(b,R.props),tr(b,R),b.return=O,b):(b=Ja(R.type,R.key,R.props,null,O.mode,q),tr(b,R),b.return=O,b)}function C(O,b,R,q){return b===null||b.tag!==4||b.stateNode.containerInfo!==R.containerInfo||b.stateNode.implementation!==R.implementation?(b=Ds(R,O.mode,q),b.return=O,b):(b=r(b,R.children||[]),b.return=O,b)}function D(O,b,R,q,ae){return b===null||b.tag!==7?(b=Ui(R,O.mode,q,ae),b.return=O,b):(b=r(b,R),b.return=O,b)}function G(O,b,R){if(typeof b=="string"&&b!==""||typeof b=="number"||typeof b=="bigint")return b=Ll(""+b,O.mode,R),b.return=O,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case we:return R=Ja(b.type,b.key,b.props,null,O.mode,R),tr(R,b),R.return=O,R;case pe:return b=Ds(b,O.mode,R),b.return=O,b;case vt:var q=b._init;return b=q(b._payload),G(O,b,R)}if(de(b)||He(b))return b=Ui(b,O.mode,R,null),b.return=O,b;if(typeof b.then=="function")return G(O,zo(b),R);if(b.$$typeof===Ke)return G(O,pn(O,b),R);jo(O,b)}return null}function E(O,b,R,q){var ae=b!==null?b.key:null;if(typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint")return ae!==null?null:g(O,b,""+R,q);if(typeof R=="object"&&R!==null){switch(R.$$typeof){case we:return R.key===ae?y(O,b,R,q):null;case pe:return R.key===ae?C(O,b,R,q):null;case vt:return ae=R._init,R=ae(R._payload),E(O,b,R,q)}if(de(R)||He(R))return ae!==null?null:D(O,b,R,q,null);if(typeof R.then=="function")return E(O,b,zo(R),q);if(R.$$typeof===Ke)return E(O,b,pn(O,R),q);jo(O,R)}return null}function M(O,b,R,q,ae){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return O=O.get(R)||null,g(b,O,""+q,ae);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case we:return O=O.get(q.key===null?R:q.key)||null,y(b,O,q,ae);case pe:return O=O.get(q.key===null?R:q.key)||null,C(b,O,q,ae);case vt:var ze=q._init;return q=ze(q._payload),M(O,b,R,q,ae)}if(de(q)||He(q))return O=O.get(R)||null,D(b,O,q,ae,null);if(typeof q.then=="function")return M(O,b,R,zo(q),ae);if(q.$$typeof===Ke)return M(O,b,R,pn(b,q),ae);jo(b,q)}return null}function Oe(O,b,R,q){for(var ae=null,ze=null,fe=b,ye=b=0,It=null;fe!==null&&ye<R.length;ye++){fe.index>ye?(It=fe,fe=null):It=fe.sibling;var We=E(O,fe,R[ye],q);if(We===null){fe===null&&(fe=It);break}e&&fe&&We.alternate===null&&t(O,fe),b=c(We,b,ye),ze===null?ae=We:ze.sibling=We,ze=We,fe=It}if(ye===R.length)return n(O,fe),Ee&&ki(O,ye),ae;if(fe===null){for(;ye<R.length;ye++)fe=G(O,R[ye],q),fe!==null&&(b=c(fe,b,ye),ze===null?ae=fe:ze.sibling=fe,ze=fe);return Ee&&ki(O,ye),ae}for(fe=s(fe);ye<R.length;ye++)It=M(fe,O,ye,R[ye],q),It!==null&&(e&&It.alternate!==null&&fe.delete(It.key===null?ye:It.key),b=c(It,b,ye),ze===null?ae=It:ze.sibling=It,ze=It);return e&&fe.forEach(function(La){return t(O,La)}),Ee&&ki(O,ye),ae}function me(O,b,R,q){if(R==null)throw Error(A(151));for(var ae=null,ze=null,fe=b,ye=b=0,It=null,We=R.next();fe!==null&&!We.done;ye++,We=R.next()){fe.index>ye?(It=fe,fe=null):It=fe.sibling;var La=E(O,fe,We.value,q);if(La===null){fe===null&&(fe=It);break}e&&fe&&La.alternate===null&&t(O,fe),b=c(La,b,ye),ze===null?ae=La:ze.sibling=La,ze=La,fe=It}if(We.done)return n(O,fe),Ee&&ki(O,ye),ae;if(fe===null){for(;!We.done;ye++,We=R.next())We=G(O,We.value,q),We!==null&&(b=c(We,b,ye),ze===null?ae=We:ze.sibling=We,ze=We);return Ee&&ki(O,ye),ae}for(fe=s(fe);!We.done;ye++,We=R.next())We=M(fe,O,ye,We.value,q),We!==null&&(e&&We.alternate!==null&&fe.delete(We.key===null?ye:We.key),b=c(We,b,ye),ze===null?ae=We:ze.sibling=We,ze=We);return e&&fe.forEach(function(ip){return t(O,ip)}),Ee&&ki(O,ye),ae}function ot(O,b,R,q){if(typeof R=="object"&&R!==null&&R.type===Ce&&R.key===null&&(R=R.props.children),typeof R=="object"&&R!==null){switch(R.$$typeof){case we:e:{for(var ae=R.key;b!==null;){if(b.key===ae){if(ae=R.type,ae===Ce){if(b.tag===7){n(O,b.sibling),q=r(b,R.props.children),q.return=O,O=q;break e}}else if(b.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===vt&&Gf(ae)===b.type){n(O,b.sibling),q=r(b,R.props),tr(q,R),q.return=O,O=q;break e}n(O,b);break}else t(O,b);b=b.sibling}R.type===Ce?(q=Ui(R.props.children,O.mode,q,R.key),q.return=O,O=q):(q=Ja(R.type,R.key,R.props,null,O.mode,q),tr(q,R),q.return=O,O=q)}return d(O);case pe:e:{for(ae=R.key;b!==null;){if(b.key===ae)if(b.tag===4&&b.stateNode.containerInfo===R.containerInfo&&b.stateNode.implementation===R.implementation){n(O,b.sibling),q=r(b,R.children||[]),q.return=O,O=q;break e}else{n(O,b);break}else t(O,b);b=b.sibling}q=Ds(R,O.mode,q),q.return=O,O=q}return d(O);case vt:return ae=R._init,R=ae(R._payload),ot(O,b,R,q)}if(de(R))return Oe(O,b,R,q);if(He(R)){if(ae=He(R),typeof ae!="function")throw Error(A(150));return R=ae.call(R),me(O,b,R,q)}if(typeof R.then=="function")return ot(O,b,zo(R),q);if(R.$$typeof===Ke)return ot(O,b,pn(O,R),q);jo(O,R)}return typeof R=="string"&&R!==""||typeof R=="number"||typeof R=="bigint"?(R=""+R,b!==null&&b.tag===6?(n(O,b.sibling),q=r(b,R),q.return=O,O=q):(n(O,b),q=Ll(R,O.mode,q),q.return=O,O=q),d(O)):n(O,b)}return function(O,b,R,q){try{er=0;var ae=ot(O,b,R,q);return Ys=null,ae}catch(fe){if(fe===ns||fe===zs)throw fe;var ze=sn(29,fe,null,O.mode);return ze.lanes=q,ze.return=O,ze}finally{}}}var Ps=Vf(!0),If=Vf(!1),wn=H(null),pi=null;function Sa(e){var t=e.alternate;K(zt,zt.current&1),K(wn,e),pi===null&&(t===null||hi.current!==null||t.memoizedState!==null)&&(pi=e)}function Yf(e){if(e.tag===22){if(K(zt,zt.current),K(wn,e),pi===null){var t=e.alternate;t!==null&&t.memoizedState!==null&&(pi=e)}}else Oa()}function Oa(){K(zt,zt.current),K(wn,wn.current)}function qi(e){I(wn),pi===e&&(pi=null),I(zt)}var zt=H(0);function qo(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||Hu(n)))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if((t.flags&128)!==0)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Wc(e,t,n,s){t=e.memoizedState,n=n(s,t),n=n==null?t:te({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Fc={enqueueSetState:function(e,t,n){e=e._reactInternals;var s=An(),r=ui(s);r.payload=t,n!=null&&(r.callback=n),t=fi(e,r,s),t!==null&&(Rn(t,e,s),ss(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var s=An(),r=ui(s);r.tag=1,r.payload=t,n!=null&&(r.callback=n),t=fi(e,r,s),t!==null&&(Rn(t,e,s),ss(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=An(),s=ui(n);s.tag=2,t!=null&&(s.callback=t),t=fi(e,s,n),t!==null&&(Rn(t,e,n),ss(t,e,n))}};function Pf(e,t,n,s,r,c,d){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(s,c,d):t.prototype&&t.prototype.isPureReactComponent?!ai(n,s)||!ai(r,c):!0}function Xf(e,t,n,s){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,s),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,s),t.state!==e&&Fc.enqueueReplaceState(t,t.state,null)}function cs(e,t){var n=t;if("ref"in t){n={};for(var s in t)s!=="ref"&&(n[s]=t[s])}if(e=e.defaultProps){n===t&&(n=te({},n));for(var r in e)n[r]===void 0&&(n[r]=e[r])}return n}var Ho=typeof reportError=="function"?reportError:function(e){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof e=="object"&&e!==null&&typeof e.message=="string"?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",e);return}console.error(e)};function Qf(e){Ho(e)}function Zf(e){console.error(e)}function Kf(e){Ho(e)}function Go(e,t){try{var n=e.onUncaughtError;n(t.value,{componentStack:t.stack})}catch(s){setTimeout(function(){throw s})}}function Jf(e,t,n){try{var s=e.onCaughtError;s(n.value,{componentStack:n.stack,errorBoundary:t.tag===1?t.stateNode:null})}catch(r){setTimeout(function(){throw r})}}function $c(e,t,n){return n=ui(n),n.tag=3,n.payload={element:null},n.callback=function(){Go(e,t)},n}function Wf(e){return e=ui(e),e.tag=3,e}function Ff(e,t,n,s){var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var c=s.value;e.payload=function(){return r(c)},e.callback=function(){Jf(t,n,s)}}var d=n.stateNode;d!==null&&typeof d.componentDidCatch=="function"&&(e.callback=function(){Jf(t,n,s),typeof r!="function"&&(Ea===null?Ea=new Set([this]):Ea.add(this));var g=s.stack;this.componentDidCatch(s.value,{componentStack:g!==null?g:""})})}function ig(e,t,n,s,r){if(n.flags|=32768,s!==null&&typeof s=="object"&&typeof s.then=="function"){if(t=n.alternate,t!==null&&Fa(t,n,r,!0),n=wn.current,n!==null){switch(n.tag){case 13:return pi===null?Ru():n.alternate===null&&Ct===0&&(Ct=3),n.flags&=-257,n.flags|=65536,n.lanes=r,s===Il?n.flags|=16384:(t=n.updateQueue,t===null?n.updateQueue=new Set([s]):t.add(s),Cu(e,s,r)),!1;case 22:return n.flags|=65536,s===Il?n.flags|=16384:(t=n.updateQueue,t===null?(t={transitions:null,markerInstances:null,retryQueue:new Set([s])},n.updateQueue=t):(n=t.retryQueue,n===null?t.retryQueue=new Set([s]):n.add(s)),Cu(e,s,r)),!1}throw Error(A(435,n.tag))}return Cu(e,s,r),Ru(),!1}if(Ee)return t=wn.current,t!==null?((t.flags&65536)===0&&(t.flags|=256),t.flags|=65536,t.lanes=r,s!==Di&&(e=Error(A(422),{cause:s}),Xn(hn(e,n)))):(s!==Di&&(t=Error(A(423),{cause:s}),Xn(hn(t,n))),e=e.current.alternate,e.flags|=65536,r&=-r,e.lanes|=r,s=hn(s,n),r=$c(e.stateNode,s,r),Pl(e,r),Ct!==4&&(Ct=2)),!1;var c=Error(A(520),{cause:s});if(c=hn(c,n),or===null?or=[c]:or.push(c),Ct!==4&&(Ct=2),t===null)return!0;s=hn(s,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,e=$c(n.stateNode,s,e),Pl(n,e),!1;case 1:if(t=n.type,c=n.stateNode,(n.flags&128)===0&&(typeof t.getDerivedStateFromError=="function"||c!==null&&typeof c.componentDidCatch=="function"&&(Ea===null||!Ea.has(c))))return n.flags|=65536,r&=-r,n.lanes|=r,r=Wf(r),Ff(r,e,n,s),Pl(n,r),!1}n=n.return}while(n!==null);return!1}var $f=Error(A(461)),Gt=!1;function Xt(e,t,n,s){t.child=e===null?If(t,null,n,s):Ps(t,e.child,n,s)}function eh(e,t,n,s,r){n=n.render;var c=t.ref;if("ref"in s){var d={};for(var g in s)g!=="ref"&&(d[g]=s[g])}else d=s;return Li(t),s=Jl(e,t,n,d,c,r),g=i(),e!==null&&!Gt?(a(e,t,r),Hi(e,t,r)):(Ee&&g&&Bl(t),t.flags|=1,Xt(e,t,s,r),t.child)}function th(e,t,n,s,r){if(e===null){var c=n.type;return typeof c=="function"&&!Ka(c)&&c.defaultProps===void 0&&n.compare===null?(t.tag=15,t.type=c,nh(e,t,c,s,r)):(e=Ja(n.type,null,s,t,t.mode,r),e.ref=t.ref,e.return=t,t.child=e)}if(c=e.child,!ru(e,r)){var d=c.memoizedProps;if(n=n.compare,n=n!==null?n:ai,n(d,s)&&e.ref===t.ref)return Hi(e,t,r)}return t.flags|=1,e=qn(c,s),e.ref=t.ref,e.return=t,t.child=e}function nh(e,t,n,s,r){if(e!==null){var c=e.memoizedProps;if(ai(c,s)&&e.ref===t.ref)if(Gt=!1,t.pendingProps=s=c,ru(e,r))(e.flags&131072)!==0&&(Gt=!0);else return t.lanes=e.lanes,Hi(e,t,r)}return eu(e,t,n,s,r)}function ih(e,t,n){var s=t.pendingProps,r=s.children,c=e!==null?e.memoizedState:null;if(s.mode==="hidden"){if((t.flags&128)!==0){if(s=c!==null?c.baseLanes|n:n,e!==null){for(r=t.child=e.child,c=0;r!==null;)c=c|r.lanes|r.childLanes,r=r.sibling;t.childLanes=c&~s}else t.childLanes=0,t.child=null;return ah(e,t,s,n)}if((n&536870912)!==0)t.memoizedState={baseLanes:0,cachePool:null},e!==null&&ma(t,c!==null?c.cachePool:null),c!==null?Hs(t,c):Gs(),Yf(t);else return t.lanes=t.childLanes=536870912,ah(e,t,c!==null?c.baseLanes|n:n,n)}else c!==null?(ma(t,c.cachePool),Hs(t,c),Oa(),t.memoizedState=null):(e!==null&&ma(t,null),Gs(),Oa());return Xt(e,t,r,n),t.child}function ah(e,t,n,s){var r=Vl();return r=r===null?null:{parent:ut._currentValue,pool:r},t.memoizedState={baseLanes:n,cachePool:r},e!==null&&ma(t,null),Gs(),Yf(t),e!==null&&Fa(e,t,s,!0),null}function Vo(e,t){var n=t.ref;if(n===null)e!==null&&e.ref!==null&&(t.flags|=4194816);else{if(typeof n!="function"&&typeof n!="object")throw Error(A(284));(e===null||e.ref!==n)&&(t.flags|=4194816)}}function eu(e,t,n,s,r){return Li(t),n=Jl(e,t,n,s,void 0,r),s=i(),e!==null&&!Gt?(a(e,t,r),Hi(e,t,r)):(Ee&&s&&Bl(t),t.flags|=1,Xt(e,t,n,r),t.child)}function sh(e,t,n,s,r,c){return Li(t),t.updateQueue=null,n=Uo(t,s,n,r),Wl(e),s=i(),e!==null&&!Gt?(a(e,t,c),Hi(e,t,c)):(Ee&&s&&Bl(t),t.flags|=1,Xt(e,t,n,c),t.child)}function lh(e,t,n,s,r){if(Li(t),t.stateNode===null){var c=Ni,d=n.contextType;typeof d=="object"&&d!==null&&(c=Lt(d)),c=new n(s,c),t.memoizedState=c.state!==null&&c.state!==void 0?c.state:null,c.updater=Fc,t.stateNode=c,c._reactInternals=t,c=t.stateNode,c.props=s,c.state=t.memoizedState,c.refs={},js(t),d=n.contextType,c.context=typeof d=="object"&&d!==null?Lt(d):Ni,c.state=t.memoizedState,d=n.getDerivedStateFromProps,typeof d=="function"&&(Wc(t,n,d,s),c.state=t.memoizedState),typeof n.getDerivedStateFromProps=="function"||typeof c.getSnapshotBeforeUpdate=="function"||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(d=c.state,typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount(),d!==c.state&&Fc.enqueueReplaceState(c,c.state,null),rs(t,s,c,r),ls(),c.state=t.memoizedState),typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!0}else if(e===null){c=t.stateNode;var g=t.memoizedProps,y=cs(n,g);c.props=y;var C=c.context,D=n.contextType;d=Ni,typeof D=="object"&&D!==null&&(d=Lt(D));var G=n.getDerivedStateFromProps;D=typeof G=="function"||typeof c.getSnapshotBeforeUpdate=="function",g=t.pendingProps!==g,D||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(g||C!==d)&&Xf(t,c,s,d),Zn=!1;var E=t.memoizedState;c.state=E,rs(t,s,c,r),ls(),C=t.memoizedState,g||E!==C||Zn?(typeof G=="function"&&(Wc(t,n,G,s),C=t.memoizedState),(y=Zn||Pf(t,n,y,s,E,C,d))?(D||typeof c.UNSAFE_componentWillMount!="function"&&typeof c.componentWillMount!="function"||(typeof c.componentWillMount=="function"&&c.componentWillMount(),typeof c.UNSAFE_componentWillMount=="function"&&c.UNSAFE_componentWillMount()),typeof c.componentDidMount=="function"&&(t.flags|=4194308)):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=s,t.memoizedState=C),c.props=s,c.state=C,c.context=d,s=y):(typeof c.componentDidMount=="function"&&(t.flags|=4194308),s=!1)}else{c=t.stateNode,Yl(e,t),d=t.memoizedProps,D=cs(n,d),c.props=D,G=t.pendingProps,E=c.context,C=n.contextType,y=Ni,typeof C=="object"&&C!==null&&(y=Lt(C)),g=n.getDerivedStateFromProps,(C=typeof g=="function"||typeof c.getSnapshotBeforeUpdate=="function")||typeof c.UNSAFE_componentWillReceiveProps!="function"&&typeof c.componentWillReceiveProps!="function"||(d!==G||E!==y)&&Xf(t,c,s,y),Zn=!1,E=t.memoizedState,c.state=E,rs(t,s,c,r),ls();var M=t.memoizedState;d!==G||E!==M||Zn||e!==null&&e.dependencies!==null&&$a(e.dependencies)?(typeof g=="function"&&(Wc(t,n,g,s),M=t.memoizedState),(D=Zn||Pf(t,n,D,s,E,M,y)||e!==null&&e.dependencies!==null&&$a(e.dependencies))?(C||typeof c.UNSAFE_componentWillUpdate!="function"&&typeof c.componentWillUpdate!="function"||(typeof c.componentWillUpdate=="function"&&c.componentWillUpdate(s,M,y),typeof c.UNSAFE_componentWillUpdate=="function"&&c.UNSAFE_componentWillUpdate(s,M,y)),typeof c.componentDidUpdate=="function"&&(t.flags|=4),typeof c.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),t.memoizedProps=s,t.memoizedState=M),c.props=s,c.state=M,c.context=y,s=D):(typeof c.componentDidUpdate!="function"||d===e.memoizedProps&&E===e.memoizedState||(t.flags|=4),typeof c.getSnapshotBeforeUpdate!="function"||d===e.memoizedProps&&E===e.memoizedState||(t.flags|=1024),s=!1)}return c=s,Vo(e,t),s=(t.flags&128)!==0,c||s?(c=t.stateNode,n=s&&typeof n.getDerivedStateFromError!="function"?null:c.render(),t.flags|=1,e!==null&&s?(t.child=Ps(t,e.child,null,r),t.child=Ps(t,null,n,r)):Xt(e,t,n,r),t.memoizedState=c.state,e=t.child):e=Hi(e,t,r),e}function rh(e,t,n,s){return ua(),t.flags|=256,Xt(e,t,n,s),t.child}var tu={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function nu(e){return{baseLanes:e,cachePool:_o()}}function iu(e,t,n){return e=e!==null?e.childLanes&~n:0,t&&(e|=xn),e}function oh(e,t,n){var s=t.pendingProps,r=!1,c=(t.flags&128)!==0,d;if((d=c)||(d=e!==null&&e.memoizedState===null?!1:(zt.current&2)!==0),d&&(r=!0,t.flags&=-129),d=(t.flags&32)!==0,t.flags&=-33,e===null){if(Ee){if(r?Sa(t):Oa(),Ee){var g=St,y;if(y=g){e:{for(y=g,g=gn;y.nodeType!==8;){if(!g){g=null;break e}if(y=Jn(y.nextSibling),y===null){g=null;break e}}g=y}g!==null?(t.memoizedState={dehydrated:g,treeContext:Hn!==null?{id:Gn,overflow:Vn}:null,retryLane:536870912,hydrationErrors:null},y=sn(18,null,null,0),y.stateNode=g,y.return=t,t.child=y,Ht=t,St=null,y=!0):y=!1}y||Yn(t)}if(g=t.memoizedState,g!==null&&(g=g.dehydrated,g!==null))return Hu(g)?t.lanes=32:t.lanes=536870912,null;qi(t)}return g=s.children,s=s.fallback,r?(Oa(),r=t.mode,g=Io({mode:"hidden",children:g},r),s=Ui(s,r,n,null),g.return=t,s.return=t,g.sibling=s,t.child=g,r=t.child,r.memoizedState=nu(n),r.childLanes=iu(e,d,n),t.memoizedState=tu,s):(Sa(t),au(t,g))}if(y=e.memoizedState,y!==null&&(g=y.dehydrated,g!==null)){if(c)t.flags&256?(Sa(t),t.flags&=-257,t=su(e,t,n)):t.memoizedState!==null?(Oa(),t.child=e.child,t.flags|=128,t=null):(Oa(),r=s.fallback,g=t.mode,s=Io({mode:"visible",children:s.children},g),r=Ui(r,g,n,null),r.flags|=2,s.return=t,r.return=t,s.sibling=r,t.child=s,Ps(t,e.child,null,n),s=t.child,s.memoizedState=nu(n),s.childLanes=iu(e,d,n),t.memoizedState=tu,t=r);else if(Sa(t),Hu(g)){if(d=g.nextSibling&&g.nextSibling.dataset,d)var C=d.dgst;d=C,s=Error(A(419)),s.stack="",s.digest=d,Xn({value:s,source:null,stack:null}),t=su(e,t,n)}else if(Gt||Fa(e,t,n,!1),d=(n&e.childLanes)!==0,Gt||d){if(d=ft,d!==null&&(s=n&-n,s=(s&42)!==0?1:cl(s),s=(s&(d.suspendedLanes|n))!==0?0:s,s!==0&&s!==y.retryLane))throw y.retryLane=s,ra(e,s),Rn(d,e,s),$f;g.data==="$?"||Ru(),t=su(e,t,n)}else g.data==="$?"?(t.flags|=192,t.child=e.child,t=null):(e=y.treeContext,St=Jn(g.nextSibling),Ht=t,Ee=!0,In=null,gn=!1,e!==null&&($t[dn++]=Gn,$t[dn++]=Vn,$t[dn++]=Hn,Gn=e.id,Vn=e.overflow,Hn=t),t=au(t,s.children),t.flags|=4096);return t}return r?(Oa(),r=s.fallback,g=t.mode,y=e.child,C=y.sibling,s=qn(y,{mode:"hidden",children:s.children}),s.subtreeFlags=y.subtreeFlags&65011712,C!==null?r=qn(C,r):(r=Ui(r,g,n,null),r.flags|=2),r.return=t,s.return=t,s.sibling=r,t.child=s,s=r,r=t.child,g=e.child.memoizedState,g===null?g=nu(n):(y=g.cachePool,y!==null?(C=ut._currentValue,y=y.parent!==C?{parent:C,pool:C}:y):y=_o(),g={baseLanes:g.baseLanes|n,cachePool:y}),r.memoizedState=g,r.childLanes=iu(e,d,n),t.memoizedState=tu,s):(Sa(t),n=e.child,e=n.sibling,n=qn(n,{mode:"visible",children:s.children}),n.return=t,n.sibling=null,e!==null&&(d=t.deletions,d===null?(t.deletions=[e],t.flags|=16):d.push(e)),t.child=n,t.memoizedState=null,n)}function au(e,t){return t=Io({mode:"visible",children:t},e.mode),t.return=e,e.child=t}function Io(e,t){return e=sn(22,e,null,t),e.lanes=0,e.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},e}function su(e,t,n){return Ps(t,e.child,null,n),e=au(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function ch(e,t,n){e.lanes|=t;var s=e.alternate;s!==null&&(s.lanes|=t),ha(e.return,t,n)}function lu(e,t,n,s,r){var c=e.memoizedState;c===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(c.isBackwards=t,c.rendering=null,c.renderingStartTime=0,c.last=s,c.tail=n,c.tailMode=r)}function uh(e,t,n){var s=t.pendingProps,r=s.revealOrder,c=s.tail;if(Xt(e,t,s.children,n),s=zt.current,(s&2)!==0)s=s&1|2,t.flags|=128;else{if(e!==null&&(e.flags&128)!==0)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ch(e,n,t);else if(e.tag===19)ch(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}s&=1}switch(K(zt,s),r){case"forwards":for(n=t.child,r=null;n!==null;)e=n.alternate,e!==null&&qo(e)===null&&(r=n),n=n.sibling;n=r,n===null?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),lu(t,!1,r,n,c);break;case"backwards":for(n=null,r=t.child,t.child=null;r!==null;){if(e=r.alternate,e!==null&&qo(e)===null){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}lu(t,!0,n,null,c);break;case"together":lu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Hi(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),_a|=t.lanes,(n&t.childLanes)===0)if(e!==null){if(Fa(e,t,n,!1),(n&t.childLanes)===0)return null}else return null;if(e!==null&&t.child!==e.child)throw Error(A(153));if(t.child!==null){for(e=t.child,n=qn(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=qn(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function ru(e,t){return(e.lanes&t)!==0?!0:(e=e.dependencies,!!(e!==null&&$a(e)))}function ag(e,t,n){switch(t.tag){case 3:Be(t,t.stateNode.containerInfo),Mn(t,ut,e.memoizedState.cache),ua();break;case 27:case 5:Un(t);break;case 4:Be(t,t.stateNode.containerInfo);break;case 10:Mn(t,t.type,t.memoizedProps.value);break;case 13:var s=t.memoizedState;if(s!==null)return s.dehydrated!==null?(Sa(t),t.flags|=128,null):(n&t.child.childLanes)!==0?oh(e,t,n):(Sa(t),e=Hi(e,t,n),e!==null?e.sibling:null);Sa(t);break;case 19:var r=(e.flags&128)!==0;if(s=(n&t.childLanes)!==0,s||(Fa(e,t,n,!1),s=(n&t.childLanes)!==0),r){if(s)return uh(e,t,n);t.flags|=128}if(r=t.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),K(zt,zt.current),s)break;return null;case 22:case 23:return t.lanes=0,ih(e,t,n);case 24:Mn(t,ut,e.memoizedState.cache)}return Hi(e,t,n)}function fh(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps)Gt=!0;else{if(!ru(e,n)&&(t.flags&128)===0)return Gt=!1,ag(e,t,n);Gt=(e.flags&131072)!==0}else Gt=!1,Ee&&(t.flags&1048576)!==0&&Oo(t,Bs,t.index);switch(t.lanes=0,t.tag){case 16:e:{e=t.pendingProps;var s=t.elementType,r=s._init;if(s=r(s._payload),t.type=s,typeof s=="function")Ka(s)?(e=cs(s,e),t.tag=1,t=lh(null,t,s,e,n)):(t.tag=0,t=eu(null,t,s,e,n));else{if(s!=null){if(r=s.$$typeof,r===x){t.tag=11,t=eh(null,t,s,e,n);break e}else if(r===yt){t.tag=14,t=th(null,t,s,e,n);break e}}throw t=_(s)||s,Error(A(306,t,""))}}return t;case 0:return eu(e,t,t.type,t.pendingProps,n);case 1:return s=t.type,r=cs(s,t.pendingProps),lh(e,t,s,r,n);case 3:e:{if(Be(t,t.stateNode.containerInfo),e===null)throw Error(A(387));s=t.pendingProps;var c=t.memoizedState;r=c.element,Yl(e,t),rs(t,s,null,n);var d=t.memoizedState;if(s=d.cache,Mn(t,ut,s),s!==c.cache&&Hl(t,[ut],n,!0),ls(),s=d.element,c.isDehydrated)if(c={element:s,isDehydrated:!1,cache:d.cache},t.updateQueue.baseState=c,t.memoizedState=c,t.flags&256){t=rh(e,t,s,n);break e}else if(s!==r){r=hn(Error(A(424)),t),Xn(r),t=rh(e,t,s,n);break e}else{switch(e=t.stateNode.containerInfo,e.nodeType){case 9:e=e.body;break;default:e=e.nodeName==="HTML"?e.ownerDocument.body:e}for(St=Jn(e.firstChild),Ht=t,Ee=!0,In=null,gn=!0,n=If(t,null,s,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling}else{if(ua(),s===r){t=Hi(e,t,n);break e}Xt(e,t,s,n)}t=t.child}return t;case 26:return Vo(e,t),e===null?(n=pd(t.type,null,t.pendingProps,null))?t.memoizedState=n:Ee||(n=t.type,e=t.pendingProps,s=ic(re.current).createElement(n),s[Dt]=t,s[Yt]=e,Zt(s,n,e),xt(s),t.stateNode=s):t.memoizedState=pd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return Un(t),e===null&&Ee&&(s=t.stateNode=hd(t.type,t.pendingProps,re.current),Ht=t,gn=!0,r=St,xa(t.type)?(Gu=r,St=Jn(s.firstChild)):St=r),Xt(e,t,t.pendingProps.children,n),Vo(e,t),e===null&&(t.flags|=4194304),t.child;case 5:return e===null&&Ee&&((r=s=St)&&(s=Ug(s,t.type,t.pendingProps,gn),s!==null?(t.stateNode=s,Ht=t,St=Jn(s.firstChild),gn=!1,r=!0):r=!1),r||Yn(t)),Un(t),r=t.type,c=t.pendingProps,d=e!==null?e.memoizedProps:null,s=c.children,zu(r,c)?s=null:d!==null&&zu(r,d)&&(t.flags|=32),t.memoizedState!==null&&(r=Jl(e,t,Pc,null,null,n),yr._currentValue=r),Vo(e,t),Xt(e,t,s,n),t.child;case 6:return e===null&&Ee&&((e=n=St)&&(n=kg(n,t.pendingProps,gn),n!==null?(t.stateNode=n,Ht=t,St=null,e=!0):e=!1),e||Yn(t)),null;case 13:return oh(e,t,n);case 4:return Be(t,t.stateNode.containerInfo),s=t.pendingProps,e===null?t.child=Ps(t,null,s,n):Xt(e,t,s,n),t.child;case 11:return eh(e,t,t.type,t.pendingProps,n);case 7:return Xt(e,t,t.pendingProps,n),t.child;case 8:return Xt(e,t,t.pendingProps.children,n),t.child;case 12:return Xt(e,t,t.pendingProps.children,n),t.child;case 10:return s=t.pendingProps,Mn(t,t.type,s.value),Xt(e,t,s.children,n),t.child;case 9:return r=t.type._context,s=t.pendingProps.children,Li(t),r=Lt(r),s=s(r),t.flags|=1,Xt(e,t,s,n),t.child;case 14:return th(e,t,t.type,t.pendingProps,n);case 15:return nh(e,t,t.type,t.pendingProps,n);case 19:return uh(e,t,n);case 31:return s=t.pendingProps,n=t.mode,s={mode:s.mode,children:s.children},e===null?(n=Io(s,n),n.ref=t.ref,t.child=n,n.return=t,t=n):(n=qn(e.child,s),n.ref=t.ref,t.child=n,n.return=t,t=n),t;case 22:return ih(e,t,n);case 24:return Li(t),s=Lt(ut),e===null?(r=Vl(),r===null&&(r=ft,c=oi(),r.pooledCache=c,c.refCount++,c!==null&&(r.pooledCacheLanes|=n),r=c),t.memoizedState={parent:s,cache:r},js(t),Mn(t,ut,r)):((e.lanes&n)!==0&&(Yl(e,t),rs(t,null,null,n),ls()),r=e.memoizedState,c=t.memoizedState,r.parent!==s?(r={parent:s,cache:s},t.memoizedState=r,t.lanes===0&&(t.memoizedState=t.updateQueue.baseState=r),Mn(t,ut,s)):(s=c.cache,Mn(t,ut,s),s!==r.cache&&Hl(t,[ut],n,!0))),Xt(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(A(156,t.tag))}function Gi(e){e.flags|=4}function hh(e,t){if(t.type!=="stylesheet"||(t.state.loading&4)!==0)e.flags&=-16777217;else if(e.flags|=16777216,!Sd(t)){if(t=wn.current,t!==null&&((Pe&4194048)===Pe?pi!==null:(Pe&62914560)!==Pe&&(Pe&536870912)===0||t!==pi))throw as=Il,Eo;e.flags|=8192}}function Yo(e,t){t!==null&&(e.flags|=4),e.flags&16384&&(t=e.tag!==22?qa():536870912,e.lanes|=t,Ks|=t)}function nr(e,t){if(!Ee)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:s.sibling=null}}function Rt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,s=0;if(t)for(var r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&65011712,s|=r.flags&65011712,r.return=e,r=r.sibling;else for(r=e.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=s,e.childLanes=n,t}function sg(e,t,n){var s=t.pendingProps;switch(zl(t),t.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(t),null;case 1:return Rt(t),null;case 3:return n=t.stateNode,s=null,e!==null&&(s=e.memoizedState.cache),t.memoizedState.cache!==s&&(t.flags|=2048),kt(ut),Kt(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Pn(t)?Gi(t):e===null||e.memoizedState.isDehydrated&&(t.flags&256)===0||(t.flags|=1024,fa())),Rt(t),null;case 26:return n=t.memoizedState,e===null?(Gi(t),n!==null?(Rt(t),hh(t,n)):(Rt(t),t.flags&=-16777217)):n?n!==e.memoizedState?(Gi(t),Rt(t),hh(t,n)):(Rt(t),t.flags&=-16777217):(e.memoizedProps!==s&&Gi(t),Rt(t),t.flags&=-16777217),null;case 27:Wn(t),n=re.current;var r=t.type;if(e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Gi(t);else{if(!s){if(t.stateNode===null)throw Error(A(166));return Rt(t),null}e=se.current,Pn(t)?jl(t):(e=hd(r,s,n),t.stateNode=e,Gi(t))}return Rt(t),null;case 5:if(Wn(t),n=t.type,e!==null&&t.stateNode!=null)e.memoizedProps!==s&&Gi(t);else{if(!s){if(t.stateNode===null)throw Error(A(166));return Rt(t),null}if(e=se.current,Pn(t))jl(t);else{switch(r=ic(re.current),e){case 1:e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case 2:e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;default:switch(n){case"svg":e=r.createElementNS("http://www.w3.org/2000/svg",n);break;case"math":e=r.createElementNS("http://www.w3.org/1998/Math/MathML",n);break;case"script":e=r.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild);break;case"select":e=typeof s.is=="string"?r.createElement("select",{is:s.is}):r.createElement("select"),s.multiple?e.multiple=!0:s.size&&(e.size=s.size);break;default:e=typeof s.is=="string"?r.createElement(n,{is:s.is}):r.createElement(n)}}e[Dt]=t,e[Yt]=s;e:for(r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.tag!==27&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break e;for(;r.sibling===null;){if(r.return===null||r.return===t)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}t.stateNode=e;e:switch(Zt(e,n,s),n){case"button":case"input":case"select":case"textarea":e=!!s.autoFocus;break e;case"img":e=!0;break e;default:e=!1}e&&Gi(t)}}return Rt(t),t.flags&=-16777217,null;case 6:if(e&&t.stateNode!=null)e.memoizedProps!==s&&Gi(t);else{if(typeof s!="string"&&t.stateNode===null)throw Error(A(166));if(e=re.current,Pn(t)){if(e=t.stateNode,n=t.memoizedProps,s=null,r=Ht,r!==null)switch(r.tag){case 27:case 5:s=r.memoizedProps}e[Dt]=t,e=!!(e.nodeValue===n||s!==null&&s.suppressHydrationWarning===!0||sd(e.nodeValue,n)),e||Yn(t)}else e=ic(e).createTextNode(s),e[Dt]=t,t.stateNode=e}return Rt(t),null;case 13:if(s=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(r=Pn(t),s!==null&&s.dehydrated!==null){if(e===null){if(!r)throw Error(A(318));if(r=t.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(A(317));r[Dt]=t}else ua(),(t.flags&128)===0&&(t.memoizedState=null),t.flags|=4;Rt(t),r=!1}else r=fa(),e!==null&&e.memoizedState!==null&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return t.flags&256?(qi(t),t):(qi(t),null)}if(qi(t),(t.flags&128)!==0)return t.lanes=n,t;if(n=s!==null,e=e!==null&&e.memoizedState!==null,n){s=t.child,r=null,s.alternate!==null&&s.alternate.memoizedState!==null&&s.alternate.memoizedState.cachePool!==null&&(r=s.alternate.memoizedState.cachePool.pool);var c=null;s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==r&&(s.flags|=2048)}return n!==e&&n&&(t.child.flags|=8192),Yo(t,t.updateQueue),Rt(t),null;case 4:return Kt(),e===null&&Uu(t.stateNode.containerInfo),Rt(t),null;case 10:return kt(t.type),Rt(t),null;case 19:if(I(zt),r=t.memoizedState,r===null)return Rt(t),null;if(s=(t.flags&128)!==0,c=r.rendering,c===null)if(s)nr(r,!1);else{if(Ct!==0||e!==null&&(e.flags&128)!==0)for(e=t.child;e!==null;){if(c=qo(e),c!==null){for(t.flags|=128,nr(r,!1),e=c.updateQueue,t.updateQueue=e,Yo(t,e),t.subtreeFlags=0,e=n,n=t.child;n!==null;)So(n,e),n=n.sibling;return K(zt,zt.current&1|2),t.child}e=e.sibling}r.tail!==null&&Qe()>Qo&&(t.flags|=128,s=!0,nr(r,!1),t.lanes=4194304)}else{if(!s)if(e=qo(c),e!==null){if(t.flags|=128,s=!0,e=e.updateQueue,t.updateQueue=e,Yo(t,e),nr(r,!0),r.tail===null&&r.tailMode==="hidden"&&!c.alternate&&!Ee)return Rt(t),null}else 2*Qe()-r.renderingStartTime>Qo&&n!==536870912&&(t.flags|=128,s=!0,nr(r,!1),t.lanes=4194304);r.isBackwards?(c.sibling=t.child,t.child=c):(e=r.last,e!==null?e.sibling=c:t.child=c,r.last=c)}return r.tail!==null?(t=r.tail,r.rendering=t,r.tail=t.sibling,r.renderingStartTime=Qe(),t.sibling=null,e=zt.current,K(zt,s?e&1|2:e&1),t):(Rt(t),null);case 22:case 23:return qi(t),Zl(),s=t.memoizedState!==null,e!==null?e.memoizedState!==null!==s&&(t.flags|=8192):s&&(t.flags|=8192),s?(n&536870912)!==0&&(t.flags&128)===0&&(Rt(t),t.subtreeFlags&6&&(t.flags|=8192)):Rt(t),n=t.updateQueue,n!==null&&Yo(t,n.retryQueue),n=null,e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),s=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(s=t.memoizedState.cachePool.pool),s!==n&&(t.flags|=2048),e!==null&&I(ci),null;case 24:return n=null,e!==null&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),kt(ut),Rt(t),null;case 25:return null;case 30:return null}throw Error(A(156,t.tag))}function lg(e,t){switch(zl(t),t.tag){case 1:return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return kt(ut),Kt(),e=t.flags,(e&65536)!==0&&(e&128)===0?(t.flags=e&-65537|128,t):null;case 26:case 27:case 5:return Wn(t),null;case 13:if(qi(t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(A(340));ua()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return I(zt),null;case 4:return Kt(),null;case 10:return kt(t.type),null;case 22:case 23:return qi(t),Zl(),e!==null&&I(ci),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 24:return kt(ut),null;case 25:return null;default:return null}}function dh(e,t){switch(zl(t),t.tag){case 3:kt(ut),Kt();break;case 26:case 27:case 5:Wn(t);break;case 4:Kt();break;case 13:qi(t);break;case 19:I(zt);break;case 10:kt(t.type);break;case 22:case 23:qi(t),Zl(),e!==null&&I(ci);break;case 24:kt(ut)}}function ir(e,t){try{var n=t.updateQueue,s=n!==null?n.lastEffect:null;if(s!==null){var r=s.next;n=r;do{if((n.tag&e)===e){s=void 0;var c=n.create,d=n.inst;s=c(),d.destroy=s}n=n.next}while(n!==r)}}catch(g){ct(t,t.return,g)}}function Aa(e,t,n){try{var s=t.updateQueue,r=s!==null?s.lastEffect:null;if(r!==null){var c=r.next;s=c;do{if((s.tag&e)===e){var d=s.inst,g=d.destroy;if(g!==void 0){d.destroy=void 0,r=t;var y=n,C=g;try{C()}catch(D){ct(r,y,D)}}}s=s.next}while(s!==c)}}catch(D){ct(t,t.return,D)}}function gh(e){var t=e.updateQueue;if(t!==null){var n=e.stateNode;try{Ql(t,n)}catch(s){ct(e,e.return,s)}}}function ph(e,t,n){n.props=cs(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(s){ct(e,t,s)}}function ar(e,t){try{var n=e.ref;if(n!==null){switch(e.tag){case 26:case 27:case 5:var s=e.stateNode;break;case 30:s=e.stateNode;break;default:s=e.stateNode}typeof n=="function"?e.refCleanup=n(s):n.current=s}}catch(r){ct(e,t,r)}}function mi(e,t){var n=e.ref,s=e.refCleanup;if(n!==null)if(typeof s=="function")try{s()}catch(r){ct(e,t,r)}finally{e.refCleanup=null,e=e.alternate,e!=null&&(e.refCleanup=null)}else if(typeof n=="function")try{n(null)}catch(r){ct(e,t,r)}else n.current=null}function mh(e){var t=e.type,n=e.memoizedProps,s=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&s.focus();break e;case"img":n.src?s.src=n.src:n.srcSet&&(s.srcset=n.srcSet)}}catch(r){ct(e,e.return,r)}}function ou(e,t,n){try{var s=e.stateNode;Eg(s,e.type,n,t),s[Yt]=t}catch(r){ct(e,e.return,r)}}function yh(e){return e.tag===5||e.tag===3||e.tag===26||e.tag===27&&xa(e.type)||e.tag===4}function cu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||yh(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.tag===27&&xa(e.type)||e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function uu(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n).insertBefore(e,t):(t=n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,t.appendChild(e),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=nc));else if(s!==4&&(s===27&&xa(e.type)&&(n=e.stateNode,t=null),e=e.child,e!==null))for(uu(e,t,n),e=e.sibling;e!==null;)uu(e,t,n),e=e.sibling}function Po(e,t,n){var s=e.tag;if(s===5||s===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(s!==4&&(s===27&&xa(e.type)&&(n=e.stateNode),e=e.child,e!==null))for(Po(e,t,n),e=e.sibling;e!==null;)Po(e,t,n),e=e.sibling}function vh(e){var t=e.stateNode,n=e.memoizedProps;try{for(var s=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);Zt(t,s,n),t[Dt]=e,t[Yt]=n}catch(c){ct(e,e.return,c)}}var Vi=!1,Mt=!1,fu=!1,bh=typeof WeakSet=="function"?WeakSet:Set,Vt=null;function rg(e,t){if(e=e.containerInfo,Lu=cc,e=Ft(e),Za(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,c=s.focusNode;s=s.focusOffset;try{n.nodeType,c.nodeType}catch{n=null;break e}var d=0,g=-1,y=-1,C=0,D=0,G=e,E=null;t:for(;;){for(var M;G!==n||r!==0&&G.nodeType!==3||(g=d+r),G!==c||s!==0&&G.nodeType!==3||(y=d+s),G.nodeType===3&&(d+=G.nodeValue.length),(M=G.firstChild)!==null;)E=G,G=M;for(;;){if(G===e)break t;if(E===n&&++C===r&&(g=d),E===c&&++D===s&&(y=d),(M=G.nextSibling)!==null)break;G=E,E=G.parentNode}G=M}n=g===-1||y===-1?null:{start:g,end:y}}else n=null}n=n||{start:0,end:0}}else n=null;for(Bu={focusedElem:e,selectionRange:n},cc=!1,Vt=t;Vt!==null;)if(t=Vt,e=t.child,(t.subtreeFlags&1024)!==0&&e!==null)e.return=t,Vt=e;else for(;Vt!==null;){switch(t=Vt,c=t.alternate,e=t.flags,t.tag){case 0:break;case 11:case 15:break;case 1:if((e&1024)!==0&&c!==null){e=void 0,n=t,r=c.memoizedProps,c=c.memoizedState,s=n.stateNode;try{var Oe=cs(n.type,r,n.elementType===n.type);e=s.getSnapshotBeforeUpdate(Oe,c),s.__reactInternalSnapshotBeforeUpdate=e}catch(me){ct(n,n.return,me)}}break;case 3:if((e&1024)!==0){if(e=t.stateNode.containerInfo,n=e.nodeType,n===9)qu(e);else if(n===1)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":qu(e);break;default:e.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((e&1024)!==0)throw Error(A(163))}if(e=t.sibling,e!==null){e.return=t.return,Vt=e;break}Vt=t.return}}function Sh(e,t,n){var s=n.flags;switch(n.tag){case 0:case 11:case 15:Ra(e,n),s&4&&ir(5,n);break;case 1:if(Ra(e,n),s&4)if(e=n.stateNode,t===null)try{e.componentDidMount()}catch(d){ct(n,n.return,d)}else{var r=cs(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(d){ct(n,n.return,d)}}s&64&&gh(n),s&512&&ar(n,n.return);break;case 3:if(Ra(e,n),s&64&&(e=n.updateQueue,e!==null)){if(t=null,n.child!==null)switch(n.child.tag){case 27:case 5:t=n.child.stateNode;break;case 1:t=n.child.stateNode}try{Ql(e,t)}catch(d){ct(n,n.return,d)}}break;case 27:t===null&&s&4&&vh(n);case 26:case 5:Ra(e,n),t===null&&s&4&&mh(n),s&512&&ar(n,n.return);break;case 12:Ra(e,n);break;case 13:Ra(e,n),s&4&&Rh(e,n),s&64&&(e=n.memoizedState,e!==null&&(e=e.dehydrated,e!==null&&(n=mg.bind(null,n),Dg(e,n))));break;case 22:if(s=n.memoizedState!==null||Vi,!s){t=t!==null&&t.memoizedState!==null||Mt,r=Vi;var c=Mt;Vi=s,(Mt=t)&&!c?Ta(e,n,(n.subtreeFlags&8772)!==0):Ra(e,n),Vi=r,Mt=c}break;case 30:break;default:Ra(e,n)}}function Oh(e){var t=e.alternate;t!==null&&(e.alternate=null,Oh(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&dl(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var Ot=null,mn=!1;function Ii(e,t,n){for(n=n.child;n!==null;)Ah(e,t,n),n=n.sibling}function Ah(e,t,n){if(_e&&typeof _e.onCommitFiberUnmount=="function")try{_e.onCommitFiberUnmount(Me,n)}catch{}switch(n.tag){case 26:Mt||mi(n,t),Ii(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode,n.parentNode.removeChild(n));break;case 27:Mt||mi(n,t);var s=Ot,r=mn;xa(n.type)&&(Ot=n.stateNode,mn=!1),Ii(e,t,n),dr(n.stateNode),Ot=s,mn=r;break;case 5:Mt||mi(n,t);case 6:if(s=Ot,r=mn,Ot=null,Ii(e,t,n),Ot=s,mn=r,Ot!==null)if(mn)try{(Ot.nodeType===9?Ot.body:Ot.nodeName==="HTML"?Ot.ownerDocument.body:Ot).removeChild(n.stateNode)}catch(c){ct(n,t,c)}else try{Ot.removeChild(n.stateNode)}catch(c){ct(n,t,c)}break;case 18:Ot!==null&&(mn?(e=Ot,ud(e.nodeType===9?e.body:e.nodeName==="HTML"?e.ownerDocument.body:e,n.stateNode),Or(e)):ud(Ot,n.stateNode));break;case 4:s=Ot,r=mn,Ot=n.stateNode.containerInfo,mn=!0,Ii(e,t,n),Ot=s,mn=r;break;case 0:case 11:case 14:case 15:Mt||Aa(2,n,t),Mt||Aa(4,n,t),Ii(e,t,n);break;case 1:Mt||(mi(n,t),s=n.stateNode,typeof s.componentWillUnmount=="function"&&ph(n,t,s)),Ii(e,t,n);break;case 21:Ii(e,t,n);break;case 22:Mt=(s=Mt)||n.memoizedState!==null,Ii(e,t,n),Mt=s;break;default:Ii(e,t,n)}}function Rh(e,t){if(t.memoizedState===null&&(e=t.alternate,e!==null&&(e=e.memoizedState,e!==null&&(e=e.dehydrated,e!==null))))try{Or(e)}catch(n){ct(t,t.return,n)}}function og(e){switch(e.tag){case 13:case 19:var t=e.stateNode;return t===null&&(t=e.stateNode=new bh),t;case 22:return e=e.stateNode,t=e._retryCache,t===null&&(t=e._retryCache=new bh),t;default:throw Error(A(435,e.tag))}}function hu(e,t){var n=og(e);t.forEach(function(s){var r=yg.bind(null,e,s);n.has(s)||(n.add(s),s.then(r,r))})}function bn(e,t){var n=t.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s],c=e,d=t,g=d;e:for(;g!==null;){switch(g.tag){case 27:if(xa(g.type)){Ot=g.stateNode,mn=!1;break e}break;case 5:Ot=g.stateNode,mn=!1;break e;case 3:case 4:Ot=g.stateNode.containerInfo,mn=!0;break e}g=g.return}if(Ot===null)throw Error(A(160));Ah(c,d,r),Ot=null,mn=!1,c=r.alternate,c!==null&&(c.return=null),r.return=null}if(t.subtreeFlags&13878)for(t=t.child;t!==null;)Th(t,e),t=t.sibling}var Kn=null;function Th(e,t){var n=e.alternate,s=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:bn(t,e),Sn(e),s&4&&(Aa(3,e,e.return),ir(3,e),Aa(5,e,e.return));break;case 1:bn(t,e),Sn(e),s&512&&(Mt||n===null||mi(n,n.return)),s&64&&Vi&&(e=e.updateQueue,e!==null&&(s=e.callbacks,s!==null&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=n===null?s:n.concat(s))));break;case 26:var r=Kn;if(bn(t,e),Sn(e),s&512&&(Mt||n===null||mi(n,n.return)),s&4){var c=n!==null?n.memoizedState:null;if(s=e.memoizedState,n===null)if(s===null)if(e.stateNode===null){e:{s=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(s){case"title":c=r.getElementsByTagName("title")[0],(!c||c[Ha]||c[Dt]||c.namespaceURI==="http://www.w3.org/2000/svg"||c.hasAttribute("itemprop"))&&(c=r.createElement(s),r.head.insertBefore(c,r.querySelector("head > title"))),Zt(c,s,n),c[Dt]=e,xt(c),s=c;break e;case"link":var d=vd("link","href",r).get(s+(n.href||""));if(d){for(var g=0;g<d.length;g++)if(c=d[g],c.getAttribute("href")===(n.href==null||n.href===""?null:n.href)&&c.getAttribute("rel")===(n.rel==null?null:n.rel)&&c.getAttribute("title")===(n.title==null?null:n.title)&&c.getAttribute("crossorigin")===(n.crossOrigin==null?null:n.crossOrigin)){d.splice(g,1);break t}}c=r.createElement(s),Zt(c,s,n),r.head.appendChild(c);break;case"meta":if(d=vd("meta","content",r).get(s+(n.content||""))){for(g=0;g<d.length;g++)if(c=d[g],c.getAttribute("content")===(n.content==null?null:""+n.content)&&c.getAttribute("name")===(n.name==null?null:n.name)&&c.getAttribute("property")===(n.property==null?null:n.property)&&c.getAttribute("http-equiv")===(n.httpEquiv==null?null:n.httpEquiv)&&c.getAttribute("charset")===(n.charSet==null?null:n.charSet)){d.splice(g,1);break t}}c=r.createElement(s),Zt(c,s,n),r.head.appendChild(c);break;default:throw Error(A(468,s))}c[Dt]=e,xt(c),s=c}e.stateNode=s}else bd(r,e.type,e.stateNode);else e.stateNode=yd(r,s,e.memoizedProps);else c!==s?(c===null?n.stateNode!==null&&(n=n.stateNode,n.parentNode.removeChild(n)):c.count--,s===null?bd(r,e.type,e.stateNode):yd(r,s,e.memoizedProps)):s===null&&e.stateNode!==null&&ou(e,e.memoizedProps,n.memoizedProps)}break;case 27:bn(t,e),Sn(e),s&512&&(Mt||n===null||mi(n,n.return)),n!==null&&s&4&&ou(e,e.memoizedProps,n.memoizedProps);break;case 5:if(bn(t,e),Sn(e),s&512&&(Mt||n===null||mi(n,n.return)),e.flags&32){r=e.stateNode;try{ue(r,"")}catch(M){ct(e,e.return,M)}}s&4&&e.stateNode!=null&&(r=e.memoizedProps,ou(e,r,n!==null?n.memoizedProps:r)),s&1024&&(fu=!0);break;case 6:if(bn(t,e),Sn(e),s&4){if(e.stateNode===null)throw Error(A(162));s=e.memoizedProps,n=e.stateNode;try{n.nodeValue=s}catch(M){ct(e,e.return,M)}}break;case 3:if(lc=null,r=Kn,Kn=ac(t.containerInfo),bn(t,e),Kn=r,Sn(e),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Or(t.containerInfo)}catch(M){ct(e,e.return,M)}fu&&(fu=!1,Ch(e));break;case 4:s=Kn,Kn=ac(e.stateNode.containerInfo),bn(t,e),Sn(e),Kn=s;break;case 12:bn(t,e),Sn(e);break;case 13:bn(t,e),Sn(e),e.child.flags&8192&&e.memoizedState!==null!=(n!==null&&n.memoizedState!==null)&&(vu=Qe()),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,hu(e,s)));break;case 22:r=e.memoizedState!==null;var y=n!==null&&n.memoizedState!==null,C=Vi,D=Mt;if(Vi=C||r,Mt=D||y,bn(t,e),Mt=D,Vi=C,Sn(e),s&8192)e:for(t=e.stateNode,t._visibility=r?t._visibility&-2:t._visibility|1,r&&(n===null||y||Vi||Mt||us(e)),n=null,t=e;;){if(t.tag===5||t.tag===26){if(n===null){y=n=t;try{if(c=y.stateNode,r)d=c.style,typeof d.setProperty=="function"?d.setProperty("display","none","important"):d.display="none";else{g=y.stateNode;var G=y.memoizedProps.style,E=G!=null&&G.hasOwnProperty("display")?G.display:null;g.style.display=E==null||typeof E=="boolean"?"":(""+E).trim()}}catch(M){ct(y,y.return,M)}}}else if(t.tag===6){if(n===null){y=t;try{y.stateNode.nodeValue=r?"":y.memoizedProps}catch(M){ct(y,y.return,M)}}}else if((t.tag!==22&&t.tag!==23||t.memoizedState===null||t===e)&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}s&4&&(s=e.updateQueue,s!==null&&(n=s.retryQueue,n!==null&&(s.retryQueue=null,hu(e,n))));break;case 19:bn(t,e),Sn(e),s&4&&(s=e.updateQueue,s!==null&&(e.updateQueue=null,hu(e,s)));break;case 30:break;case 21:break;default:bn(t,e),Sn(e)}}function Sn(e){var t=e.flags;if(t&2){try{for(var n,s=e.return;s!==null;){if(yh(s)){n=s;break}s=s.return}if(n==null)throw Error(A(160));switch(n.tag){case 27:var r=n.stateNode,c=cu(e);Po(e,c,r);break;case 5:var d=n.stateNode;n.flags&32&&(ue(d,""),n.flags&=-33);var g=cu(e);Po(e,g,d);break;case 3:case 4:var y=n.stateNode.containerInfo,C=cu(e);uu(e,C,y);break;default:throw Error(A(161))}}catch(D){ct(e,e.return,D)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function Ch(e){if(e.subtreeFlags&1024)for(e=e.child;e!==null;){var t=e;Ch(t),t.tag===5&&t.flags&1024&&t.stateNode.reset(),e=e.sibling}}function Ra(e,t){if(t.subtreeFlags&8772)for(t=t.child;t!==null;)Sh(e,t.alternate,t),t=t.sibling}function us(e){for(e=e.child;e!==null;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:Aa(4,t,t.return),us(t);break;case 1:mi(t,t.return);var n=t.stateNode;typeof n.componentWillUnmount=="function"&&ph(t,t.return,n),us(t);break;case 27:dr(t.stateNode);case 26:case 5:mi(t,t.return),us(t);break;case 22:t.memoizedState===null&&us(t);break;case 30:us(t);break;default:us(t)}e=e.sibling}}function Ta(e,t,n){for(n=n&&(t.subtreeFlags&8772)!==0,t=t.child;t!==null;){var s=t.alternate,r=e,c=t,d=c.flags;switch(c.tag){case 0:case 11:case 15:Ta(r,c,n),ir(4,c);break;case 1:if(Ta(r,c,n),s=c,r=s.stateNode,typeof r.componentDidMount=="function")try{r.componentDidMount()}catch(C){ct(s,s.return,C)}if(s=c,r=s.updateQueue,r!==null){var g=s.stateNode;try{var y=r.shared.hiddenCallbacks;if(y!==null)for(r.shared.hiddenCallbacks=null,r=0;r<y.length;r++)ya(y[r],g)}catch(C){ct(s,s.return,C)}}n&&d&64&&gh(c),ar(c,c.return);break;case 27:vh(c);case 26:case 5:Ta(r,c,n),n&&s===null&&d&4&&mh(c),ar(c,c.return);break;case 12:Ta(r,c,n);break;case 13:Ta(r,c,n),n&&d&4&&Rh(r,c);break;case 22:c.memoizedState===null&&Ta(r,c,n),ar(c,c.return);break;case 30:break;default:Ta(r,c,n)}t=t.sibling}}function du(e,t){var n=null;e!==null&&e.memoizedState!==null&&e.memoizedState.cachePool!==null&&(n=e.memoizedState.cachePool.pool),e=null,t.memoizedState!==null&&t.memoizedState.cachePool!==null&&(e=t.memoizedState.cachePool.pool),e!==n&&(e!=null&&e.refCount++,n!=null&&ts(n))}function gu(e,t){e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ts(e))}function yi(e,t,n,s){if(t.subtreeFlags&10256)for(t=t.child;t!==null;)_h(e,t,n,s),t=t.sibling}function _h(e,t,n,s){var r=t.flags;switch(t.tag){case 0:case 11:case 15:yi(e,t,n,s),r&2048&&ir(9,t);break;case 1:yi(e,t,n,s);break;case 3:yi(e,t,n,s),r&2048&&(e=null,t.alternate!==null&&(e=t.alternate.memoizedState.cache),t=t.memoizedState.cache,t!==e&&(t.refCount++,e!=null&&ts(e)));break;case 12:if(r&2048){yi(e,t,n,s),e=t.stateNode;try{var c=t.memoizedProps,d=c.id,g=c.onPostCommit;typeof g=="function"&&g(d,t.alternate===null?"mount":"update",e.passiveEffectDuration,-0)}catch(y){ct(t,t.return,y)}}else yi(e,t,n,s);break;case 13:yi(e,t,n,s);break;case 23:break;case 22:c=t.stateNode,d=t.alternate,t.memoizedState!==null?c._visibility&2?yi(e,t,n,s):sr(e,t):c._visibility&2?yi(e,t,n,s):(c._visibility|=2,Xs(e,t,n,s,(t.subtreeFlags&10256)!==0)),r&2048&&du(d,t);break;case 24:yi(e,t,n,s),r&2048&&gu(t.alternate,t);break;default:yi(e,t,n,s)}}function Xs(e,t,n,s,r){for(r=r&&(t.subtreeFlags&10256)!==0,t=t.child;t!==null;){var c=e,d=t,g=n,y=s,C=d.flags;switch(d.tag){case 0:case 11:case 15:Xs(c,d,g,y,r),ir(8,d);break;case 23:break;case 22:var D=d.stateNode;d.memoizedState!==null?D._visibility&2?Xs(c,d,g,y,r):sr(c,d):(D._visibility|=2,Xs(c,d,g,y,r)),r&&C&2048&&du(d.alternate,d);break;case 24:Xs(c,d,g,y,r),r&&C&2048&&gu(d.alternate,d);break;default:Xs(c,d,g,y,r)}t=t.sibling}}function sr(e,t){if(t.subtreeFlags&10256)for(t=t.child;t!==null;){var n=e,s=t,r=s.flags;switch(s.tag){case 22:sr(n,s),r&2048&&du(s.alternate,s);break;case 24:sr(n,s),r&2048&&gu(s.alternate,s);break;default:sr(n,s)}t=t.sibling}}var lr=8192;function Qs(e){if(e.subtreeFlags&lr)for(e=e.child;e!==null;)Eh(e),e=e.sibling}function Eh(e){switch(e.tag){case 26:Qs(e),e.flags&lr&&e.memoizedState!==null&&Qg(Kn,e.memoizedState,e.memoizedProps);break;case 5:Qs(e);break;case 3:case 4:var t=Kn;Kn=ac(e.stateNode.containerInfo),Qs(e),Kn=t;break;case 22:e.memoizedState===null&&(t=e.alternate,t!==null&&t.memoizedState!==null?(t=lr,lr=16777216,Qs(e),lr=t):Qs(e));break;default:Qs(e)}}function Mh(e){var t=e.alternate;if(t!==null&&(e=t.child,e!==null)){t.child=null;do t=e.sibling,e.sibling=null,e=t;while(e!==null)}}function rr(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Vt=s,xh(s,e)}Mh(e)}if(e.subtreeFlags&10256)for(e=e.child;e!==null;)wh(e),e=e.sibling}function wh(e){switch(e.tag){case 0:case 11:case 15:rr(e),e.flags&2048&&Aa(9,e,e.return);break;case 3:rr(e);break;case 12:rr(e);break;case 22:var t=e.stateNode;e.memoizedState!==null&&t._visibility&2&&(e.return===null||e.return.tag!==13)?(t._visibility&=-3,Xo(e)):rr(e);break;default:rr(e)}}function Xo(e){var t=e.deletions;if((e.flags&16)!==0){if(t!==null)for(var n=0;n<t.length;n++){var s=t[n];Vt=s,xh(s,e)}Mh(e)}for(e=e.child;e!==null;){switch(t=e,t.tag){case 0:case 11:case 15:Aa(8,t,t.return),Xo(t);break;case 22:n=t.stateNode,n._visibility&2&&(n._visibility&=-3,Xo(t));break;default:Xo(t)}e=e.sibling}}function xh(e,t){for(;Vt!==null;){var n=Vt;switch(n.tag){case 0:case 11:case 15:Aa(8,n,t);break;case 23:case 22:if(n.memoizedState!==null&&n.memoizedState.cachePool!==null){var s=n.memoizedState.cachePool.pool;s!=null&&s.refCount++}break;case 24:ts(n.memoizedState.cache)}if(s=n.child,s!==null)s.return=n,Vt=s;else e:for(n=e;Vt!==null;){s=Vt;var r=s.sibling,c=s.return;if(Oh(s),s===n){Vt=null;break e}if(r!==null){r.return=c,Vt=r;break e}Vt=c}}}var cg={getCacheForType:function(e){var t=Lt(ut),n=t.data.get(e);return n===void 0&&(n=e(),t.data.set(e,n)),n}},ug=typeof WeakMap=="function"?WeakMap:Map,it=0,ft=null,je=null,Pe=0,at=0,On=null,Ca=!1,Zs=!1,pu=!1,Yi=0,Ct=0,_a=0,fs=0,mu=0,xn=0,Ks=0,or=null,yn=null,yu=!1,vu=0,Qo=1/0,Zo=null,Ea=null,Qt=0,Ma=null,Js=null,Ws=0,bu=0,Su=null,Nh=null,cr=0,Ou=null;function An(){if((it&2)!==0&&Pe!==0)return Pe&-Pe;if(N.T!==null){var e=ga;return e!==0?e:Mu()}return fl()}function Uh(){xn===0&&(xn=(Pe&536870912)===0||Ee?ol():536870912);var e=wn.current;return e!==null&&(e.flags|=32),xn}function Rn(e,t,n){(e===ft&&(at===2||at===9)||e.cancelPendingCommit!==null)&&(Fs(e,0),wa(e,Pe,xn,!1)),Zi(e,n),((it&2)===0||e!==ft)&&(e===ft&&((it&2)===0&&(fs|=n),Ct===4&&wa(e,Pe,xn,!1)),vi(e))}function kh(e,t,n){if((it&6)!==0)throw Error(A(327));var s=!n&&(t&124)===0&&(t&e.expiredLanes)===0||Qi(e,t),r=s?dg(e,t):Tu(e,t,!0),c=s;do{if(r===0){Zs&&!s&&wa(e,t,0,!1);break}else{if(n=e.current.alternate,c&&!fg(n)){r=Tu(e,t,!1),c=!1;continue}if(r===2){if(c=t,e.errorRecoveryDisabledLanes&c)var d=0;else d=e.pendingLanes&-536870913,d=d!==0?d:d&536870912?536870912:0;if(d!==0){t=d;e:{var g=e;r=or;var y=g.current.memoizedState.isDehydrated;if(y&&(Fs(g,d).flags|=256),d=Tu(g,d,!1),d!==2){if(pu&&!y){g.errorRecoveryDisabledLanes|=c,fs|=c,r=4;break e}c=yn,yn=r,c!==null&&(yn===null?yn=c:yn.push.apply(yn,c))}r=d}if(c=!1,r!==2)continue}}if(r===1){Fs(e,0),wa(e,t,0,!0);break}e:{switch(s=e,c=r,c){case 0:case 1:throw Error(A(345));case 4:if((t&4194048)!==t)break;case 6:wa(s,t,xn,!Ca);break e;case 2:yn=null;break;case 3:case 5:break;default:throw Error(A(329))}if((t&62914560)===t&&(r=vu+300-Qe(),10<r)){if(wa(s,t,xn,!Ca),ja(s,0,!0)!==0)break e;s.timeoutHandle=od(Dh.bind(null,s,n,yn,Zo,yu,t,xn,fs,Ks,Ca,c,2,-0,0),r);break e}Dh(s,n,yn,Zo,yu,t,xn,fs,Ks,Ca,c,0,-0,0)}}break}while(!0);vi(e)}function Dh(e,t,n,s,r,c,d,g,y,C,D,G,E,M){if(e.timeoutHandle=-1,G=t.subtreeFlags,(G&8192||(G&16785408)===16785408)&&(mr={stylesheets:null,count:0,unsuspend:Xg},Eh(t),G=Zg(),G!==null)){e.cancelPendingCommit=G(Gh.bind(null,e,t,c,n,s,r,d,g,y,D,1,E,M)),wa(e,c,d,!C);return}Gh(e,t,c,n,s,r,d,g,y)}function fg(e){for(var t=e;;){var n=t.tag;if((n===0||n===11||n===15)&&t.flags&16384&&(n=t.updateQueue,n!==null&&(n=n.stores,n!==null)))for(var s=0;s<n.length;s++){var r=n[s],c=r.getSnapshot;r=r.value;try{if(!an(c(),r))return!1}catch{return!1}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function wa(e,t,n,s){t&=~mu,t&=~fs,e.suspendedLanes|=t,e.pingedLanes&=~t,s&&(e.warmLanes|=t),s=e.expirationTimes;for(var r=t;0<r;){var c=31-dt(r),d=1<<c;s[c]=-1,r&=~d}n!==0&&xr(e,n,t)}function Ko(){return(it&6)===0?(ur(0),!1):!0}function Au(){if(je!==null){if(at===0)var e=je.return;else e=je,Qn=En=null,l(e),Ys=null,er=0,e=je;for(;e!==null;)dh(e.alternate,e),e=e.return;je=null}}function Fs(e,t){var n=e.timeoutHandle;n!==-1&&(e.timeoutHandle=-1,wg(n)),n=e.cancelPendingCommit,n!==null&&(e.cancelPendingCommit=null,n()),Au(),ft=e,je=n=qn(e.current,null),Pe=t,at=0,On=null,Ca=!1,Zs=Qi(e,t),pu=!1,Ks=xn=mu=fs=_a=Ct=0,yn=or=null,yu=!1,(t&8)!==0&&(t|=t&32);var s=e.entangledLanes;if(s!==0)for(e=e.entanglements,s&=t;0<s;){var r=31-dt(s),c=1<<r;t|=e[r],s&=~c}return Yi=t,Us(),n}function Lh(e,t){xe=null,N.H=Bo,t===ns||t===zs?(t=xo(),at=3):t===Eo?(t=xo(),at=4):at=t===$f?8:t!==null&&typeof t=="object"&&typeof t.then=="function"?6:1,On=t,je===null&&(Ct=1,Go(e,hn(t,e.current)))}function Bh(){var e=N.H;return N.H=Bo,e===null?Bo:e}function zh(){var e=N.A;return N.A=cg,e}function Ru(){Ct=4,Ca||(Pe&4194048)!==Pe&&wn.current!==null||(Zs=!0),(_a&134217727)===0&&(fs&134217727)===0||ft===null||wa(ft,Pe,xn,!1)}function Tu(e,t,n){var s=it;it|=2;var r=Bh(),c=zh();(ft!==e||Pe!==t)&&(Zo=null,Fs(e,t)),t=!1;var d=Ct;e:do try{if(at!==0&&je!==null){var g=je,y=On;switch(at){case 8:Au(),d=6;break e;case 3:case 2:case 9:case 6:wn.current===null&&(t=!0);var C=at;if(at=0,On=null,$s(e,g,y,C),n&&Zs){d=0;break e}break;default:C=at,at=0,On=null,$s(e,g,y,C)}}hg(),d=Ct;break}catch(D){Lh(e,D)}while(!0);return t&&e.shellSuspendCounter++,Qn=En=null,it=s,N.H=r,N.A=c,je===null&&(ft=null,Pe=0,Us()),d}function hg(){for(;je!==null;)jh(je)}function dg(e,t){var n=it;it|=2;var s=Bh(),r=zh();ft!==e||Pe!==t?(Zo=null,Qo=Qe()+500,Fs(e,t)):Zs=Qi(e,t);e:do try{if(at!==0&&je!==null){t=je;var c=On;t:switch(at){case 1:at=0,On=null,$s(e,t,c,1);break;case 2:case 9:if(Mo(c)){at=0,On=null,qh(t);break}t=function(){at!==2&&at!==9||ft!==e||(at=7),vi(e)},c.then(t,t);break e;case 3:at=7;break e;case 4:at=5;break e;case 7:Mo(c)?(at=0,On=null,qh(t)):(at=0,On=null,$s(e,t,c,7));break;case 5:var d=null;switch(je.tag){case 26:d=je.memoizedState;case 5:case 27:var g=je;if(!d||Sd(d)){at=0,On=null;var y=g.sibling;if(y!==null)je=y;else{var C=g.return;C!==null?(je=C,Jo(C)):je=null}break t}}at=0,On=null,$s(e,t,c,5);break;case 6:at=0,On=null,$s(e,t,c,6);break;case 8:Au(),Ct=6;break e;default:throw Error(A(462))}}gg();break}catch(D){Lh(e,D)}while(!0);return Qn=En=null,N.H=s,N.A=r,it=n,je!==null?0:(ft=null,Pe=0,Us(),Ct)}function gg(){for(;je!==null&&!De();)jh(je)}function jh(e){var t=fh(e.alternate,e,Yi);e.memoizedProps=e.pendingProps,t===null?Jo(e):je=t}function qh(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=sh(n,t,t.pendingProps,t.type,void 0,Pe);break;case 11:t=sh(n,t,t.pendingProps,t.type.render,t.ref,Pe);break;case 5:l(t);default:dh(n,t),t=je=So(t,Yi),t=fh(n,t,Yi)}e.memoizedProps=e.pendingProps,t===null?Jo(e):je=t}function $s(e,t,n,s){Qn=En=null,l(t),Ys=null,er=0;var r=t.return;try{if(ig(e,r,t,n,Pe)){Ct=1,Go(e,hn(n,e.current)),je=null;return}}catch(c){if(r!==null)throw je=r,c;Ct=1,Go(e,hn(n,e.current)),je=null;return}t.flags&32768?(Ee||s===1?e=!0:Zs||(Pe&536870912)!==0?e=!1:(Ca=e=!0,(s===2||s===9||s===3||s===6)&&(s=wn.current,s!==null&&s.tag===13&&(s.flags|=16384))),Hh(t,e)):Jo(t)}function Jo(e){var t=e;do{if((t.flags&32768)!==0){Hh(t,Ca);return}e=t.return;var n=sg(t.alternate,t,Yi);if(n!==null){je=n;return}if(t=t.sibling,t!==null){je=t;return}je=t=e}while(t!==null);Ct===0&&(Ct=5)}function Hh(e,t){do{var n=lg(e.alternate,e);if(n!==null){n.flags&=32767,je=n;return}if(n=e.return,n!==null&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&(e=e.sibling,e!==null)){je=e;return}je=e=n}while(e!==null);Ct=6,je=null}function Gh(e,t,n,s,r,c,d,g,y){e.cancelPendingCommit=null;do Wo();while(Qt!==0);if((it&6)!==0)throw Error(A(327));if(t!==null){if(t===e.current)throw Error(A(177));if(c=t.lanes|t.childLanes,c|=kl,wr(e,n,c,d,g,y),e===ft&&(je=ft=null,Pe=0),Js=t,Ma=e,Ws=n,bu=c,Su=r,Nh=s,(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?(e.callbackNode=null,e.callbackPriority=0,vg(Y,function(){return Xh(),null})):(e.callbackNode=null,e.callbackPriority=0),s=(t.flags&13878)!==0,(t.subtreeFlags&13878)!==0||s){s=N.T,N.T=null,r=U.p,U.p=2,d=it,it|=4;try{rg(e,t,n)}finally{it=d,U.p=r,N.T=s}}Qt=1,Vh(),Ih(),Yh()}}function Vh(){if(Qt===1){Qt=0;var e=Ma,t=Js,n=(t.flags&13878)!==0;if((t.subtreeFlags&13878)!==0||n){n=N.T,N.T=null;var s=U.p;U.p=2;var r=it;it|=4;try{Th(t,e);var c=Bu,d=Ft(e.containerInfo),g=c.focusedElem,y=c.selectionRange;if(d!==g&&g&&g.ownerDocument&&xl(g.ownerDocument.documentElement,g)){if(y!==null&&Za(g)){var C=y.start,D=y.end;if(D===void 0&&(D=C),"selectionStart"in g)g.selectionStart=C,g.selectionEnd=Math.min(D,g.value.length);else{var G=g.ownerDocument||document,E=G&&G.defaultView||window;if(E.getSelection){var M=E.getSelection(),Oe=g.textContent.length,me=Math.min(y.start,Oe),ot=y.end===void 0?me:Math.min(y.end,Oe);!M.extend&&me>ot&&(d=ot,ot=me,me=d);var O=ws(g,me),b=ws(g,ot);if(O&&b&&(M.rangeCount!==1||M.anchorNode!==O.node||M.anchorOffset!==O.offset||M.focusNode!==b.node||M.focusOffset!==b.offset)){var R=G.createRange();R.setStart(O.node,O.offset),M.removeAllRanges(),me>ot?(M.addRange(R),M.extend(b.node,b.offset)):(R.setEnd(b.node,b.offset),M.addRange(R))}}}}for(G=[],M=g;M=M.parentNode;)M.nodeType===1&&G.push({element:M,left:M.scrollLeft,top:M.scrollTop});for(typeof g.focus=="function"&&g.focus(),g=0;g<G.length;g++){var q=G[g];q.element.scrollLeft=q.left,q.element.scrollTop=q.top}}cc=!!Lu,Bu=Lu=null}finally{it=r,U.p=s,N.T=n}}e.current=t,Qt=2}}function Ih(){if(Qt===2){Qt=0;var e=Ma,t=Js,n=(t.flags&8772)!==0;if((t.subtreeFlags&8772)!==0||n){n=N.T,N.T=null;var s=U.p;U.p=2;var r=it;it|=4;try{Sh(e,t.alternate,t)}finally{it=r,U.p=s,N.T=n}}Qt=3}}function Yh(){if(Qt===4||Qt===3){Qt=0,ht();var e=Ma,t=Js,n=Ws,s=Nh;(t.subtreeFlags&10256)!==0||(t.flags&10256)!==0?Qt=5:(Qt=0,Js=Ma=null,Ph(e,e.pendingLanes));var r=e.pendingLanes;if(r===0&&(Ea=null),ul(n),t=t.stateNode,_e&&typeof _e.onCommitFiberRoot=="function")try{_e.onCommitFiberRoot(Me,t,void 0,(t.current.flags&128)===128)}catch{}if(s!==null){t=N.T,r=U.p,U.p=2,N.T=null;try{for(var c=e.onRecoverableError,d=0;d<s.length;d++){var g=s[d];c(g.value,{componentStack:g.stack})}}finally{N.T=t,U.p=r}}(Ws&3)!==0&&Wo(),vi(e),r=e.pendingLanes,(n&4194090)!==0&&(r&42)!==0?e===Ou?cr++:(cr=0,Ou=e):cr=0,ur(0)}}function Ph(e,t){(e.pooledCacheLanes&=t)===0&&(t=e.pooledCache,t!=null&&(e.pooledCache=null,ts(t)))}function Wo(e){return Vh(),Ih(),Yh(),Xh()}function Xh(){if(Qt!==5)return!1;var e=Ma,t=bu;bu=0;var n=ul(Ws),s=N.T,r=U.p;try{U.p=32>n?32:n,N.T=null,n=Su,Su=null;var c=Ma,d=Ws;if(Qt=0,Js=Ma=null,Ws=0,(it&6)!==0)throw Error(A(331));var g=it;if(it|=4,wh(c.current),_h(c,c.current,d,n),it=g,ur(0,!1),_e&&typeof _e.onPostCommitFiberRoot=="function")try{_e.onPostCommitFiberRoot(Me,c)}catch{}return!0}finally{U.p=r,N.T=s,Ph(e,t)}}function Qh(e,t,n){t=hn(n,t),t=$c(e.stateNode,t,2),e=fi(e,t,2),e!==null&&(Zi(e,2),vi(e))}function ct(e,t,n){if(e.tag===3)Qh(e,e,n);else for(;t!==null;){if(t.tag===3){Qh(t,e,n);break}else if(t.tag===1){var s=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Ea===null||!Ea.has(s))){e=hn(n,e),n=Wf(2),s=fi(t,n,2),s!==null&&(Ff(n,s,t,e),Zi(s,2),vi(s));break}}t=t.return}}function Cu(e,t,n){var s=e.pingCache;if(s===null){s=e.pingCache=new ug;var r=new Set;s.set(t,r)}else r=s.get(t),r===void 0&&(r=new Set,s.set(t,r));r.has(n)||(pu=!0,r.add(n),e=pg.bind(null,e,t,n),t.then(e,e))}function pg(e,t,n){var s=e.pingCache;s!==null&&s.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ft===e&&(Pe&n)===n&&(Ct===4||Ct===3&&(Pe&62914560)===Pe&&300>Qe()-vu?(it&2)===0&&Fs(e,0):mu|=n,Ks===Pe&&(Ks=0)),vi(e)}function Zh(e,t){t===0&&(t=qa()),e=ra(e,t),e!==null&&(Zi(e,t),vi(e))}function mg(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Zh(e,n)}function yg(e,t){var n=0;switch(e.tag){case 13:var s=e.stateNode,r=e.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=e.stateNode;break;case 22:s=e.stateNode._retryCache;break;default:throw Error(A(314))}s!==null&&s.delete(t),Zh(e,n)}function vg(e,t){return V(e,t)}var Fo=null,el=null,_u=!1,$o=!1,Eu=!1,hs=0;function vi(e){e!==el&&e.next===null&&(el===null?Fo=el=e:el=el.next=e),$o=!0,_u||(_u=!0,Sg())}function ur(e,t){if(!Eu&&$o){Eu=!0;do for(var n=!1,s=Fo;s!==null;){if(e!==0){var r=s.pendingLanes;if(r===0)var c=0;else{var d=s.suspendedLanes,g=s.pingedLanes;c=(1<<31-dt(42|e)+1)-1,c&=r&~(d&~g),c=c&201326741?c&201326741|1:c?c|2:0}c!==0&&(n=!0,Fh(s,c))}else c=Pe,c=ja(s,s===ft?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),(c&3)===0||Qi(s,c)||(n=!0,Fh(s,c));s=s.next}while(n);Eu=!1}}function bg(){Kh()}function Kh(){$o=_u=!1;var e=0;hs!==0&&(Mg()&&(e=hs),hs=0);for(var t=Qe(),n=null,s=Fo;s!==null;){var r=s.next,c=Jh(s,t);c===0?(s.next=null,n===null?Fo=r:n.next=r,r===null&&(el=n)):(n=s,(e!==0||(c&3)!==0)&&($o=!0)),s=r}ur(e)}function Jh(e,t){for(var n=e.suspendedLanes,s=e.pingedLanes,r=e.expirationTimes,c=e.pendingLanes&-62914561;0<c;){var d=31-dt(c),g=1<<d,y=r[d];y===-1?((g&n)===0||(g&s)!==0)&&(r[d]=ds(g,t)):y<=t&&(e.expiredLanes|=g),c&=~g}if(t=ft,n=Pe,n=ja(e,e===t?n:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s=e.callbackNode,n===0||e===t&&(at===2||at===9)||e.cancelPendingCommit!==null)return s!==null&&s!==null&&Z(s),e.callbackNode=null,e.callbackPriority=0;if((n&3)===0||Qi(e,n)){if(t=n&-n,t===e.callbackPriority)return t;switch(s!==null&&Z(s),ul(n)){case 2:case 8:n=Jt;break;case 32:n=Y;break;case 268435456:n=ie;break;default:n=Y}return s=Wh.bind(null,e),n=V(n,s),e.callbackPriority=t,e.callbackNode=n,t}return s!==null&&s!==null&&Z(s),e.callbackPriority=2,e.callbackNode=null,2}function Wh(e,t){if(Qt!==0&&Qt!==5)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Wo()&&e.callbackNode!==n)return null;var s=Pe;return s=ja(e,e===ft?s:0,e.cancelPendingCommit!==null||e.timeoutHandle!==-1),s===0?null:(kh(e,s,t),Jh(e,Qe()),e.callbackNode!=null&&e.callbackNode===n?Wh.bind(null,e):null)}function Fh(e,t){if(Wo())return null;kh(e,t,!0)}function Sg(){xg(function(){(it&6)!==0?V(jt,bg):Kh()})}function Mu(){return hs===0&&(hs=ol()),hs}function $h(e){return e==null||typeof e=="symbol"||typeof e=="boolean"?null:typeof e=="function"?e:Ss(""+e)}function ed(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}function Og(e,t,n,s,r){if(t==="submit"&&n&&n.stateNode===r){var c=$h((r[Yt]||null).action),d=s.submitter;d&&(t=(t=d[Yt]||null)?$h(t.formAction):d.getAttribute("formAction"),t!==null&&(c=t,d=null));var g=new Cs("action","action",null,s,r);e.push({event:g,listeners:[{instance:null,listener:function(){if(s.defaultPrevented){if(hs!==0){var y=d?ed(r,d):new FormData(r);Zc(n,{pending:!0,data:y,method:r.method,action:c},null,y)}}else typeof c=="function"&&(g.preventDefault(),y=d?ed(r,d):new FormData(r),Zc(n,{pending:!0,data:y,method:r.method,action:c},c,y))},currentTarget:r}]})}}for(var wu=0;wu<sa.length;wu++){var xu=sa[wu],Ag=xu.toLowerCase(),Rg=xu[0].toUpperCase()+xu.slice(1);Nt(Ag,"on"+Rg)}Nt(li,"onAnimationEnd"),Nt(Ns,"onAnimationIteration"),Nt(go,"onAnimationStart"),Nt("dblclick","onDoubleClick"),Nt("focusin","onFocus"),Nt("focusout","onBlur"),Nt(po,"onTransitionRun"),Nt(mo,"onTransitionStart"),Nt(Gc,"onTransitionCancel"),Nt(yo,"onTransitionEnd"),$n("onMouseEnter",["mouseout","mouseover"]),$n("onMouseLeave",["mouseout","mouseover"]),$n("onPointerEnter",["pointerout","pointerover"]),$n("onPointerLeave",["pointerout","pointerover"]),Si("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Si("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Si("onBeforeInput",["compositionend","keypress","textInput","paste"]),Si("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Si("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Si("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tg=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fr));function td(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var s=e[n],r=s.event;s=s.listeners;e:{var c=void 0;if(t)for(var d=s.length-1;0<=d;d--){var g=s[d],y=g.instance,C=g.currentTarget;if(g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=C;try{c(r)}catch(D){Ho(D)}r.currentTarget=null,c=y}else for(d=0;d<s.length;d++){if(g=s[d],y=g.instance,C=g.currentTarget,g=g.listener,y!==c&&r.isPropagationStopped())break e;c=g,r.currentTarget=C;try{c(r)}catch(D){Ho(D)}r.currentTarget=null,c=y}}}}function qe(e,t){var n=t[gs];n===void 0&&(n=t[gs]=new Set);var s=e+"__bubble";n.has(s)||(nd(t,e,2,!1),n.add(s))}function Nu(e,t,n){var s=0;t&&(s|=4),nd(n,e,s,t)}var ec="_reactListening"+Math.random().toString(36).slice(2);function Uu(e){if(!e[ec]){e[ec]=!0,ve.forEach(function(n){n!=="selectionchange"&&(Tg.has(n)||Nu(n,!1,e),Nu(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[ec]||(t[ec]=!0,Nu("selectionchange",!1,t))}}function nd(e,t,n,s){switch(_d(t)){case 2:var r=Wg;break;case 8:r=Fg;break;default:r=Xu}n=r.bind(null,t,n,e),r=void 0,!ii||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(r=!0),s?r!==void 0?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):r!==void 0?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function ku(e,t,n,s,r){var c=s;if((t&1)===0&&(t&2)===0&&s!==null)e:for(;;){if(s===null)return;var d=s.tag;if(d===3||d===4){var g=s.stateNode.containerInfo;if(g===r)break;if(d===4)for(d=s.return;d!==null;){var y=d.tag;if((y===3||y===4)&&d.stateNode.containerInfo===r)return;d=d.return}for(;g!==null;){if(d=Ln(g),d===null)return;if(y=d.tag,y===5||y===6||y===26||y===27){s=c=d;continue e}g=g.parentNode}}s=s.return}Ol(function(){var C=c,D=Ga(n),G=[];e:{var E=vo.get(e);if(E!==void 0){var M=Cs,Oe=e;switch(e){case"keypress":if(Ia(n)===0)break e;case"keydown":case"keyup":M=Nc;break;case"focusin":Oe="focus",M=Tl;break;case"focusout":Oe="blur",M=Tl;break;case"beforeblur":case"afterblur":M=Tl;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":M=Rl;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":M=Es;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":M=Zr;break;case li:case Ns:case go:M=Ec;break;case yo:M=Dc;break;case"scroll":case"scrollend":M=Rc;break;case"wheel":M=Kr;break;case"copy":case"cut":case"paste":M=Gr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":M=Qr;break;case"toggle":case"beforetoggle":M=Cl}var me=(t&4)!==0,ot=!me&&(e==="scroll"||e==="scrollend"),O=me?E!==null?E+"Capture":null:E;me=[];for(var b=C,R;b!==null;){var q=b;if(R=q.stateNode,q=q.tag,q!==5&&q!==26&&q!==27||R===null||O===null||(q=ni(b,O),q!=null&&me.push(hr(b,q,R))),ot)break;b=b.return}0<me.length&&(E=new M(E,Oe,null,n,D),G.push({event:E,listeners:me}))}}if((t&7)===0){e:{if(E=e==="mouseover"||e==="pointerover",M=e==="mouseout"||e==="pointerout",E&&n!==Os&&(Oe=n.relatedTarget||n.fromElement)&&(Ln(Oe)||Oe[Ki]))break e;if((M||E)&&(E=D.window===D?D:(E=D.ownerDocument)?E.defaultView||E.parentWindow:window,M?(Oe=n.relatedTarget||n.toElement,M=C,Oe=Oe?Ln(Oe):null,Oe!==null&&(ot=J(Oe),me=Oe.tag,Oe!==ot||me!==5&&me!==27&&me!==6)&&(Oe=null)):(M=null,Oe=C),M!==Oe)){if(me=Rl,q="onMouseLeave",O="onMouseEnter",b="mouse",(e==="pointerout"||e==="pointerover")&&(me=Qr,q="onPointerLeave",O="onPointerEnter",b="pointer"),ot=M==null?E:Fn(M),R=Oe==null?E:Fn(Oe),E=new me(q,b+"leave",M,n,D),E.target=ot,E.relatedTarget=R,q=null,Ln(D)===C&&(me=new me(O,b+"enter",Oe,n,D),me.target=R,me.relatedTarget=ot,q=me),ot=q,M&&Oe)t:{for(me=M,O=Oe,b=0,R=me;R;R=tl(R))b++;for(R=0,q=O;q;q=tl(q))R++;for(;0<b-R;)me=tl(me),b--;for(;0<R-b;)O=tl(O),R--;for(;b--;){if(me===O||O!==null&&me===O.alternate)break t;me=tl(me),O=tl(O)}me=null}else me=null;M!==null&&id(G,E,M,me,!1),Oe!==null&&ot!==null&&id(G,ot,Oe,me,!0)}}e:{if(E=C?Fn(C):window,M=E.nodeName&&E.nodeName.toLowerCase(),M==="select"||M==="input"&&E.type==="file")var ae=so;else if(io(E))if(lo)ae=Hc;else{ae=oo;var ze=ro}else M=E.nodeName,!M||M.toLowerCase()!=="input"||E.type!=="checkbox"&&E.type!=="radio"?C&&bs(C.elementType)&&(ae=so):ae=co;if(ae&&(ae=ae(e,C))){_l(G,ae,n,D);break e}ze&&ze(e,E,C),e==="focusout"&&C&&E.type==="number"&&C.memoizedProps.value!=null&&bl(E,"number",E.value)}switch(ze=C?Fn(C):window,e){case"focusin":(io(ze)||ze.contentEditable==="true")&&(aa=ze,Ul=C,Ei=null);break;case"focusout":Ei=Ul=aa=null;break;case"mousedown":xs=!0;break;case"contextmenu":case"mouseup":case"dragend":xs=!1,fo(G,n,D);break;case"selectionchange":if(Nl)break;case"keydown":case"keyup":fo(G,n,D)}var fe;if(Ti)e:{switch(e){case"compositionstart":var ye="onCompositionStart";break e;case"compositionend":ye="onCompositionEnd";break e;case"compositionupdate":ye="onCompositionUpdate";break e}ye=void 0}else Ci?eo(e,n)&&(ye="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(ye="onCompositionStart");ye&&(Wr&&n.locale!=="ko"&&(Ci||ye!=="onCompositionStart"?ye==="onCompositionEnd"&&Ci&&(fe=Ri()):(zn=D,As="value"in zn?zn.value:zn.textContent,Ci=!0)),ze=tc(C,ye),0<ze.length&&(ye=new Ir(ye,e,null,n,D),G.push({event:ye,listeners:ze}),fe?ye.data=fe:(fe=to(n),fe!==null&&(ye.data=fe)))),(fe=zc?jc(e,n):no(e,n))&&(ye=tc(C,"onBeforeInput"),0<ye.length&&(ze=new Ir("onBeforeInput","beforeinput",null,n,D),G.push({event:ze,listeners:ye}),ze.data=fe)),Og(G,e,C,n,D)}td(G,t)})}function hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function tc(e,t){for(var n=t+"Capture",s=[];e!==null;){var r=e,c=r.stateNode;if(r=r.tag,r!==5&&r!==26&&r!==27||c===null||(r=ni(e,n),r!=null&&s.unshift(hr(e,r,c)),r=ni(e,t),r!=null&&s.push(hr(e,r,c))),e.tag===3)return s;e=e.return}return[]}function tl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5&&e.tag!==27);return e||null}function id(e,t,n,s,r){for(var c=t._reactName,d=[];n!==null&&n!==s;){var g=n,y=g.alternate,C=g.stateNode;if(g=g.tag,y!==null&&y===s)break;g!==5&&g!==26&&g!==27||C===null||(y=C,r?(C=ni(n,c),C!=null&&d.unshift(hr(n,C,y))):r||(C=ni(n,c),C!=null&&d.push(hr(n,C,y)))),n=n.return}d.length!==0&&e.push({event:t,listeners:d})}var Cg=/\r\n?/g,_g=/\u0000|\uFFFD/g;function ad(e){return(typeof e=="string"?e:""+e).replace(Cg,`
`).replace(_g,"")}function sd(e,t){return t=ad(t),ad(e)===t}function nc(){}function rt(e,t,n,s,r,c){switch(n){case"children":typeof s=="string"?t==="body"||t==="textarea"&&s===""||ue(e,s):(typeof s=="number"||typeof s=="bigint")&&t!=="body"&&ue(e,""+s);break;case"className":Wi(e,"class",s);break;case"tabIndex":Wi(e,"tabindex",s);break;case"dir":case"role":case"viewBox":case"width":case"height":Wi(e,n,s);break;case"style":jr(e,s,c);break;case"data":if(t!=="object"){Wi(e,"data",s);break}case"src":case"href":if(s===""&&(t!=="a"||n!=="href")){e.removeAttribute(n);break}if(s==null||typeof s=="function"||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Ss(""+s),e.setAttribute(n,s);break;case"action":case"formAction":if(typeof s=="function"){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof c=="function"&&(n==="formAction"?(t!=="input"&&rt(e,t,"name",r.name,r,null),rt(e,t,"formEncType",r.formEncType,r,null),rt(e,t,"formMethod",r.formMethod,r,null),rt(e,t,"formTarget",r.formTarget,r,null)):(rt(e,t,"encType",r.encType,r,null),rt(e,t,"method",r.method,r,null),rt(e,t,"target",r.target,r,null)));if(s==null||typeof s=="symbol"||typeof s=="boolean"){e.removeAttribute(n);break}s=Ss(""+s),e.setAttribute(n,s);break;case"onClick":s!=null&&(e.onclick=nc);break;case"onScroll":s!=null&&qe("scroll",e);break;case"onScrollEnd":s!=null&&qe("scrollend",e);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(A(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(A(60));e.innerHTML=n}}break;case"multiple":e.multiple=s&&typeof s!="function"&&typeof s!="symbol";break;case"muted":e.muted=s&&typeof s!="function"&&typeof s!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(s==null||typeof s=="function"||typeof s=="boolean"||typeof s=="symbol"){e.removeAttribute("xlink:href");break}n=Ss(""+s),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""+s):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":s&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":s===!0?e.setAttribute(n,""):s!==!1&&s!=null&&typeof s!="function"&&typeof s!="symbol"?e.setAttribute(n,s):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":s!=null&&typeof s!="function"&&typeof s!="symbol"&&!isNaN(s)&&1<=s?e.setAttribute(n,s):e.removeAttribute(n);break;case"rowSpan":case"start":s==null||typeof s=="function"||typeof s=="symbol"||isNaN(s)?e.removeAttribute(n):e.setAttribute(n,s);break;case"popover":qe("beforetoggle",e),qe("toggle",e),Oi(e,"popover",s);break;case"xlinkActuate":Bn(e,"http://www.w3.org/1999/xlink","xlink:actuate",s);break;case"xlinkArcrole":Bn(e,"http://www.w3.org/1999/xlink","xlink:arcrole",s);break;case"xlinkRole":Bn(e,"http://www.w3.org/1999/xlink","xlink:role",s);break;case"xlinkShow":Bn(e,"http://www.w3.org/1999/xlink","xlink:show",s);break;case"xlinkTitle":Bn(e,"http://www.w3.org/1999/xlink","xlink:title",s);break;case"xlinkType":Bn(e,"http://www.w3.org/1999/xlink","xlink:type",s);break;case"xmlBase":Bn(e,"http://www.w3.org/XML/1998/namespace","xml:base",s);break;case"xmlLang":Bn(e,"http://www.w3.org/XML/1998/namespace","xml:lang",s);break;case"xmlSpace":Bn(e,"http://www.w3.org/XML/1998/namespace","xml:space",s);break;case"is":Oi(e,"is",s);break;case"innerText":case"textContent":break;default:(!(2<n.length)||n[0]!=="o"&&n[0]!=="O"||n[1]!=="n"&&n[1]!=="N")&&(n=Ac.get(n)||n,Oi(e,n,s))}}function Du(e,t,n,s,r,c){switch(n){case"style":jr(e,s,c);break;case"dangerouslySetInnerHTML":if(s!=null){if(typeof s!="object"||!("__html"in s))throw Error(A(61));if(n=s.__html,n!=null){if(r.children!=null)throw Error(A(60));e.innerHTML=n}}break;case"children":typeof s=="string"?ue(e,s):(typeof s=="number"||typeof s=="bigint")&&ue(e,""+s);break;case"onScroll":s!=null&&qe("scroll",e);break;case"onScrollEnd":s!=null&&qe("scrollend",e);break;case"onClick":s!=null&&(e.onclick=nc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!kr.hasOwnProperty(n))e:{if(n[0]==="o"&&n[1]==="n"&&(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),c=e[Yt]||null,c=c!=null?c[n]:null,typeof c=="function"&&e.removeEventListener(t,c,r),typeof s=="function")){typeof c!="function"&&c!==null&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,s,r);break e}n in e?e[n]=s:s===!0?e.setAttribute(n,""):Oi(e,n,s)}}}function Zt(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qe("error",e),qe("load",e);var s=!1,r=!1,c;for(c in n)if(n.hasOwnProperty(c)){var d=n[c];if(d!=null)switch(c){case"src":s=!0;break;case"srcSet":r=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(A(137,t));default:rt(e,t,c,d,n,null)}}r&&rt(e,t,"srcSet",n.srcSet,n,null),s&&rt(e,t,"src",n.src,n,null);return;case"input":qe("invalid",e);var g=c=d=r=null,y=null,C=null;for(s in n)if(n.hasOwnProperty(s)){var D=n[s];if(D!=null)switch(s){case"name":r=D;break;case"type":d=D;break;case"checked":y=D;break;case"defaultChecked":C=D;break;case"value":c=D;break;case"defaultValue":g=D;break;case"children":case"dangerouslySetInnerHTML":if(D!=null)throw Error(A(137,t));break;default:rt(e,t,s,D,n,null)}}vs(e,c,g,y,C,d,r,!1),ys(e);return;case"select":qe("invalid",e),s=d=c=null;for(r in n)if(n.hasOwnProperty(r)&&(g=n[r],g!=null))switch(r){case"value":c=g;break;case"defaultValue":d=g;break;case"multiple":s=g;default:rt(e,t,r,g,n,null)}t=c,n=d,e.multiple=!!s,t!=null?ei(e,!!s,t,!1):n!=null&&ei(e,!!s,n,!0);return;case"textarea":qe("invalid",e),c=r=s=null;for(d in n)if(n.hasOwnProperty(d)&&(g=n[d],g!=null))switch(d){case"value":s=g;break;case"defaultValue":r=g;break;case"children":c=g;break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(A(91));break;default:rt(e,t,d,g,n,null)}Et(e,s,r,c),ys(e);return;case"option":for(y in n)if(n.hasOwnProperty(y)&&(s=n[y],s!=null))switch(y){case"selected":e.selected=s&&typeof s!="function"&&typeof s!="symbol";break;default:rt(e,t,y,s,n,null)}return;case"dialog":qe("beforetoggle",e),qe("toggle",e),qe("cancel",e),qe("close",e);break;case"iframe":case"object":qe("load",e);break;case"video":case"audio":for(s=0;s<fr.length;s++)qe(fr[s],e);break;case"image":qe("error",e),qe("load",e);break;case"details":qe("toggle",e);break;case"embed":case"source":case"link":qe("error",e),qe("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(C in n)if(n.hasOwnProperty(C)&&(s=n[C],s!=null))switch(C){case"children":case"dangerouslySetInnerHTML":throw Error(A(137,t));default:rt(e,t,C,s,n,null)}return;default:if(bs(t)){for(D in n)n.hasOwnProperty(D)&&(s=n[D],s!==void 0&&Du(e,t,D,s,n,void 0));return}}for(g in n)n.hasOwnProperty(g)&&(s=n[g],s!=null&&rt(e,t,g,s,n,null))}function Eg(e,t,n,s){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,c=null,d=null,g=null,y=null,C=null,D=null;for(M in n){var G=n[M];if(n.hasOwnProperty(M)&&G!=null)switch(M){case"checked":break;case"value":break;case"defaultValue":y=G;default:s.hasOwnProperty(M)||rt(e,t,M,null,s,G)}}for(var E in s){var M=s[E];if(G=n[E],s.hasOwnProperty(E)&&(M!=null||G!=null))switch(E){case"type":c=M;break;case"name":r=M;break;case"checked":C=M;break;case"defaultChecked":D=M;break;case"value":d=M;break;case"defaultValue":g=M;break;case"children":case"dangerouslySetInnerHTML":if(M!=null)throw Error(A(137,t));break;default:M!==G&&rt(e,t,E,M,s,G)}}vl(e,d,g,y,C,D,c,r);return;case"select":M=d=g=E=null;for(c in n)if(y=n[c],n.hasOwnProperty(c)&&y!=null)switch(c){case"value":break;case"multiple":M=y;default:s.hasOwnProperty(c)||rt(e,t,c,null,s,y)}for(r in s)if(c=s[r],y=n[r],s.hasOwnProperty(r)&&(c!=null||y!=null))switch(r){case"value":E=c;break;case"defaultValue":g=c;break;case"multiple":d=c;default:c!==y&&rt(e,t,r,c,s,y)}t=g,n=d,s=M,E!=null?ei(e,!!n,E,!1):!!s!=!!n&&(t!=null?ei(e,!!n,t,!0):ei(e,!!n,n?[]:"",!1));return;case"textarea":M=E=null;for(g in n)if(r=n[g],n.hasOwnProperty(g)&&r!=null&&!s.hasOwnProperty(g))switch(g){case"value":break;case"children":break;default:rt(e,t,g,null,s,r)}for(d in s)if(r=s[d],c=n[d],s.hasOwnProperty(d)&&(r!=null||c!=null))switch(d){case"value":E=r;break;case"defaultValue":M=r;break;case"children":break;case"dangerouslySetInnerHTML":if(r!=null)throw Error(A(91));break;default:r!==c&&rt(e,t,d,r,s,c)}Br(e,E,M);return;case"option":for(var Oe in n)if(E=n[Oe],n.hasOwnProperty(Oe)&&E!=null&&!s.hasOwnProperty(Oe))switch(Oe){case"selected":e.selected=!1;break;default:rt(e,t,Oe,null,s,E)}for(y in s)if(E=s[y],M=n[y],s.hasOwnProperty(y)&&E!==M&&(E!=null||M!=null))switch(y){case"selected":e.selected=E&&typeof E!="function"&&typeof E!="symbol";break;default:rt(e,t,y,E,s,M)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var me in n)E=n[me],n.hasOwnProperty(me)&&E!=null&&!s.hasOwnProperty(me)&&rt(e,t,me,null,s,E);for(C in s)if(E=s[C],M=n[C],s.hasOwnProperty(C)&&E!==M&&(E!=null||M!=null))switch(C){case"children":case"dangerouslySetInnerHTML":if(E!=null)throw Error(A(137,t));break;default:rt(e,t,C,E,s,M)}return;default:if(bs(t)){for(var ot in n)E=n[ot],n.hasOwnProperty(ot)&&E!==void 0&&!s.hasOwnProperty(ot)&&Du(e,t,ot,void 0,s,E);for(D in s)E=s[D],M=n[D],!s.hasOwnProperty(D)||E===M||E===void 0&&M===void 0||Du(e,t,D,E,s,M);return}}for(var O in n)E=n[O],n.hasOwnProperty(O)&&E!=null&&!s.hasOwnProperty(O)&&rt(e,t,O,null,s,E);for(G in s)E=s[G],M=n[G],!s.hasOwnProperty(G)||E===M||E==null&&M==null||rt(e,t,G,E,s,M)}var Lu=null,Bu=null;function ic(e){return e.nodeType===9?e:e.ownerDocument}function ld(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function rd(e,t){if(e===0)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return e===1&&t==="foreignObject"?0:e}function zu(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.children=="bigint"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ju=null;function Mg(){var e=window.event;return e&&e.type==="popstate"?e===ju?!1:(ju=e,!0):(ju=null,!1)}var od=typeof setTimeout=="function"?setTimeout:void 0,wg=typeof clearTimeout=="function"?clearTimeout:void 0,cd=typeof Promise=="function"?Promise:void 0,xg=typeof queueMicrotask=="function"?queueMicrotask:typeof cd<"u"?function(e){return cd.resolve(null).then(e).catch(Ng)}:od;function Ng(e){setTimeout(function(){throw e})}function xa(e){return e==="head"}function ud(e,t){var n=t,s=0,r=0;do{var c=n.nextSibling;if(e.removeChild(n),c&&c.nodeType===8)if(n=c.data,n==="/$"){if(0<s&&8>s){n=s;var d=e.ownerDocument;if(n&1&&dr(d.documentElement),n&2&&dr(d.body),n&4)for(n=d.head,dr(n),d=n.firstChild;d;){var g=d.nextSibling,y=d.nodeName;d[Ha]||y==="SCRIPT"||y==="STYLE"||y==="LINK"&&d.rel.toLowerCase()==="stylesheet"||n.removeChild(d),d=g}}if(r===0){e.removeChild(c),Or(t);return}r--}else n==="$"||n==="$?"||n==="$!"?r++:s=n.charCodeAt(0)-48;else s=0;n=c}while(n);Or(t)}function qu(e){var t=e.firstChild;for(t&&t.nodeType===10&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":qu(n),dl(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(n.rel.toLowerCase()==="stylesheet")continue}e.removeChild(n)}}function Ug(e,t,n,s){for(;e.nodeType===1;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!s&&(e.nodeName!=="INPUT"||e.type!=="hidden"))break}else if(s){if(!e[Ha])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if(c=e.getAttribute("rel"),c==="stylesheet"&&e.hasAttribute("data-precedence"))break;if(c!==r.rel||e.getAttribute("href")!==(r.href==null||r.href===""?null:r.href)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin)||e.getAttribute("title")!==(r.title==null?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(c=e.getAttribute("src"),(c!==(r.src==null?null:r.src)||e.getAttribute("type")!==(r.type==null?null:r.type)||e.getAttribute("crossorigin")!==(r.crossOrigin==null?null:r.crossOrigin))&&c&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else if(t==="input"&&e.type==="hidden"){var c=r.name==null?null:""+r.name;if(r.type==="hidden"&&e.getAttribute("name")===c)return e}else return e;if(e=Jn(e.nextSibling),e===null)break}return null}function kg(e,t,n){if(t==="")return null;for(;e.nodeType!==3;)if((e.nodeType!==1||e.nodeName!=="INPUT"||e.type!=="hidden")&&!n||(e=Jn(e.nextSibling),e===null))return null;return e}function Hu(e){return e.data==="$!"||e.data==="$?"&&e.ownerDocument.readyState==="complete"}function Dg(e,t){var n=e.ownerDocument;if(e.data!=="$?"||n.readyState==="complete")t();else{var s=function(){t(),n.removeEventListener("DOMContentLoaded",s)};n.addEventListener("DOMContentLoaded",s),e._reactRetry=s}}function Jn(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?"||t==="F!"||t==="F")break;if(t==="/$")return null}}return e}var Gu=null;function fd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}function hd(e,t,n){switch(t=ic(n),e){case"html":if(e=t.documentElement,!e)throw Error(A(452));return e;case"head":if(e=t.head,!e)throw Error(A(453));return e;case"body":if(e=t.body,!e)throw Error(A(454));return e;default:throw Error(A(451))}}function dr(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);dl(e)}var Nn=new Map,dd=new Set;function ac(e){return typeof e.getRootNode=="function"?e.getRootNode():e.nodeType===9?e:e.ownerDocument}var Pi=U.d;U.d={f:Lg,r:Bg,D:zg,C:jg,L:qg,m:Hg,X:Vg,S:Gg,M:Ig};function Lg(){var e=Pi.f(),t=Ko();return e||t}function Bg(e){var t=bi(e);t!==null&&t.tag===5&&t.type==="form"?kf(t):Pi.r(e)}var nl=typeof document>"u"?null:document;function gd(e,t,n){var s=nl;if(s&&typeof t=="string"&&t){var r=cn(t);r='link[rel="'+e+'"][href="'+r+'"]',typeof n=="string"&&(r+='[crossorigin="'+n+'"]'),dd.has(r)||(dd.add(r),e={rel:e,crossOrigin:n,href:t},s.querySelector(r)===null&&(t=s.createElement("link"),Zt(t,"link",e),xt(t),s.head.appendChild(t)))}}function zg(e){Pi.D(e),gd("dns-prefetch",e,null)}function jg(e,t){Pi.C(e,t),gd("preconnect",e,t)}function qg(e,t,n){Pi.L(e,t,n);var s=nl;if(s&&e&&t){var r='link[rel="preload"][as="'+cn(t)+'"]';t==="image"&&n&&n.imageSrcSet?(r+='[imagesrcset="'+cn(n.imageSrcSet)+'"]',typeof n.imageSizes=="string"&&(r+='[imagesizes="'+cn(n.imageSizes)+'"]')):r+='[href="'+cn(e)+'"]';var c=r;switch(t){case"style":c=il(e);break;case"script":c=al(e)}Nn.has(c)||(e=te({rel:"preload",href:t==="image"&&n&&n.imageSrcSet?void 0:e,as:t},n),Nn.set(c,e),s.querySelector(r)!==null||t==="style"&&s.querySelector(gr(c))||t==="script"&&s.querySelector(pr(c))||(t=s.createElement("link"),Zt(t,"link",e),xt(t),s.head.appendChild(t)))}}function Hg(e,t){Pi.m(e,t);var n=nl;if(n&&e){var s=t&&typeof t.as=="string"?t.as:"script",r='link[rel="modulepreload"][as="'+cn(s)+'"][href="'+cn(e)+'"]',c=r;switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":c=al(e)}if(!Nn.has(c)&&(e=te({rel:"modulepreload",href:e},t),Nn.set(c,e),n.querySelector(r)===null)){switch(s){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(pr(c)))return}s=n.createElement("link"),Zt(s,"link",e),xt(s),n.head.appendChild(s)}}}function Gg(e,t,n){Pi.S(e,t,n);var s=nl;if(s&&e){var r=Ji(s).hoistableStyles,c=il(e);t=t||"default";var d=r.get(c);if(!d){var g={loading:0,preload:null};if(d=s.querySelector(gr(c)))g.loading=5;else{e=te({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Nn.get(c))&&Vu(e,n);var y=d=s.createElement("link");xt(y),Zt(y,"link",e),y._p=new Promise(function(C,D){y.onload=C,y.onerror=D}),y.addEventListener("load",function(){g.loading|=1}),y.addEventListener("error",function(){g.loading|=2}),g.loading|=4,sc(d,t,s)}d={type:"stylesheet",instance:d,count:1,state:g},r.set(c,d)}}}function Vg(e,t){Pi.X(e,t);var n=nl;if(n&&e){var s=Ji(n).hoistableScripts,r=al(e),c=s.get(r);c||(c=n.querySelector(pr(r)),c||(e=te({src:e,async:!0},t),(t=Nn.get(r))&&Iu(e,t),c=n.createElement("script"),xt(c),Zt(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function Ig(e,t){Pi.M(e,t);var n=nl;if(n&&e){var s=Ji(n).hoistableScripts,r=al(e),c=s.get(r);c||(c=n.querySelector(pr(r)),c||(e=te({src:e,async:!0,type:"module"},t),(t=Nn.get(r))&&Iu(e,t),c=n.createElement("script"),xt(c),Zt(c,"link",e),n.head.appendChild(c)),c={type:"script",instance:c,count:1,state:null},s.set(r,c))}}function pd(e,t,n,s){var r=(r=re.current)?ac(r):null;if(!r)throw Error(A(446));switch(e){case"meta":case"title":return null;case"style":return typeof n.precedence=="string"&&typeof n.href=="string"?(t=il(n.href),n=Ji(r).hoistableStyles,s=n.get(t),s||(s={type:"style",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};case"link":if(n.rel==="stylesheet"&&typeof n.href=="string"&&typeof n.precedence=="string"){e=il(n.href);var c=Ji(r).hoistableStyles,d=c.get(e);if(d||(r=r.ownerDocument||r,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},c.set(e,d),(c=r.querySelector(gr(e)))&&!c._p&&(d.instance=c,d.state.loading=5),Nn.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Nn.set(e,n),c||Yg(r,e,n,d.state))),t&&s===null)throw Error(A(528,""));return d}if(t&&s!==null)throw Error(A(529,""));return null;case"script":return t=n.async,n=n.src,typeof n=="string"&&t&&typeof t!="function"&&typeof t!="symbol"?(t=al(n),n=Ji(r).hoistableScripts,s=n.get(t),s||(s={type:"script",instance:null,count:0,state:null},n.set(t,s)),s):{type:"void",instance:null,count:0,state:null};default:throw Error(A(444,e))}}function il(e){return'href="'+cn(e)+'"'}function gr(e){return'link[rel="stylesheet"]['+e+"]"}function md(e){return te({},e,{"data-precedence":e.precedence,precedence:null})}function Yg(e,t,n,s){e.querySelector('link[rel="preload"][as="style"]['+t+"]")?s.loading=1:(t=e.createElement("link"),s.preload=t,t.addEventListener("load",function(){return s.loading|=1}),t.addEventListener("error",function(){return s.loading|=2}),Zt(t,"link",n),xt(t),e.head.appendChild(t))}function al(e){return'[src="'+cn(e)+'"]'}function pr(e){return"script[async]"+e}function yd(e,t,n){if(t.count++,t.instance===null)switch(t.type){case"style":var s=e.querySelector('style[data-href~="'+cn(n.href)+'"]');if(s)return t.instance=s,xt(s),s;var r=te({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return s=(e.ownerDocument||e).createElement("style"),xt(s),Zt(s,"style",r),sc(s,n.precedence,e),t.instance=s;case"stylesheet":r=il(n.href);var c=e.querySelector(gr(r));if(c)return t.state.loading|=4,t.instance=c,xt(c),c;s=md(n),(r=Nn.get(r))&&Vu(s,r),c=(e.ownerDocument||e).createElement("link"),xt(c);var d=c;return d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),Zt(c,"link",s),t.state.loading|=4,sc(c,n.precedence,e),t.instance=c;case"script":return c=al(n.src),(r=e.querySelector(pr(c)))?(t.instance=r,xt(r),r):(s=n,(r=Nn.get(c))&&(s=te({},n),Iu(s,r)),e=e.ownerDocument||e,r=e.createElement("script"),xt(r),Zt(r,"link",s),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(A(443,t.type))}else t.type==="stylesheet"&&(t.state.loading&4)===0&&(s=t.instance,t.state.loading|=4,sc(s,n.precedence,e));return t.instance}function sc(e,t,n){for(var s=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=s.length?s[s.length-1]:null,c=r,d=0;d<s.length;d++){var g=s[d];if(g.dataset.precedence===t)c=g;else if(c!==r)break}c?c.parentNode.insertBefore(e,c.nextSibling):(t=n.nodeType===9?n.head:n,t.insertBefore(e,t.firstChild))}function Vu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.title==null&&(e.title=t.title)}function Iu(e,t){e.crossOrigin==null&&(e.crossOrigin=t.crossOrigin),e.referrerPolicy==null&&(e.referrerPolicy=t.referrerPolicy),e.integrity==null&&(e.integrity=t.integrity)}var lc=null;function vd(e,t,n){if(lc===null){var s=new Map,r=lc=new Map;r.set(n,s)}else r=lc,s=r.get(n),s||(s=new Map,r.set(n,s));if(s.has(e))return s;for(s.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var c=n[r];if(!(c[Ha]||c[Dt]||e==="link"&&c.getAttribute("rel")==="stylesheet")&&c.namespaceURI!=="http://www.w3.org/2000/svg"){var d=c.getAttribute(t)||"";d=e+d;var g=s.get(d);g?g.push(c):s.set(d,[c])}}return s}function bd(e,t,n){e=e.ownerDocument||e,e.head.insertBefore(n,t==="title"?e.querySelector("head > title"):null)}function Pg(e,t,n){if(n===1||t.itemProp!=null)return!1;switch(e){case"meta":case"title":return!0;case"style":if(typeof t.precedence!="string"||typeof t.href!="string"||t.href==="")break;return!0;case"link":if(typeof t.rel!="string"||typeof t.href!="string"||t.href===""||t.onLoad||t.onError)break;switch(t.rel){case"stylesheet":return e=t.disabled,typeof t.precedence=="string"&&e==null;default:return!0}case"script":if(t.async&&typeof t.async!="function"&&typeof t.async!="symbol"&&!t.onLoad&&!t.onError&&t.src&&typeof t.src=="string")return!0}return!1}function Sd(e){return!(e.type==="stylesheet"&&(e.state.loading&3)===0)}var mr=null;function Xg(){}function Qg(e,t,n){if(mr===null)throw Error(A(475));var s=mr;if(t.type==="stylesheet"&&(typeof n.media!="string"||matchMedia(n.media).matches!==!1)&&(t.state.loading&4)===0){if(t.instance===null){var r=il(n.href),c=e.querySelector(gr(r));if(c){e=c._p,e!==null&&typeof e=="object"&&typeof e.then=="function"&&(s.count++,s=rc.bind(s),e.then(s,s)),t.state.loading|=4,t.instance=c,xt(c);return}c=e.ownerDocument||e,n=md(n),(r=Nn.get(r))&&Vu(n,r),c=c.createElement("link"),xt(c);var d=c;d._p=new Promise(function(g,y){d.onload=g,d.onerror=y}),Zt(c,"link",n),t.instance=c}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(t,e),(e=t.state.preload)&&(t.state.loading&3)===0&&(s.count++,t=rc.bind(s),e.addEventListener("load",t),e.addEventListener("error",t))}}function Zg(){if(mr===null)throw Error(A(475));var e=mr;return e.stylesheets&&e.count===0&&Yu(e,e.stylesheets),0<e.count?function(t){var n=setTimeout(function(){if(e.stylesheets&&Yu(e,e.stylesheets),e.unsuspend){var s=e.unsuspend;e.unsuspend=null,s()}},6e4);return e.unsuspend=t,function(){e.unsuspend=null,clearTimeout(n)}}:null}function rc(){if(this.count--,this.count===0){if(this.stylesheets)Yu(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}}var oc=null;function Yu(e,t){e.stylesheets=null,e.unsuspend!==null&&(e.count++,oc=new Map,t.forEach(Kg,e),oc=null,rc.call(e))}function Kg(e,t){if(!(t.state.loading&4)){var n=oc.get(e);if(n)var s=n.get(null);else{n=new Map,oc.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),c=0;c<r.length;c++){var d=r[c];(d.nodeName==="LINK"||d.getAttribute("media")!=="not all")&&(n.set(d.dataset.precedence,d),s=d)}s&&n.set(null,s)}r=t.instance,d=r.getAttribute("data-precedence"),c=n.get(d)||s,c===s&&n.set(null,r),n.set(d,r),this.count++,s=rc.bind(this),r.addEventListener("load",s),r.addEventListener("error",s),c?c.parentNode.insertBefore(r,c.nextSibling):(e=e.nodeType===9?e.head:e,e.insertBefore(r,e.firstChild)),t.state.loading|=4}}var yr={$$typeof:Ke,Provider:null,Consumer:null,_currentValue:ne,_currentValue2:ne,_threadCount:0};function Jg(e,t,n,s,r,c,d,g){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=wt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wt(0),this.hiddenUpdates=wt(null),this.identifierPrefix=s,this.onUncaughtError=r,this.onCaughtError=c,this.onRecoverableError=d,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=g,this.incompleteTransitions=new Map}function Od(e,t,n,s,r,c,d,g,y,C,D,G){return e=new Jg(e,t,n,d,g,y,C,G),t=1,c===!0&&(t|=24),c=sn(3,null,null,t),e.current=c,c.stateNode=e,t=oi(),t.refCount++,e.pooledCache=t,t.refCount++,c.memoizedState={element:s,isDehydrated:n,cache:t},js(c),e}function Ad(e){return e?(e=Ni,e):Ni}function Rd(e,t,n,s,r,c){r=Ad(r),s.context===null?s.context=r:s.pendingContext=r,s=ui(t),s.payload={element:n},c=c===void 0?null:c,c!==null&&(s.callback=c),n=fi(e,s,t),n!==null&&(Rn(n,e,t),ss(n,e,t))}function Td(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function Pu(e,t){Td(e,t),(e=e.alternate)&&Td(e,t)}function Cd(e){if(e.tag===13){var t=ra(e,67108864);t!==null&&Rn(t,e,67108864),Pu(e,67108864)}}var cc=!0;function Wg(e,t,n,s){var r=N.T;N.T=null;var c=U.p;try{U.p=2,Xu(e,t,n,s)}finally{U.p=c,N.T=r}}function Fg(e,t,n,s){var r=N.T;N.T=null;var c=U.p;try{U.p=8,Xu(e,t,n,s)}finally{U.p=c,N.T=r}}function Xu(e,t,n,s){if(cc){var r=Qu(s);if(r===null)ku(e,t,s,uc,n),Ed(e,s);else if(ep(r,e,t,n,s))s.stopPropagation();else if(Ed(e,s),t&4&&-1<$g.indexOf(e)){for(;r!==null;){var c=bi(r);if(c!==null)switch(c.tag){case 3:if(c=c.stateNode,c.current.memoizedState.isDehydrated){var d=kn(c.pendingLanes);if(d!==0){var g=c;for(g.pendingLanes|=2,g.entangledLanes|=2;d;){var y=1<<31-dt(d);g.entanglements[1]|=y,d&=~y}vi(c),(it&6)===0&&(Qo=Qe()+500,ur(0))}}break;case 13:g=ra(c,2),g!==null&&Rn(g,c,2),Ko(),Pu(c,2)}if(c=Qu(s),c===null&&ku(e,t,s,uc,n),c===r)break;r=c}r!==null&&s.stopPropagation()}else ku(e,t,s,null,n)}}function Qu(e){return e=Ga(e),Zu(e)}var uc=null;function Zu(e){if(uc=null,e=Ln(e),e!==null){var t=J(e);if(t===null)e=null;else{var n=t.tag;if(n===13){if(e=Ue(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return uc=e,null}function _d(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ye()){case jt:return 2;case Jt:return 8;case Y:case le:return 32;case ie:return 268435456;default:return 32}default:return 32}}var Ku=!1,Na=null,Ua=null,ka=null,vr=new Map,br=new Map,Da=[],$g="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ed(e,t){switch(e){case"focusin":case"focusout":Na=null;break;case"dragenter":case"dragleave":Ua=null;break;case"mouseover":case"mouseout":ka=null;break;case"pointerover":case"pointerout":vr.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":br.delete(t.pointerId)}}function Sr(e,t,n,s,r,c){return e===null||e.nativeEvent!==c?(e={blockedOn:t,domEventName:n,eventSystemFlags:s,nativeEvent:c,targetContainers:[r]},t!==null&&(t=bi(t),t!==null&&Cd(t)),e):(e.eventSystemFlags|=s,t=e.targetContainers,r!==null&&t.indexOf(r)===-1&&t.push(r),e)}function ep(e,t,n,s,r){switch(t){case"focusin":return Na=Sr(Na,e,t,n,s,r),!0;case"dragenter":return Ua=Sr(Ua,e,t,n,s,r),!0;case"mouseover":return ka=Sr(ka,e,t,n,s,r),!0;case"pointerover":var c=r.pointerId;return vr.set(c,Sr(vr.get(c)||null,e,t,n,s,r)),!0;case"gotpointercapture":return c=r.pointerId,br.set(c,Sr(br.get(c)||null,e,t,n,s,r)),!0}return!1}function Md(e){var t=Ln(e.target);if(t!==null){var n=J(t);if(n!==null){if(t=n.tag,t===13){if(t=Ue(n),t!==null){e.blockedOn=t,Nr(e.priority,function(){if(n.tag===13){var s=An();s=cl(s);var r=ra(n,s);r!==null&&Rn(r,n,s),Pu(n,s)}});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function fc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qu(e.nativeEvent);if(n===null){n=e.nativeEvent;var s=new n.constructor(n.type,n);Os=s,n.target.dispatchEvent(s),Os=null}else return t=bi(n),t!==null&&Cd(t),e.blockedOn=n,!1;t.shift()}return!0}function wd(e,t,n){fc(e)&&n.delete(t)}function tp(){Ku=!1,Na!==null&&fc(Na)&&(Na=null),Ua!==null&&fc(Ua)&&(Ua=null),ka!==null&&fc(ka)&&(ka=null),vr.forEach(wd),br.forEach(wd)}function hc(e,t){e.blockedOn===t&&(e.blockedOn=null,Ku||(Ku=!0,k.unstable_scheduleCallback(k.unstable_NormalPriority,tp)))}var dc=null;function xd(e){dc!==e&&(dc=e,k.unstable_scheduleCallback(k.unstable_NormalPriority,function(){dc===e&&(dc=null);for(var t=0;t<e.length;t+=3){var n=e[t],s=e[t+1],r=e[t+2];if(typeof s!="function"){if(Zu(s||n)===null)continue;break}var c=bi(n);c!==null&&(e.splice(t,3),t-=3,Zc(c,{pending:!0,data:r,method:n.method,action:s},s,r))}}))}function Or(e){function t(y){return hc(y,e)}Na!==null&&hc(Na,e),Ua!==null&&hc(Ua,e),ka!==null&&hc(ka,e),vr.forEach(t),br.forEach(t);for(var n=0;n<Da.length;n++){var s=Da[n];s.blockedOn===e&&(s.blockedOn=null)}for(;0<Da.length&&(n=Da[0],n.blockedOn===null);)Md(n),n.blockedOn===null&&Da.shift();if(n=(e.ownerDocument||e).$$reactFormReplay,n!=null)for(s=0;s<n.length;s+=3){var r=n[s],c=n[s+1],d=r[Yt]||null;if(typeof c=="function")d||xd(n);else if(d){var g=null;if(c&&c.hasAttribute("formAction")){if(r=c,d=c[Yt]||null)g=d.formAction;else if(Zu(r)!==null)continue}else g=d.action;typeof g=="function"?n[s+1]=g:(n.splice(s,3),s-=3),xd(n)}}}function Ju(e){this._internalRoot=e}gc.prototype.render=Ju.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(A(409));var n=t.current,s=An();Rd(n,s,e,t,null,null)},gc.prototype.unmount=Ju.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Rd(e.current,2,null,e,null,null),Ko(),t[Ki]=null}};function gc(e){this._internalRoot=e}gc.prototype.unstable_scheduleHydration=function(e){if(e){var t=fl();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Da.length&&t!==0&&t<Da[n].priority;n++);Da.splice(n,0,e),n===0&&Md(e)}};var Nd=oe.version;if(Nd!=="19.1.0")throw Error(A(527,Nd,"19.1.0"));U.findDOMNode=function(e){var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(A(188)):(e=Object.keys(e).join(","),Error(A(268,e)));return e=ee(t),e=e!==null?L(e):null,e=e===null?null:e.stateNode,e};var np={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:N,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var pc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!pc.isDisabled&&pc.supportsFiber)try{Me=pc.inject(np),_e=pc}catch{}}return Rr.createRoot=function(e,t){if(!W(e))throw Error(A(299));var n=!1,s="",r=Qf,c=Zf,d=Kf,g=null;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onUncaughtError!==void 0&&(r=t.onUncaughtError),t.onCaughtError!==void 0&&(c=t.onCaughtError),t.onRecoverableError!==void 0&&(d=t.onRecoverableError),t.unstable_transitionCallbacks!==void 0&&(g=t.unstable_transitionCallbacks)),t=Od(e,1,!1,null,null,n,s,r,c,d,g,null),e[Ki]=t.current,Uu(e),new Ju(t)},Rr.hydrateRoot=function(e,t,n){if(!W(e))throw Error(A(299));var s=!1,r="",c=Qf,d=Zf,g=Kf,y=null,C=null;return n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(r=n.identifierPrefix),n.onUncaughtError!==void 0&&(c=n.onUncaughtError),n.onCaughtError!==void 0&&(d=n.onCaughtError),n.onRecoverableError!==void 0&&(g=n.onRecoverableError),n.unstable_transitionCallbacks!==void 0&&(y=n.unstable_transitionCallbacks),n.formState!==void 0&&(C=n.formState)),t=Od(e,1,!0,t,n??null,s,r,c,d,g,y,C),t.context=Ad(null),n=t.current,s=An(),s=cl(s),r=ui(s),r.callback=null,fi(n,r,s),n=s,t.current.lanes=n,Zi(t,n),vi(t),e[Ki]=t.current,Uu(e),new gc(t)},Rr.version="19.1.0",Rr}var Gd;function dp(){if(Gd)return $u.exports;Gd=1;function k(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(k)}catch(oe){console.error(oe)}}return k(),$u.exports=hp(),$u.exports}var gp=dp();const pp=df(gp);var mc={exports:{}};/*@license Copyright 2015-2022 Ably Real-time Ltd (ably.com)

Ably JavaScript Library v2.10.1
https://github.com/ably/ably-js

Released under the Apache Licence v2.0*/var mp=mc.exports,Vd;function yp(){return Vd||(Vd=1,function(k,oe){(function(ce,A){k.exports=A()})(mp,()=>{var ce={},A={exports:ce},W=Object.defineProperty,J=Object.defineProperties,Ue=Object.getOwnPropertyDescriptor,Le=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertyNames,L=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable,we=(i,a,l)=>a in i?W(i,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[a]=l,pe=(i,a)=>{for(var l in a||(a={}))te.call(a,l)&&we(i,l,a[l]);if(L)for(var l of L(a))ke.call(a,l)&&we(i,l,a[l]);return i},Ce=(i,a)=>J(i,Le(a)),Fe=(i,a)=>{var l={};for(var o in i)te.call(i,o)&&a.indexOf(o)<0&&(l[o]=i[o]);if(i!=null&&L)for(var o of L(i))a.indexOf(o)<0&&ke.call(i,o)&&(l[o]=i[o]);return l},P=(i,a)=>{for(var l in a)W(i,l,{get:a[l],enumerable:!0})},Ge=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of ee(a))!te.call(i,u)&&u!==l&&W(i,u,{get:()=>a[u],enumerable:!(o=Ue(a,u))||o.enumerable});return i},mt=i=>Ge(W({},"__esModule",{value:!0}),i),Ke={};P(Ke,{ErrorInfo:()=>_,Realtime:()=>In,Rest:()=>Ns,default:()=>Uo,makeProtocolMessageFromDeserialized:()=>xl,msgpack:()=>zi}),A.exports=mt(Ke);var x=class{},he=typeof Ba<"u"?Ba:typeof window<"u"?window:self;function Ae(i,a){return`${i}`.padStart(a?3:2,"0")}function yt(i){return x.Config.logTimestamps?function(a){const l=new Date;i(Ae(l.getHours())+":"+Ae(l.getMinutes())+":"+Ae(l.getSeconds())+"."+Ae(l.getMilliseconds(),1)+" "+a)}:function(a){i(a)}}var vt=()=>{var i;let a,l;return typeof((i=he?.console)==null?void 0:i.log)=="function"?(a=function(...o){console.log.apply(console,o)},l=console.warn?function(...o){console.warn.apply(console,o)}:a):a=l=function(){},[a,l].map(yt)},Ie=class Tr{constructor(){this.deprecated=(a,l)=>{this.deprecationWarning(`${a} is deprecated and will be removed in a future version. ${l}`)},this.shouldLog=a=>a<=this.logLevel,this.setLog=(a,l)=>{a!==void 0&&(this.logLevel=a),l!==void 0&&(this.logHandler=this.logErrorHandler=l)},this.logLevel=Tr.defaultLogLevel,this.logHandler=Tr.defaultLogHandler,this.logErrorHandler=Tr.defaultLogErrorHandler}static initLogHandlers(){const[a,l]=vt();this.defaultLogHandler=a,this.defaultLogErrorHandler=l,this.defaultLogger=new Tr}static logActionNoStrip(a,l,o,u){a.logAction(l,o,u)}logAction(a,l,o){this.shouldLog(a)&&(a===1?this.logErrorHandler:this.logHandler)("Ably: "+l+": "+o,a)}renamedClientOption(a,l){this.deprecationWarning(`The \`${a}\` client option has been renamed to \`${l}\`. Please update your code to use \`${l}\` instead. \`${a}\` will be removed in a future version.`)}renamedMethod(a,l,o){this.deprecationWarning(`\`${a}\`’s \`${l}\` method has been renamed to \`${o}\`. Please update your code to use \`${o}\` instead. \`${l}\` will be removed in a future version.`)}deprecationWarning(a){this.shouldLog(1)&&this.logErrorHandler(`Ably: Deprecation warning - ${a}`,1)}};Ie.defaultLogLevel=1,Ie.LOG_NONE=0,Ie.LOG_ERROR=1,Ie.LOG_MAJOR=2,Ie.LOG_MINOR=3,Ie.LOG_MICRO=4,Ie.logAction=(i,a,l,o)=>{Ie.logActionNoStrip(i,a,l,o)};var _t=Ie,h=_t,He={};P(He,{Format:()=>ht,allSame:()=>De,allToLowerCase:()=>rl,allToUpperCase:()=>Er,arrChooseN:()=>Me,arrDeleteValue:()=>Un,arrEquals:()=>ol,arrIntersect:()=>Be,arrIntersectOb:()=>Kt,arrPopRandomElement:()=>Qe,arrWithoutValue:()=>Wn,cheapRandStr:()=>st,containsValue:()=>re,copy:()=>ne,createMissingPluginError:()=>qa,dataSizeBytes:()=>ie,decodeBody:()=>Je,encodeBody:()=>dt,ensureArray:()=>Te,forInOwnNonNullProperties:()=>Z,getBackoffCoefficient:()=>Mr,getGlobalObject:()=>kn,getJitterCoefficient:()=>za,getRetryTime:()=>Xi,inherits:()=>Re,inspectBody:()=>le,inspectError:()=>Y,intersect:()=>et,isEmpty:()=>H,isErrorInfoOrPartialErrorInfo:()=>Jt,isNil:()=>I,isObject:()=>v,keysArray:()=>tn,matchDerivedChannel:()=>Qi,mixin:()=>U,parseQueryString:()=>jt,prototypicalClone:()=>se,randomString:()=>be,shallowClone:()=>K,shallowEquals:()=>ja,throwMissingPluginError:()=>wt,toBase64:()=>ds,toQueryString:()=>Ye,valuesArray:()=>V,whenPromiseSettles:()=>_e,withTimeoutAsync:()=>Zi});function Xe(i){let a="["+i.constructor.name;return i.message&&(a+=": "+i.message),i.statusCode&&(a+="; statusCode="+i.statusCode),i.code&&(a+="; code="+i.code),i.cause&&(a+="; cause="+Y(i.cause)),i.href&&!(i.message&&i.message.indexOf("help.ably.io")>-1)&&(a+="; see "+i.href+" "),a+="]",a}var _=class af extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,af.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return Xe(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||typeof o!="number"||typeof u!="number")throw new Error("ErrorInfo.fromValues(): invalid values: "+x.Config.inspect(a));const f=Object.assign(new af(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}},de=class sf extends Error{constructor(a,l,o,u){super(a),typeof Object.setPrototypeOf<"u"&&Object.setPrototypeOf(this,sf.prototype),this.code=l,this.statusCode=o,this.cause=u}toString(){return Xe(this)}static fromValues(a){const{message:l,code:o,statusCode:u}=a;if(typeof l!="string"||!I(o)&&typeof o!="number"||!I(u)&&typeof u!="number")throw new Error("PartialErrorInfo.fromValues(): invalid values: "+x.Config.inspect(a));const f=Object.assign(new sf(l,o,u),a);return f.code&&!f.href&&(f.href="https://help.ably.io/error/"+f.code),f}};function N(i){return Math.floor(Math.random()*i.length)}function U(i,...a){for(let l=0;l<a.length;l++){const o=a[l];if(!o)break;for(const u in o)Object.prototype.hasOwnProperty.call(o,u)&&(i[u]=o[u])}return i}function ne(i){return U({},i)}function Te(i){return I(i)?[]:Array.isArray(i)?i:[i]}function v(i){return Object.prototype.toString.call(i)=="[object Object]"}function H(i){for(const a in i)return!1;return!0}function I(i){return i==null}function K(i){const a=new Object;for(const l in i)a[l]=i[l];return a}function se(i,a){class l{}l.prototype=i;const o=new l;return a&&U(o,a),o}var Re=function(i,a){if(x.Config.inherits){x.Config.inherits(i,a);return}i.super_=a,i.prototype=se(a.prototype,{constructor:i})};function re(i,a){for(const l in i)if(i[l]==a)return!0;return!1}function et(i,a){return Array.isArray(a)?Be(i,a):Kt(i,a)}function Be(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];a.indexOf(u)!=-1&&l.push(u)}return l}function Kt(i,a){const l=[];for(let o=0;o<i.length;o++){const u=i[o];u in a&&l.push(u)}return l}function Un(i,a){const l=i.indexOf(a),o=l!=-1;return o&&i.splice(l,1),o}function Wn(i,a){const l=i.slice();return Un(l,a),l}function tn(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(o);return l}function V(i,a){const l=[];for(const o in i)a&&!Object.prototype.hasOwnProperty.call(i,o)||l.push(i[o]);return l}function Z(i,a){for(const l in i)Object.prototype.hasOwnProperty.call(i,l)&&i[l]&&a(l)}function De(i,a){if(i.length===0)return!0;const l=i[0][a];return i.every(function(o){return o[a]===l})}var ht=(i=>(i.msgpack="msgpack",i.json="json",i))(ht||{});function Qe(i){return i.splice(N(i),1)[0]}function Ye(i){const a=[];if(i)for(const l in i)a.push(encodeURIComponent(l)+"="+encodeURIComponent(i[l]));return a.length?"?"+a.join("&"):""}function jt(i){let a;const l=/([^?&=]+)=?([^&]*)/g,o={};for(;a=l.exec(i);)o[decodeURIComponent(a[1])]=decodeURIComponent(a[2]);return o}function Jt(i){return typeof i=="object"&&i!==null&&(i instanceof _||i instanceof de)}function Y(i){var a,l;return i instanceof Error||((a=i?.constructor)==null?void 0:a.name)==="ErrorInfo"||((l=i?.constructor)==null?void 0:l.name)==="PartialErrorInfo"?i.toString():x.Config.inspect(i)}function le(i){return x.BufferUtils.isBuffer(i)?i.toString():typeof i=="string"?i:x.Config.inspect(i)}function ie(i){if(x.BufferUtils.isBuffer(i))return x.BufferUtils.byteLength(i);if(typeof i=="string")return x.Config.stringByteSize(i);if(typeof i=="number")return 8;if(typeof i=="boolean")return 1;throw new Error(`Expected input of Utils.dataSizeBytes to be a string, a number, a boolean or a buffer, but was: ${typeof i}`)}function st(){return String(Math.random()).substr(2)}var be=async i=>{const a=await x.Config.getRandomArrayBuffer(i);return x.BufferUtils.base64Encode(a)};function Me(i,a){const l=Math.min(a,i.length),o=i.slice(),u=[];for(let f=0;f<l;f++)u.push(Qe(o));return u}function _e(i,a){i.then(l=>{a?.(null,l)}).catch(l=>{a?.(l)})}function Je(i,a,l){return l=="msgpack"?(a||wt("MsgPack"),a.decode(i)):JSON.parse(String(i))}function dt(i,a,l){return l=="msgpack"?(a||wt("MsgPack"),a.encode(i,!0)):JSON.stringify(i)}function rl(i){return i.map(function(a){return a&&a.toLowerCase()})}function Er(i){return i.map(function(a){return a&&a.toUpperCase()})}function Mr(i){return Math.min((i+2)/3,2)}function za(){return 1-Math.random()*.2}function Xi(i,a){return i*Mr(a)*za()}function kn(){return typeof Ba<"u"?Ba:typeof window<"u"?window:self}function ja(i,a){return Object.keys(i).every(l=>i[l]===a[l])&&Object.keys(a).every(l=>a[l]===i[l])}function Qi(i){const a=/^(\[([^?]*)(?:(.*))\])?(.+)$/,l=i.match(a);if(!l||!l.length||l.length<5)throw new _("regex match failed",400,40010);if(l[2])throw new _(`cannot use a derived option with a ${l[2]} channel`,400,40010);return{qualifierParam:l[3]||"",channelName:l[4]}}function ds(i){const a=x.BufferUtils,l=a.utf8Encode(i);return a.base64Encode(l)}function ol(i,a){return i.length===a.length&&i.every(function(l,o){return l===a[o]})}function qa(i){return new _(`${i} plugin not provided`,40019,400)}function wt(i){throw qa(i)}async function Zi(i,a=5e3,l="Timeout expired"){const o=new _(l,5e4,500);return Promise.race([i,new Promise((u,f)=>setTimeout(()=>f(o),a))])}var wr="2.10.1",xr="ably-js/"+wr,rn={ENDPOINT:"main",ENVIRONMENT:"",REST_HOST:"rest.ably.io",REALTIME_HOST:"realtime.ably.io",FALLBACK_HOSTS:["main.a.fallback.ably-realtime.com","main.b.fallback.ably-realtime.com","main.c.fallback.ably-realtime.com","main.d.fallback.ably-realtime.com","main.e.fallback.ably-realtime.com"],PORT:80,TLS_PORT:443,TIMEOUTS:{disconnectedRetryTimeout:15e3,suspendedRetryTimeout:3e4,httpRequestTimeout:1e4,httpMaxRetryDuration:15e3,channelRetryTimeout:15e3,fallbackRetryTimeout:6e5,connectionStateTtl:12e4,realtimeRequestTimeout:1e4,recvTimeout:9e4,webSocketConnectTimeout:1e4,webSocketSlowTimeout:4e3},httpMaxRetryCount:3,maxMessageSize:65536,version:wr,protocolVersion:3,agent:xr,getPort:cl,getHttpScheme:ul,getPrimaryDomainFromEndpoint:Nr,getEndpointFallbackHosts:Dn,getFallbackHosts:Yt,getHosts:Ki,checkHost:gs,objectifyOptions:Ur,normaliseOptions:dl,defaultGetHeaders:Ji,defaultPostHeaders:xt};function cl(i,a){return a||i.tls?i.tlsPort:i.port}function ul(i){return i.tls?"https://":"http://"}function fl(i){return i.includes(".")||i.includes("::")||i==="localhost"}function Nr(i){return fl(i)?i:i.startsWith("nonprod:")?`${i.replace("nonprod:","")}.realtime.ably-nonprod.net`:`${i}.realtime.ably.net`}function Dn(i){if(fl(i))return[];if(i.startsWith("nonprod:")){const a=i.replace("nonprod:","");return Dt(a,"ably-realtime-nonprod.com")}return Dt(i,"ably-realtime.com")}function Dt(i,a){return["a","b","c","d","e"].map(l=>`${i}.${l}.fallback.${a}`)}function Yt(i){const a=i.fallbackHosts,l=typeof i.httpMaxRetryCount<"u"?i.httpMaxRetryCount:rn.httpMaxRetryCount;return a?Me(a,l):[]}function Ki(i){return[i.primaryDomain].concat(Yt(i))}function gs(i){if(typeof i!="string")throw new _("host must be a string; was a "+typeof i,4e4,400);if(!i.length)throw new _("host must not be zero-length",4e4,400)}function vc(i){const a={};for(const l in rn.TIMEOUTS)a[l]=i[l]||rn.TIMEOUTS[l];return a}function hl(i){let a=rn.agent;if(i.agents)for(var l in i.agents)a+=" "+l+"/"+i.agents[l];return a}function Ur(i,a,l,o,u){if(i===void 0){const p=a?`${l} must be initialized with either a client options object, an Ably API key, or an Ably Token`:`${l} must be initialized with a client options object`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,p),new Error(p)}let f;if(typeof i=="string")if(i.indexOf(":")==-1){if(!a){const p=`${l} cannot be initialized with just an Ably Token; you must provide a client options object with a \`plugins\` property. (Set this Ably Token as the object’s \`token\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,p),new Error(p)}f={token:i}}else{if(!a){const p=`${l} cannot be initialized with just an Ably API key; you must provide a client options object with a \`plugins\` property. (Set this Ably API key as the object’s \`key\` property.)`;throw h.logAction(o,h.LOG_ERROR,`${l}()`,p),new Error(p)}f={key:i}}else f=i;return u&&(f=Ce(pe({},f),{plugins:pe(pe({},u),f.plugins)})),f}function Ha(i){if(i.endpoint&&(i.environment||i.restHost||i.realtimeHost))throw new _("The `endpoint` option cannot be used in conjunction with the `environment`, `restHost`, or `realtimeHost` options.",40106,400);if(i.environment&&(i.restHost||i.realtimeHost))throw new _("The `environment` option cannot be used in conjunction with the `restHost`, or `realtimeHost` options.",40106,400)}function dl(i,a,l){const o=l??h.defaultLogger;i.environment&&o.deprecated("The `environment` client option","Use the `endpoint` client option instead."),i.restHost&&o.deprecated("The `restHost` client option","Use the `endpoint` client option instead."),i.realtimeHost&&o.deprecated("The `realtimeHost` client option","Use the `endpoint` client option instead."),Ha(i),typeof i.recover=="function"&&i.closeOnUnload===!0&&(h.logAction(o,h.LOG_ERROR,"Defaults.normaliseOptions","closeOnUnload was true and a session recovery function was set - these are mutually exclusive, so unsetting the latter"),i.recover=void 0),"closeOnUnload"in i||(i.closeOnUnload=!i.recover),"queueMessages"in i||(i.queueMessages=!0);const u=i.endpoint||rn.ENDPOINT;!i.fallbackHosts&&!i.restHost&&!i.realtimeHost&&!i.port&&!i.tlsPort&&(i.fallbackHosts=Dn(i.environment||u));const f=i.environment&&`${i.environment}.realtime.ably.net`,m=i.restHost||i.realtimeHost||f||Nr(u);(i.fallbackHosts||[]).concat(m).forEach(gs),i.port=i.port||rn.PORT,i.tlsPort=i.tlsPort||rn.TLS_PORT,"tls"in i||(i.tls=!0);const T=vc(i);a?"useBinaryProtocol"in i?i.useBinaryProtocol=x.Config.supportsBinary&&i.useBinaryProtocol:i.useBinaryProtocol=x.Config.preferBinary:i.useBinaryProtocol=!1;const S={};i.clientId&&(S["X-Ably-ClientId"]=x.BufferUtils.base64Encode(x.BufferUtils.utf8Encode(i.clientId))),"idempotentRestPublishing"in i||(i.idempotentRestPublishing=!0);let B=null,z=i.connectivityCheckUrl;if(i.connectivityCheckUrl){let[j,F]=i.connectivityCheckUrl.split("?");B=F?jt(F):{},j.indexOf("://")===-1&&(j="https://"+j),z=j}let Q=i.wsConnectivityCheckUrl;return Q&&Q.indexOf("://")===-1&&(Q="wss://"+Q),Ce(pe({},i),{primaryDomain:m,maxMessageSize:i.maxMessageSize||rn.maxMessageSize,timeouts:T,connectivityCheckParams:B,connectivityCheckUrl:z,wsConnectivityCheckUrl:Q,headers:S})}function Ln(i,a,l){const o=l||{};if(o.cipher){i||wt("Crypto");const u=i.getCipher(o.cipher,a);o.cipher=u.cipherParams,o.channelCipher=u.cipher}else"cipher"in o&&(o.cipher=void 0,o.channelCipher=null);return o}var bi={json:"application/json",xml:"application/xml",html:"text/html",msgpack:"application/x-msgpack",text:"text/plain"},Fn={format:"json",protocolVersion:rn.protocolVersion};function Ji(i,{format:a=Fn.format,protocolVersion:l=Fn.protocolVersion}={}){return{accept:bi[a],"X-Ably-Version":l.toString(),"Ably-Agent":hl(i)}}function xt(i,{format:a=Fn.format,protocolVersion:l=Fn.protocolVersion}={}){let o;return{accept:o=bi[a],"content-type":o,"X-Ably-Version":l.toString(),"Ably-Agent":hl(i)}}var ve=rn;function kr(i){return Object.assign(rn,i)}var Si=class Pd{constructor(a,l){this.logger=a,this.members=l||[]}call(a,l){for(const o of this.members)if(o)try{o(a,l)}catch(u){h.logAction(this.logger,h.LOG_ERROR,"Multicaster multiple callback handler","Unexpected exception: "+u+"; stack = "+u.stack)}}push(...a){this.members.push(...a)}createPromise(){return new Promise((a,l)=>{this.push((o,u)=>{o?l(o):a(u)})})}resolveAll(a){this.call(null,a)}rejectAll(a){this.call(a)}static create(a,l){const o=new Pd(a,l);return Object.assign((u,f)=>o.call(u,f),{push:u=>o.push(u),createPromise:()=>o.createPromise(),resolveAll:u=>o.resolveAll(u),rejectAll:u=>o.rejectAll(u)})}},$n=Si,Dr=(i=>(i.Get="get",i.Delete="delete",i.Post="post",i.Put="put",i.Patch="patch",i))(Dr||{}),bt=Dr,gl=(i=>(i[i.Success=200]="Success",i[i.NoContent=204]="NoContent",i[i.BadRequest=400]="BadRequest",i[i.Unauthorized=401]="Unauthorized",i[i.Forbidden=403]="Forbidden",i[i.RequestTimeout=408]="RequestTimeout",i[i.InternalServerError=500]="InternalServerError",i))(gl||{});function bc(i){return i>=200&&i<400}var Oi=gl,Wi=Math.pow(2,17);function Bn(){return("000000"+Math.floor(Math.random()*1e16)).slice(-16)}function pl(i){return!!i.connection}function ml(i){return Jt(i)?(i.code||(i.statusCode===403?i.code=40300:(i.code=40170,i.statusCode=401)),i):new _(Y(i),i.code||40170,i.statusCode||401)}var Fi=(i,a)=>{const l=x.BufferUtils,o=l.utf8Encode(i),u=l.utf8Encode(a),f=l.hmacSha256(o,u);return l.base64Encode(f)};function ps(i){if(!i)return"";typeof i=="string"&&(i=JSON.parse(i));const a=Object.create(null),l=tn(i,!0);if(!l)return"";l.sort();for(let o=0;o<l.length;o++)a[l[o]]=i[l[o]].sort();return JSON.stringify(a)}function ms(i,a){if(i.authCallback)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authCallback");else if(i.authUrl)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with authUrl");else if(i.key)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with client-side signing");else if(i.tokenDetails)h.logAction(a,h.LOG_MINOR,"Auth()","using token auth with supplied token only");else{const l="authOptions must include valid authentication parameters";throw h.logAction(a,h.LOG_ERROR,"Auth()",l),new Error(l)}}function Sc(i){return"useTokenAuth"in i&&!i.useTokenAuth}function yl(i){return i.useTokenAuth||!Sc(i)&&(i.authCallback||i.authUrl||i.token||i.tokenDetails)}function on(i){return!i.key&&!i.authCallback&&!i.authUrl}var Lr=0;function Oc(){return Lr++}var ys=class{constructor(i,a){if(this.authOptions={},this.client=i,this.tokenParams=a.defaultTokenParams||{},this.currentTokenRequestId=null,this.waitingForTokenRequest=null,yl(a))on(a)&&h.logAction(this.logger,h.LOG_ERROR,"Auth()","Warning: library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),this._saveTokenOptions(a.defaultTokenParams,a),ms(this.authOptions,this.logger);else{if(!a.key){const l="No authentication options provided; need one of: key, authUrl, or authCallback (or for testing only, token or tokenDetails)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()",l),new _(l,40160,401)}h.logAction(this.logger,h.LOG_MINOR,"Auth()","anonymous, using basic auth"),this._saveBasicOptions(a)}}get logger(){return this.client.logger}async authorize(i,a){if(a&&a.key&&this.authOptions.key!==a.key)throw new _("Unable to update auth options with incompatible key",40102,401);try{let l=await this._forceNewToken(i??null,a??null);return pl(this.client)?new Promise((o,u)=>{this.client.connection.connectionManager.onAuthUpdated(l,(f,p)=>f?u(f):o(p))}):l}catch(l){throw this.client.connection&&l.statusCode===Oi.Forbidden&&this.client.connection.connectionManager.actOnErrorFromAuthorize(l),l}}async _forceNewToken(i,a){this.tokenDetails=null,this._saveTokenOptions(i,a),ms(this.authOptions,this.logger);try{return this._ensureValidAuthCredentials(!0)}finally{delete this.tokenParams.timestamp,delete this.authOptions.queryTime}}async requestToken(i,a){const l=a||this.authOptions,o=i||ne(this.tokenParams);let u,f=this.client;if(l.authCallback)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authCallback"),u=l.authCallback;else if(l.authUrl)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with authUrl"),u=(m,T)=>{const S=U({accept:"application/json, text/plain"},l.authHeaders),B=l.authMethod&&l.authMethod.toLowerCase()==="post";let z;const Q=l.authUrl.indexOf("?");Q>-1&&(z=jt(l.authUrl.slice(Q)),l.authUrl=l.authUrl.slice(0,Q),B||(l.authParams=U(z,l.authParams)));const j=U({},l.authParams||{},m),F=$=>{var ge,Ve;let $e=(ge=$.body)!=null?ge:null,nt=null;if($.error)h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received Error: "+Y($.error));else{const Bt=(Ve=$.headers["content-type"])!=null?Ve:null;Array.isArray(Bt)?nt=Bt.join(", "):nt=Bt,h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Received; content-type: "+nt+"; body: "+le($e))}if($.error){T($.error,null);return}if($.unpacked){T(null,$e);return}if(x.BufferUtils.isBuffer($e)&&($e=$e.toString()),!nt){T(new _("authUrl response is missing a content-type header",40170,401),null);return}const Se=nt.indexOf("application/json")>-1,ln=nt.indexOf("text/plain")>-1||nt.indexOf("application/jwt")>-1;if(!Se&&!ln){T(new _("authUrl responded with unacceptable content-type "+nt+", should be either text/plain, application/jwt or application/json",40170,401),null);return}if(Se){if($e.length>Wi){T(new _("authUrl response exceeded max permitted length",40170,401),null);return}try{$e=JSON.parse($e)}catch(Bt){T(new _("Unexpected error processing authURL response; err = "+Bt.message,40170,401),null);return}}T(null,$e,nt)};if(h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().tokenRequestCallback","Requesting token from "+l.authUrl+"; Params: "+JSON.stringify(j)+"; method: "+(B?"POST":"GET")),B){const $=S||{};$["content-type"]="application/x-www-form-urlencoded";const ge=Ye(j).slice(1);_e(this.client.http.doUri(bt.Post,l.authUrl,$,ge,z),(Ve,$e)=>F(Ve||$e))}else _e(this.client.http.doUri(bt.Get,l.authUrl,S||{},null,j),($,ge)=>F($||ge))};else if(l.key)h.logAction(this.logger,h.LOG_MINOR,"Auth.requestToken()","using token auth with client-side signing"),u=(m,T)=>{_e(this.createTokenRequest(m,l),(S,B)=>T(S,B??null))};else{const m="Need a new token, but authOptions does not include any way to request one (no authUrl, authCallback, or key)";throw h.logAction(this.logger,h.LOG_ERROR,"Auth()","library initialized with a token literal without any way to renew the token when it expires (no authUrl, authCallback, or key). See https://help.ably.io/error/40171 for help"),new _(m,40171,403)}"capability"in o&&(o.capability=ps(o.capability));const p=(m,T)=>{const S=m.keyName,B="/keys/"+S+"/requestToken",z=function(j){return f.baseUri(j)+B},Q=ve.defaultPostHeaders(this.client.options);l.requestHeaders&&U(Q,l.requestHeaders),h.logAction(this.logger,h.LOG_MICRO,"Auth.requestToken().requestToken","Sending POST to "+B+"; Token params: "+JSON.stringify(m)),_e(this.client.http.do(bt.Post,z,Q,JSON.stringify(m),null),(j,F)=>j?T(j):T(F.error,F.body,F.unpacked))};return new Promise((m,T)=>{let S=!1,B=this.client.options.timeouts.realtimeRequestTimeout,z=setTimeout(()=>{S=!0;const Q="Token request callback timed out after "+B/1e3+" seconds";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",Q),T(new _(Q,40170,401))},B);u(o,(Q,j,F)=>{if(S)return;if(clearTimeout(z),Q){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request signing call returned error; err = "+Y(Q)),T(ml(Q));return}if(typeof j=="string"){j.length===0?T(new _("Token string is empty",40170,401)):j.length>Wi?T(new _("Token string exceeded max permitted length (was "+j.length+" bytes)",40170,401)):j==="undefined"||j==="null"?T(new _("Token string was literal null/undefined",40170,401)):j[0]==="{"&&!(F&&F.indexOf("application/jwt")>-1)?T(new _("Token was double-encoded; make sure you're not JSON-encoding an already encoded token request or details",40170,401)):m({token:j});return}if(typeof j!="object"||j===null){const ge="Expected token request callback to call back with a token string or token request/details object, but got a "+typeof j;h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",ge),T(new _(ge,40170,401));return}const $=JSON.stringify(j).length;if($>Wi&&!l.suppressMaxLengthCheck){T(new _("Token request/details object exceeded max permitted stringified size (was "+$+" bytes)",40170,401));return}if("issued"in j){m(j);return}if(!("keyName"in j)){const ge="Expected token request callback to call back with a token string, token request object, or token details object";h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()",ge),T(new _(ge,40170,401));return}p(j,(ge,Ve,$e)=>{if(ge){h.logAction(this.logger,h.LOG_ERROR,"Auth.requestToken()","token request API call returned error; err = "+Y(ge)),T(ml(ge));return}$e||(Ve=JSON.parse(Ve)),h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","token received"),m(Ve)})})})}async createTokenRequest(i,a){a=a||this.authOptions,i=i||ne(this.tokenParams);const l=a.key;if(!l)throw new _("No key specified",40101,403);const o=l.split(":"),u=o[0],f=o[1];if(!f)throw new _("Invalid key specified",40101,403);if(i.clientId==="")throw new _("clientId can’t be an empty string",40012,400);"capability"in i&&(i.capability=ps(i.capability));const p=U({keyName:u},i),m=i.clientId||"",T=i.ttl||"",S=i.capability||"";p.timestamp||(p.timestamp=await this._getTimestamp(a&&a.queryTime));const B=p.nonce||(p.nonce=Bn()),z=p.timestamp,Q=p.keyName+`
`+T+`
`+S+`
`+m+`
`+z+`
`+B+`
`;return p.mac=p.mac||Fi(Q,f),h.logAction(this.logger,h.LOG_MINOR,"Auth.getTokenRequest()","generated signed request"),p}async getAuthParams(){if(this.method=="basic")return{key:this.key};{let i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{access_token:i.token}}}async getAuthHeaders(){if(this.method=="basic")return{authorization:"Basic "+this.basicKey};{const i=await this._ensureValidAuthCredentials(!1);if(!i)throw new Error("Auth.getAuthParams(): _ensureValidAuthCredentials returned no error or tokenDetails");return{authorization:"Bearer "+ds(i.token)}}}_saveBasicOptions(i){this.method="basic",this.key=i.key,this.basicKey=ds(i.key),this.authOptions=i||{},"clientId"in i&&this._userSetClientId(i.clientId)}_saveTokenOptions(i,a){this.method="token",i&&(this.tokenParams=i),a&&(a.token&&(a.tokenDetails=typeof a.token=="string"?{token:a.token}:a.token),a.tokenDetails&&(this.tokenDetails=a.tokenDetails),"clientId"in a&&this._userSetClientId(a.clientId),this.authOptions=a)}async _ensureValidAuthCredentials(i){const a=this.tokenDetails;if(a){if(this._tokenClientIdMismatch(a.clientId))throw new _("Mismatch between clientId in token ("+a.clientId+") and current clientId ("+this.clientId+")",40102,403);if(!this.client.isTimeOffsetSet()||!a.expires||a.expires>=this.client.getTimestampUsingOffset())return h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","using cached token; expires = "+a.expires),a;h.logAction(this.logger,h.LOG_MINOR,"Auth.getToken()","deleting expired token"),this.tokenDetails=null}const l=(this.waitingForTokenRequest||(this.waitingForTokenRequest=$n.create(this.logger))).createPromise();if(this.currentTokenRequestId!==null&&!i)return l;const o=this.currentTokenRequestId=Oc();let u,f=null;try{u=await this.requestToken(this.tokenParams,this.authOptions)}catch(m){f=m}if(this.currentTokenRequestId>o)return h.logAction(this.logger,h.LOG_MINOR,"Auth._ensureValidAuthCredentials()","Discarding token request response; overtaken by newer one"),l;this.currentTokenRequestId=null;const p=this.waitingForTokenRequest;return this.waitingForTokenRequest=null,f?(p?.rejectAll(f),l):(p?.resolveAll(this.tokenDetails=u),l)}_userSetClientId(i){if(typeof i=="string"||i===null){if(i==="*")throw new _('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, instantiate the library with {defaultTokenParams: {clientId: "*"}}), or if calling authorize(), pass it in as a tokenParam: authorize({clientId: "*"}, authOptions)',40012,400);{const a=this._uncheckedSetClientId(i);if(a)throw a}}else throw new _("clientId must be either a string or null",40012,400)}_uncheckedSetClientId(i){if(this._tokenClientIdMismatch(i)){const a="Unexpected clientId mismatch: client has "+this.clientId+", requested "+i,l=new _(a,40102,401);return h.logAction(this.logger,h.LOG_ERROR,"Auth._uncheckedSetClientId()",a),l}else return this.clientId=this.tokenParams.clientId=i,null}_tokenClientIdMismatch(i){return!!(this.clientId&&this.clientId!=="*"&&i&&i!=="*"&&this.clientId!==i)}static isTokenErr(i){return i.code&&i.code>=40140&&i.code<40150}revokeTokens(i,a){return this.client.rest.revokeTokens(i,a)}async _getTimestamp(i){return this.client.getTimestamp(i||!!this.authOptions.queryTime)}},Tn=ys;function $i(i){const a=[];if(i)for(const l in i)a.push(l+"="+i[l]);return a.join("&")}function ea(i,a){return i+(a?"?":"")+$i(a)}function cn(i,a,l,o,u){i.error?h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received Error; "+ea(l,o)+"; Error: "+Y(i.error)):h.logActionNoStrip(u,h.LOG_MICRO,"Http."+a+"()","Received; "+ea(l,o)+"; Headers: "+$i(i.headers)+"; StatusCode: "+i.statusCode+"; Body"+(x.BufferUtils.isBuffer(i.body)?" (Base64): "+x.BufferUtils.base64Encode(i.body):": "+i.body))}function vl(i,a,l,o,u){u.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(u,h.LOG_MICRO,"Http."+i+"()","Sending; "+ea(a,o)+"; Body"+(x.BufferUtils.isBuffer(l)?" (Base64): "+x.BufferUtils.base64Encode(l):": "+l))}var vs=class{constructor(i){this.client=i,this.platformHttp=new x.Http(i),this.checkConnectivity=this.platformHttp.checkConnectivity?()=>this.platformHttp.checkConnectivity():void 0}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}get supportsAuthHeaders(){return this.platformHttp.supportsAuthHeaders}get supportsLinkHeaders(){return this.platformHttp.supportsLinkHeaders}_getHosts(i){const a=i.connection,l=a&&a.connectionManager.host;return l?[l].concat(ve.getFallbackHosts(i.options)):ve.getHosts(i.options)}async do(i,a,l,o,u){try{const f=this.client;if(!f)return{error:new _("http.do called without client",5e4,500)};const p=typeof a=="function"?a:function(z){return f.baseUri(z)+a},m=f._currentFallback;if(m)if(m.validUntil>Date.now()){const z=await this.doUri(i,p(m.host),l,o,u);return z.error&&this.platformHttp.shouldFallback(z.error)?(f._currentFallback=null,this.do(i,a,l,o,u)):z}else f._currentFallback=null;const T=this._getHosts(f);if(T.length===1)return this.doUri(i,p(T[0]),l,o,u);let S=null;const B=async(z,Q)=>{const j=z.shift();S=S??new Date;const F=await this.doUri(i,p(j),l,o,u);return F.error&&this.platformHttp.shouldFallback(F.error)&&z.length?Date.now()-S.getTime()>f.options.timeouts.httpMaxRetryDuration?{error:new _(`Timeout for trying fallback hosts retries. Total elapsed time exceeded the ${f.options.timeouts.httpMaxRetryDuration}ms limit`,50003,500)}:B(z,!0):(Q&&(f._currentFallback={host:j,validUntil:Date.now()+f.options.timeouts.fallbackRetryTimeout}),F)};return B(T)}catch(f){return{error:new _(`Unexpected error in Http.do: ${Y(f)}`,500,5e4)}}}async doUri(i,a,l,o,u){try{vl(i,a,o,u,this.logger);const f=await this.platformHttp.doUri(i,a,l,o,u);return this.logger.shouldLog(h.LOG_MICRO)&&cn(f,i,a,u,this.logger),f}catch(f){return{error:new _(`Unexpected error in Http.doUri: ${Y(f)}`,500,5e4)}}}};function bl(i,a,l,o){try{l.apply(a,o)}catch(u){h.logAction(i,h.LOG_ERROR,"EventEmitter.emit()","Unexpected listener exception: "+u+"; stack = "+(u&&u.stack))}}function ei(i,a,l){let o,u,f;for(let p=0;p<i.length;p++)if(o=i[p],l&&(o=o[l]),Array.isArray(o)){for(;(u=o.indexOf(a))!==-1;)o.splice(u,1);l&&o.length===0&&delete i[p][l]}else if(v(o))for(f in o)Object.prototype.hasOwnProperty.call(o,f)&&Array.isArray(o[f])&&ei([o],a,f)}var Br=class{constructor(i){this.logger=i,this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null)}on(...i){if(i.length===1){const a=i[0];if(typeof a=="function")this.any.push(a);else throw new Error("EventListener.on(): Invalid arguments: "+x.Config.inspect(i))}if(i.length===2){const[a,l]=i;if(typeof l!="function")throw new Error("EventListener.on(): Invalid arguments: "+x.Config.inspect(i));if(I(a))this.any.push(l);else if(Array.isArray(a))a.forEach(o=>{this.on(o,l)});else{if(typeof a!="string")throw new Error("EventListener.on(): Invalid arguments: "+x.Config.inspect(i));(this.events[a]||(this.events[a]=[])).push(l)}}}off(...i){if(i.length==0||I(i[0])&&I(i[1])){this.any=[],this.events=Object.create(null),this.anyOnce=[],this.eventsOnce=Object.create(null);return}const[a,l]=i;let o=null,u=null;if(i.length===1||!l)typeof a=="function"?o=a:u=a;else{if(typeof l!="function")throw new Error("EventEmitter.off(): invalid arguments:"+x.Config.inspect(i));[u,o]=[a,l]}if(o&&I(u)){ei([this.any,this.events,this.anyOnce,this.eventsOnce],o);return}if(Array.isArray(u)){u.forEach(f=>{this.off(f,o)});return}if(typeof u!="string")throw new Error("EventEmitter.off(): invalid arguments:"+x.Config.inspect(i));o?ei([this.events,this.eventsOnce],o,u):(delete this.events[u],delete this.eventsOnce[u])}listeners(i){if(i){const a=this.events[i]||[];return this.eventsOnce[i]&&Array.prototype.push.apply(a,this.eventsOnce[i]),a.length?a:null}return this.any.length?this.any:null}emit(i,...a){const l={event:i},o=[];this.anyOnce.length&&(Array.prototype.push.apply(o,this.anyOnce),this.anyOnce=[]),this.any.length&&Array.prototype.push.apply(o,this.any);const u=this.eventsOnce[i];u&&(Array.prototype.push.apply(o,u),delete this.eventsOnce[i]);const f=this.events[i];f&&Array.prototype.push.apply(o,f),o.forEach(p=>{bl(this.logger,l,p,a)})}once(...i){const a=i.length;if(a===0||a===1&&typeof i[0]!="function"){const u=i[0];return new Promise(f=>{this.once(u,f)})}const[l,o]=i;if(i.length===1&&typeof l=="function")this.anyOnce.push(l);else if(I(l)){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));this.anyOnce.push(o)}else if(Array.isArray(l)){const u=this,f=function(){const p=Array.prototype.slice.call(arguments);if(l.forEach(function(m){u.off(m,f)}),typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));o.apply(this,p)};l.forEach(function(p){u.on(p,f)})}else{if(typeof l!="string")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));const u=this.eventsOnce[l]||(this.eventsOnce[l]=[]);if(o){if(typeof o!="function")throw new Error("EventEmitter.once(): Invalid arguments:"+x.Config.inspect(i));u.push(o)}}}async whenState(i,a){if(typeof i!="string"||typeof a!="string")throw new Error("whenState requires a valid state String argument");return i===a?null:this.once(i)}},Et=Br,ue={HEARTBEAT:0,ACK:1,NACK:2,CONNECT:3,CONNECTED:4,DISCONNECT:5,DISCONNECTED:6,CLOSE:7,CLOSED:8,ERROR:9,ATTACH:10,ATTACHED:11,DETACH:12,DETACHED:13,PRESENCE:14,MESSAGE:15,SYNC:16,AUTH:17,ACTIVATE:18,OBJECT:19,OBJECT_SYNC:20,ANNOTATION:21},zr=[];Object.keys(ue).forEach(function(i){zr[ue[i]]=i});var Pt={HAS_PRESENCE:1,HAS_BACKLOG:2,RESUMED:4,TRANSIENT:16,ATTACH_RESUME:32,HAS_OBJECTS:128,PRESENCE:65536,PUBLISH:1<<17,SUBSCRIBE:1<<18,PRESENCE_SUBSCRIBE:1<<19,ANNOTATION_PUBLISH:1<<21,ANNOTATION_SUBSCRIBE:1<<22,OBJECT_SUBSCRIBE:1<<24,OBJECT_PUBLISH:1<<25},jr=Object.keys(Pt);Pt.MODE_ALL=Pt.PRESENCE|Pt.PUBLISH|Pt.SUBSCRIBE|Pt.PRESENCE_SUBSCRIBE|Pt.ANNOTATION_PUBLISH|Pt.ANNOTATION_SUBSCRIBE|Pt.OBJECT_SUBSCRIBE|Pt.OBJECT_PUBLISH;var bs=["PRESENCE","PUBLISH","SUBSCRIBE","PRESENCE_SUBSCRIBE","ANNOTATION_PUBLISH","ANNOTATION_SUBSCRIBE","OBJECT_SUBSCRIBE","OBJECT_PUBLISH"];function Ac(i){return!i||!i.channelOptions?{channelOptions:i,plugins:{},baseEncodedPreviousPayload:void 0}:i}function qr(i,a,l){if(l&&l.cipher){i||wt("Crypto");const o=i.getCipher(l.cipher,a);return{cipher:o.cipherParams,channelCipher:o.cipher}}return l??{}}async function Ss(i,a){const{data:l,encoding:o}=await Os(i.data,i.encoding,a);return i.data=l,i.encoding=o,i}async function Os(i,a,l){let o=l.channelCipher,u=i,f=a?a+"/":"";x.BufferUtils.isBuffer(u)||(u=x.BufferUtils.utf8Encode(String(u)),f=f+"utf-8/");const p=await o.encrypt(u);return f=f+"cipher+"+o.algorithm,{data:p,encoding:f}}async function Ga(i,a){const l=typeof i.data=="string"||x.BufferUtils.isBuffer(i.data)||i.data===null||i.data===void 0,{data:o,encoding:u}=Ai(i.data,i.encoding,l);return i.data=o,i.encoding=u,a!=null&&a.cipher?Ss(i,a):i}function Ai(i,a,l){if(l)return{data:i,encoding:a};if(v(i)||Array.isArray(i))return{data:JSON.stringify(i),encoding:a?a+"/json":"json"};throw new _("Data type is unsupported",40013,400)}async function ti(i,a){const{data:l,encoding:o,error:u}=await Sl(i.data,i.encoding,a);if(i.data=l,i.encoding=o,u)throw u}async function Sl(i,a,l){const o=Ac(l);let u=i,f=i,p=a,m;if(a){const T=a.split("/");let S,B=T.length,z="";try{for(;(S=B)>0;){const Q=T[--B].match(/([-\w]+)(\+([\w-]+))?/);if(!Q)break;switch(z=Q[1],z){case"base64":f=x.BufferUtils.base64Decode(String(f)),S==T.length&&(u=f);continue;case"utf-8":f=x.BufferUtils.utf8Decode(f);continue;case"json":f=JSON.parse(f);continue;case"cipher":if(o.channelOptions!=null&&o.channelOptions.cipher&&o.channelOptions.channelCipher){const j=Q[3],F=o.channelOptions.channelCipher;if(j!=F.algorithm)throw new Error("Unable to decrypt message with given cipher; incompatible cipher params");f=await F.decrypt(f);continue}else throw new Error("Unable to decrypt message; not an encrypted channel");case"vcdiff":if(!o.plugins||!o.plugins.vcdiff)throw new _("Missing Vcdiff decoder (https://github.com/ably-forks/vcdiff-decoder)",40019,400);if(typeof Uint8Array>"u")throw new _("Delta decoding not supported on this browser (need ArrayBuffer & Uint8Array)",40020,400);try{let j=o.baseEncodedPreviousPayload;typeof j=="string"&&(j=x.BufferUtils.utf8Encode(j));const F=x.BufferUtils.toBuffer(j);f=x.BufferUtils.toBuffer(f),f=x.BufferUtils.arrayBufferViewToBuffer(o.plugins.vcdiff.decode(f,F)),u=f}catch(j){throw new _("Vcdiff delta decode failed with "+j,40018,400)}continue;default:throw new Error("Unknown encoding")}}}catch(Q){const j=Q;m=new _(`Error processing the ${z} encoding, decoder returned ‘${j.message}’`,j.code||40013,400)}finally{p=S<=0?null:T.slice(0,S).join("/")}}return m?{error:m,data:f,encoding:p}:(o.baseEncodedPreviousPayload=u,{data:f,encoding:p})}function Va(...i){const a=i.length>0?"json":"msgpack",{data:l,encoding:o}=Ol(this.data,this.encoding,a);return Object.assign({},this,{encoding:o,data:l})}function Ol(i,a,l){return!i||!x.BufferUtils.isBuffer(i)?{data:i,encoding:a}:l==="msgpack"?{data:x.BufferUtils.toBuffer(i),encoding:a}:{data:x.BufferUtils.base64Encode(i),encoding:a?a+"/base64":"base64"}}var ni={encryptData:Os,encodeData:Ai,encodeDataForWire:Ol,decodeData:Sl};function un(i){const{id:a,connectionId:l,timestamp:o}=i;let u;switch(i.action){case ue.MESSAGE:{u=i.messages;break}case ue.PRESENCE:case ue.SYNC:u=i.presence;break;case ue.ANNOTATION:u=i.annotations;break;case ue.OBJECT:case ue.OBJECT_SYNC:u=i.state;break;default:throw new _("Unexpected action "+i.action,4e4,400)}for(let f=0;f<u.length;f++){const p=u[f];p.connectionId||(p.connectionId=l),p.timestamp||(p.timestamp=o),a&&!p.id&&(p.id=a+":"+f)}}function ii(i,a){let l="["+a;for(const o in i)o==="data"?typeof i.data=="string"?l+="; data="+i.data:x.BufferUtils.isBuffer(i.data)?l+="; data (buffer)="+x.BufferUtils.base64Encode(i.data):typeof i.data<"u"&&(l+="; data (json)="+JSON.stringify(i.data)):o&&(o==="extras"||o==="operation")?l+="; "+o+"="+JSON.stringify(i[o]):i[o]!==void 0&&(l+="; "+o+"="+i[o]);return l+="]",l}var Cn=class{},zn=class{constructor(i){this.Platform=x,this.ErrorInfo=_,this.Logger=h,this.Defaults=ve,this.Utils=He,this.EventEmitter=Et,this.MessageEncoding=ni;var a,l,o,u,f,p,m,T,S,B;this._additionalHTTPRequestImplementations=(a=i.plugins)!=null?a:null,this.logger=new h,this.logger.setLog(i.logLevel,i.logHandler),h.logAction(this.logger,h.LOG_MICRO,"BaseClient()","initialized with clientOptions "+x.Config.inspect(i)),this._MsgPack=(o=(l=i.plugins)==null?void 0:l.MsgPack)!=null?o:null;const z=this.options=ve.normaliseOptions(i,this._MsgPack,this.logger);if(z.key){const Q=z.key.match(/^([^:\s]+):([^:.\s]+)$/);if(!Q){const j="invalid key parameter";throw h.logAction(this.logger,h.LOG_ERROR,"BaseClient()",j),new _(j,40400,404)}z.keyName=Q[1],z.keySecret=Q[2]}if("clientId"in z)if(typeof z.clientId=="string"||z.clientId===null){if(z.clientId==="*")throw new _('Can’t use "*" as a clientId as that string is reserved. (To change the default token request behaviour to use a wildcard clientId, use {defaultTokenParams: {clientId: "*"}})',40012,400)}else throw new _("clientId must be either a string or null",40012,400);h.logAction(this.logger,h.LOG_MINOR,"BaseClient()","started; version = "+ve.version),this._currentFallback=null,this.serverTimeOffset=null,this.http=new vs(this),this.auth=new Tn(this,z),this._rest=(u=i.plugins)!=null&&u.Rest?new i.plugins.Rest(this):null,this._Crypto=(p=(f=i.plugins)==null?void 0:f.Crypto)!=null?p:null,this.__FilteredSubscriptions=(T=(m=i.plugins)==null?void 0:m.MessageInteractions)!=null?T:null,this._Annotations=(B=(S=i.plugins)==null?void 0:S.Annotations)!=null?B:null}get rest(){return this._rest||wt("Rest"),this._rest}get _FilteredSubscriptions(){return this.__FilteredSubscriptions||wt("MessageInteractions"),this.__FilteredSubscriptions}get channels(){return this.rest.channels}get push(){return this.rest.push}device(){var i;return(!((i=this.options.plugins)!=null&&i.Push)||!this.push.LocalDevice)&&wt("Push"),this._device||(this._device=this.push.LocalDevice.load(this)),this._device}baseUri(i){return ve.getHttpScheme(this.options)+i+":"+ve.getPort(this.options,!1)}async stats(i){return this.rest.stats(i)}async time(i){return this.rest.time(i)}async request(i,a,l,o,u,f){return this.rest.request(i,a,l,o,u,f)}batchPublish(i){return this.rest.batchPublish(i)}batchPresence(i){return this.rest.batchPresence(i)}setLog(i){this.logger.setLog(i.level,i.handler)}async getTimestamp(i){return!this.isTimeOffsetSet()&&i?this.time():this.getTimestampUsingOffset()}getTimestampUsingOffset(){return Date.now()+(this.serverTimeOffset||0)}isTimeOffsetSet(){return this.serverTimeOffset!==null}};zn.Platform=x;var As=zn,Rs=class sl{toJSON(){var a,l,o;return{id:this.id,deviceSecret:this.deviceSecret,platform:this.platform,formFactor:this.formFactor,clientId:this.clientId,metadata:this.metadata,deviceIdentityToken:this.deviceIdentityToken,push:{recipient:(a=this.push)==null?void 0:a.recipient,state:(l=this.push)==null?void 0:l.state,error:(o=this.push)==null?void 0:o.error}}}toString(){var a,l,o,u;let f="[DeviceDetails";return this.id&&(f+="; id="+this.id),this.platform&&(f+="; platform="+this.platform),this.formFactor&&(f+="; formFactor="+this.formFactor),this.clientId&&(f+="; clientId="+this.clientId),this.metadata&&(f+="; metadata="+this.metadata),this.deviceIdentityToken&&(f+="; deviceIdentityToken="+JSON.stringify(this.deviceIdentityToken)),(a=this.push)!=null&&a.recipient&&(f+="; push.recipient="+JSON.stringify(this.push.recipient)),(l=this.push)!=null&&l.state&&(f+="; push.state="+this.push.state),(o=this.push)!=null&&o.error&&(f+="; push.error="+JSON.stringify(this.push.error)),(u=this.push)!=null&&u.metadata&&(f+="; push.metadata="+this.push.metadata),f+="]",f}static toRequestBody(a,l,o){return dt(a,l,o)}static fromResponseBody(a,l,o){return o&&(a=Je(a,l,o)),Array.isArray(a)?sl.fromValuesArray(a):sl.fromValues(a)}static fromValues(a){return a.error=a.error&&_.fromValues(a.error),Object.assign(new sl,a)}static fromLocalDevice(a){return Object.assign(new sl,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=sl.fromValues(a[u]);return o}},Ri=Rs;async function Ia(i,a,l,o){if(i.http.supportsAuthHeaders){const u=await i.auth.getAuthHeaders();return o(U(u,a),l)}else{const u=await i.auth.getAuthParams();return o(a,U(u,l))}}function Ts(i,a,l){if(i.err&&!i.body)return{err:i.err};if(i.statusCode===Oi.NoContent)return Ce(pe({},i),{body:[],unpacked:!0});let o=i.body;if(!i.unpacked)try{o=Je(o,a,l)}catch(m){return Jt(m)?{err:m}:{err:new de(Y(m),null)}}if(!o)return{err:new de("unenvelope(): Response body is missing",null)};const{statusCode:u,response:f,headers:p}=o;if(u===void 0)return Ce(pe({},i),{body:o,unpacked:!0});if(u<200||u>=300){let m=f&&f.error||i.err;return m||(m=new Error("Error in unenveloping "+o),m.statusCode=u),{err:m,body:f,headers:p,unpacked:!0,statusCode:u}}return{err:i.err,body:f,headers:p,unpacked:!0,statusCode:u}}function Hr(i,a,l,o,u){i.err?h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received Error; "+ea(l,o)+"; Error: "+Y(i.err)):h.logAction(u,h.LOG_MICRO,"Resource."+a+"()","Received; "+ea(l,o)+"; Headers: "+$i(i.headers)+"; StatusCode: "+i.statusCode+"; Body: "+(x.BufferUtils.isBuffer(i.body)?" (Base64): "+x.BufferUtils.base64Encode(i.body):": "+x.Config.inspect(i.body)))}var Wt=class ll{static async get(a,l,o,u,f,p){return ll.do(bt.Get,a,l,null,o,u,f,p??!1)}static async delete(a,l,o,u,f,p){return ll.do(bt.Delete,a,l,null,o,u,f,p)}static async post(a,l,o,u,f,p,m){return ll.do(bt.Post,a,l,o,u,f,p,m)}static async patch(a,l,o,u,f,p,m){return ll.do(bt.Patch,a,l,o,u,f,p,m)}static async put(a,l,o,u,f,p,m){return ll.do(bt.Put,a,l,o,u,f,p,m)}static async do(a,l,o,u,f,p,m,T){m&&((p=p||{}).envelope=m);const S=l.logger;async function B(Q,j){var F;if(S.shouldLog(h.LOG_MICRO)){let ge=u;if(((F=Q["content-type"])==null?void 0:F.indexOf("msgpack"))>0)try{l._MsgPack||wt("MsgPack"),ge=l._MsgPack.decode(u)}catch(Ve){h.logAction(S,h.LOG_MICRO,"Resource."+a+"()","Sending MsgPack Decoding Error: "+Y(Ve))}h.logAction(S,h.LOG_MICRO,"Resource."+a+"()","Sending; "+ea(o,j)+"; Body: "+ge)}const $=await l.http.do(a,o,Q,u,j);return $.error&&Tn.isTokenErr($.error)?(await l.auth.authorize(null,null),Ia(l,Q,j,B)):{err:$.error,body:$.body,headers:$.headers,unpacked:$.unpacked,statusCode:$.statusCode}}let z=await Ia(l,f,p,B);if(m&&(z=Ts(z,l._MsgPack,m)),S.shouldLog(h.LOG_MICRO)&&Hr(z,a,o,p,S),T){if(z.err)throw z.err;{const Q=pe({},z);return delete Q.err,Q}}return z}},lt=Wt;function Cs(i){const a=i.match(/^\.\/(\w+)\?(.*)$/);return a&&a[2]&&jt(a[2])}function Ya(i){typeof i=="string"&&(i=i.split(","));const a={};for(let l=0;l<i.length;l++){const o=i[l].match(/^\s*<(.+)>;\s*rel="(\w+)"$/);if(o){const u=Cs(o[1]);u&&(a[o[2]]=u)}}return a}function Rc(i,a,l){return!(l&&(a||typeof i.code=="number"))}var Al=class{constructor(i,a,l,o,u,f){this.client=i,this.path=a,this.headers=l,this.envelope=o??null,this.bodyHandler=u,this.useHttpPaginatedResponse=f||!1}get logger(){return this.client.logger}async get(i){const a=await lt.get(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async delete(i){const a=await lt.delete(this.client,this.path,this.headers,i,this.envelope,!1);return this.handlePage(a)}async post(i,a){const l=await lt.post(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async put(i,a){const l=await lt.put(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async patch(i,a){const l=await lt.patch(this.client,this.path,a,this.headers,i,this.envelope,!1);return this.handlePage(l)}async handlePage(i){if(i.err&&Rc(i.err,i.body,this.useHttpPaginatedResponse))throw h.logAction(this.logger,h.LOG_ERROR,"PaginatedResource.handlePage()","Unexpected error getting resource: err = "+Y(i.err)),i.err;let a,l,o;try{a=i.statusCode==Oi.NoContent?[]:await this.bodyHandler(i.body,i.headers||{},i.unpacked)}catch(u){throw i.err||u}return i.headers&&(l=i.headers.Link||i.headers.link)&&(o=Ya(l)),this.useHttpPaginatedResponse?new Pa(this,a,i.headers||{},i.statusCode,o,i.err):new _s(this,a,o)}},_s=class{constructor(i,a,l){this.resource=i,this.items=a,this._relParams=l}async first(){if(this.hasFirst())return this.get(this._relParams.first);throw new _("No link to the first page of results",40400,404)}async current(){if(this.hasCurrent())return this.get(this._relParams.current);throw new _("No link to the current page of results",40400,404)}async next(){return this.hasNext()?this.get(this._relParams.next):null}hasFirst(){return this._relParams!=null&&"first"in this._relParams}hasCurrent(){return this._relParams!=null&&"current"in this._relParams}hasNext(){return this._relParams!=null&&"next"in this._relParams}isLast(){return!this.hasNext()}async get(i){const a=this.resource,l=await lt.get(a.client,a.path,a.headers,i,a.envelope,!1);return a.handlePage(l)}},Pa=class extends _s{constructor(i,a,l,o,u,f){super(i,a,u),this.statusCode=o,this.success=o<300&&o>=200,this.headers=l,this.errorCode=f&&f.code,this.errorMessage=f&&f.message}toJSON(){return{items:this.items,statusCode:this.statusCode,success:this.success,headers:this.headers,errorCode:this.errorCode,errorMessage:this.errorMessage}}},nn=Al,Rl=class Cr{toJSON(){return{channel:this.channel,deviceId:this.deviceId,clientId:this.clientId}}toString(){let a="[PushChannelSubscription";return this.channel&&(a+="; channel="+this.channel),this.deviceId&&(a+="; deviceId="+this.deviceId),this.clientId&&(a+="; clientId="+this.clientId),a+="]",a}static fromResponseBody(a,l,o){return o&&(a=Je(a,l,o)),Array.isArray(a)?Cr.fromValuesArray(a):Cr.fromValues(a)}static fromValues(a){return Object.assign(new Cr,a)}static fromValuesArray(a){const l=a.length,o=new Array(l);for(let u=0;u<l;u++)o[u]=Cr.fromValues(a[u]);return o}};Rl.toRequestBody=dt;var Tc=Rl,Es=Tc,Cc=class{constructor(i){var a;this.client=i,this.admin=new Tl(i),x.Config.push&&((a=i.options.plugins)!=null&&a.Push)&&(this.stateMachine=new i.options.plugins.Push.ActivationStateMachine(i),this.LocalDevice=i.options.plugins.Push.localDeviceFactory(Ri))}async activate(i,a){await new Promise((l,o)=>{var u;if(!((u=this.client.options.plugins)!=null&&u.Push)){o(qa("Push"));return}if(!this.stateMachine){o(new _("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.activatedCallback){o(new _("Activation already in progress",4e4,400));return}this.stateMachine.activatedCallback=f=>{if(f){o(f);return}l()},this.stateMachine.updateFailedCallback=a,this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledActivate(this.stateMachine,i))})}async deactivate(i){await new Promise((a,l)=>{var o;if(!((o=this.client.options.plugins)!=null&&o.Push)){l(qa("Push"));return}if(!this.stateMachine){l(new _("This platform is not supported as a target of push notifications",4e4,400));return}if(this.stateMachine.deactivatedCallback){l(new _("Deactivation already in progress",4e4,400));return}this.stateMachine.deactivatedCallback=u=>{if(u){l(u);return}a()},this.stateMachine.handleEvent(new this.client.options.plugins.Push.CalledDeactivate(this.stateMachine,i))})}},Tl=class{constructor(i){this.client=i,this.deviceRegistrations=new _c(i),this.channelSubscriptions=new Ec(i)}async publish(i,a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=ve.defaultPostHeaders(l.options,{format:o}),f={},p=U({recipient:i},a);U(u,l.options.headers),l.options.pushFullWait&&U(f,{fullWait:"true"});const m=dt(p,l._MsgPack,o);await lt.post(l,"/push/publish",m,u,f,null,!0)}},_c=class{constructor(i){this.client=i}async save(i){const a=this.client,l=Ri.fromValues(i),o=a.options.useBinaryProtocol?"msgpack":"json",u=ve.defaultPostHeaders(a.options,{format:o}),f={};U(u,a.options.headers),a.options.pushFullWait&&U(f,{fullWait:"true"});const p=dt(l,a._MsgPack,o),m=await lt.put(a,"/push/deviceRegistrations/"+encodeURIComponent(i.id),p,u,f,null,!0);return Ri.fromResponseBody(m.body,a._MsgPack,m.unpacked?void 0:o)}async get(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=ve.defaultGetHeaders(a.options,{format:l}),u=i.id||i;if(typeof u!="string"||!u.length)throw new _("First argument to DeviceRegistrations#get must be a deviceId string or DeviceDetails",4e4,400);U(o,a.options.headers);const f=await lt.get(a,"/push/deviceRegistrations/"+encodeURIComponent(u),o,{},null,!0);return Ri.fromResponseBody(f.body,a._MsgPack,f.unpacked?void 0:l)}async list(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l,u=ve.defaultGetHeaders(a.options,{format:l});return U(u,a.options.headers),new nn(a,"/push/deviceRegistrations",u,o,async function(f,p,m){return Ri.fromResponseBody(f,a._MsgPack,m?void 0:l)}).get(i)}async remove(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=ve.defaultGetHeaders(a.options,{format:l}),u={},f=i.id||i;if(typeof f!="string"||!f.length)throw new _("First argument to DeviceRegistrations#remove must be a deviceId string or DeviceDetails",4e4,400);U(o,a.options.headers),a.options.pushFullWait&&U(u,{fullWait:"true"}),await lt.delete(a,"/push/deviceRegistrations/"+encodeURIComponent(f),o,u,null,!0)}async removeWhere(i){const a=this.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=ve.defaultGetHeaders(a.options,{format:l});U(o,a.options.headers),a.options.pushFullWait&&U(i,{fullWait:"true"}),await lt.delete(a,"/push/deviceRegistrations",o,i,null,!0)}},Ec=class Xd{constructor(a){this.remove=Xd.prototype.removeWhere,this.client=a}async save(a){const l=this.client,o=Es.fromValues(a),u=l.options.useBinaryProtocol?"msgpack":"json",f=ve.defaultPostHeaders(l.options,{format:u}),p={};U(f,l.options.headers),l.options.pushFullWait&&U(p,{fullWait:"true"});const m=dt(o,l._MsgPack,u),T=await lt.post(l,"/push/channelSubscriptions",m,f,p,null,!0);return Es.fromResponseBody(T.body,l._MsgPack,T.unpacked?void 0:u)}async list(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=ve.defaultGetHeaders(l.options,{format:o});return U(f,l.options.headers),new nn(l,"/push/channelSubscriptions",f,u,async function(p,m,T){return Es.fromResponseBody(p,l._MsgPack,T?void 0:o)}).get(a)}async removeWhere(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=ve.defaultGetHeaders(l.options,{format:o});U(u,l.options.headers),l.options.pushFullWait&&U(a,{fullWait:"true"}),await lt.delete(l,"/push/channelSubscriptions",u,a,null,!0)}async listChannels(a){const l=this.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=this.client.http.supportsLinkHeaders?void 0:o,f=ve.defaultGetHeaders(l.options,{format:o});return U(f,l.options.headers),l.options.pushFullWait&&U(a,{fullWait:"true"}),new nn(l,"/push/channels",f,u,async function(p,m,T){const S=!T&&o?Je(p,l._MsgPack,o):p;for(let B=0;B<S.length;B++)S[B]=String(S[B]);return S}).get(a)}},Mc=Cc,Gr=["absent","present","enter","leave","update"];async function Vr(i,a,l,o){const u=qr(a,i,o??null);return Xa.fromValues(l).decode(u,i)}async function Ir(i,a,l,o){return Promise.all(l.map(function(u){return Vr(i,a,u,o)}))}async function wc(i,a){return Xa.fromValues(i).decode(a.channelOptions,a.logger)}async function Yr(i,a){return Promise.all(i.map(function(l){return wc(l,a)}))}var Pr=class _r extends Cn{isSynthesized(){return!this.id||!this.connectionId?!0:this.id.substring(this.connectionId.length,0)!==this.connectionId}parseId(){if(!this.id)throw new Error("parseId(): Presence message does not contain an id");const a=this.id.split(":");return{connectionId:a[0],msgSerial:parseInt(a[1],10),index:parseInt(a[2],10)}}async encode(a){const l=Object.assign(new Xa,this,{action:Gr.indexOf(this.action||"present")});return Ga(l,a)}static fromValues(a){return Object.assign(new _r,a)}static fromValuesArray(a){return a.map(l=>_r.fromValues(l))}static fromData(a){return a instanceof _r?a:_r.fromValues({data:a})}toString(){return ii(this,"PresenceMessage")}},Xa=class lf extends Cn{toJSON(...a){return Va.call(this,...a)}static fromValues(a){return Object.assign(new lf,a)}static fromValuesArray(a){return a.map(l=>lf.fromValues(l))}async decode(a,l){const o=Object.assign(new Pr,Ce(pe({},this),{action:Gr[this.action]}));try{await ti(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WirePresenceMessage.decode()",Y(u))}return o}toString(){return ii(this,"WirePresenceMessage")}},_n=Pr,xc=class{constructor(i){this.channel=i}get logger(){return this.channel.logger}async get(i){h.logAction(this.logger,h.LOG_MICRO,"RestPresence.get()","channel = "+this.channel.name);const a=this.channel.client,l=a.options.useBinaryProtocol?"msgpack":"json",o=this.channel.client.http.supportsLinkHeaders?void 0:l,u=ve.defaultGetHeaders(a.options,{format:l});return U(u,a.options.headers),new nn(a,this.channel.client.rest.presenceMixin.basePath(this),u,o,async(f,p,m)=>{const T=m?f:Je(f,a._MsgPack,l);return Yr(T,this.channel)}).get(i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestPresence.history()","channel = "+this.channel.name),this.channel.client.rest.presenceMixin.history(this,i)}},Nc=xc,Xr=["message.create","message.update","message.delete","meta","message.summary"];function Qr(i){return Xr[i||0]||"unknown"}function Uc(i){let a=0;return i.name&&(a+=i.name.length),i.clientId&&(a+=i.clientId.length),i.extras&&(a+=JSON.stringify(i.extras).length),i.data&&(a+=ie(i.data)),a}async function Zr(i,a,l,o){const u=qr(a,i,o??null);return Ti.fromValues(l).decode(u,i)}async function kc(i,a,l,o){return Promise.all(l.map(function(u){return Zr(i,a,u,o)}))}async function Dc(i,a){return Ti.fromValues(i).decode(a.channelOptions,a.logger)}async function Lc(i,a){return Promise.all(i.map(function(l){return Dc(l,a)}))}async function Kr(i,a){return Promise.all(i.map(l=>l.encode(a)))}var Bc=dt;function Cl(i){let a,l=0;for(let o=0;o<i.length;o++)a=i[o],l+=a.size||(a.size=Uc(a));return l}var Jr=class rf extends Cn{expandFields(){this.action==="message.create"&&(this.version&&!this.serial&&(this.serial=this.version),this.timestamp&&!this.createdAt&&(this.createdAt=this.timestamp))}async encode(a){const l=Object.assign(new Ti,this,{action:Xr.indexOf(this.action||"message.create")});return Ga(l,a)}static fromValues(a){return Object.assign(new rf,a)}static fromValuesArray(a){return a.map(l=>rf.fromValues(l))}toString(){return ii(this,"Message")}},Ti=class of extends Cn{toJSON(...a){return Va.call(this,...a)}static fromValues(a){return Object.assign(new of,a)}static fromValuesArray(a){return a.map(l=>of.fromValues(l))}async decodeWithErr(a,l){const o=Object.assign(new Jr,Ce(pe({},this),{action:Qr(this.action)}));let u;try{await ti(o,a)}catch(f){h.logAction(l,h.LOG_ERROR,"WireMessage.decode()",Y(f)),u=f}return o.expandFields(),{decoded:o,err:u}}async decode(a,l){const{decoded:o}=await this.decodeWithErr(a,l);return o}toString(){return ii(this,"WireMessage")}},fn=Jr,zc=9;function Wr(i){return i.every(function(a){return!a.id})}var Fr=class{constructor(i,a,l){this._annotations=null;var o,u;h.logAction(i.logger,h.LOG_MINOR,"RestChannel()","started; name = "+a),this.name=a,this.client=i,this.presence=new Nc(this),this.channelOptions=Ln((o=i._Crypto)!=null?o:null,this.logger,l),(u=i.options.plugins)!=null&&u.Push&&(this._push=new i.options.plugins.Push.PushChannel(this)),i._Annotations&&(this._annotations=new i._Annotations.RestAnnotations(this))}get annotations(){return this._annotations||wt("Annotations"),this._annotations}get push(){return this._push||wt("Push"),this._push}get logger(){return this.client.logger}setOptions(i){var a;this.channelOptions=Ln((a=this.client._Crypto)!=null?a:null,this.logger,i)}async history(i){return h.logAction(this.logger,h.LOG_MICRO,"RestChannel.history()","channel = "+this.name),this.client.rest.channelMixin.history(this,i)}async publish(...i){const a=i[0],l=i[1];let o,u;if(typeof a=="string"||a===null)o=[fn.fromValues({name:a,data:l})],u=i[2];else if(v(a))o=[fn.fromValues(a)],u=i[1];else if(Array.isArray(a))o=fn.fromValuesArray(a),u=i[1];else throw new _("The single-argument form of publish() expects a message object or an array of message objects",40013,400);u||(u={});const f=this.client,p=f.options,m=p.useBinaryProtocol?"msgpack":"json",T=f.options.idempotentRestPublishing,S=ve.defaultPostHeaders(f.options,{format:m});if(U(S,p.headers),T&&Wr(o)){const j=await be(zc);o.forEach(function(F,$){F.id=j+":"+$.toString()})}const B=await Kr(o,this.channelOptions),z=Cl(B),Q=p.maxMessageSize;if(z>Q)throw new _(`Maximum size of messages that can be published at once exceeded (was ${z} bytes; limit is ${Q} bytes)`,40009,400);await this._publish(Bc(B,f._MsgPack,m),S,u)}async _publish(i,a,l){await lt.post(this.client,this.client.rest.channelMixin.basePath(this)+"/messages",i,a,l,null,!0)}async status(){return this.client.rest.channelMixin.status(this)}},$r=Fr,eo=class Qd{constructor(a){this.entries=a&&a.entries||void 0,this.schema=a&&a.schema||void 0,this.appId=a&&a.appId||void 0,this.inProgress=a&&a.inProgress||void 0,this.unit=a&&a.unit||void 0,this.intervalId=a&&a.intervalId||void 0}static fromValues(a){return new Qd(a)}},to=eo,Ci=class{static basePath(i){return"/channels/"+encodeURIComponent(i.name)}static history(i,a){const l=i.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.client.http.supportsLinkHeaders?void 0:o,f=ve.defaultGetHeaders(l.options,{format:o});return U(f,l.options.headers),new nn(l,this.basePath(i)+"/messages",f,u,async function(p,m,T){const S=T?p:Je(p,l._MsgPack,o);return Lc(S,i)}).get(a)}static async status(i){const a=i.client.options.useBinaryProtocol?"msgpack":"json",l=ve.defaultPostHeaders(i.client.options,{format:a});return(await lt.get(i.client,this.basePath(i),l,{},a,!0)).body}},jc=class{static basePath(i){return Ci.basePath(i.channel)+"/presence"}static async history(i,a){const l=i.channel.client,o=l.options.useBinaryProtocol?"msgpack":"json",u=i.channel.client.http.supportsLinkHeaders?void 0:o,f=ve.defaultGetHeaders(l.options,{format:o});return U(f,l.options.headers),new nn(l,this.basePath(i)+"/history",f,u,async(p,m,T)=>{const S=T?p:Je(p,l._MsgPack,o);return Yr(S,i.channel)}).get(a)}},no=class{constructor(i){this.channelMixin=Ci,this.presenceMixin=jc,this.Resource=lt,this.PaginatedResource=nn,this.DeviceDetails=Ri,this.PushChannelSubscription=Es,this.client=i,this.channels=new qc(this.client),this.push=new Mc(this.client)}async stats(i){const a=ve.defaultGetHeaders(this.client.options),l=this.client.options.useBinaryProtocol?"msgpack":"json",o=this.client.http.supportsLinkHeaders?void 0:l;return U(a,this.client.options.headers),new nn(this.client,"/stats",a,o,function(u,f,p){const m=p?u:JSON.parse(u);for(let T=0;T<m.length;T++)m[T]=to.fromValues(m[T]);return m}).get(i)}async time(i){const a=ve.defaultGetHeaders(this.client.options);this.client.options.headers&&U(a,this.client.options.headers);const l=m=>this.client.baseUri(m)+"/time";let{error:o,body:u,unpacked:f}=await this.client.http.do(bt.Get,l,a,null,i);if(o)throw o;f||(u=JSON.parse(u));const p=u[0];if(!p)throw new _("Internal error (unexpected result type from GET /time)",5e4,500);return this.client.serverTimeOffset=p-Date.now(),p}async request(i,a,l,o,u,f){var p;const[m,T,S]=this.client.options.useBinaryProtocol?(this.client._MsgPack||wt("MsgPack"),[this.client._MsgPack.encode,this.client._MsgPack.decode,"msgpack"]):[JSON.stringify,JSON.parse,"json"],B=this.client.http.supportsLinkHeaders?void 0:S;o=o||{};const z=i.toLowerCase(),Q=z=="get"?ve.defaultGetHeaders(this.client.options,{format:S,protocolVersion:l}):ve.defaultPostHeaders(this.client.options,{format:S,protocolVersion:l});typeof u!="string"&&(u=(p=m(u))!=null?p:null),U(Q,this.client.options.headers),f&&U(Q,f);const j=new nn(this.client,a,Q,B,async function(F,$,ge){return Te(ge?F:T(F))},!0);if(!x.Http.methods.includes(z))throw new _("Unsupported method "+z,40500,405);return x.Http.methodsWithBody.includes(z)?j[z](o,u):j[z](o)}async batchPublish(i){let a,l;Array.isArray(i)?(a=i,l=!1):(a=[i],l=!0);const o=this.client.options.useBinaryProtocol?"msgpack":"json",u=ve.defaultPostHeaders(this.client.options,{format:o});this.client.options.headers&&U(u,this.client.options.headers);const f=dt(a,this.client._MsgPack,o),p=await lt.post(this.client,"/messages",f,u,{},null,!0),m=p.unpacked?p.body:Je(p.body,this.client._MsgPack,o);return l?m[0]:m}async batchPresence(i){const a=this.client.options.useBinaryProtocol?"msgpack":"json",l=ve.defaultPostHeaders(this.client.options,{format:a});this.client.options.headers&&U(l,this.client.options.headers);const o=i.join(","),u=await lt.get(this.client,"/presence",l,{channels:o},null,!0);return u.unpacked?u.body:Je(u.body,this.client._MsgPack,a)}async revokeTokens(i,a){if(yl(this.client.options))throw new _("Cannot revoke tokens when using token auth",40162,401);const l=this.client.options.keyName;let o=a??{};const u=pe({targets:i.map(S=>`${S.type}:${S.value}`)},o),f=this.client.options.useBinaryProtocol?"msgpack":"json",p=ve.defaultPostHeaders(this.client.options,{format:f});this.client.options.headers&&U(p,this.client.options.headers);const m=dt(u,this.client._MsgPack,f),T=await lt.post(this.client,`/keys/${l}/revokeTokens`,m,p,{},null,!0);return T.unpacked?T.body:Je(T.body,this.client._MsgPack,f)}},qc=class{constructor(i){this.client=i,this.all=Object.create(null)}get(i,a){i=String(i);let l=this.all[i];return l?a&&l.setOptions(a):this.all[i]=l=new $r(this.client,i,a),l}release(i){delete this.all[String(i)]}},io=class extends As{constructor(i){super(ve.objectifyOptions(i,!1,"BaseRest",h.defaultLogger,{Rest:no}))}},_l={Rest:no},ta=class extends fn{static async fromEncoded(i,a){return Zr(h.defaultLogger,x.Crypto,i,a)}static async fromEncodedArray(i,a){return kc(h.defaultLogger,x.Crypto,i,a)}static fromValues(i){return fn.fromValues(i)}},na=class extends _n{static async fromEncoded(i,a){return Vr(h.defaultLogger,x.Crypto,i,a)}static async fromEncodedArray(i,a){return Ir(h.defaultLogger,x.Crypto,i,a)}static fromValues(i){return _n.fromValues(i)}},ao=["annotation.create","annotation.delete"];async function Qa(i,a,l){return _i.fromValues(a).decode(l||{},i)}async function so(i,a,l){return Promise.all(a.map(function(o){return Qa(i,o,l)}))}async function lo(i,a){return _i.fromValues(i).decode(a.channelOptions,a.logger)}async function El(i,a){return Promise.all(i.map(function(l){return lo(l,a)}))}var Ms=class cf extends Cn{async encode(){const a=Object.assign(new _i,this,{action:ao.indexOf(this.action||"annotation.create")});return Ga(a,{})}static fromValues(a){return Object.assign(new cf,a)}static fromValuesArray(a){return a.map(l=>cf.fromValues(l))}toString(){return ii(this,"Annotation")}},_i=class uf extends Cn{toJSON(...a){return Va.call(this,...a)}static fromValues(a){return Object.assign(new uf,a)}static fromValuesArray(a){return a.map(l=>uf.fromValues(l))}async decode(a,l){const o=Object.assign(new Ms,Ce(pe({},this),{action:ao[this.action]}));try{await ti(o,a)}catch(u){h.logAction(l,h.LOG_ERROR,"WireAnnotation.decode()",Y(u))}return o}toString(){return ii(this,"WireAnnotation")}},ia=Ms,Ml=class extends ia{static async fromEncoded(i,a){return Qa(h.defaultLogger,i,a)}static async fromEncodedArray(i,a){return so(h.defaultLogger,i,a)}static fromValues(i){return ia.fromValues(i)}};function ro(i){let a;switch(typeof i){case"string":a=i;break;case"object":a=i.serial;break}if(!a||typeof a!="string")throw new _("First argument of annotations.publish() must be either a Message (or at least an object with a string `serial` property) or a message serial (string)",40003,400);return a}function oo(i,a){const l=ro(i);if(!a||typeof a!="object")throw new _("Second argument of annotations.publish() must be an object (the intended annotation to publish)",40003,400);const o=ia.fromValues(a);return o.messageSerial=l,o.action||(o.action="annotation.create"),o}function co(i,a){return i.client.rest.channelMixin.basePath(i)+"/messages/"+encodeURIComponent(a)+"/annotations"}var Hc=class{constructor(i){this.channel=i}async publish(i,a){const l=oo(i,a),o=await l.encode(),u=this.channel.client,f=u.options,p=f.useBinaryProtocol?"msgpack":"json",m=ve.defaultPostHeaders(u.options,{format:p}),T={};U(m,u.options.headers);const S=dt([o],u._MsgPack,p);await lt.post(u,co(this.channel,l.messageSerial),S,m,T,null,!0)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async get(i,a){const l=this.channel.client,o=ro(i),u=l.options.useBinaryProtocol?"msgpack":"json",f=l.http.supportsLinkHeaders?void 0:u,p=ve.defaultGetHeaders(l.options,{format:u});return U(p,l.options.headers),new nn(l,co(this.channel,o),p,f,async(m,T,S)=>{const B=S?m:Je(m,l._MsgPack,u);return El(B,this.channel)}).get(a)}},wl=Hc,an=dt;function ai(i){const a=[];if(i)for(let l=0;l<i.length;l++)a.push(i[l].toString());return"[ "+a.join(", ")+" ]"}function uo(i,a,l,o,u,f){const p=Je(i,a,f);return ws(p,l,o,u)}function ws(i,a,l,o){let u;i.error&&(u=_.fromValues(i.error));let f;i.messages&&(f=Ti.fromValuesArray(i.messages));let p;a&&i.presence&&(p=a.WirePresenceMessage.fromValuesArray(i.presence));let m;l&&i.annotations&&(m=l.WireAnnotation.fromValuesArray(i.annotations));let T;return o&&i.state&&(T=o.ObjectMessage.fromValuesArray(i.state,He,ni)),Object.assign(new Nl,Ce(pe({},i),{presence:p,messages:f,annotations:m,state:T,error:u}))}function xl(i){return a=>{var l;return ws(a,{WirePresenceMessage:Xa},{WireAnnotation:_i},(l=i?.ObjectsPlugin)!=null?l:null)}}function Ft(i){return Object.assign(new Nl,i)}function Za(i,a,l,o){let u="[ProtocolMessage";i.action!==void 0&&(u+="; action="+zr[i.action]||i.action);const f=["id","channel","channelSerial","connectionId","count","msgSerial","timestamp"];let p;for(let m=0;m<f.length;m++)p=f[m],i[p]!==void 0&&(u+="; "+p+"="+i[p]);if(i.messages&&(u+="; messages="+ai(Ti.fromValuesArray(i.messages))),i.presence&&a&&(u+="; presence="+ai(a.WirePresenceMessage.fromValuesArray(i.presence))),i.annotations&&l&&(u+="; annotations="+ai(l.WireAnnotation.fromValuesArray(i.annotations))),i.state&&o&&(u+="; state="+ai(o.ObjectMessage.fromValuesArray(i.state,He,ni))),i.error&&(u+="; error="+_.fromValues(i.error).toString()),i.auth&&i.auth.accessToken&&(u+="; token="+i.auth.accessToken),i.flags&&(u+="; flags="+jr.filter(i.hasFlag).join(",")),i.params){let m="";Z(i.params,function(T){m.length>0&&(m+="; "),m+=T+"="+i.params[T]}),m.length>0&&(u+="; params=["+m+"]")}return u+="]",u}var Nl=class{constructor(){this.hasFlag=i=>(this.flags&Pt[i])>0}setFlag(i){return this.flags=this.flags|Pt[i]}getMode(){return(this.flags||0)&Pt.MODE_ALL}encodeModesToFlags(i){i.forEach(a=>this.setFlag(a))}decodeModesFromFlags(){const i=[];return bs.forEach(a=>{this.hasFlag(a)&&i.push(a)}),i.length>0?i:void 0}},aa=Nl,Ul=class{constructor(i,a,l,o,u){this.previous=i,this.current=a,a==="attached"&&(this.resumed=l,this.hasBacklog=o),u&&(this.reason=u)}},Ei=Ul,xs=function(){};function fo(i){if(i&&"params"in i&&!v(i.params))return new _("options.params must be an object",4e4,400);if(i&&"modes"in i){if(!Array.isArray(i.modes))return new _("options.modes must be an array",4e4,400);for(let a=0;a<i.modes.length;a++){const l=i.modes[a];if(!l||typeof l!="string"||!bs.includes(String.prototype.toUpperCase.call(l)))return new _("Invalid channel mode: "+l,4e4,400)}}}var Mi=class ff extends Et{constructor(a,l,o){var u,f,p;super(a.logger),this._annotations=null,this._mode=0,this.retryCount=0,this.history=async function(m){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.history()","channel = "+this.name);const T=this.client.rest.channelMixin;if(m&&m.untilAttach){if(this.state!=="attached")throw new _("option untilAttach requires the channel to be attached",4e4,400);if(!this.properties.attachSerial)throw new _("untilAttach was specified and channel is attached, but attachSerial is not defined",4e4,400);delete m.untilAttach,m.from_serial=this.properties.attachSerial}return T.history(this,m)},this.whenState=m=>Et.prototype.whenState.call(this,m,this.state),h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel()","started; name = "+l),this.name=l,this.channelOptions=Ln((u=a._Crypto)!=null?u:null,this.logger,o),this.client=a,this._presence=a._RealtimePresence?new a._RealtimePresence.RealtimePresence(this):null,a._Annotations&&(this._annotations=new a._Annotations.RealtimeAnnotations(this)),this.connectionManager=a.connection.connectionManager,this.state="initialized",this.subscriptions=new Et(this.logger),this.syncChannelSerial=void 0,this.properties={attachSerial:void 0,channelSerial:void 0},this.setOptions(o),this.errorReason=null,this._attachResume=!1,this._decodingContext={channelOptions:this.channelOptions,plugins:a.options.plugins||{},baseEncodedPreviousPayload:void 0},this._lastPayload={messageId:null,protocolMessageChannelSerial:null,decodeFailureRecoveryInProgress:null},this._allChannelChanges=new Et(this.logger),(f=a.options.plugins)!=null&&f.Push&&(this._push=new a.options.plugins.Push.PushChannel(this)),(p=a.options.plugins)!=null&&p.Objects&&(this._objects=new a.options.plugins.Objects.Objects(this))}get presence(){return this._presence||wt("RealtimePresence"),this._presence}get annotations(){return this._annotations||wt("Annotations"),this._annotations}get push(){return this._push||wt("Push"),this._push}get objects(){return this._objects||wt("Objects"),this._objects}invalidStateError(){return new _("Channel operation failed as channel state is "+this.state,90001,400,this.errorReason||void 0)}static processListenerArgs(a){return a=Array.prototype.slice.call(a),typeof a[0]=="function"&&a.unshift(null),a}async setOptions(a){var l;const o=this.channelOptions,u=fo(a);if(u)throw u;if(this.channelOptions=Ln((l=this.client._Crypto)!=null?l:null,this.logger,a),this._decodingContext&&(this._decodingContext.channelOptions=this.channelOptions),this._shouldReattachToSetOptions(a,o))return this.attachImpl(),new Promise((f,p)=>{this._allChannelChanges.once(["attached","update","detached","failed"],function(m){switch(this.event){case"update":case"attached":f();break;default:p(m.reason)}})})}_shouldReattachToSetOptions(a,l){if(!(this.state==="attached"||this.state==="attaching"))return!1;if(a?.params){const o=wi(a.params),u=wi(l.params);if(Object.keys(o).length!==Object.keys(u).length||!ja(u,o))return!0}return!!(a?.modes&&(!l.modes||!ol(a.modes,l.modes)))}async publish(...a){let l;if(a.length==1)if(v(a[0]))l=[fn.fromValues(a[0])];else if(Array.isArray(a[0]))l=fn.fromValuesArray(a[0]);else throw new _("The single-argument form of publish() expects a message object or an array of message objects",40013,400);else l=[fn.fromValues({name:a[0],data:a[1]})];const u=this.client.options.maxMessageSize,f=await Kr(l,this.channelOptions),p=Cl(f);if(p>u)throw new _(`Maximum size of messages that can be published at once exceeded (was ${p} bytes; limit is ${u} bytes)`,40009,400);this.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.publish()","sending message; channel state is "+this.state+", message count = "+f.length);const m=Ft({action:ue.MESSAGE,channel:this.name,messages:f});return this.sendMessage(m)}throwIfUnpublishableState(){if(!this.connectionManager.activeState())throw this.connectionManager.getError();if(this.state==="failed"||this.state==="suspended")throw this.invalidStateError()}onEvent(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.onEvent()","received message");const l=this.subscriptions;for(let o=0;o<a.length;o++){const u=a[o];l.emit(u.name,u)}}async attach(){return this.state==="attached"?null:new Promise((a,l)=>{this._attach(!1,null,(o,u)=>o?l(o):a(u))})}_attach(a,l,o){o||(o=f=>{f&&h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel._attach()","Channel attach failed: "+f.toString())});const u=this.connectionManager;if(!u.activeState()){o(u.getError());return}(this.state!=="attaching"||a)&&this.requestState("attaching",l),this.once(function(f){switch(this.event){case"attached":o?.(null,f);break;case"detached":case"suspended":case"failed":o?.(f.reason||u.getError()||new _("Unable to attach; reason unknown; state = "+this.event,9e4,500));break;case"detaching":o?.(new _("Attach request superseded by a subsequent detach request",9e4,409));break}})}attachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.attachImpl()","sending ATTACH message");const a=Ft({action:ue.ATTACH,channel:this.name,params:this.channelOptions.params,channelSerial:this.properties.channelSerial});this.channelOptions.modes&&a.encodeModesToFlags(Er(this.channelOptions.modes)),this._attachResume&&a.setFlag("ATTACH_RESUME"),this._lastPayload.decodeFailureRecoveryInProgress&&(a.channelSerial=this._lastPayload.protocolMessageChannelSerial),this.sendMessage(a).catch(xs)}async detach(){const a=this.connectionManager;if(!a.activeState())throw a.getError();switch(this.state){case"suspended":this.notifyState("detached");return;case"detached":return;case"failed":throw new _("Unable to detach; channel state = failed",90001,400);default:this.requestState("detaching");case"detaching":return new Promise((l,o)=>{this.once(function(u){switch(this.event){case"detached":l();break;case"attached":case"suspended":case"failed":o(u.reason||a.getError()||new _("Unable to detach; reason unknown; state = "+this.event,9e4,500));break;case"attaching":o(new _("Detach request superseded by a subsequent attach request",9e4,409));break}})})}}detachImpl(){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.detach()","sending DETACH message");const a=Ft({action:ue.DETACH,channel:this.name});this.sendMessage(a).catch(xs)}async subscribe(...a){const[l,o]=ff.processListenerArgs(a);if(this.state==="failed")throw _.fromValues(this.invalidStateError());return l&&typeof l=="object"&&!Array.isArray(l)?this.client._FilteredSubscriptions.subscribeFilter(this,l,o):this.subscriptions.on(l,o),this.channelOptions.attachOnSubscribe!==!1?this.attach():null}unsubscribe(...a){var l;const[o,u]=ff.processListenerArgs(a);if(typeof o=="object"&&!u||(l=this.filteredSubscriptions)!=null&&l.has(u)){this.client._FilteredSubscriptions.getAndDeleteFilteredSubscriptions(this,o,u).forEach(f=>this.subscriptions.off(f));return}this.subscriptions.off(o,u)}sync(){switch(this.state){case"initialized":case"detaching":case"detached":throw new de("Unable to sync to channel; not attached",4e4)}const a=this.connectionManager;if(!a.activeState())throw a.getError();const l=Ft({action:ue.SYNC,channel:this.name});this.syncChannelSerial&&(l.channelSerial=this.syncChannelSerial),a.send(l)}async sendMessage(a){return new Promise((l,o)=>{this.connectionManager.send(a,this.client.options.queueMessages,u=>{u?o(u):l()})})}async sendPresence(a){const l=Ft({action:ue.PRESENCE,channel:this.name,presence:a});return this.sendMessage(l)}sendState(a){const l=Ft({action:ue.OBJECT,channel:this.name,state:a});return this.sendMessage(l)}async processMessage(a){(a.action===ue.ATTACHED||a.action===ue.MESSAGE||a.action===ue.PRESENCE||a.action===ue.OBJECT||a.action===ue.ANNOTATION)&&this.setChannelSerial(a.channelSerial);let l,o=!1;switch(a.action){case ue.ATTACHED:{this.properties.attachSerial=a.channelSerial,this._mode=a.getMode(),this.params=a.params||{};const u=a.decodeModesFromFlags();this.modes=u&&rl(u)||void 0;const f=a.hasFlag("RESUMED"),p=a.hasFlag("HAS_PRESENCE"),m=a.hasFlag("HAS_BACKLOG"),T=a.hasFlag("HAS_OBJECTS");if(this.state==="attached"){f||(this._presence&&this._presence.onAttached(p),this._objects&&this._objects.onAttached(T));const S=new Ei(this.state,this.state,f,m,a.error);this._allChannelChanges.emit("update",S),(!f||this.channelOptions.updateOnAttached)&&this.emit("update",S)}else this.state==="detaching"?this.checkPendingState():this.notifyState("attached",a.error,f,p,m,T);break}case ue.DETACHED:{const u=a.error?_.fromValues(a.error):new _("Channel detached",90001,404);this.state==="detaching"?this.notifyState("detached",u):this.state==="attaching"?this.notifyState("suspended",u):(this.state==="attached"||this.state==="suspended")&&this.requestState("attaching",u);break}case ue.SYNC:if(o=!0,l=this.syncChannelSerial=a.channelSerial,!a.presence)break;case ue.PRESENCE:{if(!a.presence)break;un(a);const u=this.channelOptions;if(this._presence){const f=await Promise.all(a.presence.map(p=>p.decode(u,this.logger)));this._presence.setPresence(f,o,l)}break}case ue.OBJECT:case ue.OBJECT_SYNC:{if(!this._objects||!a.state)return;un(a);const u=a.state,f=this.client.connection.connectionManager.getActiveTransportFormat();await Promise.all(u.map(p=>this.client._objectsPlugin.ObjectMessage.decode(p,this.client,this.logger,h,He,f))),a.action===ue.OBJECT?this._objects.handleObjectMessages(u):this._objects.handleObjectSyncMessages(u,a.channelSerial);break}case ue.MESSAGE:{if(this.state!=="attached"){h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()",'Message "'+a.id+'" skipped as this channel "'+this.name+'" state is not "attached" (state is "'+this.state+'").');return}un(a);const u=a.messages,f=u[0],p=u[u.length-1];if(f.extras&&f.extras.delta&&f.extras.delta.from!==this._lastPayload.messageId){const T='Delta message decode failure - previous message not available for message "'+a.id+'" on this channel "'+this.name+'".';h.logAction(this.logger,h.LOG_ERROR,"RealtimeChannel.processMessage()",T),this._startDecodeFailureRecovery(new _(T,40018,400));break}let m=[];for(let T=0;T<u.length;T++){const{decoded:S,err:B}=await u[T].decodeWithErr(this._decodingContext,this.logger);if(m[T]=S,B)switch(B.code){case 40018:this._startDecodeFailureRecovery(B);return;case 40019:case 40021:this.notifyState("failed",B);return}}this._lastPayload.messageId=p.id,this._lastPayload.protocolMessageChannelSerial=a.channelSerial,this.onEvent(m);break}case ue.ANNOTATION:{un(a);const u=this.channelOptions;if(this._annotations){const f=await Promise.all((a.annotations||[]).map(p=>p.decode(u,this.logger)));this._annotations._processIncoming(f)}break}case ue.ERROR:{const u=a.error;u&&u.code==80016?this.checkPendingState():this.notifyState("failed",_.fromValues(u));break}default:h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Protocol error: unrecognised message action ("+a.action+")")}}_startDecodeFailureRecovery(a){this._lastPayload.decodeFailureRecoveryInProgress||(h.logAction(this.logger,h.LOG_MAJOR,"RealtimeChannel.processMessage()","Starting decode failure recovery process."),this._lastPayload.decodeFailureRecoveryInProgress=!0,this._attach(!0,a,()=>{this._lastPayload.decodeFailureRecoveryInProgress=!1}))}onAttached(){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.onAttached","activating channel; name = "+this.name)}notifyState(a,l,o,u,f,p){if(h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.notifyState","name = "+this.name+", current state = "+this.state+", notifying state "+a),this.clearStateTimer(),["detached","suspended","failed"].includes(a)&&(this.properties.channelSerial=null),a===this.state)return;this._presence&&this._presence.actOnChannelState(a,u,l),this._objects&&this._objects.actOnChannelState(a,p),a==="suspended"&&this.connectionManager.state.sendEvents?this.startRetryTimer():this.cancelRetryTimer(),l&&(this.errorReason=l);const m=new Ei(this.state,a,o,f,l),T='Channel state for channel "'+this.name+'"',S=a+(l?"; reason: "+l:"");a==="failed"?h.logAction(this.logger,h.LOG_ERROR,T,S):h.logAction(this.logger,h.LOG_MAJOR,T,S),a!=="attaching"&&a!=="suspended"&&(this.retryCount=0),a==="attached"&&this.onAttached(),a==="attached"?this._attachResume=!0:(a==="detaching"||a==="failed")&&(this._attachResume=!1),this.state=a,this._allChannelChanges.emit(a,m),this.emit(a,m)}requestState(a,l){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.requestState","name = "+this.name+", state = "+a),this.notifyState(a,l),this.checkPendingState()}checkPendingState(){if(!this.connectionManager.state.sendEvents){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","sendEvents is false; state is "+this.connectionManager.state.state);return}switch(h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.checkPendingState","name = "+this.name+", state = "+this.state),this.state){case"attaching":this.startStateTimerIfNotRunning(),this.attachImpl();break;case"detaching":this.startStateTimerIfNotRunning(),this.detachImpl();break;case"attached":this.sync();break}}timeoutPendingState(){switch(this.state){case"attaching":{const a=new _("Channel attach timed out",90007,408);this.notifyState("suspended",a);break}case"detaching":{const a=new _("Channel detach timed out",90007,408);this.notifyState("attached",a);break}default:this.checkPendingState();break}}startStateTimerIfNotRunning(){this.stateTimer||(this.stateTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.startStateTimerIfNotRunning","timer expired"),this.stateTimer=null,this.timeoutPendingState()},this.client.options.timeouts.realtimeRequestTimeout))}clearStateTimer(){const a=this.stateTimer;a&&(clearTimeout(a),this.stateTimer=null)}startRetryTimer(){if(this.retryTimer)return;this.retryCount++;const a=Xi(this.client.options.timeouts.channelRetryTimeout,this.retryCount);this.retryTimer=setTimeout(()=>{this.state==="suspended"&&this.connectionManager.state.sendEvents&&(this.retryTimer=null,h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel retry timer expired","attempting a new attach"),this.requestState("attaching"))},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}getReleaseErr(){const a=this.state;return a==="initialized"||a==="detached"||a==="failed"?null:new _("Can only release a channel in a state where there is no possibility of further updates from the server being received (initialized, detached, or failed); was "+a,90001,400)}setChannelSerial(a){h.logAction(this.logger,h.LOG_MICRO,"RealtimeChannel.setChannelSerial()","Updating channel serial; serial = "+a+"; previous = "+this.properties.channelSerial),a&&(this.properties.channelSerial=a)}async status(){return this.client.rest.channelMixin.status(this)}};function wi(i){const a=i||{},{agent:l}=a;return Fe(a,["agent"])}var xi=Mi,ho=class{constructor(i){this.channel=i,this.logger=i.logger,this.subscriptions=new Et(this.logger)}async publish(i,a){const l=this.channel.name,o=oo(i,a),u=await o.encode();this.channel.throwIfUnpublishableState(),h.logAction(this.logger,h.LOG_MICRO,"RealtimeAnnotations.publish()","channelName = "+l+", sending annotation with messageSerial = "+o.messageSerial+", type = "+o.type);const f=Ft({action:ue.ANNOTATION,channel:l,annotations:[u]});return this.channel.sendMessage(f)}async delete(i,a){return a.action="annotation.delete",this.publish(i,a)}async subscribe(...i){const a=xi.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw _.fromValues(u.invalidStateError());if(this.subscriptions.on(l,o),this.channel.channelOptions.attachOnSubscribe!==!1&&await u.attach(),(this.channel.state==="attached"&&this.channel._mode&Pt.ANNOTATION_SUBSCRIBE)===0)throw new _("You are trying to add an annotation listener, but you haven't requested the annotation_subscribe channel mode in ChannelOptions, so this won't do anything (we only deliver annotations to clients who have explicitly requested them)",93001,400)}unsubscribe(...i){const a=xi.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}_processIncoming(i){for(const a of i)this.subscriptions.emit(a.type||"",a)}async get(i,a){return wl.prototype.get.call(this,i,a)}},si=ho,li=class yc extends io{constructor(a){var l,o;if(!yc._MsgPack)throw new Error("Expected DefaultRest._MsgPack to have been set");super(ve.objectifyOptions(a,!0,"Rest",h.defaultLogger,Ce(pe({},_l),{Crypto:(l=yc.Crypto)!=null?l:void 0,MsgPack:(o=yc._MsgPack)!=null?o:void 0,Annotations:{Annotation:ia,WireAnnotation:_i,RealtimeAnnotations:si,RestAnnotations:wl}})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};li._Crypto=null,li.Message=ta,li.PresenceMessage=na,li.Annotation=Ml,li._MsgPack=null,li._Http=vs;var Ns=li,go=class extends Et{constructor(i){super(i),this.messages=[]}count(){return this.messages.length}push(i){this.messages.push(i)}shift(){return this.messages.shift()}last(){return this.messages[this.messages.length-1]}copyAll(){return this.messages.slice()}append(i){this.messages.push.apply(this.messages,i)}prepend(i){this.messages.unshift.apply(this.messages,i)}completeMessages(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.completeMessages()","serial = "+i+"; count = "+a),l=l||null;const o=this.messages;if(o.length===0)throw new Error("MessageQueue.completeMessages(): completeMessages called on any empty MessageQueue");const u=o[0];if(u){const f=u.message.msgSerial,p=i+a;if(p>f){const m=o.splice(0,p-f);for(const T of m)T.callback(l)}o.length==0&&this.emit("idle")}}completeAllMessages(i){this.completeMessages(0,Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,i)}resetSendAttempted(){for(let i of this.messages)i.sendAttempted=!1}clear(){h.logAction(this.logger,h.LOG_MICRO,"MessageQueue.clear()","clearing "+this.messages.length+" messages"),this.messages=[],this.emit("idle")}},po=go,mo=class{constructor(i,a){this.message=i,this.callback=a,this.merged=!1;const l=i.action;this.sendAttempted=!1,this.ackRequired=typeof l=="number"&&[ue.MESSAGE,ue.PRESENCE,ue.ANNOTATION,ue.OBJECT].includes(l)}},Gc=class extends Et{constructor(i){super(i.logger),this.transport=i,this.messageQueue=new po(this.logger),i.on("ack",(a,l)=>{this.onAck(a,l)}),i.on("nack",(a,l,o)=>{this.onNack(a,l,o)})}onAck(i,a){h.logAction(this.logger,h.LOG_MICRO,"Protocol.onAck()","serial = "+i+"; count = "+a),this.messageQueue.completeMessages(i,a)}onNack(i,a,l){h.logAction(this.logger,h.LOG_ERROR,"Protocol.onNack()","serial = "+i+"; count = "+a+"; err = "+Y(l)),l||(l=new _("Unable to send message; channel not responding",50001,500)),this.messageQueue.completeMessages(i,a,l)}onceIdle(i){const a=this.messageQueue;if(a.count()===0){i();return}a.once("idle",i)}send(i){i.ackRequired&&this.messageQueue.push(i),this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Protocol.send()","sending msg; "+Za(i.message,this.transport.connectionManager.realtime._RealtimePresence,this.transport.connectionManager.realtime._Annotations,this.transport.connectionManager.realtime._objectsPlugin)),i.sendAttempted=!0,this.transport.send(i.message)}getTransport(){return this.transport}getPendingMessages(){return this.messageQueue.copyAll()}clearPendingMessages(){return this.messageQueue.clear()}finish(){const i=this.transport;this.onceIdle(function(){i.disconnect()})}},yo=Gc,vo=class{constructor(i,a,l,o){this.previous=i,this.current=a,l&&(this.retryIn=l),o&&(this.reason=o)}},sa=vo,Nt={DISCONNECTED:80003,SUSPENDED:80002,FAILED:8e4,CLOSING:80017,CLOSED:80017,UNKNOWN_CONNECTION_ERR:50002,UNKNOWN_CHANNEL_ERR:50001},bo={disconnected:()=>_.fromValues({statusCode:400,code:Nt.DISCONNECTED,message:"Connection to server temporarily unavailable"}),suspended:()=>_.fromValues({statusCode:400,code:Nt.SUSPENDED,message:"Connection to server unavailable"}),failed:()=>_.fromValues({statusCode:400,code:Nt.FAILED,message:"Connection failed or disconnected by server"}),closing:()=>_.fromValues({statusCode:400,code:Nt.CLOSING,message:"Connection closing"}),closed:()=>_.fromValues({statusCode:400,code:Nt.CLOSED,message:"Connection closed"}),unknownConnectionErr:()=>_.fromValues({statusCode:500,code:Nt.UNKNOWN_CONNECTION_ERR,message:"Internal connection error"}),unknownChannelErr:()=>_.fromValues({statusCode:500,code:Nt.UNKNOWN_CONNECTION_ERR,message:"Internal channel error"})};function hn(i){return!i.statusCode||!i.code||i.statusCode>=500?!0:Object.values(Nt).includes(i.code)}var Ut=bo,la=Ft({action:ue.CLOSE}),kl=Ft({action:ue.DISCONNECT}),Us=class extends Et{constructor(i,a,l,o){super(i.logger),o&&(l.format=void 0,l.heartbeats=!0),this.connectionManager=i,this.auth=a,this.params=l,this.timeouts=l.options.timeouts,this.format=l.format,this.isConnected=!1,this.isFinished=!1,this.isDisposed=!1,this.maxIdleInterval=null,this.idleTimer=null,this.lastActivity=null}connect(){}close(){this.isConnected&&this.requestClose(),this.finish("closed",Ut.closed())}disconnect(i){this.isConnected&&this.requestDisconnect(),this.finish("disconnected",i||Ut.disconnected())}fail(i){this.isConnected&&this.requestDisconnect(),this.finish("failed",i||Ut.failed())}finish(i,a){var l;this.isFinished||(this.isFinished=!0,this.isConnected=!1,this.maxIdleInterval=null,clearTimeout((l=this.idleTimer)!=null?l:void 0),this.idleTimer=null,this.emit(i,a),this.dispose())}onProtocolMessage(i){switch(this.logger.shouldLog(h.LOG_MICRO)&&h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()","received on "+this.shortName+": "+Za(i,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin)+"; connectionId = "+this.connectionManager.connectionId),this.onActivity(),i.action){case ue.HEARTBEAT:h.logActionNoStrip(this.logger,h.LOG_MICRO,"Transport.onProtocolMessage()",this.shortName+" heartbeat; connectionId = "+this.connectionManager.connectionId),this.emit("heartbeat",i.id);break;case ue.CONNECTED:this.onConnect(i),this.emit("connected",i.error,i.connectionId,i.connectionDetails,i);break;case ue.CLOSED:this.onClose(i);break;case ue.DISCONNECTED:this.onDisconnect(i);break;case ue.ACK:this.emit("ack",i.msgSerial,i.count);break;case ue.NACK:this.emit("nack",i.msgSerial,i.count,i.error);break;case ue.SYNC:this.connectionManager.onChannelMessage(i,this);break;case ue.ACTIVATE:break;case ue.AUTH:_e(this.auth.authorize(),a=>{a&&h.logAction(this.logger,h.LOG_ERROR,"Transport.onProtocolMessage()","Ably requested re-authentication, but unable to obtain a new token: "+Y(a))});break;case ue.ERROR:if(h.logAction(this.logger,h.LOG_MINOR,"Transport.onProtocolMessage()","received error action; connectionId = "+this.connectionManager.connectionId+"; err = "+x.Config.inspect(i.error)+(i.channel?", channel: "+i.channel:"")),i.channel===void 0){this.onFatalError(i);break}this.connectionManager.onChannelMessage(i,this);break;default:this.connectionManager.onChannelMessage(i,this)}}onConnect(i){if(this.isConnected=!0,!i.connectionDetails)throw new Error("Transport.onConnect(): Connect message recieved without connectionDetails");const a=i.connectionDetails.maxIdleInterval;a&&(this.maxIdleInterval=a+this.timeouts.realtimeRequestTimeout,this.onActivity())}onDisconnect(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onDisconnect()","err = "+Y(a)),this.finish("disconnected",a)}onFatalError(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onFatalError()","err = "+Y(a)),this.finish("failed",a)}onClose(i){const a=i&&i.error;h.logAction(this.logger,h.LOG_MINOR,"Transport.onClose()","err = "+Y(a)),this.finish("closed",a)}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestClose()",""),this.send(la)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"Transport.requestDisconnect()",""),this.send(kl)}ping(i){const a={action:ue.HEARTBEAT};i&&(a.id=i),this.send(Ft(a))}dispose(){h.logAction(this.logger,h.LOG_MINOR,"Transport.dispose()",""),this.isDisposed=!0,this.off()}onActivity(){this.maxIdleInterval&&(this.lastActivity=this.connectionManager.lastActivity=Date.now(),this.setIdleTimer(this.maxIdleInterval+100))}setIdleTimer(i){this.idleTimer||(this.idleTimer=setTimeout(()=>{this.onIdleTimerExpire()},i))}onIdleTimerExpire(){if(!this.lastActivity||!this.maxIdleInterval)throw new Error("Transport.onIdleTimerExpire(): lastActivity/maxIdleInterval not set");this.idleTimer=null;const i=Date.now()-this.lastActivity,a=this.maxIdleInterval-i;if(a<=0){const l="No activity seen from realtime in "+i+"ms; assuming connection has dropped";h.logAction(this.logger,h.LOG_ERROR,"Transport.onIdleTimerExpire()",l),this.disconnect(new _(l,80003,408))}else this.setIdleTimer(a+100)}static tryConnect(i,a,l,o,u){const f=new i(a,l,o);let p;const m=function(S){clearTimeout(p),u({event:this.event,error:S})},T=a.options.timeouts.realtimeRequestTimeout;return p=setTimeout(()=>{f.off(["preconnect","disconnected","failed"]),f.dispose(),m.call({event:"disconnected"},new _("Timeout waiting for transport to indicate itself viable",5e4,500))},T),f.on(["failed","disconnected"],m),f.on("preconnect",function(){h.logAction(a.logger,h.LOG_MINOR,"Transport.tryConnect()","viable transport "+f),clearTimeout(p),f.off(["failed","disconnected"],m),u(null,f)}),f.connect(),f}static isAvailable(){throw new _("isAvailable not implemented for transport",5e4,500)}},jn=Us,qt;(i=>{i.WebSocket="web_socket",i.Comet="comet",i.XhrPolling="xhr_polling"})(qt||(qt={}));var ra=typeof Ba<"u"?Ba:typeof window<"u"?window:self,ks=()=>{var i;return typeof x.WebStorage<"u"&&((i=x.WebStorage)==null?void 0:i.localSupported)},ri=()=>{var i;return typeof x.WebStorage<"u"&&((i=x.WebStorage)==null?void 0:i.sessionSupported)},Ni=function(){},Dl="ably-transport-preference";function sn(i,a,l){let o;if(i.channel!==a.channel||(o=i.action)!==ue.PRESENCE&&o!==ue.MESSAGE||o!==a.action)return!1;const u=o===ue.PRESENCE?"presence":"messages",f=i[u].concat(a[u]);return Cl(f)>l||!De(f,"clientId")||!f.every(function(m){return!m.id})?!1:(i[u]=f,!0)}function Ka(i){try{return JSON.parse(i)}catch{return null}}var qn=class{constructor(i,a,l,o){this.options=i,this.host=a,this.mode=l,this.connectionKey=o,this.format=i.useBinaryProtocol?"msgpack":"json"}getConnectParams(i){const a=i?ne(i):{},l=this.options;switch(this.mode){case"resume":a.resume=this.connectionKey;break;case"recover":{const o=Ka(l.recover);o&&(a.recover=o.connectionKey);break}}return l.clientId!==void 0&&(a.clientId=l.clientId),l.echoMessages===!1&&(a.echo="false"),this.format!==void 0&&(a.format=this.format),this.stream!==void 0&&(a.stream=this.stream),this.heartbeats!==void 0&&(a.heartbeats=this.heartbeats),a.v=ve.protocolVersion,a.agent=hl(this.options),l.transportParams!==void 0&&U(a,l.transportParams),a}toString(){let i="[mode="+this.mode;return this.host&&(i+=",host="+this.host),this.connectionKey&&(i+=",connectionKey="+this.connectionKey),this.format&&(i+=",format="+this.format),i+="]",i}},So=class Zd extends Et{constructor(a,l){super(a.logger),this.supportedTransports={},this.disconnectedRetryCount=0,this.pendingChannelMessagesState={isProcessing:!1,queue:[]},this.realtime=a,this.initTransports(),this.options=l;const o=l.timeouts,u=o.webSocketConnectTimeout+o.realtimeRequestTimeout;if(this.states={initialized:{state:"initialized",terminal:!1,queueEvents:!0,sendEvents:!1,failState:"disconnected"},connecting:{state:"connecting",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:u,failState:"disconnected"},connected:{state:"connected",terminal:!1,queueEvents:!1,sendEvents:!0,failState:"disconnected"},disconnected:{state:"disconnected",terminal:!1,queueEvents:!0,sendEvents:!1,retryDelay:o.disconnectedRetryTimeout,failState:"disconnected"},suspended:{state:"suspended",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.suspendedRetryTimeout,failState:"suspended"},closing:{state:"closing",terminal:!1,queueEvents:!1,sendEvents:!1,retryDelay:o.realtimeRequestTimeout,failState:"closed"},closed:{state:"closed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"closed"},failed:{state:"failed",terminal:!0,queueEvents:!1,sendEvents:!1,failState:"failed"}},this.state=this.states.initialized,this.errorReason=null,this.queuedMessages=new po(this.logger),this.msgSerial=0,this.connectionDetails=void 0,this.connectionId=void 0,this.connectionKey=void 0,this.connectionStateTtl=o.connectionStateTtl,this.maxIdleInterval=null,this.transports=et(l.transports||ve.defaultTransports,this.supportedTransports),this.transportPreference=null,this.transports.includes(qt.WebSocket)&&(this.webSocketTransportAvailable=!0),this.transports.includes(qt.XhrPolling)?this.baseTransport=qt.XhrPolling:this.transports.includes(qt.Comet)&&(this.baseTransport=qt.Comet),this.domains=ve.getHosts(l),this.activeProtocol=null,this.host=null,this.lastAutoReconnectAttempt=null,this.lastActivity=null,this.forceFallbackHost=!1,this.connectCounter=0,this.wsCheckResult=null,this.webSocketSlowTimer=null,this.webSocketGiveUpTimer=null,this.abandonedWebSocket=!1,h.logAction(this.logger,h.LOG_MINOR,"Realtime.ConnectionManager()","started"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","requested transports = ["+(l.transports||ve.defaultTransports)+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","available transports = ["+this.transports+"]"),h.logAction(this.logger,h.LOG_MICRO,"Realtime.ConnectionManager()","http domains = ["+this.domains+"]"),!this.transports.length){const p="no requested transports available";throw h.logAction(this.logger,h.LOG_ERROR,"realtime.ConnectionManager()",p),new Error(p)}const f=x.Config.addEventListener;f&&(ri()&&typeof l.recover=="function"&&f("beforeunload",this.persistConnection.bind(this)),l.closeOnUnload===!0&&f("beforeunload",()=>{h.logAction(this.logger,h.LOG_MAJOR,"Realtime.ConnectionManager()","beforeunload event has triggered the connection to close as closeOnUnload is true"),this.requestState({state:"closing"})}),f("online",()=>{var p;this.state==this.states.disconnected||this.state==this.states.suspended?(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser ‘online’ event","reattempting connection"),this.requestState({state:"connecting"})):this.state==this.states.connecting&&((p=this.pendingTransport)==null||p.off(),this.disconnectAllTransports(),this.startConnect())}),f("offline",()=>{this.state==this.states.connected&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager caught browser ‘offline’ event","disconnecting active transport"),this.disconnectAllTransports())}))}static supportedTransports(a){const l={supportedTransports:{}};return this.initTransports(a,l),l.supportedTransports}static initTransports(a,l){const o=pe(pe({},x.Transports.bundledImplementations),a);[qt.WebSocket,...x.Transports.order].forEach(u=>{const f=o[u];f&&f.isAvailable()&&(l.supportedTransports[u]=f)})}initTransports(){Zd.initTransports(this.realtime._additionalTransportImplementations,this)}createTransportParams(a,l){return new qn(this.options,a,l,this.connectionKey)}getTransportParams(a){(o=>{if(this.connectionKey){o("resume");return}if(typeof this.options.recover=="string"){o("recover");return}const u=this.options.recover,f=this.getSessionRecoverData(),p=this.sessionRecoveryName();if(f&&typeof u=="function"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Calling clientOptions-provided recover function with last session data (recovery scope: "+p+")"),u(f,m=>{m?(this.options.recover=f.recoveryKey,o("recover")):o("clean")});return}o("clean")})(o=>{const u=this.createTransportParams(null,o);if(o==="recover"){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport recovery mode = recover; recoveryKey = "+this.options.recover);const f=Ka(this.options.recover);f&&(this.msgSerial=f.msgSerial)}else h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.getTransportParams()","Transport params = "+u.toString());a(u)})}tryATransport(a,l,o){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","trying "+l),this.proposedTransport=jn.tryConnect(this.supportedTransports[l],this,this.realtime.auth,a,(u,f)=>{const p=this.state;if(p==this.states.closing||p==this.states.closed||p==this.states.failed){f&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","connection "+p.state+" while we were attempting the transport; closing "+f),f.close()),o(!0);return}if(u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.tryATransport()","transport "+l+" "+u.event+", err: "+u.error.toString()),Tn.isTokenErr(u.error)&&!(this.errorReason&&Tn.isTokenErr(this.errorReason))?(this.errorReason=u.error,_e(this.realtime.auth._forceNewToken(null,null),m=>{if(m){this.actOnErrorFromAuthorize(m);return}this.tryATransport(a,l,o)})):u.event==="failed"?(this.notifyState({state:"failed",error:u.error}),o(!0)):u.event==="disconnected"&&(hn(u.error)?o(!1):(this.notifyState({state:this.states.connecting.failState,error:u.error}),o(!0)));return}h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryATransport()","viable transport "+l+"; setting pending"),this.setTransportPending(f,a),o(null,f)})}setTransportPending(a,l){const o=l.mode;h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setTransportPending()","transport = "+a+"; mode = "+o),this.pendingTransport=a,this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),a.once("connected",(f,p,m)=>{this.activateTransport(f,a,p,m),o==="recover"&&this.options.recover&&(delete this.options.recover,this.unpersistConnection())});const u=this;a.on(["disconnected","closed","failed"],function(f){u.deactivateTransport(a,this.event,f)}),this.emit("transport.pending",a)}activateTransport(a,l,o,u){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","transport = "+l),a&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","error = "+a),o&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionId =  "+o),u&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.activateTransport()","connectionDetails =  "+JSON.stringify(u)),this.persistTransportPreference(l);const f=this.state,p=this.states.connected.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","current state = "+f.state),f.state==this.states.closing.state||f.state==this.states.closed.state||f.state==this.states.failed.state)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Disconnecting transport and abandoning"),l.disconnect(),!1;if(delete this.pendingTransport,!l.isConnected)return h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.activateTransport()","Declining to activate transport "+l+" since it appears to no longer be connected"),!1;const m=this.activeProtocol;this.activeProtocol=new yo(l),this.host=l.params.host;const T=u.connectionKey;if(T&&this.connectionKey!=T&&this.setConnection(o,u,!!a),this.onConnectionDetailsUpdate(u,l),x.Config.nextTick(()=>{l.on("connected",(S,B,z)=>{this.onConnectionDetailsUpdate(z,l),this.emit("update",new sa(p,p,null,S))})}),f.state===this.states.connected.state?a&&(this.errorReason=this.realtime.connection.errorReason=a,this.emit("update",new sa(p,p,null,a))):(this.notifyState({state:"connected",error:a}),this.errorReason=this.realtime.connection.errorReason=a||null),this.emit("transport.active",l),m)if(m.messageQueue.count()>0&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()","Previous active protocol (for transport "+m.transport.shortName+", new one is "+l.shortName+") finishing with "+m.messageQueue.count()+" messages still pending"),m.transport===l){const S="Assumption violated: activating a transport that was also the transport for the previous active protocol; transport = "+l.shortName+"; stack = "+new Error().stack;h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.activateTransport()",S)}else m.finish();return!0}deactivateTransport(a,l,o){const u=this.activeProtocol,f=u&&u.getTransport()===a,p=a===this.pendingTransport,m=this.noTransportsScheduledForActivation();if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","transport = "+a),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.deactivateTransport()","state = "+l+(f?"; was active":p?"; was pending":"")+(m?"":"; another transport is scheduled for activation")),o&&o.message&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","reason =  "+o.message),f&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.deactivateTransport()","Getting, clearing, and requeuing "+this.activeProtocol.messageQueue.count()+" pending messages"),this.queuePendingMessages(u.getPendingMessages()),u.clearPendingMessages(),this.activeProtocol=this.host=null),this.emit("transport.inactive",a),f&&m||f&&l==="failed"||l==="closed"||u===null&&p){if(l==="disconnected"&&o&&o.statusCode>500&&this.domains.length>1){this.unpersistTransportPreference(),this.forceFallbackHost=!0,this.notifyState({state:l,error:o,retryImmediately:!0});return}const T=l==="failed"&&Tn.isTokenErr(o)?"disconnected":l;this.notifyState({state:T,error:o});return}}noTransportsScheduledForActivation(){return!this.pendingTransport||!this.pendingTransport.isConnected}setConnection(a,l,o){const u=this.connectionId;(u&&u!==a||!u&&o)&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","Resetting msgSerial"),this.msgSerial=0,this.queuedMessages.resetSendAttempted()),this.connectionId!==a&&h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.setConnection()","New connectionId; reattaching any attached channels"),this.realtime.connection.id=this.connectionId=a,this.realtime.connection.key=this.connectionKey=l.connectionKey}clearConnection(){this.realtime.connection.id=this.connectionId=void 0,this.realtime.connection.key=this.connectionKey=void 0,this.msgSerial=0,this.unpersistConnection()}createRecoveryKey(){return this.connectionKey?JSON.stringify({connectionKey:this.connectionKey,msgSerial:this.msgSerial,channelSerials:this.realtime.channels.channelSerials()}):null}checkConnectionStateFreshness(){if(!this.lastActivity||!this.connectionId)return;const a=Date.now()-this.lastActivity;a>this.connectionStateTtl+this.maxIdleInterval&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.checkConnectionStateFreshness()","Last known activity from realtime was "+a+"ms ago; discarding connection state"),this.clearConnection(),this.states.connecting.failState="suspended")}persistConnection(){if(ri()){const a=this.createRecoveryKey();a&&this.setSessionRecoverData({recoveryKey:a,disconnectedAt:Date.now(),location:ra.location,clientId:this.realtime.auth.clientId})}}unpersistConnection(){this.clearSessionRecoverData()}getActiveTransportFormat(){var a;return(a=this.activeProtocol)==null?void 0:a.getTransport().format}getError(){if(this.errorReason){const a=de.fromValues(this.errorReason);return a.cause=this.errorReason,a}return this.getStateError()}getStateError(){var a,l;return(l=(a=Ut)[this.state.state])==null?void 0:l.call(a)}activeState(){return this.state.queueEvents||this.state.sendEvents}enactStateChange(a){const l="Connection state",o=a.current+(a.reason?"; reason: "+a.reason:"");a.current==="failed"?h.logAction(this.logger,h.LOG_ERROR,l,o):h.logAction(this.logger,h.LOG_MAJOR,l,o),h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.enactStateChange","setting new state: "+a.current+"; reason = "+(a.reason&&a.reason.message));const u=this.state=this.states[a.current];a.reason&&(this.errorReason=a.reason,this.realtime.connection.errorReason=a.reason),(u.terminal||u.state==="suspended")&&this.clearConnection(),this.emit("connectionstate",a)}startTransitionTimer(a){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","transitionState: "+a.state),this.transitionTimer&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startTransitionTimer()","clearing already-running timer"),clearTimeout(this.transitionTimer)),this.transitionTimer=setTimeout(()=>{this.transitionTimer&&(this.transitionTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager "+a.state+" timer expired","requesting new state: "+a.failState),this.notifyState({state:a.failState}))},a.retryDelay)}cancelTransitionTimer(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.cancelTransitionTimer()",""),this.transitionTimer&&(clearTimeout(this.transitionTimer),this.transitionTimer=null)}startSuspendTimer(){this.suspendTimer||(this.suspendTimer=setTimeout(()=>{this.suspendTimer&&(this.suspendTimer=null,h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager suspend timer expired","requesting new state: suspended"),this.states.connecting.failState="suspended",this.notifyState({state:"suspended"}))},this.connectionStateTtl))}checkSuspendTimer(a){a!=="disconnected"&&a!=="suspended"&&a!=="connecting"&&this.cancelSuspendTimer()}cancelSuspendTimer(){this.states.connecting.failState="disconnected",this.suspendTimer&&(clearTimeout(this.suspendTimer),this.suspendTimer=null)}startRetryTimer(a){this.retryTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager retry timer expired","retrying"),this.retryTimer=null,this.requestState({state:"connecting"})},a)}cancelRetryTimer(){this.retryTimer&&(clearTimeout(this.retryTimer),this.retryTimer=null)}startWebSocketSlowTimer(){this.webSocketSlowTimer=setTimeout(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","checking connectivity"),this.checkWsConnectivity().then(()=>{h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","ws connectivity check succeeded"),this.wsCheckResult=!0}).catch(()=>{h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","ws connectivity check failed"),this.wsCheckResult=!1}),this.realtime.http.checkConnectivity&&_e(this.realtime.http.checkConnectivity(),(a,l)=>{a||!l?(h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket slow timer","http connectivity check failed"),this.cancelWebSocketGiveUpTimer(),this.notifyState({state:"disconnected",error:new _("Unable to connect (network unreachable)",80003,404)})):h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket slow timer","http connectivity check succeeded")})},this.options.timeouts.webSocketSlowTimeout)}cancelWebSocketSlowTimer(){this.webSocketSlowTimer&&(clearTimeout(this.webSocketSlowTimer),this.webSocketSlowTimer=null)}startWebSocketGiveUpTimer(a){this.webSocketGiveUpTimer=setTimeout(()=>{var l,o;this.wsCheckResult||(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager WebSocket give up timer","websocket connection took more than 10s; "+(this.baseTransport?"trying base transport":"")),this.baseTransport?(this.abandonedWebSocket=!0,(l=this.proposedTransport)==null||l.dispose(),(o=this.pendingTransport)==null||o.dispose(),this.connectBase(a,++this.connectCounter)):h.logAction(this.logger,h.LOG_MAJOR,"ConnectionManager WebSocket give up timer","websocket connectivity appears to be unavailable but no other transports to try"))},this.options.timeouts.webSocketConnectTimeout)}cancelWebSocketGiveUpTimer(){this.webSocketGiveUpTimer&&(clearTimeout(this.webSocketGiveUpTimer),this.webSocketGiveUpTimer=null)}notifyState(a){var l,o;const u=a.state,f=u==="disconnected"&&(this.state===this.states.connected||a.retryImmediately||this.state===this.states.connecting&&a.error&&Tn.isTokenErr(a.error)&&!(this.errorReason&&Tn.isTokenErr(this.errorReason)));if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.notifyState()","new state: "+u+(f?"; will retry connection immediately":"")),u==this.state.state||(this.cancelTransitionTimer(),this.cancelRetryTimer(),this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.checkSuspendTimer(a.state),(u==="suspended"||u==="connected")&&(this.disconnectedRetryCount=0),this.state.terminal))return;const p=this.states[a.state];let m=p.retryDelay;p.state==="disconnected"&&(this.disconnectedRetryCount++,m=Xi(p.retryDelay,this.disconnectedRetryCount));const T=new sa(this.state.state,p.state,m,a.error||((o=(l=Ut)[p.state])==null?void 0:o.call(l)));if(f){const S=()=>{this.state===this.states.disconnected&&(this.lastAutoReconnectAttempt=Date.now(),this.requestState({state:"connecting"}))},B=this.lastAutoReconnectAttempt&&Date.now()-this.lastAutoReconnectAttempt+1;B&&B<1e3?(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.notifyState()","Last reconnect attempt was only "+B+"ms ago, waiting another "+(1e3-B)+"ms before trying again"),setTimeout(S,1e3-B)):x.Config.nextTick(S)}else(u==="disconnected"||u==="suspended")&&this.startRetryTimer(m);(u==="disconnected"&&!f||u==="suspended"||p.terminal)&&x.Config.nextTick(()=>{this.disconnectAllTransports()}),u=="connected"&&!this.activeProtocol&&h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.notifyState()","Broken invariant: attempted to go into connected state, but there is no active protocol"),this.enactStateChange(T),this.state.sendEvents?this.sendQueuedMessages():this.state.queueEvents||(this.realtime.channels.propogateConnectionInterruption(u,T.reason),this.failQueuedMessages(T.reason))}requestState(a){var l,o;const u=a.state;if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.requestState()","requested state: "+u+"; current state: "+this.state.state),u==this.state.state||(this.cancelWebSocketSlowTimer(),this.cancelWebSocketGiveUpTimer(),this.cancelTransitionTimer(),this.cancelRetryTimer(),this.checkSuspendTimer(u),u=="connecting"&&this.state.state=="connected")||u=="closing"&&this.state.state=="closed")return;const f=this.states[u],p=new sa(this.state.state,f.state,null,a.error||((o=(l=Ut)[f.state])==null?void 0:o.call(l)));this.enactStateChange(p),u=="connecting"&&x.Config.nextTick(()=>{this.startConnect()}),u=="closing"&&this.closeImpl()}startConnect(){if(this.state!==this.states.connecting){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","Must be in connecting state to connect, but was "+this.state.state);return}const a=this.realtime.auth,l=++this.connectCounter,o=()=>{this.checkConnectionStateFreshness(),this.getTransportParams(u=>{if(u.mode==="recover"&&u.options.recover){const f=Ka(u.options.recover);f&&this.realtime.channels.recoverChannels(f.channelSerials)}l===this.connectCounter&&this.connectImpl(u,l)})};if(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.startConnect()","starting connection"),this.startSuspendTimer(),this.startTransitionTimer(this.states.connecting),a.method==="basic")o();else{const u=f=>{l===this.connectCounter&&(f?this.actOnErrorFromAuthorize(f):o())};this.errorReason&&Tn.isTokenErr(this.errorReason)?_e(a._forceNewToken(null,null),u):_e(a._ensureValidAuthCredentials(!1),u)}}connectImpl(a,l){const o=this.state.state;if(o!==this.states.connecting.state){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl()","Must be in connecting state to connect, but was "+o);return}const u=this.getTransportPreference();u&&u===this.baseTransport&&this.webSocketTransportAvailable&&this.checkWsConnectivity().then(()=>{this.unpersistTransportPreference(),this.state===this.states.connecting&&(h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.connectImpl():","web socket connectivity available, cancelling connection attempt with "+this.baseTransport),this.disconnectAllTransports(),this.connectWs(a,++this.connectCounter))}).catch(Ni),u&&u===this.baseTransport||this.baseTransport&&!this.webSocketTransportAvailable?this.connectBase(a,l):this.connectWs(a,l)}connectWs(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectWs()"),this.wsCheckResult=null,this.abandonedWebSocket=!1,this.startWebSocketSlowTimer(),this.startWebSocketGiveUpTimer(a),this.tryTransportWithFallbacks("web_socket",a,!0,l,()=>this.wsCheckResult!==!1&&!this.abandonedWebSocket)}connectBase(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.connectBase()"),this.baseTransport?this.tryTransportWithFallbacks(this.baseTransport,a,!1,l,()=>!0):this.notifyState({state:"disconnected",error:new _("No transports left to try",8e4,404)})}tryTransportWithFallbacks(a,l,o,u,f){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.tryTransportWithFallbacks()",a);const p=z=>{this.notifyState({state:this.states.connecting.failState,error:z})},m=this.domains.slice(),T=(z,Q)=>{if(u===this.connectCounter){if(!f()){Q&&Q.dispose();return}!Q&&!z&&B()}},S=m.shift();if(!S){p(new _("Unable to connect (no available host)",80003,404));return}l.host=S;const B=()=>{if(!m.length){p(new _("Unable to connect (and no more fallback hosts to try)",80003,404));return}if(!this.realtime.http.checkConnectivity){p(new de("Internal error: Http.checkConnectivity not set",null,500));return}_e(this.realtime.http.checkConnectivity(),(z,Q)=>{if(u===this.connectCounter&&f()){if(z){p(z);return}if(!Q){p(new _("Unable to connect (network unreachable)",80003,404));return}l.host=Qe(m),this.tryATransport(l,a,T)}})};if(this.forceFallbackHost&&m.length){this.forceFallbackHost=!1,B();return}this.tryATransport(l,a,T)}closeImpl(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.closeImpl()","closing connection"),this.cancelSuspendTimer(),this.startTransitionTimer(this.states.closing),this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing pending transport: "+this.pendingTransport),this.pendingTransport.close()),this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.closeImpl()","Closing active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().close()),this.notifyState({state:"closed"})}onAuthUpdated(a,l){var o;switch(this.state.state){case"connected":{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Sending AUTH message on active transport");const u=(o=this.activeProtocol)==null?void 0:o.getTransport();u&&u.onAuthUpdated&&u.onAuthUpdated(a);const f=Ft({action:ue.AUTH,auth:{accessToken:a.token}});this.send(f);const p=()=>{this.off(m),l(null,a)},m=T=>{T.current==="failed"&&(this.off(p),this.off(m),l(T.reason||this.getStateError()))};this.once("connectiondetails",p),this.on("connectionstate",m);break}case"connecting":h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Aborting current connection attempts in order to start again with the new auth details"),this.disconnectAllTransports();default:{h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.onAuthUpdated()","Connection state is "+this.state.state+"; waiting until either connected or failed");const u=f=>{switch(f.current){case"connected":this.off(u),l(null,a);break;case"failed":case"closed":case"suspended":this.off(u),l(f.reason||this.getStateError());break}};this.on("connectionstate",u),this.state.state==="connecting"?this.startConnect():this.requestState({state:"connecting"})}}}disconnectAllTransports(){h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.disconnectAllTransports()","Disconnecting all transports"),this.connectCounter++,this.pendingTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting pending transport: "+this.pendingTransport),this.pendingTransport.disconnect()),delete this.pendingTransport,this.proposedTransport&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting proposed transport: "+this.pendingTransport),this.proposedTransport.disconnect()),delete this.pendingTransport,this.activeProtocol&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.disconnectAllTransports()","Disconnecting active transport: "+this.activeProtocol.getTransport()),this.activeProtocol.getTransport().disconnect())}send(a,l,o){o=o||Ni;const u=this.state;if(u.sendEvents){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","sending event"),this.sendImpl(new mo(a,o));return}if(!(l&&u.queueEvents)){const p="rejecting event, queueEvent was "+l+", state was "+u.state;h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()",p),o(this.errorReason||new _(p,9e4,400));return}this.logger.shouldLog(h.LOG_MICRO)&&h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.send()","queueing msg; "+Za(a,this.realtime._RealtimePresence,this.realtime._Annotations,this.realtime._objectsPlugin)),this.queue(a,o)}sendImpl(a){const l=a.message;a.ackRequired&&!a.sendAttempted&&(l.msgSerial=this.msgSerial++);try{this.activeProtocol.send(a)}catch(o){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.sendImpl()","Unexpected exception in transport.send(): "+o.stack)}}queue(a,l){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queue()","queueing event");const o=this.queuedMessages.last(),u=this.options.maxMessageSize;o&&!o.sendAttempted&&sn(o.message,a,u)?(o.merged||(o.callback=$n.create(this.logger,[o.callback]),o.merged=!0),o.callback.push(l)):this.queuedMessages.push(new mo(a,l))}sendQueuedMessages(){h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.sendQueuedMessages()","sending "+this.queuedMessages.count()+" queued messages");let a;for(;a=this.queuedMessages.shift();)this.sendImpl(a)}queuePendingMessages(a){a&&a.length&&(h.logAction(this.logger,h.LOG_MICRO,"ConnectionManager.queuePendingMessages()","queueing "+a.length+" pending messages"),this.queuedMessages.prepend(a))}failQueuedMessages(a){const l=this.queuedMessages.count();l>0&&(h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.failQueuedMessages()","failing "+l+" queued messages, err = "+Y(a)),this.queuedMessages.completeAllMessages(a))}onChannelMessage(a,l){this.pendingChannelMessagesState.queue.push({message:a,transport:l}),this.pendingChannelMessagesState.isProcessing||this.processNextPendingChannelMessage()}processNextPendingChannelMessage(){if(this.pendingChannelMessagesState.queue.length>0){this.pendingChannelMessagesState.isProcessing=!0;const a=this.pendingChannelMessagesState.queue.shift();this.processChannelMessage(a.message).catch(l=>{h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.processNextPendingChannelMessage() received error ",l)}).finally(()=>{this.pendingChannelMessagesState.isProcessing=!1,this.processNextPendingChannelMessage()})}}async processChannelMessage(a){await this.realtime.channels.processChannelMessage(a)}async ping(){var a;if(this.state.state!=="connected")throw new _("Unable to ping service; not connected",4e4,400);const l=(a=this.activeProtocol)==null?void 0:a.getTransport();if(!l)throw this.getStateError();h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.ping()","transport = "+l);const o=Date.now(),u=st();return Zi(new Promise(f=>{const p=m=>{m===u&&(l.off("heartbeat",p),f(Date.now()-o))};l.on("heartbeat",p),l.ping(u)}),this.options.timeouts.realtimeRequestTimeout,"Timeout waiting for heartbeat response")}abort(a){this.activeProtocol.getTransport().fail(a)}getTransportPreference(){var a,l;return this.transportPreference||ks()&&((l=(a=x.WebStorage)==null?void 0:a.get)==null?void 0:l.call(a,Dl))}persistTransportPreference(a){var l,o;this.transportPreference=a.shortName,ks()&&((o=(l=x.WebStorage)==null?void 0:l.set)==null||o.call(l,Dl,a.shortName))}unpersistTransportPreference(){var a,l;this.transportPreference=null,ks()&&((l=(a=x.WebStorage)==null?void 0:a.remove)==null||l.call(a,Dl))}actOnErrorFromAuthorize(a){if(a.code===40171)this.notifyState({state:"failed",error:a});else if(a.code===40102)this.notifyState({state:"failed",error:a});else if(a.statusCode===Oi.Forbidden){const l="Client configured authentication provider returned 403; failing the connection";h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.actOnErrorFromAuthorize()",l),this.notifyState({state:"failed",error:new _(l,80019,403,a)})}else{const l="Client configured authentication provider request failed";h.logAction(this.logger,h.LOG_MINOR,"ConnectionManager.actOnErrorFromAuthorize",l),this.notifyState({state:this.state.failState,error:new _(l,80019,401,a)})}}onConnectionDetailsUpdate(a,l){if(!a)return;this.connectionDetails=a,a.maxMessageSize&&(this.options.maxMessageSize=a.maxMessageSize);const o=a.clientId;if(o){const f=this.realtime.auth._uncheckedSetClientId(o);if(f){h.logAction(this.logger,h.LOG_ERROR,"ConnectionManager.onConnectionDetailsUpdate()",f.message),l.fail(f);return}}const u=a.connectionStateTtl;u&&(this.connectionStateTtl=u),this.maxIdleInterval=a.maxIdleInterval,this.emit("connectiondetails",a)}checkWsConnectivity(){const a=this.options.wsConnectivityCheckUrl||ve.wsConnectivityCheckUrl,l=new x.Config.WebSocket(a);return new Promise((o,u)=>{let f=!1;l.onopen=()=>{f||(f=!0,o(),l.close())},l.onclose=l.onerror=()=>{f||(f=!0,u())}})}sessionRecoveryName(){return this.options.recoveryKeyStorageName||"ably-connection-recovery"}getSessionRecoverData(){var a,l;return ri()&&((l=(a=x.WebStorage)==null?void 0:a.getSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}setSessionRecoverData(a){var l,o;return ri()&&((o=(l=x.WebStorage)==null?void 0:l.setSession)==null?void 0:o.call(l,this.sessionRecoveryName(),a))}clearSessionRecoverData(){var a,l;return ri()&&((l=(a=x.WebStorage)==null?void 0:a.removeSession)==null?void 0:l.call(a,this.sessionRecoveryName()))}},Ja=So,Ui=class extends Et{constructor(i,a){super(i.logger),this.whenState=l=>Et.prototype.whenState.call(this,l,this.state),this.ably=i,this.connectionManager=new Ja(i,a),this.state=this.connectionManager.state.state,this.key=void 0,this.id=void 0,this.errorReason=null,this.connectionManager.on("connectionstate",l=>{const o=this.state=l.current;x.Config.nextTick(()=>{this.emit(o,l)})}),this.connectionManager.on("update",l=>{x.Config.nextTick(()=>{this.emit("update",l)})})}connect(){h.logAction(this.logger,h.LOG_MINOR,"Connection.connect()",""),this.connectionManager.requestState({state:"connecting"})}async ping(){return h.logAction(this.logger,h.LOG_MINOR,"Connection.ping()",""),this.connectionManager.ping()}close(){h.logAction(this.logger,h.LOG_MINOR,"Connection.close()","connectionKey = "+this.key),this.connectionManager.requestState({state:"closing"})}get recoveryKey(){return this.logger.deprecationWarning("The `Connection.recoveryKey` attribute has been replaced by the `Connection.createRecoveryKey()` method. Replace your usage of `recoveryKey` with the return value of `createRecoveryKey()`. `recoveryKey` will be removed in a future version."),this.createRecoveryKey()}createRecoveryKey(){return this.connectionManager.createRecoveryKey()}},Ll=Ui,Ds=class Kd extends As{constructor(a){var l,o,u,f;if(super(ve.objectifyOptions(a,!1,"BaseRealtime",h.defaultLogger)),h.logAction(this.logger,h.LOG_MINOR,"Realtime()",""),typeof EdgeRuntime=="string")throw new _(`Ably.Realtime instance cannot be used in Vercel Edge runtime. If you are running Vercel Edge functions, please replace your "new Ably.Realtime()" with "new Ably.Rest()" and use Ably Rest API instead of the Realtime API. If you are server-rendering your application in the Vercel Edge runtime, please use the condition "if (typeof EdgeRuntime === 'string')" to prevent instantiating Ably.Realtime instance during SSR in the Vercel Edge runtime.`,4e4,400);this._additionalTransportImplementations=Kd.transportImplementationsFromPlugins(this.options.plugins),this._RealtimePresence=(o=(l=this.options.plugins)==null?void 0:l.RealtimePresence)!=null?o:null,this._objectsPlugin=(f=(u=this.options.plugins)==null?void 0:u.Objects)!=null?f:null,this.connection=new Ll(this,this.options),this._channels=new ca(this),this.options.autoConnect!==!1&&this.connect()}static transportImplementationsFromPlugins(a){const l={};return a?.WebSocketTransport&&(l[qt.WebSocket]=a.WebSocketTransport),a?.XHRPolling&&(l[qt.XhrPolling]=a.XHRPolling),l}get channels(){return this._channels}connect(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.connect()",""),this.connection.connect()}close(){h.logAction(this.logger,h.LOG_MINOR,"Realtime.close()",""),this.connection.close()}};Ds.EventEmitter=Et;var oa=Ds,ca=class extends Et{constructor(i){super(i.logger),this.realtime=i,this.all=Object.create(null),i.connection.connectionManager.on("transport.active",()=>{this.onTransportActive()})}channelSerials(){let i={};for(const a of tn(this.all,!0)){const l=this.all[a];l.properties.channelSerial&&(i[a]=l.properties.channelSerial)}return i}recoverChannels(i){for(const a of tn(i,!0)){const l=this.get(a);l.properties.channelSerial=i[a]}}async processChannelMessage(i){const a=i.channel;if(a===void 0){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event unspecified channel, action = "+i.action);return}const l=this.all[a];if(!l){h.logAction(this.logger,h.LOG_ERROR,"Channels.processChannelMessage()","received event for non-existent channel: "+a);return}await l.processMessage(i)}onTransportActive(){for(const i in this.all){const a=this.all[i];a.state==="attaching"||a.state==="detaching"?a.checkPendingState():a.state==="suspended"?a._attach(!1,null):a.state==="attached"&&a.requestState("attaching")}}propogateConnectionInterruption(i,a){const l={closing:"detached",closed:"detached",failed:"failed",suspended:"suspended"},o=["attaching","attached","detaching","suspended"],u=l[i];for(const f in this.all){const p=this.all[f];o.includes(p.state)&&p.notifyState(u,a)}}get(i,a){i=String(i);let l=this.all[i];if(!l)l=this.all[i]=new xi(this.realtime,i,a);else if(a){if(l._shouldReattachToSetOptions(a,l.channelOptions))throw new _("Channels.get() cannot be used to set channel options that would cause the channel to reattach. Please, use RealtimeChannel.setOptions() instead.",4e4,400);l.setOptions(a)}return l}getDerived(i,a,l){if(a.filter){const o=ds(a.filter),u=Qi(i);i=`[filter=${o}${u.qualifierParam}]${u.channelName}`}return this.get(i,l)}release(i){i=String(i);const a=this.all[i];if(!a)return;const l=a.getReleaseErr();if(l)throw l;delete this.all[i]}},Ls=oa;function Bs(i,a){if(i.isSynthesized()||a.isSynthesized())return i.timestamp>=a.timestamp;const l=i.parseId(),o=a.parseId();return l.msgSerial===o.msgSerial?l.index>o.index:l.msgSerial>o.msgSerial}var $t=class extends Et{constructor(i,a,l=Bs){super(i.logger),this.presence=i,this.map=Object.create(null),this.syncInProgress=!1,this.residualMembers=null,this.memberKey=a,this.newerThan=l}get(i){return this.map[i]}getClient(i){const a=this.map,l=[];for(const o in a){const u=a[o];u.clientId==i&&u.action!="absent"&&l.push(u)}return l}list(i){const a=this.map,l=i&&i.clientId,o=i&&i.connectionId,u=[];for(const f in a){const p=a[f];p.action!=="absent"&&(l&&l!=p.clientId||o&&o!=p.connectionId||u.push(p))}return u}put(i){(i.action==="enter"||i.action==="update")&&(i=_n.fromValues(i),i.action="present");const a=this.map,l=this.memberKey(i);this.residualMembers&&delete this.residualMembers[l];const o=a[l];return o&&!this.newerThan(i,o)?!1:(a[l]=i,!0)}values(){const i=this.map,a=[];for(const l in i){const o=i[l];o.action!="absent"&&a.push(o)}return a}remove(i){const a=this.map,l=this.memberKey(i),o=a[l];return o&&!this.newerThan(i,o)?!1:(this.syncInProgress?(i=_n.fromValues(i),i.action="absent",a[l]=i):delete a[l],!!o)}startSync(){const i=this.map,a=this.syncInProgress;h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.startSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),this.syncInProgress||(this.residualMembers=ne(i),this.setInProgress(!0))}endSync(){const i=this.map,a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.endSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),a){for(const l in i)i[l].action==="absent"&&delete i[l];this.presence._synthesizeLeaves(V(this.residualMembers));for(const l in this.residualMembers)delete i[l];this.residualMembers=null,this.setInProgress(!1)}this.emit("sync")}waitSync(i){const a=this.syncInProgress;if(h.logAction(this.logger,h.LOG_MINOR,"PresenceMap.waitSync()","channel = "+this.presence.channel.name+"; syncInProgress = "+a),!a){i();return}this.once("sync",i)}clear(){this.map={},this.setInProgress(!1),this.residualMembers=null}setInProgress(i){h.logAction(this.logger,h.LOG_MICRO,"PresenceMap.setInProgress()","inProgress = "+i),this.syncInProgress=i,this.presence.syncComplete=!i}};function dn(i){return i.channel.client.auth.clientId}function Hn(i){const a=i.channel.client,l=a.auth.clientId;return(!l||l==="*")&&a.connection.state==="connected"}function Gn(i,a,l){switch(i.state){case"attached":case"suspended":l();break;case"initialized":case"detached":case"detaching":case"attaching":_e(i.attach(),function(o){o?a(o):l()});break;default:a(_.fromValues(i.invalidStateError()))}}var Vn=class extends Et{constructor(i){super(i.logger),this.channel=i,this.syncComplete=!1,this.members=new $t(this,a=>a.clientId+":"+a.connectionId),this._myMembers=new $t(this,a=>a.clientId),this.subscriptions=new Et(this.logger),this.pendingPresence=[]}async enter(i){if(Hn(this))throw new _("clientId must be specified to enter a presence channel",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"enter")}async update(i){if(Hn(this))throw new _("clientId must be specified to update presence data",40012,400);return this._enterOrUpdateClient(void 0,void 0,i,"update")}async enterClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"enter")}async updateClient(i,a){return this._enterOrUpdateClient(void 0,i,a,"update")}async _enterOrUpdateClient(i,a,l,o){const u=this.channel;if(!u.connectionManager.activeState())throw u.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence."+o+"Client()","channel = "+u.name+", id = "+i+", client = "+(a||"(implicit) "+dn(this)));const f=_n.fromData(l);f.action=o,i&&(f.id=i),a&&(f.clientId=a);const p=await f.encode(u.channelOptions);switch(u.state){case"attached":return u.sendPresence([p]);case"initialized":case"detached":u.attach();case"attaching":return new Promise((m,T)=>{this.pendingPresence.push({presence:p,callback:S=>S?T(S):m()})});default:{const m=new de("Unable to "+o+" presence channel while in "+u.state+" state",90001);throw m.code=90001,m}}}async leave(i){if(Hn(this))throw new _("clientId must have been specified to enter or leave a presence channel",40012,400);return this.leaveClient(void 0,i)}async leaveClient(i,a){const l=this.channel;if(!l.connectionManager.activeState())throw l.connectionManager.getError();h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.leaveClient()","leaving; channel = "+this.channel.name+", client = "+i);const o=_n.fromData(a);o.action="leave",i&&(o.clientId=i);const u=await o.encode(l.channelOptions);switch(l.state){case"attached":return l.sendPresence([u]);case"attaching":return new Promise((f,p)=>{this.pendingPresence.push({presence:u,callback:m=>m?p(m):f()})});case"initialized":case"failed":throw new de("Unable to leave presence channel (incompatible state)",90001);default:throw l.invalidStateError()}}async get(i){const a=!i||("waitForSync"in i?i.waitForSync:!0);return new Promise((l,o)=>{function u(f){l(i?f.list(i):f.values())}if(this.channel.state==="suspended"){a?o(_.fromValues({statusCode:400,code:91005,message:"Presence state is out of sync due to channel being in the SUSPENDED state"})):u(this.members);return}Gn(this.channel,f=>o(f),()=>{const f=this.members;a?f.waitSync(function(){u(f)}):u(f)})})}async history(i){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.history()","channel = "+this.name);const a=this.channel.client.rest.presenceMixin;if(i&&i.untilAttach)if(this.channel.state==="attached")delete i.untilAttach,i.from_serial=this.channel.properties.attachSerial;else throw new _("option untilAttach requires the channel to be attached, was: "+this.channel.state,4e4,400);return a.history(this,i)}setPresence(i,a,l){h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.setPresence()","received presence for "+i.length+" participants; syncChannelSerial = "+l);let o,u;const f=this.members,p=this._myMembers,m=[],T=this.channel.connectionManager.connectionId;a&&(this.members.startSync(),l&&(u=l.match(/^[\w-]+:(.*)$/))&&(o=u[1]));for(let S of i)switch(S.action){case"leave":f.remove(S)&&m.push(S),S.connectionId===T&&!S.isSynthesized()&&p.remove(S);break;case"enter":case"present":case"update":f.put(S)&&m.push(S),S.connectionId===T&&p.put(S);break}a&&!o&&(f.endSync(),this.channel.syncChannelSerial=null);for(let S=0;S<m.length;S++){const B=m[S];this.subscriptions.emit(B.action,B)}}onAttached(i){h.logAction(this.logger,h.LOG_MINOR,"RealtimePresence.onAttached()","channel = "+this.channel.name+", hasPresence = "+i),i?this.members.startSync():(this._synthesizeLeaves(this.members.values()),this.members.clear()),this._ensureMyMembersPresent();const a=this.pendingPresence,l=a.length;if(l){this.pendingPresence=[];const o=[],u=$n.create(this.logger);h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence.onAttached","sending "+l+" queued presence messages");for(let f=0;f<l;f++){const p=a[f];o.push(p.presence),u.push(p.callback)}this.channel.sendPresence(o).then(()=>u()).catch(f=>u(f))}}actOnChannelState(i,a,l){switch(i){case"attached":this.onAttached(a);break;case"detached":case"failed":this._clearMyMembers(),this.members.clear();case"suspended":this.failPendingPresence(l);break}}failPendingPresence(i){if(this.pendingPresence.length){h.logAction(this.logger,h.LOG_MINOR,"RealtimeChannel.failPendingPresence","channel; name = "+this.channel.name+", err = "+Y(i));for(let a=0;a<this.pendingPresence.length;a++)try{this.pendingPresence[a].callback(i)}catch{}this.pendingPresence=[]}}_clearMyMembers(){this._myMembers.clear()}_ensureMyMembersPresent(){const i=this._myMembers,a=this.channel.connectionManager.connectionId;for(const l in i.map){const o=i.map[l];h.logAction(this.logger,h.LOG_MICRO,"RealtimePresence._ensureMyMembersPresent()",'Auto-reentering clientId "'+o.clientId+'" into the presence set');const u=o.connectionId===a?o.id:void 0;this._enterOrUpdateClient(u,o.clientId,o.data,"enter").catch(f=>{const p=new _("Presence auto re-enter failed",91004,400,f);h.logAction(this.logger,h.LOG_ERROR,"RealtimePresence._ensureMyMembersPresent()","Presence auto re-enter failed; reason = "+Y(f));const m=new Ei(this.channel.state,this.channel.state,!0,!1,p);this.channel.emit("update",m)})}}_synthesizeLeaves(i){const a=this.subscriptions;i.forEach(function(l){const o=_n.fromValues({action:"leave",connectionId:l.connectionId,clientId:l.clientId,data:l.data,encoding:l.encoding,timestamp:Date.now()});a.emit("leave",o)})}async subscribe(...i){const a=xi.processListenerArgs(i),l=a[0],o=a[1],u=this.channel;if(u.state==="failed")throw _.fromValues(u.invalidStateError());this.subscriptions.on(l,o),u.channelOptions.attachOnSubscribe!==!1&&await u.attach()}unsubscribe(...i){const a=xi.processListenerArgs(i),l=a[0],o=a[1];this.subscriptions.off(l,o)}},ki=Vn,Oo=qt.WebSocket;function Bl(i){return!!i.on}var zl=class extends jn{constructor(i,a,l){super(i,a,l),this.shortName=Oo,l.heartbeats=x.Config.useProtocolHeartbeats,this.wsHost=l.host}static isAvailable(){return!!x.Config.WebSocket}createWebSocket(i,a){return this.uri=i+Ye(a),new x.Config.WebSocket(this.uri)}toString(){return"WebSocketTransport; uri="+this.uri}connect(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","starting"),jn.prototype.connect.call(this);const i=this,a=this.params,l=a.options,u=(l.tls?"wss://":"ws://")+this.wsHost+":"+ve.getPort(l)+"/";h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.connect()","uri: "+u),_e(this.auth.getAuthParams(),function(f,p){if(i.isDisposed)return;let m="";for(const S in p)m+=" "+S+": "+p[S]+";";if(h.logAction(i.logger,h.LOG_MINOR,"WebSocketTransport.connect()","authParams:"+m+" err: "+f),f){i.disconnect(f);return}const T=a.getConnectParams(p);try{const S=i.wsConnection=i.createWebSocket(u,T);S.binaryType=x.Config.binaryType,S.onopen=function(){i.onWsOpen()},S.onclose=function(B){i.onWsClose(B)},S.onmessage=function(B){i.onWsData(B.data)},S.onerror=function(B){i.onWsError(B)},Bl(S)&&S.on("ping",function(){i.onActivity()})}catch(S){h.logAction(i.logger,h.LOG_ERROR,"WebSocketTransport.connect()","Unexpected exception creating websocket: err = "+(S.stack||S.message)),i.disconnect(S)}})}send(i){const a=this.wsConnection;if(!a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()","No socket connection");return}try{a.send(an(i,this.connectionManager.realtime._MsgPack,this.params.format))}catch(l){const o="Exception from ws connection when trying to send: "+Y(l);h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.send()",o),this.finish("disconnected",new _(o,5e4,500))}}onWsData(i){h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.onWsData()","data received; length = "+i.length+"; type = "+typeof i);try{this.onProtocolMessage(uo(i,this.connectionManager.realtime._MsgPack,this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin,this.format))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"WebSocketTransport.onWsData()","Unexpected exception handing channel message: "+a.stack)}}onWsOpen(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsOpen()","opened WebSocket"),this.emit("preconnect")}onWsClose(i){let a,l;if(typeof i=="object"?(l=i.code,a=i.wasClean||l===1e3):(l=i,a=l==1e3),delete this.wsConnection,a){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()","Cleanly closed WebSocket");const o=new _("Websocket closed",80003,400);this.finish("disconnected",o)}else{const o="Unclean disconnection of WebSocket ; code = "+l,u=new _(o,80003,400);h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onWsClose()",o),this.finish("disconnected",u)}this.emit("disposed")}onWsError(i){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.onError()","Error from WebSocket: "+i.message),x.Config.nextTick(()=>{this.disconnect(Error(i.message))})}dispose(){h.logAction(this.logger,h.LOG_MINOR,"WebSocketTransport.dispose()",""),this.isDisposed=!0;const i=this.wsConnection;i&&(i.onmessage=function(){},delete this.wsConnection,x.Config.nextTick(()=>{if(h.logAction(this.logger,h.LOG_MICRO,"WebSocketTransport.dispose()","closing websocket"),!i)throw new Error("WebSocketTransport.dispose(): wsConnection is not defined");i.close()}))}},Ht=zl,St=class{static subscribeFilter(i,a,l){const o=u=>{var f,p,m,T,S,B;const z={name:u.name,refTimeserial:(p=(f=u.extras)==null?void 0:f.ref)==null?void 0:p.timeserial,refType:(T=(m=u.extras)==null?void 0:m.ref)==null?void 0:T.type,isRef:!!((B=(S=u.extras)==null?void 0:S.ref)!=null&&B.timeserial),clientId:u.clientId};Object.entries(a).find(([Q,j])=>j!==void 0?z[Q]!==j:!1)||l(u)};this.addFilteredSubscription(i,a,l,o),i.subscriptions.on(o)}static addFilteredSubscription(i,a,l,o){var u;if(i.filteredSubscriptions||(i.filteredSubscriptions=new Map),i.filteredSubscriptions.has(l)){const f=i.filteredSubscriptions.get(l);f.set(a,((u=f?.get(a))==null?void 0:u.concat(o))||[o])}else i.filteredSubscriptions.set(l,new Map([[a,[o]]]))}static getAndDeleteFilteredSubscriptions(i,a,l){if(!i.filteredSubscriptions)return[];if(!l&&a)return Array.from(i.filteredSubscriptions.entries()).map(([f,p])=>{var m;let T=p.get(a);return p.delete(a),p.size===0&&((m=i.filteredSubscriptions)==null||m.delete(f)),T}).reduce((f,p)=>p?f.concat(...p):f,[]);if(!l||!i.filteredSubscriptions.has(l))return[];const o=i.filteredSubscriptions.get(l);if(!a){const f=Array.from(o.values()).reduce((p,m)=>p.concat(...m),[]);return i.filteredSubscriptions.delete(l),f}let u=o.get(a);return o.delete(a),u||[]}},Ee=class hf extends Ls{constructor(a){var l;const o=hf._MsgPack;if(!o)throw new Error("Expected DefaultRealtime._MsgPack to have been set");super(ve.objectifyOptions(a,!0,"Realtime",h.defaultLogger,Ce(pe({},_l),{Crypto:(l=hf.Crypto)!=null?l:void 0,MsgPack:o,RealtimePresence:{RealtimePresence:ki,PresenceMessage:_n,WirePresenceMessage:Xa},Annotations:{Annotation:ia,WireAnnotation:_i,RealtimeAnnotations:si,RestAnnotations:wl},WebSocketTransport:Ht,MessageInteractions:St})))}static get Crypto(){if(this._Crypto===null)throw new Error("Encryption not enabled; use ably.encryption.js instead");return this._Crypto}static set Crypto(a){this._Crypto=a}};Ee.Utils=He,Ee.ConnectionManager=Ja,Ee.ProtocolMessage=aa,Ee._Crypto=null,Ee.Message=ta,Ee.PresenceMessage=na,Ee.Annotation=Ml,Ee._MsgPack=null,Ee._Http=vs,Ee._PresenceMap=$t,Ee._MessageEncoding=ni;var In=Ee,gn=Uint8Array,Di=Uint32Array,Yn=Math.pow,jl=new Di(8),ql=[],Pn=new Di(64);function ua(i){return(i-(i|0))*Yn(2,32)|0}for(var fa=2,Xn=0;Xn<64;){for(Wa=!0,En=2;En<=fa/2;En++)fa%En===0&&(Wa=!1);Wa&&(Xn<8&&(jl[Xn]=ua(Yn(fa,1/2))),ql[Xn]=ua(Yn(fa,1/3)),Xn++),fa++}var Wa,En,Qn=!!new gn(new Di([1]).buffer)[0];function Mn(i){return Qn?i>>>24|(i>>>16&255)<<8|(i&65280)<<8|i<<24:i}function kt(i,a){return i>>>a|i<<32-a}function ha(i){var a=jl.slice(),l=i.length,o=l*8,u=512-(o+64)%512-1+o+65,f=new gn(u/8),p=new Di(f.buffer);f.set(i,0),f[l]=128,p[p.length-1]=Mn(o);for(var m,T=0;T<u/32;T+=16){var S=a.slice();for(m=0;m<64;m++){var B;if(m<16)B=Mn(p[T+m]);else{var z=Pn[m-15],Q=Pn[m-2];B=Pn[m-7]+Pn[m-16]+(kt(z,7)^kt(z,18)^z>>>3)+(kt(Q,17)^kt(Q,19)^Q>>>10)}Pn[m]=B|=0;for(var j=(kt(S[4],6)^kt(S[4],11)^kt(S[4],25))+(S[4]&S[5]^~S[4]&S[6])+S[7]+B+ql[m],F=(kt(S[0],2)^kt(S[0],13)^kt(S[0],22))+(S[0]&S[1]^S[2]&(S[0]^S[1])),$=7;$>0;$--)S[$]=S[$-1];S[0]=j+F|0,S[4]=S[4]+j|0}for(m=0;m<8;m++)a[m]=a[m]+S[m]|0}return new gn(new Di(a.map(function(ge){return Mn(ge)})).buffer)}function Hl(i,a){if(i.length>64&&(i=ha(i)),i.length<64){const m=new Uint8Array(64);m.set(i,0),i=m}for(var l=new Uint8Array(64),o=new Uint8Array(64),u=0;u<64;u++)l[u]=54^i[u],o[u]=92^i[u];var f=new Uint8Array(a.length+64);f.set(l,0),f.set(a,64);var p=new Uint8Array(96);return p.set(o,0),p.set(ha(f),64),ha(p)}var Fa=class{constructor(){this.base64CharSet="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",this.hexCharSet="0123456789abcdef"}uint8ViewToBase64(i){let a="";const l=this.base64CharSet,o=i.byteLength,u=o%3,f=o-u;let p,m,T,S,B;for(let z=0;z<f;z=z+3)B=i[z]<<16|i[z+1]<<8|i[z+2],p=(B&16515072)>>18,m=(B&258048)>>12,T=(B&4032)>>6,S=B&63,a+=l[p]+l[m]+l[T]+l[S];return u==1?(B=i[f],p=(B&252)>>2,m=(B&3)<<4,a+=l[p]+l[m]+"=="):u==2&&(B=i[f]<<8|i[f+1],p=(B&64512)>>10,m=(B&1008)>>4,T=(B&15)<<2,a+=l[p]+l[m]+l[T]+"="),a}base64ToArrayBuffer(i){const a=atob?.(i),l=a.length,o=new Uint8Array(l);for(let u=0;u<l;u++){const f=a.charCodeAt(u);o[u]=f}return this.toArrayBuffer(o)}isBuffer(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)}toBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to Buffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(this.toArrayBuffer(i));throw new Error("BufferUtils.toBuffer expected an ArrayBuffer or a view onto one")}toArrayBuffer(i){if(!ArrayBuffer)throw new Error("Can't convert to ArrayBuffer: browser does not support the necessary types");if(i instanceof ArrayBuffer)return i;if(ArrayBuffer.isView(i))return i.buffer.slice(i.byteOffset,i.byteOffset+i.byteLength);throw new Error("BufferUtils.toArrayBuffer expected an ArrayBuffer or a view onto one")}base64Encode(i){return this.uint8ViewToBase64(this.toBuffer(i))}base64UrlEncode(i){return this.base64Encode(i).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}base64Decode(i){if(ArrayBuffer&&x.Config.atob)return this.base64ToArrayBuffer(i);throw new Error("Expected ArrayBuffer to exist and Platform.Config.atob to be configured")}hexEncode(i){return this.toBuffer(i).reduce((l,o)=>l+o.toString(16).padStart(2,"0"),"")}hexDecode(i){if(i.length%2!==0)throw new Error("Can't create a byte array from a hex string of odd length");const a=new Uint8Array(i.length/2);for(let l=0;l<a.length;l++)a[l]=parseInt(i.slice(2*l,2*(l+1)),16);return this.toArrayBuffer(a)}utf8Encode(i){if(x.Config.TextEncoder){const a=new x.Config.TextEncoder().encode(i);return this.toArrayBuffer(a)}else throw new Error("Expected TextEncoder to be configured")}utf8Decode(i){if(!this.isBuffer(i))throw new Error("Expected input of utf8decode to be an arraybuffer or typed array");if(TextDecoder)return new TextDecoder().decode(i);throw new Error("Expected TextDecoder to be configured")}areBuffersEqual(i,a){if(!i||!a)return!1;const l=this.toArrayBuffer(i),o=this.toArrayBuffer(a);if(l.byteLength!=o.byteLength)return!1;const u=new Uint8Array(l),f=new Uint8Array(o);for(var p=0;p<u.length;p++)if(u[p]!=f[p])return!1;return!0}byteLength(i){return i instanceof ArrayBuffer||ArrayBuffer.isView(i)?i.byteLength:-1}arrayBufferViewToBuffer(i){return this.toArrayBuffer(i)}concat(i){const a=i.reduce((u,f)=>u+f.byteLength,0),l=new Uint8Array(a);let o=0;for(const u of i){const f=this.toBuffer(u);l.set(f,o),o+=f.byteLength}return l.buffer}sha256(i){const a=ha(this.toBuffer(i));return this.toArrayBuffer(a)}hmacSha256(i,a){const l=Hl(this.toBuffer(a),this.toBuffer(i));return this.toArrayBuffer(l)}},$a=new Fa,Li=function(i,a){var l="aes",o=256,u="cbc",f=16;function p(Q){if(Q.algorithm==="aes"&&Q.mode==="cbc"){if(Q.keyLength===128||Q.keyLength===256)return;throw new Error("Unsupported key length "+Q.keyLength+" for aes-cbc encryption. Encryption key must be 128 or 256 bits (16 or 32 ASCII characters)")}}function m(Q){return Q.replace("_","/").replace("-","+")}function T(Q){return Q instanceof S}class S{constructor(j,F,$,ge){this.algorithm=j,this.keyLength=F,this.mode=$,this.key=ge}}class B{static getDefaultParams(j){var F;if(!j.key)throw new Error("Crypto.getDefaultParams: a key is required");typeof j.key=="string"?F=a.toArrayBuffer(a.base64Decode(m(j.key))):j.key instanceof ArrayBuffer?F=j.key:F=a.toArrayBuffer(j.key);var $=j.algorithm||l,ge=F.byteLength*8,Ve=j.mode||u,$e=new S($,ge,Ve,F);if(j.keyLength&&j.keyLength!==$e.keyLength)throw new Error("Crypto.getDefaultParams: a keyLength of "+j.keyLength+" was specified, but the key actually has length "+$e.keyLength);return p($e),$e}static async generateRandomKey(j){try{return i.getRandomArrayBuffer((j||o)/8)}catch(F){throw new _("Failed to generate random key: "+F.message,400,5e4,F)}}static getCipher(j,F){var $,ge=T(j)?j:this.getDefaultParams(j);return{cipherParams:ge,cipher:new z(ge,($=j.iv)!=null?$:null,F)}}}B.CipherParams=S;class z{constructor(j,F,$){if(this.logger=$,!crypto.subtle)throw isSecureContext?new Error("Crypto operations are not possible since the browser’s SubtleCrypto class is unavailable (reason unknown)."):new Error("Crypto operations are is not possible since the current environment is a non-secure context and hence the browser’s SubtleCrypto class is not available.");this.algorithm=j.algorithm+"-"+String(j.keyLength)+"-"+j.mode,this.webCryptoAlgorithm=j.algorithm+"-"+j.mode,this.key=a.toArrayBuffer(j.key),this.iv=F?a.toArrayBuffer(F):null}concat(j,F){const $=new ArrayBuffer(j.byteLength+F.byteLength),ge=new DataView($),Ve=new DataView(a.toArrayBuffer(j));for(let nt=0;nt<Ve.byteLength;nt++)ge.setInt8(nt,Ve.getInt8(nt));const $e=new DataView(a.toArrayBuffer(F));for(let nt=0;nt<$e.byteLength;nt++)ge.setInt8(Ve.byteLength+nt,$e.getInt8(nt));return $}async encrypt(j){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.encrypt()","");const F=await this.getIv(),$=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["encrypt"]),ge=await crypto.subtle.encrypt({name:this.webCryptoAlgorithm,iv:F},$,j);return this.concat(F,ge)}async decrypt(j){h.logAction(this.logger,h.LOG_MICRO,"CBCCipher.decrypt()","");const F=a.toArrayBuffer(j),$=F.slice(0,f),ge=F.slice(f),Ve=await crypto.subtle.importKey("raw",this.key,this.webCryptoAlgorithm,!1,["decrypt"]);return crypto.subtle.decrypt({name:this.webCryptoAlgorithm,iv:$},Ve,ge)}async getIv(){if(this.iv){var j=this.iv;return this.iv=null,j}const F=await i.getRandomArrayBuffer(f);return a.toArrayBuffer(F)}}return B},Lt=(i=>(i[i.REQ_SEND=0]="REQ_SEND",i[i.REQ_RECV=1]="REQ_RECV",i[i.REQ_RECV_POLL=2]="REQ_RECV_POLL",i[i.REQ_RECV_STREAM=3]="REQ_RECV_STREAM",i))(Lt||{}),pn=Lt;function Gl(){return new _("No HTTP request plugin provided. Provide at least one of the FetchRequest or XHRRequest plugins.",400,4e4)}var es,Ao=(es=class{constructor(i){this.checksInProgress=null,this.checkConnectivity=void 0,this.supportsAuthHeaders=!1,this.supportsLinkHeaders=!1;var a;this.client=i??null;const l=i?.options.connectivityCheckUrl||ve.connectivityCheckUrl,o=(a=i?.options.connectivityCheckParams)!=null?a:null,u=!i?.options.connectivityCheckUrl,f=pe(pe({},Ao.bundledRequestImplementations),i?._additionalHTTPRequestImplementations),p=f.XHRRequest,m=f.FetchRequest,T=!!(p||m);if(!T)throw Gl();x.Config.xhrSupported&&p?(this.supportsAuthHeaders=!0,this.Request=async function(S,B,z,Q,j){return new Promise(F=>{var $;const ge=p.createRequest(B,z,Q,j,pn.REQ_SEND,($=i&&i.options.timeouts)!=null?$:null,this.logger,S);ge.once("complete",(Ve,$e,nt,Se,ln)=>F({error:Ve,body:$e,headers:nt,unpacked:Se,statusCode:ln})),ge.exec()})},i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var S;h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Sending; "+l);const B=await this.doUri(bt.Get,l,null,null,o);let z=!1;return u?z=!B.error&&((S=B.body)==null?void 0:S.replace(/\n/,""))=="yes":z=!B.error&&bc(B.statusCode),h.logAction(this.logger,h.LOG_MICRO,"(XHRRequest)Http.checkConnectivity()","Result: "+z),z}):x.Config.fetchSupported&&m?(this.supportsAuthHeaders=!0,this.Request=async(S,B,z,Q,j)=>m(S,i??null,B,z,Q,j),i?.options.disableConnectivityCheck?this.checkConnectivity=async function(){return!0}:this.checkConnectivity=async function(){var S;h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Sending; "+l);const B=await this.doUri(bt.Get,l,null,null,null),z=!B.error&&((S=B.body)==null?void 0:S.replace(/\n/,""))=="yes";return h.logAction(this.logger,h.LOG_MICRO,"(Fetch)Http.checkConnectivity()","Result: "+z),z}):this.Request=async()=>({error:T?new de("no supported HTTP transports available",null,400):Gl()})}get logger(){var i,a;return(a=(i=this.client)==null?void 0:i.logger)!=null?a:h.defaultLogger}async doUri(i,a,l,o,u){return this.Request?this.Request(i,a,l,u,o):{error:new de("Request invoked before assigned to",null,500)}}shouldFallback(i){const a=i.statusCode;return a===408&&!i.code||a===400&&!i.code||a>=500&&a<=504}},es.methods=[bt.Get,bt.Delete,bt.Post,bt.Put,bt.Patch],es.methodsWithoutBody=[bt.Get,bt.Delete],es.methodsWithBody=[bt.Post,bt.Put,bt.Patch],es),Ro=Ao,ut="ablyjs-storage-test",oi=typeof Ba<"u"?Ba:typeof window<"u"?window:self,ts=class{constructor(){try{oi.sessionStorage.setItem(ut,ut),oi.sessionStorage.removeItem(ut),this.sessionSupported=!0}catch{this.sessionSupported=!1}try{oi.localStorage.setItem(ut,ut),oi.localStorage.removeItem(ut),this.localSupported=!0}catch{this.localSupported=!1}}get(i){return this._get(i,!1)}getSession(i){return this._get(i,!0)}remove(i){return this._remove(i,!1)}removeSession(i){return this._remove(i,!0)}set(i,a,l){return this._set(i,a,l,!1)}setSession(i,a,l){return this._set(i,a,l,!0)}_set(i,a,l,o){const u={value:a};return l&&(u.expires=Date.now()+l),this.storageInterface(o).setItem(i,JSON.stringify(u))}_get(i,a){if(a&&!this.sessionSupported)throw new Error("Session Storage not supported");if(!a&&!this.localSupported)throw new Error("Local Storage not supported");const l=this.storageInterface(a).getItem(i);if(!l)return null;const o=JSON.parse(l);return o.expires&&o.expires<Date.now()?(this.storageInterface(a).removeItem(i),null):o.value}_remove(i,a){return this.storageInterface(a).removeItem(i)}storageInterface(i){return i?oi.sessionStorage:oi.localStorage}},da=new ts,gt=kn(),ga=typeof EdgeRuntime=="string";typeof Window>"u"&&typeof WorkerGlobalScope>"u"&&!ga&&console.log("Warning: this distribution of Ably is intended for browsers. On nodejs, please use the 'ably' package on npm");function pa(){const i=gt.location;return!gt.WebSocket||!i||!i.origin||i.origin.indexOf("http")>-1}function Vc(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}var To=gt.navigator&&gt.navigator.userAgent.toString(),Ic=gt.location&&gt.location.href,Co={agent:"browser",logTimestamps:!0,userAgent:To,currentUrl:Ic,binaryType:"arraybuffer",WebSocket:gt.WebSocket,fetchSupported:!!gt.fetch,xhrSupported:gt.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,allowComet:pa(),useProtocolHeartbeats:!0,supportsBinary:!!gt.TextDecoder,preferBinary:!1,ArrayBuffer:gt.ArrayBuffer,atob:gt.atob,nextTick:typeof gt.setImmediate<"u"?gt.setImmediate.bind(gt):function(i){setTimeout(i,0)},addEventListener:gt.addEventListener,inspect:JSON.stringify,stringByteSize:function(i){return gt.TextDecoder&&new gt.TextEncoder().encode(i).length||i.length},TextEncoder:gt.TextEncoder,TextDecoder:gt.TextDecoder,getRandomArrayBuffer:async function(i){const a=new Uint8Array(i);return gt.crypto.getRandomValues(a),a.buffer},isWebworker:Vc(),push:{platform:"browser",formFactor:"desktop",storage:da}},ci=Co;function Vl(i){const a=[80015,80017,80030];return i.code?Tn.isTokenErr(i)?!1:a.includes(i.code)?!0:i.code>=4e4&&i.code<5e4:!1}function ma(i){return Vl(i)?[Ft({action:ue.ERROR,error:i})]:[Ft({action:ue.DISCONNECTED,error:i})]}var _o=class extends jn{constructor(i,a,l){super(i,a,l,!0),this.onAuthUpdated=o=>{this.authParams={access_token:o.token}},this.stream="stream"in l?l.stream:!0,this.sendRequest=null,this.recvRequest=null,this.pendingCallback=null,this.pendingItems=null}connect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","starting"),jn.prototype.connect.call(this);const i=this.params,a=i.options,l=i.host||a.primaryDomain,o=ve.getPort(a),u=a.tls?"https://":"http://";this.baseUri=u+l+":"+o+"/comet/";const f=this.baseUri+"connect";h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","uri: "+f),_e(this.auth.getAuthParams(),(p,m)=>{if(p){this.disconnect(p);return}if(this.isDisposed)return;this.authParams=m;const T=this.params.getConnectParams(m);"stream"in T&&(this.stream=T.stream),h.logAction(this.logger,h.LOG_MINOR,"CometTransport.connect()","connectParams:"+Ye(T));let S=!1;const B=this.recvRequest=this.createRequest(f,null,T,null,this.stream?pn.REQ_RECV_STREAM:pn.REQ_RECV);B.on("data",z=>{this.recvRequest&&(S||(S=!0,this.emit("preconnect")),this.onData(z))}),B.on("complete",z=>{if(this.recvRequest||(z=z||new _("Request cancelled",80003,400)),this.recvRequest=null,!S&&!z&&(S=!0,this.emit("preconnect")),this.onActivity(),z){z.code?this.onData(ma(z)):this.disconnect(z);return}x.Config.nextTick(()=>{this.recv()})}),B.exec()})}requestClose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestClose()"),this._requestCloseOrDisconnect(!0)}requestDisconnect(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.requestDisconnect()"),this._requestCloseOrDisconnect(!1)}_requestCloseOrDisconnect(i){const a=i?this.closeUri:this.disconnectUri;if(a){const l=this.createRequest(a,null,this.authParams,null,pn.REQ_SEND);l.on("complete",o=>{o&&(h.logAction(this.logger,h.LOG_ERROR,"CometTransport.request"+(i?"Close()":"Disconnect()"),"request returned err = "+Y(o)),this.finish("disconnected",o))}),l.exec()}}dispose(){h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()",""),this.isDisposed||(this.isDisposed=!0,this.recvRequest&&(h.logAction(this.logger,h.LOG_MINOR,"CometTransport.dispose()","aborting recv request"),this.recvRequest.abort(),this.recvRequest=null),this.finish("disconnected",Ut.disconnected()),x.Config.nextTick(()=>{this.emit("disposed")}))}onConnect(i){var a;if(this.isDisposed)return;const l=(a=i.connectionDetails)==null?void 0:a.connectionKey;jn.prototype.onConnect.call(this,i);const o=this.baseUri+l;h.logAction(this.logger,h.LOG_MICRO,"CometTransport.onConnect()","baseUri = "+o),this.sendUri=o+"/send",this.recvUri=o+"/recv",this.closeUri=o+"/close",this.disconnectUri=o+"/disconnect"}send(i){if(this.sendRequest){this.pendingItems=this.pendingItems||[],this.pendingItems.push(i);return}const a=this.pendingItems||[];a.push(i),this.pendingItems=null,this.sendItems(a)}sendAnyPending(){const i=this.pendingItems;i&&(this.pendingItems=null,this.sendItems(i))}sendItems(i){const a=this.sendRequest=this.createRequest(this.sendUri,null,this.authParams,this.encodeRequest(i),pn.REQ_SEND);a.on("complete",(l,o)=>{if(l&&h.logAction(this.logger,h.LOG_ERROR,"CometTransport.sendItems()","on complete: err = "+Y(l)),this.sendRequest=null,l){l.code?this.onData(ma(l)):this.disconnect(l);return}o&&this.onData(o),this.pendingItems&&x.Config.nextTick(()=>{this.sendRequest||this.sendAnyPending()})}),a.exec()}recv(){if(this.recvRequest||!this.isConnected)return;const i=this.recvRequest=this.createRequest(this.recvUri,null,this.authParams,null,this.stream?pn.REQ_RECV_STREAM:pn.REQ_RECV_POLL);i.on("data",a=>{this.onData(a)}),i.on("complete",a=>{if(this.recvRequest=null,this.onActivity(),a){a.code?this.onData(ma(a)):this.disconnect(a);return}x.Config.nextTick(()=>{this.recv()})}),i.exec()}onData(i){try{const a=this.decodeResponse(i);if(a&&a.length)for(let l=0;l<a.length;l++)this.onProtocolMessage(ws(a[l],this.connectionManager.realtime._RealtimePresence,this.connectionManager.realtime._Annotations,this.connectionManager.realtime._objectsPlugin))}catch(a){h.logAction(this.logger,h.LOG_ERROR,"CometTransport.onData()","Unexpected exception handing channel event: "+a.stack)}}encodeRequest(i){return JSON.stringify(i)}decodeResponse(i){return typeof i=="string"?JSON.parse(i):i}},ns=_o;function Eo(i,a){return rl(tn(a)).includes("x-ably-errorcode")}function zs(i,a){if(Eo(i,a))return i.error&&_.fromValues(i.error)}var Il=function(){},Mo=0,is={};function wo(i,a){return i.getResponseHeader&&i.getResponseHeader(a)}function as(i){return i.getResponseHeader&&(i.getResponseHeader("transfer-encoding")||!i.getResponseHeader("content-length"))}function xo(i){const a=i.getAllResponseHeaders().trim().split(`\r
`),l={};for(let o=0;o<a.length;o++){const u=a[o].split(":").map(f=>f.trim());l[u[0].toLowerCase()]=u[1]}return l}var No=class Jd extends Et{constructor(a,l,o,u,f,p,m,T){super(m),o=o||{},o.rnd=st(),this.uri=a+Ye(o),this.headers=l||{},this.body=u,this.method=T?T.toUpperCase():I(u)?"GET":"POST",this.requestMode=f,this.timeouts=p,this.timedOut=!1,this.requestComplete=!1,this.id=String(++Mo),is[this.id]=this}static createRequest(a,l,o,u,f,p,m,T){const S=p||ve.TIMEOUTS;return new Jd(a,l,ne(o),u,f,S,m,T)}complete(a,l,o,u,f){this.requestComplete||(this.requestComplete=!0,!a&&l&&this.emit("data",l),this.emit("complete",a,l,o,u,f),this.dispose())}abort(){this.dispose()}exec(){let a=this.headers;const l=this.requestMode==pn.REQ_SEND?this.timeouts.httpRequestTimeout:this.timeouts.recvTimeout,o=this.timer=setTimeout(()=>{this.timedOut=!0,f.abort()},l),u=this.method,f=this.xhr=new XMLHttpRequest,p=a.accept;let m=this.body,T="text";p?p.indexOf("application/x-msgpack")===0&&(T="arraybuffer"):a.accept="application/json",m&&(a["content-type"]||(a["content-type"]="application/json")).indexOf("application/json")>-1&&typeof m!="string"&&(m=JSON.stringify(m)),f.open(u,this.uri,!0),f.responseType=T,"authorization"in a&&(f.withCredentials=!0);for(const Se in a)f.setRequestHeader(Se,a[Se]);const S=(Se,ln,Bt,ba)=>{var ji;let os=ln+" (event type: "+Se.type+")";(ji=this==null?void 0:this.xhr)!=null&&ji.statusText&&(os+=", current statusText is "+this.xhr.statusText),h.logAction(this.logger,h.LOG_ERROR,"Request.on"+Se.type+"()",os),this.complete(new de(os,Bt,ba))};f.onerror=Se=>{S(Se,"XHR error occurred",null,400)},f.onabort=Se=>{this.timedOut?S(Se,"Request aborted due to request timeout expiring",null,408):S(Se,"Request cancelled",null,400)},f.ontimeout=Se=>{S(Se,"Request timed out",null,408)};let B,z,Q,j=0,F=!1;const $=()=>{if(clearTimeout(o),Q=z<400,z==204){this.complete(null,null,null,null,z);return}B=this.requestMode==pn.REQ_RECV_STREAM&&Q&&as(f)},ge=()=>{let Se;try{const Bt=wo(f,"content-type");if(Bt?Bt.indexOf("application/json")>=0:f.responseType=="text"){const ji=f.responseType==="arraybuffer"?x.BufferUtils.utf8Decode(f.response):String(f.responseText);ji.length?Se=JSON.parse(ji):Se=ji,F=!0}else Se=f.response;Se.response!==void 0?(z=Se.statusCode,Q=z<400,a=Se.headers,Se=Se.response):a=xo(f)}catch(Bt){this.complete(new de("Malformed response body from server: "+Bt.message,null,400));return}if(Q||Array.isArray(Se)){this.complete(null,Se,a,F,z);return}let ln=zs(Se,a);ln||(ln=new de("Error response received from server: "+z+" body was: "+x.Config.inspect(Se),null,z)),this.complete(ln,Se,a,F,z)};function Ve(){const Se=f.responseText,ln=Se.length-1;let Bt,ba;for(;j<ln&&(Bt=Se.indexOf(`
`,j))>-1;)ba=Se.slice(j,Bt),j=Bt+1,$e(ba)}const $e=Se=>{try{Se=JSON.parse(Se)}catch(ln){this.complete(new de("Malformed response body from server: "+ln.message,null,400));return}this.emit("data",Se)},nt=()=>{Ve(),this.streamComplete=!0,x.Config.nextTick(()=>{this.complete()})};f.onreadystatechange=()=>{const Se=f.readyState;Se<3||f.status!==0&&(z===void 0&&(z=f.status,$()),Se==3&&B?Ve():Se==4&&(B?nt():ge()))},f.send(m)}dispose(){const a=this.xhr;if(a){a.onreadystatechange=a.onerror=a.onabort=a.ontimeout=Il,this.xhr=null;const l=this.timer;l&&(clearTimeout(l),this.timer=null),this.requestComplete||a.abort()}delete is[this.id]}},Zn=No,js=qt.XhrPolling,Yl=class extends ns{constructor(i,a,l){super(i,a,l),this.shortName=js,l.stream=!1,this.shortName=js}static isAvailable(){return!!(x.Config.xhrSupported&&x.Config.allowComet)}toString(){return"XHRPollingTransport; uri="+this.baseUri+"; isConnected="+this.isConnected}createRequest(i,a,l,o,u){return Zn.createRequest(i,a,l,o,u,this.timeouts,this.logger)}},ui=Yl,fi=["xhr_polling"],ss={order:fi,bundledImplementations:{web_socket:Ht,xhr_polling:ui}},Pl=ss,Xl={connectivityCheckUrl:"https://internet-up.ably-realtime.com/is-the-internet-up.txt",wsConnectivityCheckUrl:"wss://ws-up.ably-realtime.com",defaultTransports:[qt.XhrPolling,qt.WebSocket]},ls=Xl;function rs(i){if(i===void 0)return"undefined";let a,l;if(i instanceof ArrayBuffer?(l="ArrayBuffer",a=new DataView(i)):i instanceof DataView&&(l="DataView",a=i),!a)return JSON.stringify(i);const o=[];for(let u=0;u<i.byteLength;u++){if(u>20){o.push("...");break}let f=a.getUint8(u).toString(16);f.length===1&&(f="0"+f),o.push(f)}return"<"+l+" "+o.join(" ")+">"}function ya(i,a,l){for(let o=0,u=l.length;o<u;o++){const f=l.charCodeAt(o);if(f<128){i.setUint8(a++,f>>>0&127|0);continue}if(f<2048){i.setUint8(a++,f>>>6&31|192),i.setUint8(a++,f>>>0&63|128);continue}if(f<65536){i.setUint8(a++,f>>>12&15|224),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}if(f<1114112){i.setUint8(a++,f>>>18&7|240),i.setUint8(a++,f>>>12&63|128),i.setUint8(a++,f>>>6&63|128),i.setUint8(a++,f>>>0&63|128);continue}throw new Error("bad codepoint "+f)}}function Ql(i,a,l){let o="";for(let u=a,f=a+l;u<f;u++){const p=i.getUint8(u);if((p&128)===0){o+=String.fromCharCode(p);continue}if((p&224)===192){o+=String.fromCharCode((p&15)<<6|i.getUint8(++u)&63);continue}if((p&240)===224){o+=String.fromCharCode((p&15)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}if((p&248)===240){o+=String.fromCharCode((p&7)<<18|(i.getUint8(++u)&63)<<12|(i.getUint8(++u)&63)<<6|(i.getUint8(++u)&63)<<0);continue}throw new Error("Invalid byte "+p.toString(16))}return o}function hi(i){let a=0;for(let l=0,o=i.length;l<o;l++){const u=i.charCodeAt(l);if(u<128){a+=1;continue}if(u<2048){a+=2;continue}if(u<65536){a+=3;continue}if(u<1114112){a+=4;continue}throw new Error("bad codepoint "+u)}return a}function qs(i,a){const l=gi(i,a);if(l===0)return;const o=new ArrayBuffer(l),u=new DataView(o);return vn(i,u,0,a),o}var Hs=65536*65536,Gs=1/Hs;function Zl(i,a){return a=a||0,i.getInt32(a)*Hs+i.getUint32(a+4)}function di(i,a){return a=a||0,i.getUint32(a)*Hs+i.getUint32(a+4)}function xe(i,a,l){l<9223372036854776e3?(i.setInt32(a,Math.floor(l*Gs)),i.setInt32(a+4,l&-1)):(i.setUint32(a,2147483647),i.setUint32(a+4,2147483647))}function tt(i,a,l){l<18446744073709552e3?(i.setUint32(a,Math.floor(l*Gs)),i.setInt32(a+4,l&-1)):(i.setUint32(a,4294967295),i.setUint32(a+4,4294967295))}var Tt=class{constructor(i,a){this.map=l=>{const o={};for(let u=0;u<l;u++){const f=this.parse();o[f]=this.parse()}return o},this.bin=l=>{const o=new ArrayBuffer(l);return new Uint8Array(o).set(new Uint8Array(this.view.buffer,this.offset,l),0),this.offset+=l,o},this.buf=this.bin,this.str=l=>{const o=Ql(this.view,this.offset,l);return this.offset+=l,o},this.array=l=>{const o=new Array(l);for(let u=0;u<l;u++)o[u]=this.parse();return o},this.ext=l=>(this.offset+=l,{type:this.view.getInt8(this.offset),data:this.buf(l)}),this.parse=()=>{const l=this.view.getUint8(this.offset);let o,u;if((l&128)===0)return this.offset++,l;if((l&240)===128)return u=l&15,this.offset++,this.map(u);if((l&240)===144)return u=l&15,this.offset++,this.array(u);if((l&224)===160)return u=l&31,this.offset++,this.str(u);if((l&224)===224)return o=this.view.getInt8(this.offset),this.offset++,o;switch(l){case 192:return this.offset++,null;case 193:this.offset++;return;case 194:return this.offset++,!1;case 195:return this.offset++,!0;case 196:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.bin(u);case 197:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.bin(u);case 198:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.bin(u);case 199:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.ext(u);case 200:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.ext(u);case 201:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.ext(u);case 202:return o=this.view.getFloat32(this.offset+1),this.offset+=5,o;case 203:return o=this.view.getFloat64(this.offset+1),this.offset+=9,o;case 204:return o=this.view.getUint8(this.offset+1),this.offset+=2,o;case 205:return o=this.view.getUint16(this.offset+1),this.offset+=3,o;case 206:return o=this.view.getUint32(this.offset+1),this.offset+=5,o;case 207:return o=di(this.view,this.offset+1),this.offset+=9,o;case 208:return o=this.view.getInt8(this.offset+1),this.offset+=2,o;case 209:return o=this.view.getInt16(this.offset+1),this.offset+=3,o;case 210:return o=this.view.getInt32(this.offset+1),this.offset+=5,o;case 211:return o=Zl(this.view,this.offset+1),this.offset+=9,o;case 212:return u=1,this.offset++,this.ext(u);case 213:return u=2,this.offset++,this.ext(u);case 214:return u=4,this.offset++,this.ext(u);case 215:return u=8,this.offset++,this.ext(u);case 216:return u=16,this.offset++,this.ext(u);case 217:return u=this.view.getUint8(this.offset+1),this.offset+=2,this.str(u);case 218:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.str(u);case 219:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.str(u);case 220:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.array(u);case 221:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.array(u);case 222:return u=this.view.getUint16(this.offset+1),this.offset+=3,this.map(u);case 223:return u=this.view.getUint32(this.offset+1),this.offset+=5,this.map(u)}throw new Error("Unknown type 0x"+l.toString(16))},this.offset=a||0,this.view=i}};function Vs(i){const a=new DataView(i),l=new Tt(a),o=l.parse();if(l.offset!==i.byteLength)throw new Error(i.byteLength-l.offset+" trailing bytes");return o}function Bi(i,a){return Object.keys(i).filter(function(l){const o=i[l],u=typeof o;return(!a||o!=null)&&(u!=="function"||!!o.toJSON)})}function vn(i,a,l,o){const u=typeof i;if(typeof i=="string"){const f=hi(i);if(f<32)return a.setUint8(l,f|160),ya(a,l+1,i),1+f;if(f<256)return a.setUint8(l,217),a.setUint8(l+1,f),ya(a,l+2,i),2+f;if(f<65536)return a.setUint8(l,218),a.setUint16(l+1,f),ya(a,l+3,i),3+f;if(f<4294967296)return a.setUint8(l,219),a.setUint32(l+1,f),ya(a,l+5,i),5+f}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const f=i.byteLength;if(f<256)return a.setUint8(l,196),a.setUint8(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+2),2+f;if(f<65536)return a.setUint8(l,197),a.setUint16(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+3),3+f;if(f<4294967296)return a.setUint8(l,198),a.setUint32(l+1,f),new Uint8Array(a.buffer).set(new Uint8Array(i),l+5),5+f}if(typeof i=="number"){if(Math.floor(i)!==i)return a.setUint8(l,203),a.setFloat64(l+1,i),9;if(i>=0){if(i<128)return a.setUint8(l,i),1;if(i<256)return a.setUint8(l,204),a.setUint8(l+1,i),2;if(i<65536)return a.setUint8(l,205),a.setUint16(l+1,i),3;if(i<4294967296)return a.setUint8(l,206),a.setUint32(l+1,i),5;if(i<18446744073709552e3)return a.setUint8(l,207),tt(a,l+1,i),9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return a.setInt8(l,i),1;if(i>=-128)return a.setUint8(l,208),a.setInt8(l+1,i),2;if(i>=-32768)return a.setUint8(l,209),a.setInt16(l+1,i),3;if(i>=-2147483648)return a.setUint8(l,210),a.setInt32(l+1,i),5;if(i>=-9223372036854776e3)return a.setUint8(l,211),xe(a,l+1,i),9;throw new Error("Number too small -0x"+(-i).toString(16).substr(1))}if(u==="undefined")return o?0:(a.setUint8(l,212),a.setUint8(l+1,0),a.setUint8(l+2,0),3);if(i===null)return o?0:(a.setUint8(l,192),1);if(u==="boolean")return a.setUint8(l,i?195:194),1;if(typeof i.toJSON=="function")return vn(i.toJSON(),a,l,o);if(u==="object"){let f,p=0,m;const T=Array.isArray(i);if(T?f=i.length:(m=Bi(i,o),f=m.length),f<16?(a.setUint8(l,f|(T?144:128)),p=1):f<65536?(a.setUint8(l,T?220:222),a.setUint16(l+1,f),p=3):f<4294967296&&(a.setUint8(l,T?221:223),a.setUint32(l+1,f),p=5),T)for(let S=0;S<f;S++)p+=vn(i[S],a,l+p,o);else if(m)for(let S=0;S<f;S++){const B=m[S];p+=vn(B,a,l+p),p+=vn(i[B],a,l+p,o)}return p}if(u==="function")return 0;throw new Error("Unknown type "+u)}function gi(i,a){const l=typeof i;if(l==="string"){const o=hi(i);if(o<32)return 1+o;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(ArrayBuffer.isView&&ArrayBuffer.isView(i)&&(i=i.buffer),i instanceof ArrayBuffer){const o=i.byteLength;if(o<256)return 2+o;if(o<65536)return 3+o;if(o<4294967296)return 5+o}if(typeof i=="number"){if(Math.floor(i)!==i)return 9;if(i>=0){if(i<128)return 1;if(i<256)return 2;if(i<65536)return 3;if(i<4294967296)return 5;if(i<18446744073709552e3)return 9;throw new Error("Number too big 0x"+i.toString(16))}if(i>=-32)return 1;if(i>=-128)return 2;if(i>=-32768)return 3;if(i>=-2147483648)return 5;if(i>=-9223372036854776e3)return 9;throw new Error("Number too small -0x"+i.toString(16).substr(1))}if(l==="boolean")return 1;if(i===null)return a?0:1;if(i===void 0)return a?0:3;if(typeof i.toJSON=="function")return gi(i.toJSON(),a);if(l==="object"){let o,u=0;if(Array.isArray(i)){o=i.length;for(let f=0;f<o;f++)u+=gi(i[f],a)}else{const f=Bi(i,a);o=f.length;for(let p=0;p<o;p++){const m=f[p];u+=gi(m)+gi(i[m],a)}}if(o<16)return 1+u;if(o<65536)return 3+u;if(o<4294967296)return 5+u;throw new Error("Array or object too long 0x"+o.toString(16))}if(l==="function")return 0;throw new Error("Unknown type "+l)}var zi={encode:qs,decode:Vs,inspect:rs,utf8Write:ya,utf8Read:Ql,utf8ByteCount:hi};function va(i,a){return!!a.get("x-ably-errorcode")}function Yc(i,a){if(va(i,a))return i.error&&_.fromValues(i.error)}function At(i){const a={};return i.forEach((l,o)=>{a[o]=l}),a}async function Kl(i,a,l,o,u,f){const p=new Headers(o||{}),m=i?i.toUpperCase():I(f)?"GET":"POST",T=new AbortController;let S;const B=new Promise(j=>{S=setTimeout(()=>{T.abort(),j({error:new de("Request timed out",null,408)})},a?a.options.timeouts.httpRequestTimeout:ve.TIMEOUTS.httpRequestTimeout)}),z={method:m,headers:p,body:f,signal:T.signal};x.Config.isWebworker||(z.credentials=p.has("authorization")?"include":"same-origin");const Q=(async()=>{try{const j=new URLSearchParams(u||{});j.set("rnd",st());const F=l+"?"+j,$=await kn().fetch(F,z);if(clearTimeout(S),$.status==204)return{error:null,statusCode:$.status};const ge=$.headers.get("Content-Type");let Ve;ge&&ge.indexOf("application/x-msgpack")>-1?Ve=await $.arrayBuffer():ge&&ge.indexOf("application/json")>-1?Ve=await $.json():Ve=await $.text();const $e=!!ge&&ge.indexOf("application/x-msgpack")===-1,nt=At($.headers);return $.ok?{error:null,body:Ve,headers:nt,unpacked:$e,statusCode:$.status}:{error:Yc(Ve,$.headers)||new de("Error response received from server: "+$.status+" body was: "+x.Config.inspect(Ve),null,$.status),body:Ve,headers:nt,unpacked:$e,statusCode:$.status}}catch(j){return clearTimeout(S),{error:j}}})();return Promise.race([B,Q])}var Jl={XHRRequest:Zn,FetchRequest:Kl},Wl=Li(ci,$a);x.Crypto=Wl,x.BufferUtils=$a,x.Http=Ro,x.Config=ci,x.Transports=Pl,x.WebStorage=da;for(const i of[Ns,In])i.Crypto=Wl,i._MsgPack=zi;Ro.bundledRequestImplementations=Jl,h.initLogHandlers(),x.Defaults=kr(ls),x.Config.agent&&(x.Defaults.agent+=" "+x.Config.agent);var Uo={ErrorInfo:_,Rest:Ns,Realtime:In,msgpack:zi,makeProtocolMessageFromDeserialized:xl};if(typeof A.exports=="object"&&typeof ce=="object"){var Pc=(i,a,l,o)=>{if(a&&typeof a=="object"||typeof a=="function")for(let u of Object.getOwnPropertyNames(a))!Object.prototype.hasOwnProperty.call(i,u)&&u!==l&&Object.defineProperty(i,u,{get:()=>a[u],enumerable:!(o=Object.getOwnPropertyDescriptor(a,u))||o.enumerable});return i};A.exports=Pc(A.exports,ce)}return A.exports})}(mc)),mc.exports}var vp=yp();const bp=df(vp),Sp={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:stun1.l.google.com:19302"},{urls:"turn:openrelay.metered.ca:80",username:"openrelayproject",credential:"openrelayproject"},{urls:"turn:openrelay.metered.ca:443",username:"openrelayproject",credential:"openrelayproject"}]},Op=(k,oe,ce,A,W)=>{const[J,Ue]=X.useState(null),[Le,ee]=X.useState(null),[L,te]=X.useState([]),[ke,we]=X.useState(!1),[pe,Ce]=X.useState(!1),[Fe,P]=X.useState(!1),[Ge,mt]=X.useState(!1),[Ke,x]=X.useState(!0),[he,Ae]=X.useState(null),[yt,vt]=X.useState(null),[Ie,_t]=X.useState("idle"),[h,He]=X.useState(null),Xe=X.useRef(null),_=X.useRef(null),de=X.useRef(null),N=X.useRef([]),U=X.useRef(null),ne=X.useRef(null),Te=X.useRef(Ie);X.useEffect(()=>{Te.current=Ie},[Ie]);const v=X.useCallback(async()=>{if(oe)try{const Y=await fetch("/api/data?limit=200&page=1");if(!Y.ok)throw new Error(`Failed to fetch message history: ${Y.status}`);const le=await Y.json();if(!le||!Array.isArray(le.items))return;const ie=le.items,st=ie.map(be=>{let Me;if(be.replyingTo){const _e=ie.find(Je=>String(Je.id)===String(be.replyingTo));_e&&(Me={id:String(_e.id),text:_e.message,username:_e.username})}return{type:"chat",id:String(be.id||`history-${Math.random()}`),text:be.message||"",username:be.username,timestamp:be.timestamp?new Date(be.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",replyingTo:Me,reactions:{}}}).reverse();te(be=>{const Me=new Set(be.map(Je=>Je.id));return[...st.filter(Je=>!Me.has(Je.id)),...be]})}catch(Y){console.error("Error fetching message history:",Y)}},[oe]),H=X.useCallback(()=>{Xe.current&&(Xe.current.onicecandidate=null,Xe.current.ontrack=null,Xe.current.ondatachannel=null,Xe.current.onconnectionstatechange=null,Xe.current.close(),Xe.current=null),_.current&&(_.current.onopen=null,_.current.onmessage=null,_.current.onclose=null,_.current=null),ee(null),we(!1),N.current=[]},[]),I=X.useCallback(()=>{H(),_t("idle"),He(null),U.current=null,ne.current=null,W()},[H,W]),K=X.useCallback(()=>{de.current?.presence.leave(),de.current?.unsubscribe(),de.current=null,I(),J?.getTracks().forEach(Y=>Y.stop()),Ue(null),Ce(!1),P(!1),te([]),Ae(null)},[J,I]),se=X.useCallback((Y,le,ie)=>{te(st=>st.map(be=>{if(be.id!==Y)return be;const Me={...be.reactions||{}},_e=Me[le]||[];return _e.includes(ie)?(Me[le]=_e.filter(Je=>Je!==ie),Me[le].length===0&&delete Me[le]):Me[le]=[..._e,ie],{...be,reactions:Me}}))},[]),Re=X.useCallback(Y=>{Y.onopen=()=>console.log("Data channel is open"),Y.onmessage=le=>{const ie=JSON.parse(le.data);ie.type==="chat"?te(st=>[...st,{...ie}]):ie.type==="reaction"?se(ie.messageId,ie.emoji,ie.username):(ie.type==="draw"||ie.type==="clear"||ie.type==="text")&&vt(ie)},Y.onclose=()=>console.log("Data channel is closed"),_.current=Y},[se]),re=X.useCallback(Y=>{H();const le=new RTCPeerConnection(Sp);return le.onicecandidate=ie=>{if(ie.candidate&&de.current&&k){const st={type:"ice-candidate",candidate:ie.candidate.toJSON(),from:k.auth.clientId};de.current.publish("webrtc-signal",st)}},le.ontrack=ie=>ee(ie.streams[0]),le.ondatachannel=ie=>{Re(ie.channel)},le.onconnectionstatechange=()=>{const ie=le.connectionState;ie==="connected"&&(we(!0),Te.current==="outgoing"&&ne.current&&(A(ne.current),ne.current=null),_t("idle")),(ie==="failed"||ie==="closed"||ie==="disconnected")&&I()},Y&&Y.getTracks().forEach(ie=>le.addTrack(ie,Y)),Xe.current=le,le},[H,Re,k,A,I]),et=X.useCallback(async(Y,le)=>{if(J)return J;try{const ie=await navigator.mediaDevices.getUserMedia({video:Y,audio:le});return Ue(ie),x(Y),Ae(null),ie}catch(ie){return console.error("Error accessing media devices.",ie),ie.name==="NotFoundError"||ie.name==="DevicesNotFoundError"?Ae("No camera or microphone found. Voice and video calls are disabled."):ie.name==="NotAllowedError"||ie.name==="PermissionDeniedError"?Ae("Permission for camera and microphone was denied. Voice and video calls are disabled."):Ae("Could not access camera or microphone."),Ue(null),null}},[J]),Be=X.useCallback(async Y=>{if(Xe.current)if(Xe.current.remoteDescription)try{await Xe.current.addIceCandidate(new RTCIceCandidate(Y))}catch(le){console.error("Error adding received ICE candidate",le)}else N.current.push(Y)},[]),Kt=X.useCallback(async Y=>{const le=Xe.current;if(!(!le||le.signalingState!=="have-local-offer")){await le.setRemoteDescription({type:"answer",sdp:Y});for(const ie of N.current)await Be(ie);N.current=[]}},[Be]),Un=X.useCallback(async Y=>{if(!k||Te.current!=="idle")return;_t("outgoing"),ne.current=Y;const ie=Y==="video"||Y==="voice"?await et(Y==="video",!0):null,st=re(ie),be=st.createDataChannel("chat");Re(be);const Me=await st.createOffer();await st.setLocalDescription(Me);const _e={type:"offer",sdp:Me.sdp,from:k.auth.clientId,callType:Y};await de.current.publish("webrtc-signal",_e)},[k,et,re,Re]),Wn=X.useCallback(async()=>{if(!k||Te.current!=="incoming"||!h||!U.current)return;const Y=U.current,le=h.callType,st=le==="video"||le==="voice"?await et(le==="video",!0):null,be=re(st);await be.setRemoteDescription({type:"offer",sdp:Y});for(const Je of N.current)await Be(Je);N.current=[];const Me=await be.createAnswer();await be.setLocalDescription(Me);const _e={type:"answer",sdp:Me.sdp,from:k.auth.clientId};await de.current.publish("webrtc-signal",_e),A(le)},[k,h,et,re,Be,A]),tn=X.useCallback(async()=>{if(!k||!h)return;const Y={type:"reject",from:k.auth.clientId};await de.current?.publish("webrtc-signal",Y),_t("idle"),He(null),U.current=null},[k,h]),V=X.useCallback(async()=>{if(!k)return;const Y={type:"cancel",from:k.auth.clientId};await de.current?.publish("webrtc-signal",Y),I()},[k,I]);X.useEffect(()=>{k&&oe&&ce&&!pe&&(Ce(!0),v())},[k,oe,ce,pe,v]),X.useEffect(()=>{if(!pe||!k||!ce)return;const Y=k.auth.clientId,le=k.channels.get(`p2p-chat:${ce}`);de.current=le;const ie=be=>{const Me=be.data;if(!(!Me||Me.from===Y))switch(Me.type){case"offer":if(Te.current!=="idle")return;U.current=Me.sdp,He({callType:Me.callType,from:Me.from}),_t("incoming");break;case"answer":Kt(Me.sdp);break;case"ice-candidate":Be(Me.candidate);break;case"reject":case"cancel":I();break}};le.subscribe("webrtc-signal",ie);const st=be=>{if(be.clientId!==Y){if(be.action==="enter"||be.action==="present")P(!0);else if(be.action==="leave"){if(P(!1),Te.current==="incoming"&&h?.from===be.clientId){I();return}Xe.current&&Xe.current.connectionState==="connected"&&I()}}};return le.presence.subscribe(st),le.presence.get().then(be=>{P(be.some(Me=>Me.clientId!==Y))}),le.presence.enter(),()=>{le.unsubscribe(),le.presence.unsubscribe(),le.presence.leave()}},[pe,k,ce,Kt,Be,I,h]);const Z=X.useCallback((Y,le)=>{if(!oe)return;let ie;if(le){const be=L.find(Me=>Me.id===le);be&&(ie={id:be.id,text:be.text,username:be.username})}const st={type:"chat",id:Date.now().toString(),text:Y,username:oe,timestamp:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),replyingTo:ie};te(be=>[...be,st]),_.current?.readyState==="open"&&_.current.send(JSON.stringify({...st})),fetch("/api/data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:oe,imageUrl:null,replyingTo:le||null,message:Y})}).catch(be=>console.error("Failed to save message to server:",be))},[oe,L]),De=X.useCallback((Y,le)=>{if(oe){if(se(Y,le,oe),_.current?.readyState==="open"){const ie={type:"reaction",messageId:Y,emoji:le,username:oe};_.current.send(JSON.stringify(ie))}fetch(`/api/data/${Y}/reactions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:oe,emoji:le})}).catch(ie=>console.error("Failed to save message to server:",ie))}},[oe,se]),ht=X.useCallback(Y=>{_.current?.readyState==="open"&&_.current.send(JSON.stringify(Y))},[]),Qe=X.useCallback(Y=>{_.current?.readyState==="open"&&_.current.send(JSON.stringify(Y))},[]),Ye=X.useCallback(()=>{_.current?.readyState==="open"&&_.current.send(JSON.stringify({type:"clear"}))},[]),jt=X.useCallback(()=>{J&&(J.getAudioTracks()[0].enabled=!J.getAudioTracks()[0].enabled,mt(!J.getAudioTracks()[0].enabled))},[J]),Jt=X.useCallback(()=>{J&&(J.getVideoTracks()[0].enabled=!J.getVideoTracks()[0].enabled,x(J.getVideoTracks()[0].enabled))},[J]);return X.useEffect(()=>{},[]),{localStream:J,remoteStream:Le,messages:L,hasJoinedRoom:pe,isConnected:ke,isMuted:Ge,isVideoEnabled:Ke,mediaError:he,lastCanvasEvent:yt,isPeerPresent:Fe,callState:Ie,incomingCallInfo:h,startCall:Un,sendMessage:Z,hangUp:K,toggleMute:jt,toggleVideo:Jt,sendDrawData:ht,sendClearCanvas:Ye,sendTextData:Qe,acceptCall:Wn,rejectCall:tn,cancelCall:V,sendReaction:De}},Ap=({onJoin:k,isJoining:oe})=>{const[ce,A]=X.useState("Queenofmissuniverse"),[W,J]=X.useState("uuu"),Ue=Le=>{Le.preventDefault(),ce.trim()&&!oe&&k(ce.trim(),W)};return w.jsx("div",{className:"p-6 bg-dark-surface rounded-lg shadow-lg max-w-md mx-auto text-center",children:w.jsxs("form",{onSubmit:Ue,className:"flex flex-col gap-4",children:[w.jsx("button",{type:"submit",onClick:()=>J("uuu"),className:"w-50 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"uuu"}),w.jsx("button",{type:"submit",onClick:()=>J("g11h"),className:"w-50 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-lg transition-colors",children:"g11h"})]})})},pt=({path:k,className:oe="w-6 h-6"})=>w.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:oe,"aria-hidden":"true",children:w.jsx("path",{fillRule:"evenodd",d:k,clipRule:"evenodd"})}),Ze={chat:"M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z",phone:"M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z",hangup:"M20.01 15.38c-1.23 0-2.42-.2-3.53-.56-.35-.12-.74-.03-1.01.24l-1.57 1.57c-2.83-1.35-5.21-3.73-6.56-6.56l1.57-1.57c.28-.28.36-.67.24-1.01-.37-1.11-.56-2.3-.56-3.53 0-.54-.45-.99-.99-.99H4.01c-.55 0-.99.45-.99.99 0 9.32 7.53 16.85 16.85 16.85.54 0 .99-.45-.99-.99v-3.54c0-.54-.45-.99-.99-.99z",video:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z",videoOff:"M21 6.5l-4 4V7c0-.55-.45-1-1-1H9.82L21 17.18V6.5zM3.27 2L2 3.27 4.73 6H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.22 0 .42-.08.58-.2L20.73 21 22 19.73 3.27 2z",send:"M2.01 21L23 12 2.01 3 2 10l15 2-15 2z",mic:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5-3c0 2.76-2.24 5-5 5s-5-2.24-5-5H5c0 3.53 2.61 6.43 6 6.92V21h2v-3.08c3.39-.49 6-3.39 6-6.92h-2z",micOff:"M10.8 4.9c0-.66.54-1.2 1.2-1.2.66 0 1.2.54 1.2 1.2l-.01 3.18 1.66 1.66 0-.02c0-1.55-1.11-2.82-2.6-3.15v-1.1c0-.41-.34-.75-.75-.75s-.75.34-.75.75v1.1C9.01 4.58 8 5.85 8 7.4v.02l1.66 1.66L10.8 4.9zM19 11h-1.7c0 .74-.16 1.43-.43 2.05l1.23 1.23c.56-.98.9-2.09.9-3.28zM3.41 1.86L2 3.27 4.73 6H5c0 3.53 2.61 6.43 6 6.92V17h2v-4.08c.12 0 .23-.01.35-.02l2.54 2.54c-.69.44-1.46.77-2.28.98V17h2v-1.08c1.99-.43 3.61-1.78 4.29-3.48l1.45 1.45L20.73 15l-17.32-17.14z",reply:"M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z",pen:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 00-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z",eraser:"M6.29 2.56c.39-.39 1.02-.39 1.41 0l2.59 2.59c.39.39.39 1.02 0 1.41L3.81 13.04c-.39.39-1.02.39-1.41 0L.11 10.75c-.39-.39-.39-1.02 0-1.41l6.18-6.78zm13.35 12.08l-3.95-3.95-6.18 6.78c-.39.39-.39 1.02 0 1.41l2.59 2.59c.39.39 1.02.39 1.41 0l6.13-6.83z",text:"M2.5 4v3h5v12h3V7h5V4h-13zM21.5 9h-9v3h3v7h3v-7h3V9z",undo:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.38 11.23 17.34 8 12.5 8z",redo:"M18 10h-9l3.62-3.62c-1.39-1.16-3.16-1.88-5.12-1.88C3.66 4.5 1.13 6.94.36 10.22l-2.37-.78C-1.18 5.77 2.66 2 7.5 2c2.65 0 5.05.99 6.9 2.6L18 1v9z",zoomIn:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM10 7H9v2H7v1h2v2h1v-2h2V9h-2V7z",zoomOut:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z",resetView:"M12 6v3l4-4-4-4v3c-4.42 0-8 3.58-8 8 0 1.57.46 3.03 1.24 4.26L6.7 14.8c-.45-.83-.7-1.79-.7-2.8 0-3.31 2.69-6 6-6zm6.76 1.74L17.3 9.2c.44.84.7 1.79.7 2.8 0 3.31-2.69 6-6 6v-3l-4 4 4 4v-3c4.42 0 8-3.58 8-8 0-1.57-.46-3.03-1.24-4.26z"},Rp=["👍","❤️","😂","🎉","😢"],Tp=({messages:k,sendMessage:oe,sendReaction:ce,currentUsername:A})=>{const[W,J]=X.useState(""),[Ue,Le]=X.useState(null),[ee,L]=X.useState(null),te=X.useRef(null),ke=X.useRef(null);console.log("activeMenuId:",Ue);const we=()=>{te.current?.scrollIntoView({behavior:"smooth"})};X.useEffect(we,[k]),X.useEffect(()=>{const P=Ge=>{ke.current&&!ke.current.contains(Ge.target)&&Le(null)};return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]);const pe=P=>{P.preventDefault(),W.trim()&&(oe(W.trim(),ee?.id),J(""),L(null))},Ce=(P,Ge)=>{ce(P,Ge),Le(null)},Fe=P=>{L(P),Le(null)};return w.jsxs("div",{className:"flex flex-col h-full bg-dark-surface rounded-b-lg",children:[w.jsxs("div",{className:"flex-1 p-4 overflow-y-auto space-y-2",children:[k.map(P=>w.jsxs("div",{className:`group flex items-end gap-2 ${P.username===A?"justify-end":"justify-start"}`,children:[w.jsxs("div",{onClick:Ge=>{Ge.stopPropagation(),Le(mt=>P.id==mt?null:P.id),console.log("clicked",P.id)},className:`relative max-w-xs lg:max-w-md px-4 py-2 rounded-2xl cursor-pointer ${P.username===A?"bg-blue-600 text-white rounded-br-none":"bg-gray-600 text-dark-text-primary rounded-bl-none"}`,children:[P.replyingTo&&w.jsxs("div",{className:"mb-2 p-2 border-l-2 border-blue-300 bg-black/20 rounded-lg",children:[w.jsx("p",{className:"font-bold text-xs opacity-80",children:P.replyingTo.username}),w.jsx("p",{className:"text-sm opacity-80 truncate",children:P.replyingTo.text})]}),w.jsx("p",{className:"text-sm whitespace-pre-wrap break-words",children:P.text}),w.jsx("p",{className:"text-xs text-right mt-1 opacity-50",children:P.timestamp}),P.reactions&&Object.keys(P.reactions).length>0&&w.jsx("div",{className:" -bottom-3 right-2 flex gap-1",children:Object.entries(P.reactions).map(([Ge,mt])=>mt.length>0&&w.jsxs("div",{className:"bg-dark-surface border border-dark-border rounded-full px-2 py-0.5 text-xs flex items-center shadow",children:[w.jsx("span",{children:Ge}),w.jsx("span",{className:"ml-1 text-dark-text-secondary font-bold",children:mt.length})]},Ge))})]}),Ue==P.id&&w.jsxs("div",{ref:ke,className:" z-10 -mt-8 bg-dark-surface border border-dark-border p-1 rounded-full shadow-lg flex items-center gap-1",children:[Rp.map(Ge=>w.jsx("button",{onClick:()=>Ce(P.id,Ge),className:`p-1.5 rounded-full hover:bg-gray-600 transition-colors text-xl leading-none ${P.reactions?.[Ge]?.includes(A)?"bg-blue-800":""}`,children:Ge},Ge)),w.jsx("div",{className:"w-px h-6 bg-dark-border mx-1"}),w.jsx("button",{onClick:()=>Fe(P),className:"p-1.5 rounded-full hover:bg-gray-600 transition-colors",children:w.jsx(pt,{path:Ze.reply,className:"w-5 h-5"})})]})]},P.id)),w.jsx("div",{ref:te})]}),w.jsxs("div",{className:"p-4 border-t border-dark-border",children:[ee&&w.jsxs("div",{className:"mb-2 p-2 bg-gray-800 rounded-lg text-sm relative",children:[w.jsxs("p",{className:"font-bold text-dark-text-secondary",children:["Replying to ",ee.username]}),w.jsx("p",{className:"text-dark-text-primary truncate",children:ee.text}),w.jsx("button",{onClick:()=>L(null),className:"absolute top-1 right-1 p-1 rounded-full hover:bg-gray-700",children:w.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:w.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),w.jsxs("form",{onSubmit:pe,className:"flex items-center gap-4",children:[w.jsx("input",{type:"text",value:W,onChange:P=>J(P.target.value),placeholder:"Type a message...",className:"flex-1 bg-gray-700 border border-gray-600 rounded-full py-2 px-4 focus:outline-none focus:ring-2 focus:ring-blue-500 text-dark-text-primary"}),w.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white rounded-full p-3 transition-colors disabled:bg-gray-500 disabled:cursor-not-allowed","aria-label":"Send message",children:w.jsx(pt,{path:Ze.send,className:"w-6 h-6"})})]})]})]})},Cp=({localStream:k,remoteStream:oe,isMuted:ce,isVideoEnabled:A,onToggleMute:W,onToggleVideo:J,onHangUp:Ue})=>{const Le=X.useRef(null),ee=X.useRef(null);return X.useEffect(()=>{Le.current&&k&&(Le.current.srcObject=k)},[k]),X.useEffect(()=>{ee.current&&oe&&(ee.current.srcObject=oe)},[oe]),w.jsxs("div",{className:"relative h-full w-full bg-black rounded-b-lg overflow-hidden",children:[w.jsx("video",{ref:ee,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}),!oe&&w.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-900",children:w.jsxs("div",{className:"text-center",children:[w.jsx(pt,{path:Ze.video,className:"w-16 h-16 mx-auto text-gray-500"}),w.jsx("p",{className:"mt-2 text-dark-text-secondary",children:"Waiting for peer to connect..."})]})}),w.jsx("video",{ref:Le,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute bottom-4 right-4 w-1/4 max-w-[200px] rounded-lg border-2 border-dark-border shadow-lg",style:{display:k?"block":"none"}}),!k&&w.jsx("div",{className:"absolute bottom-4 right-4 w-1/4 max-w-[200px] h-auto aspect-video rounded-lg border-2 border-dark-border bg-gray-800 flex items-center justify-center",children:w.jsx(pt,{path:Ze.videoOff,className:"w-8 h-8 text-gray-500"})}),w.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-black bg-opacity-50 flex justify-center items-center gap-4",children:[w.jsx("button",{onClick:W,className:`p-3 rounded-full transition-colors ${ce?"bg-red-600":"bg-gray-600 hover:bg-gray-500"}`,"aria-label":ce?"Unmute":"Mute",children:w.jsx(pt,{path:ce?Ze.micOff:Ze.mic})}),w.jsx("button",{onClick:J,className:`p-3 rounded-full transition-colors ${A?"bg-gray-600 hover:bg-gray-500":"bg-red-600"}`,"aria-label":A?"Disable Video":"Enable Video",children:w.jsx(pt,{path:A?Ze.video:Ze.videoOff})}),w.jsx("button",{onClick:Ue,className:"p-3 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Hang up",children:w.jsx(pt,{path:Ze.hangup})})]})]})},_p=({remoteStream:k,isMuted:oe,onToggleMute:ce,onHangUp:A})=>{const W=X.useRef(null);return X.useEffect(()=>{W.current&&k&&(W.current.srcObject=k,W.current.play().catch(J=>console.error("Error playing remote audio:",J)))},[k]),w.jsxs("div",{className:"flex flex-col h-full w-full items-center justify-center bg-dark-surface rounded-b-lg p-8",children:[w.jsx("audio",{ref:W,autoPlay:!0,playsInline:!0}),w.jsxs("div",{className:"text-center",children:[w.jsxs("div",{className:"relative inline-block",children:[w.jsx("div",{className:"w-40 h-40 rounded-full bg-gray-700 flex items-center justify-center",children:w.jsx(pt,{path:Ze.phone,className:"w-20 h-20 text-blue-400"})}),k&&w.jsx("span",{className:"absolute bottom-0 right-0 block h-8 w-8 rounded-full bg-green-500 border-4 border-dark-surface animate-pulse"})]}),w.jsx("h2",{className:"text-2xl font-bold mt-6 text-dark-text-primary",children:"Voice Call in Progress"}),w.jsx("p",{className:"text-dark-text-secondary mt-2",children:k?"You are connected to your peer.":"Waiting for peer to connect..."})]}),w.jsxs("div",{className:"mt-12 flex justify-center items-center gap-6",children:[w.jsx("button",{onClick:ce,className:`p-4 rounded-full transition-colors ${oe?"bg-red-600":"bg-gray-600 hover:bg-gray-500"}`,"aria-label":oe?"Unmute":"Mute",children:w.jsx(pt,{path:oe?Ze.micOff:Ze.mic,className:"w-8 h-8"})}),w.jsx("button",{onClick:A,className:"p-4 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Hang up",children:w.jsx(pt,{path:Ze.hangup,className:"w-8 h-8"})})]})]})},Id="#1F2937",Yd=20,Ep=({sendDrawData:k,sendTextData:oe,sendClearCanvas:ce,lastCanvasEvent:A})=>{const W=X.useRef(null),[J,Ue]=X.useState("pen"),[Le,ee]=X.useState("#FFFFFF"),[L,te]=X.useState(5),[ke,we]=X.useState(!1),pe=X.useRef(null),[Ce,Fe]=X.useState({active:!1,x:0,y:0,value:""}),[P,Ge]=X.useState({scale:1,offset:{x:0,y:0}}),[mt,Ke]=X.useState(!1),x=X.useRef({x:0,y:0}),he=X.useRef(null),Ae=X.useRef(null),[yt,vt]=X.useState([]),[Ie,_t]=X.useState([]),[h,He]=X.useState(-1),Xe=X.useCallback(()=>{const V=W.current;if(!V)return;const Z=V.parentElement;if(!Z)return;const De=window.devicePixelRatio||1;V.width=Z.clientWidth*De,V.height=Z.clientHeight*De;const ht=V.getContext("2d");ht&&ht.scale(De,De)},[]);X.useEffect(()=>(Xe(),window.addEventListener("resize",Xe),()=>window.removeEventListener("resize",Xe)),[Xe]),X.useEffect(()=>{A&&(A.type==="draw"||A.type==="text"?vt(V=>[...V,A]):A.type==="clear"&&(vt([]),_t([]),He(-1)))},[A]);const _=V=>{const Z=Ie.slice(0,h+1);Z.push(V),_t(Z),He(Z.length-1)};X.useEffect(()=>{const V=W.current,Z=V?.getContext("2d");if(!V||!Z)return;const De=window.devicePixelRatio||1;Z.save(),Z.setTransform(De,0,0,De,0,0),Z.fillStyle=Id,Z.fillRect(0,0,V.width,V.height),Z.restore(),Z.save(),Z.translate(P.offset.x,P.offset.y),Z.scale(P.scale,P.scale);const ht=Ie.slice(0,h+1),Qe=[...yt,...ht];for(const Ye of Qe)Ye.type==="draw"?(Z.beginPath(),Z.moveTo(Ye.x0,Ye.y0),Z.lineTo(Ye.x1,Ye.y1),Z.strokeStyle=Ye.tool==="eraser"?Id:Ye.color,Z.lineWidth=Ye.lineWidth,Z.lineCap="round",Z.lineJoin="round",Z.stroke(),Z.closePath()):Ye.type==="text"&&(Z.font=Ye.font,Z.fillStyle=Ye.color,Z.textAlign="left",Z.textBaseline="top",Z.fillText(Ye.text,Ye.x,Ye.y));Z.restore()},[yt,Ie,h,P]);const de=(V,Z)=>{const De=W.current;if(!De)return null;const ht=De.getBoundingClientRect(),Qe=(V-ht.left-P.offset.x)/P.scale,Ye=(Z-ht.top-P.offset.y)/P.scale;return{x:Qe,y:Ye}},N=V=>{const Z=de("touches"in V.nativeEvent?V.nativeEvent.touches[0].clientX:V.nativeEvent.clientX,"touches"in V.nativeEvent?V.nativeEvent.touches[0].clientY:V.nativeEvent.clientY);Z&&(we(!0),pe.current=Z)},U=V=>{if(!ke)return;const Z=de("touches"in V.nativeEvent?V.nativeEvent.touches[0].clientX:V.nativeEvent.clientX,"touches"in V.nativeEvent?V.nativeEvent.touches[0].clientY:V.nativeEvent.clientY),De=pe.current;if(!Z||!De)return;const ht={type:"draw",tool:J,x0:De.x,y0:De.y,x1:Z.x,y1:Z.y,color:Le,lineWidth:L};_(ht),k(ht),pe.current=Z},ne=()=>{we(!1),pe.current=null},Te=()=>{if(!Ce.active||!Ce.value.trim()){Fe({active:!1,x:0,y:0,value:""});return}const V=`${Yd}px sans-serif`,Z={type:"text",x:Ce.x,y:Ce.y,text:Ce.value,color:Le,font:V};_(Z),oe(Z),Fe({active:!1,x:0,y:0,value:""})},v=V=>{if(V.button===0){if(J==="pen"||J==="eraser")N(V);else if(J==="text"){Te();const Z=de(V.clientX,V.clientY);Z&&Fe({active:!0,x:Z.x,y:Z.y,value:""})}}else V.button===2&&(Ke(!0),x.current={x:V.clientX-P.offset.x,y:V.clientY-P.offset.y})},H=V=>{mt?Ge(Z=>({...Z,offset:{x:V.clientX-x.current.x,y:V.clientY-x.current.y}})):ke&&U(V)},I=V=>{V.button===0?ne():V.button===2&&Ke(!1)},K=V=>{if(V.touches.length===1){if(J==="pen"||J==="eraser")N(V);else if(J==="text"){Te();const Z=de(V.touches[0].clientX,V.touches[0].clientY);Z&&Fe({active:!0,x:Z.x,y:Z.y,value:""})}}else if(V.touches.length>=2){we(!1);const Z=V.touches[0],De=V.touches[1];he.current=Math.hypot(Z.clientX-De.clientX,Z.clientY-De.clientY),Ae.current={x:(Z.clientX+De.clientX)/2,y:(Z.clientY+De.clientY)/2},x.current={x:Ae.current.x-P.offset.x,y:Ae.current.y-P.offset.y}}},se=V=>{if(V.touches.length===1)U(V);else if(V.touches.length>=2){V.preventDefault();const Z=V.touches[0],De=V.touches[1],ht=Math.hypot(Z.clientX-De.clientX,Z.clientY-De.clientY),Qe={x:(Z.clientX+De.clientX)/2,y:(Z.clientY+De.clientY)/2},Ye=Qe.x-x.current.x,jt=Qe.y-x.current.y,Jt=he.current?ht/he.current:1,Y=W.current;if(!Y)return;const le=Y.getBoundingClientRect(),ie=Qe.x-le.left,st=Qe.y-le.top,be=ie-(ie-Ye)*Jt,Me=st-(st-jt)*Jt;Ge(_e=>({scale:Math.max(.1,Math.min(10,_e.scale*Jt)),offset:{x:be,y:Me}})),he.current=ht,x.current={x:Qe.x-be,y:Qe.y-Me}}},Re=()=>{he.current=null,Ae.current=null,ne()},re=V=>{V.preventDefault();const Z=-V.deltaY*.001,De=Math.max(.1,Math.min(10,P.scale+Z)),ht=W.current;if(!ht)return;const Qe=ht.getBoundingClientRect(),Ye=V.clientX-Qe.left,jt=V.clientY-Qe.top,Jt=(Ye-P.offset.x)/P.scale,Y=(jt-P.offset.y)/P.scale,le=Ye-Jt*De,ie=jt-Y*De;Ge({scale:De,offset:{x:le,y:ie}})},et=()=>He(V=>Math.max(-1,V-1)),Be=()=>He(V=>Math.min(Ie.length-1,V+1)),Kt=()=>{vt([]),_t([]),He(-1),ce()},Un=V=>{const Z=W.current;if(!Z)return;const{width:De,height:ht}=Z.getBoundingClientRect(),Qe=De/2,Ye=ht/2,jt=Math.max(.1,Math.min(10,P.scale*V)),Jt=(Qe-P.offset.x)/P.scale,Y=(Ye-P.offset.y)/P.scale,le=Qe-Jt*jt,ie=Ye-Y*jt;Ge({scale:jt,offset:{x:le,y:ie}})},Wn=()=>{Ge({scale:1,offset:{x:0,y:0}})},tn=({myTool:V,label:Z,icon:De})=>w.jsx("button",{onClick:()=>Ue(V),className:`p-2 rounded-lg transition-colors ${J===V?"bg-blue-600 text-white":"bg-dark-surface hover:bg-gray-600"}`,"aria-label":Z,children:w.jsx(pt,{path:De,className:"w-5 h-5"})});return w.jsxs("div",{className:"relative h-full w-full bg-gray-800 rounded-b-lg touch-none",style:{cursor:J==="text"?"text":mt?"grabbing":"crosshair"},children:[w.jsx("canvas",{ref:W,className:"w-full h-full",onMouseDown:v,onMouseUp:I,onMouseLeave:I,onMouseMove:H,onWheel:re,onContextMenu:V=>V.preventDefault(),onTouchStart:K,onTouchEnd:Re,onTouchCancel:Re,onTouchMove:se}),w.jsxs("div",{className:"absolute top-2 left-2 flex flex-wrap items-center gap-2 bg-dark-bg p-2 rounded-lg shadow-md",children:[w.jsxs("div",{className:"flex items-center gap-1 border-r border-dark-border pr-2",children:[w.jsx(tn,{myTool:"pen",label:"Pen",icon:Ze.pen}),w.jsx(tn,{myTool:"eraser",label:"Eraser",icon:Ze.eraser}),w.jsx(tn,{myTool:"text",label:"Text",icon:Ze.text})]}),w.jsxs("div",{className:"flex items-center gap-1 border-r border-dark-border pr-2",children:[w.jsx("button",{onClick:et,disabled:h<0,className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Undo",children:w.jsx(pt,{path:Ze.undo,className:"w-5 h-5"})}),w.jsx("button",{onClick:Be,disabled:h>=Ie.length-1,className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Redo",children:w.jsx(pt,{path:Ze.redo,className:"w-5 h-5"})})]}),w.jsxs("div",{className:"flex items-center gap-1 border-r border-dark-border pr-2",children:[w.jsx("button",{onClick:()=>Un(1.2),className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600","aria-label":"Zoom In",children:w.jsx(pt,{path:Ze.zoomIn,className:"w-5 h-5"})}),w.jsx("button",{onClick:()=>Un(.8),className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600","aria-label":"Zoom Out",children:w.jsx(pt,{path:Ze.zoomOut,className:"w-5 h-5"})}),w.jsx("button",{onClick:Wn,className:"p-2 rounded-lg transition-colors bg-dark-surface hover:bg-gray-600","aria-label":"Reset View",children:w.jsx(pt,{path:Ze.resetView,className:"w-5 h-5"})})]}),w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("input",{type:"color",id:"color-picker",value:Le,onChange:V=>ee(V.target.value),className:"w-8 h-8 p-0 border-none rounded bg-dark-surface cursor-pointer"}),w.jsx("input",{type:"range",id:"line-width",min:"1",max:"50",value:L,onChange:V=>te(Number(V.target.value)),className:"w-24 cursor-pointer"})]}),w.jsx("button",{onClick:Kt,className:"bg-red-600 hover:bg-red-700 text-white text-sm font-bold py-2 px-3 rounded-lg transition-colors",children:"Clear All"})]}),Ce.active&&w.jsx("textarea",{autoFocus:!0,value:Ce.value,onChange:V=>Fe(Z=>({...Z,value:V.target.value})),onBlur:Te,onKeyDown:V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),Te())},style:{position:"absolute",left:`${P.offset.x+Ce.x*P.scale}px`,top:`${P.offset.y+Ce.y*P.scale}px`,transform:`scale(${P.scale})`,transformOrigin:"top left",fontSize:`${Yd}px`,lineHeight:1.2,color:Le,background:"transparent",border:`1px dashed ${Le}`,outline:"none",resize:"none",overflow:"hidden",minWidth:"100px"},className:"p-1 font-sans"})]})},Mp=k=>{switch(k){case"video":return{icon:Ze.video,name:"Video Call"};case"voice":return{icon:Ze.phone,name:"Voice Call"};case"canvas":return{icon:Ze.pen,name:"Canvas Session"};default:return{icon:Ze.chat,name:"Call"}}},wp=({callInfo:k,onAccept:oe,onReject:ce})=>{const{icon:A,name:W}=Mp(k.callType);return w.jsxs("div",{className:"flex flex-col h-full w-full items-center justify-center bg-dark-surface rounded-b-lg p-8",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"relative inline-block animate-pulse",children:w.jsx("div",{className:"w-40 h-40 rounded-full bg-gray-700 flex items-center justify-center",children:w.jsx(pt,{path:A,className:"w-20 h-20 text-blue-400"})})}),w.jsxs("h2",{className:"text-2xl font-bold mt-6 text-dark-text-primary",children:["Incoming ",W]}),w.jsx("p",{className:"text-dark-text-secondary mt-2",children:"You have an incoming call from your peer."})]}),w.jsxs("div",{className:"mt-12 flex justify-center items-center gap-6",children:[w.jsx("button",{onClick:ce,className:"p-4 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Reject Call",children:w.jsx(pt,{path:Ze.hangup,className:"w-8 h-8"})}),w.jsx("button",{onClick:oe,className:"p-4 rounded-full bg-green-600 hover:bg-green-700 transition-colors","aria-label":"Accept Call",children:w.jsx(pt,{path:Ze.phone,className:"w-8 h-8"})})]})]})},xp=({onCancel:k})=>w.jsxs("div",{className:"flex flex-col h-full w-full items-center justify-center bg-dark-surface rounded-b-lg p-8",children:[w.jsxs("div",{className:"text-center",children:[w.jsx("div",{className:"relative inline-block",children:w.jsxs("div",{className:"w-40 h-40 rounded-full bg-gray-700 flex items-center justify-center",children:[w.jsx("div",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-blue-400 opacity-75"}),w.jsx(pt,{path:Ze.phone,className:"w-20 h-20 text-blue-400"})]})}),w.jsx("h2",{className:"text-2xl font-bold mt-6 text-dark-text-primary",children:"Calling Peer..."}),w.jsx("p",{className:"text-dark-text-secondary mt-2",children:"Waiting for your peer to answer."})]}),w.jsx("div",{className:"mt-12 flex justify-center items-center gap-6",children:w.jsx("button",{onClick:k,className:"p-4 rounded-full bg-red-600 hover:bg-red-700 transition-colors","aria-label":"Cancel Call",children:w.jsx(pt,{path:Ze.hangup,className:"w-8 h-8"})})})]}),Np=()=>{const[k,oe]=X.useState("chat"),[ce,A]=X.useState(null),[W,J]=X.useState(null),[Ue,Le]=X.useState(""),[ee,L]=X.useState(""),te=X.useCallback(re=>{oe(re)},[]),ke=X.useCallback(()=>{oe("chat")},[]);X.useEffect(()=>{const re="I2tDaw.8aYbrA:AL3WVoe9M-LCuy9Fr4b14LuVnsoVUmQuj1t_6_2-a4k",et=new bp.Realtime({key:re,clientId:`user-${Math.random().toString(36).substring(2,9)}`});return et.connection.on("connected",()=>{A(et),J(null)}),et.connection.on("failed",Be=>{J(`Ably connection failed: ${Be.reason?.message??"Unknown error"}`)}),()=>{et.close()}},[]);const{localStream:we,remoteStream:pe,messages:Ce,hasJoinedRoom:Fe,isConnected:P,isMuted:Ge,isVideoEnabled:mt,mediaError:Ke,lastCanvasEvent:x,isPeerPresent:he,callState:Ae,incomingCallInfo:yt,startCall:vt,sendMessage:Ie,hangUp:_t,toggleMute:h,toggleVideo:He,sendDrawData:Xe,sendClearCanvas:_,sendTextData:de,acceptCall:N,rejectCall:U,cancelCall:ne,sendReaction:Te}=Op(ce,Ue,ee,te,ke),v=X.useCallback(()=>{_t(),oe("chat")},[_t]),H=X.useCallback((re,et)=>{ce&&(Le(et),L(re))},[ce]),I=X.useMemo(()=>{if(W)return w.jsx("div",{className:"p-8 text-center text-red-400",children:W});if(!ce||!Fe)return w.jsx("div",{className:"p-4 md:p-8 flex items-center justify-center h-full",children:w.jsx(Ap,{onJoin:H,isJoining:Ae!=="idle"})});if(Ae==="incoming"&&yt)return w.jsx(wp,{callInfo:yt,onAccept:N,onReject:U});if(Ae==="outgoing")return w.jsx(xp,{onCancel:ne});switch(k){case"video":return w.jsx(Cp,{localStream:we,remoteStream:pe,isMuted:Ge,isVideoEnabled:mt,onToggleMute:h,onToggleVideo:He,onHangUp:v});case"voice":return w.jsx(_p,{remoteStream:pe,isMuted:Ge,onToggleMute:h,onHangUp:v});case"canvas":return w.jsx(Ep,{sendDrawData:Xe,sendTextData:de,sendClearCanvas:_,lastCanvasEvent:x});case"chat":default:return w.jsx(Tp,{messages:Ce,sendMessage:Ie,sendReaction:Te,currentUsername:Ue})}},[ce,W,Fe,Ae,k,we,pe,Ge,mt,h,He,v,Ce,Ie,H,Ke,x,Xe,_,de,yt,N,U,ne,Te,Ue]),{statusText:K,statusColor:se}=X.useMemo(()=>Ae==="outgoing"?{statusText:"Calling...",statusColor:"bg-yellow-500"}:Ae==="incoming"?{statusText:"Incoming call...",statusColor:"bg-yellow-500"}:P?{statusText:"Connected",statusColor:"bg-green-500"}:Fe?he?{statusText:"Peer is present",statusColor:"bg-blue-500"}:{statusText:"Waiting for Peer",statusColor:"bg-orange-500"}:{statusText:"Disconnected",statusColor:"bg-red-500"},[Ae,P,Fe,he]),Re=X.useCallback(re=>{he&&!P&&Ae==="idle"&&vt(re),P&&oe(re)},[he,P,Ae,vt]);return w.jsx("div",{className:"antialiased min-h-screen flex flex-col items-center justify-center p-4 bg-dark-bg",children:w.jsxs("div",{className:"w-full max-w-4xl h-[90vh] flex flex-col bg-dark-surface rounded-lg shadow-2xl border border-dark-border",children:[w.jsx("header",{className:"flex items-center justify-between p-4 border-b border-dark-border",children:Fe&&w.jsx("div",{className:"flex items-center gap-4",children:w.jsx("div",{className:`px-3 py-1 rounded-full text-xs font-medium text-white ${se}`,children:K})})}),w.jsx("main",{className:"flex-1 overflow-y-auto relative",children:w.jsxs("div",{className:"h-full",children:[Ke&&Fe&&w.jsx("div",{className:"absolute top-0 left-0 right-0 p-2 bg-yellow-600 text-white text-center text-sm z-10 animate-pulse",children:w.jsx("p",{children:Ke})}),I]})}),Fe&&w.jsx("footer",{className:"flex items-center justify-center p-2 border-t border-dark-border",children:w.jsxs("nav",{className:"flex items-center gap-2",children:[w.jsx("button",{onClick:()=>oe("chat"),disabled:Ae!=="idle"&&!P,className:`p-2 rounded-full transition-colors ${k==="chat"&&P?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:w.jsx(pt,{path:Ze.chat})}),w.jsx("button",{onClick:()=>Re("voice"),disabled:!he||!!Ke||Ae!=="idle",title:Ke??(he?Ae==="idle"?"Start voice call":"Call in progress":"Waiting for a peer to join"),className:`p-2 rounded-full transition-colors ${k==="voice"&&P?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:w.jsx(pt,{path:Ze.phone})}),w.jsx("button",{onClick:()=>Re("video"),disabled:!he||!!Ke||Ae!=="idle",title:Ke??(he?Ae==="idle"?"Start video call":"Call in progress":"Waiting for a peer to join"),className:`p-2 rounded-full transition-colors ${k==="video"&&P?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:w.jsx(pt,{path:Ze.video})}),w.jsx("button",{onClick:()=>Re("canvas"),disabled:!he||Ae!=="idle",title:he?Ae==="idle"?"Start collaborative canvas":"Call in progress":"Waiting for a peer to join",className:`p-2 rounded-full transition-colors ${k==="canvas"&&P?"bg-blue-600":"hover:bg-gray-700"} disabled:opacity-50 disabled:cursor-not-allowed`,children:w.jsx(pt,{path:Ze.pen})})]})})]})})},Wd=document.getElementById("root");if(!Wd)throw new Error("Could not find root element to mount to");const Up=pp.createRoot(Wd);Up.render(w.jsx(rp.StrictMode,{children:w.jsx(Np,{})}));
